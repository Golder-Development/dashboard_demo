2026-01-29 21:20:19 +0000 ERROR:Session state variables not initialized!
2026-01-29 21:20:19 +0000 ERROR:Error: originalfilepath is None!
2026-01-29 21:20:23 +0000 ERROR:Cannot determine modification time for cleaned_donations.zip
2026-01-29 21:20:23 +0000 ERROR:Failed to load data from cleaned_donations.zip
2026-01-29 21:21:03 +0000 ERROR:Cannot determine modification time for cleaned_data.zip
2026-01-29 21:21:04 +0000 ERROR:Cannot determine modification time for cleaned_data.zip
2026-01-30 04:44:20 +0000 ERROR:Session state variables not initialized!
2026-01-30 04:44:20 +0000 ERROR:Error: originalfilepath is None!
2026-01-30 04:44:24 +0000 ERROR:Cannot determine modification time for cleaned_donations.zip
2026-01-30 04:44:24 +0000 ERROR:Failed to load data from cleaned_donations.zip
2026-01-30 04:45:06 +0000 ERROR:Cannot determine modification time for cleaned_data.zip
2026-01-30 04:45:06 +0000 ERROR:Cannot determine modification time for cleaned_data.zip
2026-01-30 10:58:14 +0000 ERROR:Session state variables not initialized!
2026-01-30 10:58:14 +0000 ERROR:Error: originalfilepath is None!
2026-01-30 10:58:18 +0000 ERROR:Cannot determine modification time for cleaned_donations.zip
2026-01-30 10:58:18 +0000 ERROR:Failed to load data from cleaned_donations.zip
2026-01-30 10:59:01 +0000 ERROR:Cannot determine modification time for cleaned_data.zip
2026-01-30 10:59:01 +0000 ERROR:Cannot determine modification time for cleaned_data.zip
2026-01-30 11:09:37 +0000 ERROR:Session state variables not initialized!
2026-01-30 11:09:37 +0000 ERROR:Error: originalfilepath is None!
2026-01-30 11:09:42 +0000 ERROR:Failed to load data from cleaned_donations.zip
2026-01-30 11:12:54 +0000 ERROR:Session state variables not initialized!
2026-01-30 11:12:54 +0000 ERROR:Error: originalfilepath is None!
2026-01-30 11:12:58 +0000 ERROR:Failed to load data from cleaned_donations.zip
2026-01-30 11:16:20 +0000 ERROR:Session state variables not initialized!
2026-01-30 11:16:20 +0000 ERROR:Error: originalfilepath is None!
2026-01-30 11:16:24 +0000 ERROR:Failed to load data from cleaned_donations.zip
2026-01-30 11:26:47 +0000 ERROR:Session state variables not initialized!
2026-01-30 11:26:47 +0000 ERROR:Error: originalfilepath is None!
2026-01-30 11:26:51 +0000 ERROR:Failed to load data from cleaned_donations.zip
2026-01-30 16:37:54 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2026-01-30 16:37:54 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 16:37:57 +0000 INFO:get_git_version executed successfully
2026-01-30 16:38:04 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 16:38:10 +0000 INFO:get_git_version executed successfully
2026-01-30 16:38:10 +0000 INFO:Streamlit App Starting...
2026-01-30 16:38:10 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 16:38:10 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 16:38:10 +0000 INFO:Running App setup...
2026-01-30 16:38:10 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 16:38:10 +0000 INFO:Setting up the package
2026-01-30 16:38:10 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 16:38:10 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 16:38:12 +0000 INFO:get_git_version executed successfully
2026-01-30 16:38:12 +0000 INFO:Version: v50.201
2026-01-30 16:38:12 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 16:38:12 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 16:38:12 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2026-01-30 16:38:12 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 16:38:12 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2026-01-30 16:38:12 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2026-01-30 16:38:12 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 16:38:12 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 16:38:12 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 16:38:12 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 16:38:12 +0000 DEBUG:Initialised perc_target with value: 0.5
2026-01-30 16:38:12 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2026-01-30 16:38:12 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 16:38:12 +0000 DEBUG:Initialised electoral_cycle_rules with value: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 16:38:12 +0000 DEBUG:Initialised reference_dir with value: H:\GitHub\dashboard_demo\reference_files
2026-01-30 16:38:12 +0000 DEBUG:Initialised data_dir with value: H:\GitHub\dashboard_demo\data
2026-01-30 16:38:12 +0000 DEBUG:Initialised output_dir with value: H:\GitHub\dashboard_demo\output
2026-01-30 16:38:12 +0000 DEBUG:Initialised logs_dir with value: H:\GitHub\dashboard_demo\logs
2026-01-30 16:38:12 +0000 DEBUG:Initialised components_dir with value: H:\GitHub\dashboard_demo\components
2026-01-30 16:38:12 +0000 DEBUG:Initialised app_pages_dir with value: H:\GitHub\dashboard_demo\app_pages
2026-01-30 16:38:12 +0000 DEBUG:Initialised utils_dir with value: H:\GitHub\dashboard_demo\utils
2026-01-30 16:38:12 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 16:38:12 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 16:38:12 +0000 DEBUG:Initialised mppartymemb_fname with value: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 16:38:12 +0000 DEBUG:Initialised donor_map_fname with value: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 16:38:12 +0000 DEBUG:Initialised politician_party_fname with value: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 16:38:12 +0000 DEBUG:Initialised regentity_map_fname with value: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 16:38:12 +0000 DEBUG:Initialised original_data_fname with value: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 16:38:12 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 16:38:12 +0000 DEBUG:Initialised TEXT_FILE with value: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 16:38:12 +0000 DEBUG:Initialised ELECTION_DATES with value: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 16:38:12 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 16:38:12 +0000 DEBUG:Initialised cleaned_data_fname with value: cleaned_data.zip
2026-01-30 16:38:12 +0000 DEBUG:Initialised cleaned_donations_fname with value: cleaned_donations.zip
2026-01-30 16:38:12 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: cleaned_donorlist.zip
2026-01-30 16:38:12 +0000 DEBUG:Initialised cleaned_regentity_fname with value: cleaned_regentity.zip
2026-01-30 16:38:12 +0000 DEBUG:Initialised party_summary_fname with value: party_summary.zip
2026-01-30 16:38:12 +0000 DEBUG:Initialised imported_raw_fname with value: imported_raw.zip
2026-01-30 16:38:12 +0000 DEBUG:Initialised source_data_fname with value: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 16:38:12 +0000 DEBUG:Initialised Cash_ftr with value: None
2026-01-30 16:38:12 +0000 INFO:Session_state variables initialized
2026-01-30 16:38:12 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 16:38:12 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 16:38:12 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 16:38:12 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 16:38:12 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 16:38:12 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 16:38:12 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 16:38:12 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 16:38:12 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 16:38:12 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 16:38:12 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 16:38:12 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 16:38:12 +0000 DEBUG:perc_target: 0.5
2026-01-30 16:38:12 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 16:38:12 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 16:38:12 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 16:38:12 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 16:38:12 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 16:38:12 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 16:38:12 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 16:38:12 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 16:38:12 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 16:38:12 +0000 DEBUG:Cash_ftr: None
2026-01-30 16:38:12 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 16:38:12 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 16:38:12 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 16:38:12 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 16:38:12 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 16:38:12 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 16:38:12 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 16:38:12 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 16:38:12 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 16:38:12 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 16:38:12 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 16:38:12 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 16:38:12 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 16:38:12 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 16:38:12 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 16:38:12 +0000 INFO:Session state Setup complete
2026-01-30 16:38:12 +0000 INFO:initialize_session_state executed successfully
2026-01-30 16:38:12 +0000 INFO:Package setup complete
2026-01-30 16:38:12 +0000 INFO:setup_package executed successfully
2026-01-30 16:38:12 +0000 INFO:Setup completed successfully.
2026-01-30 16:38:12 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 16:38:13 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 16:38:16 +0000 INFO:get_git_version executed successfully
2026-01-30 16:38:17 +0000 INFO:Running first load function.
2026-01-30 16:38:17 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 16:38:17 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2026-01-30 16:38:17 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2026-01-30 16:38:17 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2026-01-30 16:38:17 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2026-01-30 16:38:17 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 16:38:17 +0000 INFO:Original file path: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 16:38:17 +0000 INFO:Saved file path: imported_raw.zip
2026-01-30 16:38:17 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 16:38:17 +0000 INFO:Checking if H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip has been updated.
2026-01-30 16:38:17 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 16:38:17 +0000 INFO:Getting modification time for H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 16:38:17 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 16:38:17 +0000 INFO:Current modification time: 1769774510.1556323
2026-01-30 16:38:17 +0000 INFO:Last modification time: 1769774510.1556323
2026-01-30 16:38:17 +0000 INFO:is_file_updated executed successfully
2026-01-30 16:38:17 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 16:38:17 +0000 INFO:Loading raw data...
2026-01-30 16:38:17 +0000 DEBUG:Original data file path post raw data load: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 16:38:17 +0000 DEBUG:Processed data file path post raw data load: imported_raw.zip
2026-01-30 16:38:17 +0000 INFO:Data loaded successfully. Data has 91341 rows and 29 columns
2026-01-30 16:38:18 +0000 INFO:Data saved to imported_raw.zip
2026-01-30 16:38:18 +0000 INFO:Data saved to sessionstate as 'raw_data'
2026-01-30 16:38:18 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2026-01-30 16:38:18 +0000 INFO:Cleaning up raw data
2026-01-30 16:38:18 +0000 ERROR:Session state variables not initialized!
2026-01-30 16:38:18 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 16:38:18 +0000 INFO:Original file path: None
2026-01-30 16:38:18 +0000 INFO:Saved file path: cleaned_donations.zip
2026-01-30 16:38:18 +0000 ERROR:Error: originalfilepath is None!
2026-01-30 16:38:18 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 16:38:18 +0000 INFO:Data loaded, shape: (91341, 29)
2026-01-30 16:38:20 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2026-01-30 16:38:20 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2026-01-30 16:38:20 +0000 INFO:File deduplication complete, shape: ECRef                            592
OriginalRegulatedEntityName      592
RegulatedEntityType              592
Value                            592
AcceptedDate                     574
AccountingUnitName               592
DonorName                        592
AccountingUnitsAsCentralParty    592
IsSponsorship                    592
DonorStatus                      592
RegulatedDoneeType               592
CompanyRegistrationNumber        592
Postcode                         592
DonationType                     592
NatureOfDonation                 592
PurposeOfVisit                   592
DonationAction                   592
ReceivedDate                     486
ReportedDate                     592
IsReportedPrePoll                423
ReportingPeriodName              592
IsBequest                        592
IsAggregation                    592
OriginalRegulatedEntityId        592
AccountingUnitId                 592
DonorId                          592
CampaigningName                  592
RegisterName                     592
IsIrishSource                    592
CleanedRegulatedEntityName       592
CleanedRegulatedEntityId         592
RegulatedEntityId                592
RegulatedEntityName              592
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10109
OriginalRegulatedEntityName      10109
RegulatedEntityType              10109
Value                            10107
AcceptedDate                      9796
AccountingUnitName               10109
DonorName                        10109
AccountingUnitsAsCentralParty    10109
IsSponsorship                    10109
DonorStatus                      10109
RegulatedDoneeType               10109
CompanyRegistrationNumber        10109
Postcode                         10109
DonationType                     10109
NatureOfDonation                 10109
PurposeOfVisit                   10109
DonationAction                   10109
ReceivedDate                      7075
ReportedDate                     10099
IsReportedPrePoll                 4878
ReportingPeriodName              10109
IsBequest                        10109
IsAggregation                    10109
OriginalRegulatedEntityId        10109
AccountingUnitId                 10109
DonorId                          10109
CampaigningName                  10109
RegisterName                     10109
IsIrishSource                    10109
CleanedRegulatedEntityName       10109
CleanedRegulatedEntityId         10109
RegulatedEntityId                10109
RegulatedEntityName              10109
dtype: int64 records updated with new RegulatedEntityName
2026-01-30 16:38:20 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3771
OriginalRegulatedEntityName      3771
RegulatedEntityType              3771
Value                            3771
AcceptedDate                     3667
AccountingUnitName               3771
DonorName                        3771
AccountingUnitsAsCentralParty    3771
IsSponsorship                    3771
DonorStatus                      3771
RegulatedDoneeType               3771
CompanyRegistrationNumber        3771
Postcode                         3771
DonationType                     3771
NatureOfDonation                 3771
PurposeOfVisit                   3771
DonationAction                   3771
ReceivedDate                     3297
ReportedDate                     3771
IsReportedPrePoll                 449
ReportingPeriodName              3771
IsBequest                        3771
IsAggregation                    3771
OriginalRegulatedEntityId        3771
AccountingUnitId                 3771
DonorId                          3771
CampaigningName                  3771
RegisterName                     3771
IsIrishSource                    3771
CleanedRegulatedEntityName        592
CleanedRegulatedEntityId          592
RegulatedEntityId                3771
RegulatedEntityName              3771
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13288
OriginalRegulatedEntityName      13288
RegulatedEntityType              13288
Value                            13286
AcceptedDate                     12889
AccountingUnitName               13288
DonorName                        13288
AccountingUnitsAsCentralParty    13288
IsSponsorship                    13288
DonorStatus                      13288
RegulatedDoneeType               13288
CompanyRegistrationNumber        13288
Postcode                         13288
DonationType                     13288
NatureOfDonation                 13288
PurposeOfVisit                   13288
DonationAction                   13288
ReceivedDate                      9886
ReportedDate                     13278
IsReportedPrePoll                 4904
ReportingPeriodName              13288
IsBequest                        13288
IsAggregation                    13288
OriginalRegulatedEntityId        13288
AccountingUnitId                 13288
DonorId                          13288
CampaigningName                  13288
RegisterName                     13288
IsIrishSource                    13288
CleanedRegulatedEntityName       10109
CleanedRegulatedEntityId         10109
RegulatedEntityId                13288
RegulatedEntityName              13288
dtype: int64 records updated with new RegulatedEntityName
2026-01-30 16:38:20 +0000 INFO:File deduplication complete, shape: (91341, 33)
2026-01-30 16:38:20 +0000 INFO:dedupe_entity_file executed successfully
2026-01-30 16:38:20 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2026-01-30 16:38:20 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2026-01-30 16:38:21 +0000 INFO:File deduplication complete, shape: ECRef                            34082
OriginalRegulatedEntityName      34082
RegulatedEntityType              34082
Value                            34079
AcceptedDate                     33689
AccountingUnitName               34082
OriginalDonorName                34082
AccountingUnitsAsCentralParty    34082
IsSponsorship                    34082
DonorStatus                      34082
RegulatedDoneeType               34082
CompanyRegistrationNumber        34082
Postcode                         34082
DonationType                     34082
NatureOfDonation                 34082
PurposeOfVisit                   34082
DonationAction                   34082
ReceivedDate                     32487
ReportedDate                     34071
IsReportedPrePoll                22707
ReportingPeriodName              34082
IsBequest                        34082
IsAggregation                    34082
OriginalRegulatedEntityId        34082
AccountingUnitId                 34082
OriginalDonorId                  34082
CampaigningName                  34082
RegisterName                     34082
IsIrishSource                    34082
CleanedRegulatedEntityName       34082
CleanedRegulatedEntityId         34082
RegulatedEntityId                34082
RegulatedEntityName              34082
CleanedDonorName                 34082
CleanedDonorId                   34082
DonorId                          34082
DonorName                        34082
dtype: int64 records updated with new DonorId and ECRef                            20155
OriginalRegulatedEntityName      20155
RegulatedEntityType              20155
Value                            20153
AcceptedDate                     19834
AccountingUnitName               20155
OriginalDonorName                20155
AccountingUnitsAsCentralParty    20155
IsSponsorship                    20155
DonorStatus                      20155
RegulatedDoneeType               20155
CompanyRegistrationNumber        20155
Postcode                         20155
DonationType                     20155
NatureOfDonation                 20155
PurposeOfVisit                   20155
DonationAction                   20155
ReceivedDate                     19620
ReportedDate                     20146
IsReportedPrePoll                13414
ReportingPeriodName              20155
IsBequest                        20155
IsAggregation                    20155
OriginalRegulatedEntityId        20155
AccountingUnitId                 20155
OriginalDonorId                  20155
CampaigningName                  20155
RegisterName                     20155
IsIrishSource                    20155
CleanedRegulatedEntityName       20154
CleanedRegulatedEntityId         20154
RegulatedEntityId                20155
RegulatedEntityName              20155
CleanedDonorName                 20155
CleanedDonorId                   20155
DonorId                          20155
DonorName                        20155
dtype: int64 records updated with new DonorName
2026-01-30 16:38:21 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            52934
OriginalRegulatedEntityName      52934
RegulatedEntityType              52934
Value                            52931
AcceptedDate                     52138
AccountingUnitName               52934
OriginalDonorName                52934
AccountingUnitsAsCentralParty    52934
IsSponsorship                    52934
DonorStatus                      52934
RegulatedDoneeType               52934
CompanyRegistrationNumber        52934
Postcode                         52934
DonationType                     52934
NatureOfDonation                 52934
PurposeOfVisit                   52934
DonationAction                   52934
ReceivedDate                     50532
ReportedDate                     52923
IsReportedPrePoll                23658
ReportingPeriodName              52934
IsBequest                        52934
IsAggregation                    52934
OriginalRegulatedEntityId        52934
AccountingUnitId                 52934
OriginalDonorId                  52934
CampaigningName                  52934
RegisterName                     52934
IsIrishSource                    52934
CleanedRegulatedEntityName       49804
CleanedRegulatedEntityId         49804
RegulatedEntityId                52934
RegulatedEntityName              52934
CleanedDonorName                 34082
CleanedDonorId                   34082
DonorId                          52934
DonorName                        52934
dtype: int64 records updated with new DonorId and ECRef                            39007
OriginalRegulatedEntityName      39007
RegulatedEntityType              39007
Value                            39005
AcceptedDate                     38283
AccountingUnitName               39007
OriginalDonorName                39007
AccountingUnitsAsCentralParty    39007
IsSponsorship                    39007
DonorStatus                      39007
RegulatedDoneeType               39007
CompanyRegistrationNumber        39007
Postcode                         39007
DonationType                     39007
NatureOfDonation                 39007
PurposeOfVisit                   39007
DonationAction                   39007
ReceivedDate                     37665
ReportedDate                     38998
IsReportedPrePoll                14365
ReportingPeriodName              39007
IsBequest                        39007
IsAggregation                    39007
OriginalRegulatedEntityId        39007
AccountingUnitId                 39007
OriginalDonorId                  39007
CampaigningName                  39007
RegisterName                     39007
IsIrishSource                    39007
CleanedRegulatedEntityName       35876
CleanedRegulatedEntityId         35876
RegulatedEntityId                39007
RegulatedEntityName              39007
CleanedDonorName                 20155
CleanedDonorId                   20155
DonorId                          39007
DonorName                        39007
dtype: int64 records updated with new DonorName
2026-01-30 16:38:21 +0000 INFO:File deduplication complete, shape: (91341, 37)
2026-01-30 16:38:21 +0000 INFO:dedupe_entity_file executed successfully
2026-01-30 16:38:21 +0000 INFO:Raw Data cleanup completed
2026-01-30 16:38:21 +0000 INFO:Data shape: (91341, 37)
2026-01-30 16:38:22 +0000 INFO:Data saved to cleaned_donations.zip
2026-01-30 16:38:22 +0000 INFO:Data cleanup completed, shape: (91341, 37)
2026-01-30 16:38:22 +0000 INFO:raw_data_cleanup executed successfully
2026-01-30 16:38:22 +0000 INFO:load_raw_data executed successfully
2026-01-30 16:38:23 +0000 INFO:get_raw_data executed successfully
2026-01-30 16:38:23 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 16:38:23 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2026-01-30 16:38:23 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2026-01-30 16:38:23 +0000 DEBUG:Rows in Raw Data: 91341
2026-01-30 16:38:23 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 16:38:23 +0000 INFO:Original file path: cleaned_donations.zip
2026-01-30 16:38:23 +0000 INFO:Saved file path: cleaned_data.zip
2026-01-30 16:38:23 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 16:38:23 +0000 INFO:Checking if cleaned_donations.zip has been updated.
2026-01-30 16:38:23 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 16:38:23 +0000 INFO:Getting modification time for cleaned_donations.zip
2026-01-30 16:38:23 +0000 WARNING:File cleaned_donations.zip does not exist.
2026-01-30 16:38:23 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 16:38:23 +0000 INFO:Current modification time: None
2026-01-30 16:38:23 +0000 INFO:Last modification time: 1769774510.1556323
2026-01-30 16:38:23 +0000 WARNING:Cannot determine modification time for cleaned_donations.zip
2026-01-30 16:38:23 +0000 INFO:is_file_updated executed successfully
2026-01-30 16:38:23 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 16:38:23 +0000 ERROR:Failed to load data from cleaned_donations.zip
2026-01-30 16:38:23 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2026-01-30 16:38:23 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91341
2026-01-30 16:38:23 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91341
2026-01-30 16:38:25 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2026-01-30 16:38:25 +0000 DEBUG:Clean Data Prep 204: Map Party: 91341
2026-01-30 16:38:59 +0000 INFO:Added parliamentary_sitting column with 8 unique periods
2026-01-30 16:38:59 +0000 DEBUG:Group assignment with exceptions: {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}
2026-01-30 16:38:59 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28638
Labour Party                       22675
Liberal Democrats                  19030
Large Entity                        8611
Medium Entity                       3809
Small Entity                        1985
Uk Independence Party (Ukip)        1830
Green Party                         1673
Single Donation Entity              1353
Scottish National Party (Snp)        815
Plaid Cymru - Party Of Wales         517
Reform UK                            377
Liberal Party                         15
Sinn Féin                             13
Name: count, dtype: int64
2026-01-30 16:38:59 +0000 DEBUG:Group assignment: group
Single Donation Entity             1353
Small Entity                        839
Medium Entity                       614
Large Entity                        227
Conservative And Unionist Party       8
Labour Party                          8
Liberal Democrats                     8
Plaid Cymru - Party Of Wales          8
Scottish National Party (Snp)         8
Uk Independence Party (Ukip)          8
Green Party                           7
Liberal Party                         4
Reform UK                             3
Sinn Féin                             1
Name: count, dtype: int64
2026-01-30 16:38:59 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91341
2026-01-30 16:38:59 +0000 DEBUG:Group assignment with exceptions: {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}
2026-01-30 16:38:59 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32036
Labour Party                       27106
Large Entity                       24804
Uk Independence Party (Ukip)        1853
Green Party                         1694
Medium Entity                       1112
Scottish National Party (Snp)        881
Small Entity                         552
Plaid Cymru - Party Of Wales         525
Reform UK                            377
Single Donation Entity               372
Liberal Party                         15
Sinn Féin                             13
Democratic Unionist Party              1
Name: count, dtype: int64
2026-01-30 16:38:59 +0000 DEBUG:Group assignment: group
Single Donation Entity             372
Small Entity                       233
Medium Entity                      171
Large Entity                       120
Conservative And Unionist Party      8
Labour Party                         8
Plaid Cymru - Party Of Wales         8
Scottish National Party (Snp)        8
Uk Independence Party (Ukip)         8
Green Party                          7
Liberal Party                        4
Reform UK                            3
Democratic Unionist Party            1
Sinn Féin                            1
Name: count, dtype: int64
2026-01-30 16:38:59 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91341
2026-01-30 16:39:00 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2026-01-30 16:39:00 +0000 INFO:Loading election dates from pdpy.
2026-01-30 16:39:00 +0000 INFO:Election Dates loaded from pdpy.
2026-01-30 16:39:00 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2026-01-30 16:39:00 +0000 INFO:Election Dates Loaded Successfully.
2026-01-30 16:39:00 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 16:39:00 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 16:39:00 +0000 INFO:load_election_dates executed successfully
2026-01-30 16:39:00 +0000 DEBUG:Clean Data Prep 353: Election dates: 91341
2026-01-30 16:39:00 +0000 DEBUG:Clean Data Prep 386: End of clean: 91341
2026-01-30 16:39:03 +0000 INFO:Cleaned Data completed, shape: (91341, 57)
2026-01-30 16:39:03 +0000 INFO:load_cleaned_data executed successfully
2026-01-30 16:39:03 +0000 INFO:get_cleaned_data executed successfully
2026-01-30 16:39:03 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 16:39:03 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2026-01-30 16:39:03 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2026-01-30 16:39:03 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 16:39:03 +0000 INFO:Original file path: cleaned_data.zip
2026-01-30 16:39:03 +0000 INFO:Saved file path: cleaned_donorlist.zip
2026-01-30 16:39:03 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 16:39:03 +0000 INFO:Checking if cleaned_data.zip has been updated.
2026-01-30 16:39:03 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 16:39:03 +0000 INFO:Getting modification time for cleaned_data.zip
2026-01-30 16:39:03 +0000 WARNING:File cleaned_data.zip does not exist.
2026-01-30 16:39:03 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 16:39:03 +0000 INFO:Current modification time: None
2026-01-30 16:39:03 +0000 INFO:Last modification time: 1769718453.1764421
2026-01-30 16:39:03 +0000 WARNING:Cannot determine modification time for cleaned_data.zip
2026-01-30 16:39:03 +0000 INFO:is_file_updated executed successfully
2026-01-30 16:39:03 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 16:39:03 +0000 INFO:Donor data saved to cleaned_donorlist.zip
2026-01-30 16:39:03 +0000 INFO:Donor Data summary completed
2026-01-30 16:39:03 +0000 INFO:Data shape: (32070, 5)
2026-01-30 16:39:03 +0000 INFO:load_donorList_data executed successfully
2026-01-30 16:39:03 +0000 INFO:get_donor_data executed successfully
2026-01-30 16:39:03 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 16:39:03 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 16:39:03 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2026-01-30 16:39:03 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2026-01-30 16:39:03 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 16:39:03 +0000 INFO:Original file path: cleaned_data.zip
2026-01-30 16:39:03 +0000 INFO:Saved file path: cleaned_regentity.zip
2026-01-30 16:39:03 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 16:39:03 +0000 INFO:Checking if cleaned_data.zip has been updated.
2026-01-30 16:39:03 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 16:39:03 +0000 INFO:Getting modification time for cleaned_data.zip
2026-01-30 16:39:03 +0000 WARNING:File cleaned_data.zip does not exist.
2026-01-30 16:39:03 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 16:39:03 +0000 INFO:Current modification time: None
2026-01-30 16:39:03 +0000 INFO:Last modification time: 1769718453.1764421
2026-01-30 16:39:03 +0000 WARNING:Cannot determine modification time for cleaned_data.zip
2026-01-30 16:39:03 +0000 INFO:is_file_updated executed successfully
2026-01-30 16:39:03 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 16:39:03 +0000 INFO:Regulated entity data saved to cleaned_regentity.zip
2026-01-30 16:39:03 +0000 INFO:Raw Data cleanup completed
2026-01-30 16:39:03 +0000 INFO:Data shape: (2404, 6)
2026-01-30 16:39:03 +0000 INFO:load_regulated_entity_data executed successfully
2026-01-30 16:39:03 +0000 INFO:get_regentity_data executed successfully
2026-01-30 16:39:03 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 16:39:03 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 16:39:03 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 16:39:03 +0000 INFO:firstload executed successfully
2026-01-30 16:39:03 +0000 INFO:Data first load completed successfully.
2026-01-30 16:39:03 +0000 INFO:initialise_data executed successfully
2026-01-30 16:39:03 +0000 INFO:Running Menu setup...
2026-01-30 16:39:03 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 16:39:03 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 16:39:08 +0000 INFO:get_git_version executed successfully
2026-01-30 16:39:08 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 16:39:11 +0000 INFO:get_git_version executed successfully
2026-01-30 16:39:12 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 16:39:15 +0000 INFO:get_git_version executed successfully
2026-01-30 16:39:15 +0000 INFO:App Version: v50.239
2026-01-30 16:39:15 +0000 INFO:Switched to page: Introduction
2026-01-30 16:39:15 +0000 INFO:pagesetup executed successfully
2026-01-30 16:39:15 +0000 INFO:Menu setup completed successfully.
2026-01-30 16:39:15 +0000 INFO:App is fully loaded and ready!
2026-01-30 16:39:19 +0000 INFO:Streamlit App Starting...
2026-01-30 16:39:19 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 16:39:19 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 16:39:19 +0000 INFO:Running App setup...
2026-01-30 16:39:19 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 16:39:19 +0000 INFO:Setting up the package
2026-01-30 16:39:19 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 16:39:19 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 16:39:19 +0000 INFO:get_git_version executed successfully
2026-01-30 16:39:19 +0000 INFO:Version: v50.201
2026-01-30 16:39:19 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 16:39:19 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 16:39:19 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:filenames already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:thresholds already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:filter_def already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:security already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:perc_target already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:directories already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:data_dir already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:output_dir already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:components_dir already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 16:39:19 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 16:39:19 +0000 INFO:Session_state variables initialized
2026-01-30 16:39:19 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 16:39:19 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 16:39:19 +0000 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x0000019BF7C8E3B0>}
2026-01-30 16:39:19 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 16:39:19 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 16:39:19 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 16:39:19 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 16:39:19 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 16:39:19 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 16:39:19 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 16:39:19 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 16:39:19 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 16:39:19 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 16:39:19 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 16:39:19 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 16:39:19 +0000 DEBUG:perc_target: 0.5
2026-01-30 16:39:19 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 16:39:19 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 16:39:19 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 16:39:19 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 16:39:19 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 16:39:19 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 16:39:19 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 16:39:19 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 16:39:19 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 16:39:19 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 16:39:19 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 16:39:19 +0000 DEBUG:Cash_ftr: None
2026-01-30 16:39:19 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 16:39:19 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 16:39:19 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 16:39:19 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 16:39:19 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 16:39:19 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 16:39:19 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 16:39:19 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 16:39:19 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 16:39:19 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 16:39:19 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 16:39:19 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 16:39:19 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 16:39:19 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 16:39:19 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 16:39:19 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 16:39:19 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 16:39:19 +0000 INFO:Session state Setup complete
2026-01-30 16:39:19 +0000 INFO:initialize_session_state executed successfully
2026-01-30 16:39:19 +0000 INFO:Package setup complete
2026-01-30 16:39:19 +0000 INFO:setup_package executed successfully
2026-01-30 16:39:19 +0000 INFO:Setup completed successfully.
2026-01-30 16:39:19 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 16:39:19 +0000 INFO:Running first load function.
2026-01-30 16:39:19 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 16:39:19 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 16:39:19 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 16:39:19 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 16:39:19 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 16:39:19 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 16:39:19 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 16:39:19 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 16:39:19 +0000 INFO:firstload executed successfully
2026-01-30 16:39:19 +0000 INFO:Data first load completed successfully.
2026-01-30 16:39:19 +0000 INFO:initialise_data executed successfully
2026-01-30 16:39:19 +0000 INFO:Running Menu setup...
2026-01-30 16:39:19 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 16:39:19 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 16:39:19 +0000 INFO:get_git_version executed successfully
2026-01-30 16:39:19 +0000 INFO:App Version: v50.239
2026-01-30 16:39:19 +0000 INFO:Switched to page: Head Line Figures
2026-01-30 16:39:19 +0000 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2026-01-30 16:39:19 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 16:39:19 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 16:39:19 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 16:39:19 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 16:39:21 +0000 DEBUG:Aggregated DataFrame:                         Party_Group         Value
0   Conservative And Unionist Party  20170.405233
1         Democratic Unionist Party   3618.940000
2                       Green Party   6204.226405
3                      Labour Party  20519.157176
4                      Large Entity  12031.362470
5                     Liberal Party   2871.754667
6                     Medium Entity  19378.136232
7      Plaid Cymru - Party Of Wales  15859.742724
8                         Reform UK  97641.772732
9     Scottish National Party (Snp)  36021.189364
10           Single Donation Entity  13864.955459
11                        Sinn Féin  44317.630769
12                     Small Entity  24968.983822
13     Uk Independence Party (Ukip)   9943.456859
2026-01-30 16:39:21 +0000 DEBUG:Sorted DataFrame:                         Party_Group         Value
8                         Reform UK  97641.772732
11                        Sinn Féin  44317.630769
9     Scottish National Party (Snp)  36021.189364
12                     Small Entity  24968.983822
3                      Labour Party  20519.157176
0   Conservative And Unionist Party  20170.405233
6                     Medium Entity  19378.136232
7      Plaid Cymru - Party Of Wales  15859.742724
10           Single Donation Entity  13864.955459
4                      Large Entity  12031.362470
13     Uk Independence Party (Ukip)   9943.456859
2                       Green Party   6204.226405
1         Democratic Unionist Party   3618.940000
5                     Liberal Party   2871.754667
2026-01-30 16:39:21 +0000 DEBUG:Unique XValues: ['Reform UK' 'Sinn Féin' 'Scottish National Party (Snp)' 'Small Entity'
 'Labour Party' 'Conservative And Unionist Party' 'Medium Entity'
 'Plaid Cymru - Party Of Wales' 'Single Donation Entity' 'Large Entity'
 'Uk Independence Party (Ukip)' 'Green Party' 'Democratic Unionist Party'
 'Liberal Party']
2026-01-30 16:39:21 +0000 DEBUG:Final color_discrete_map: {'Reform UK': '#12B6CF', 'Sinn Féin': '#326760', 'Scottish National Party (Snp)': '#636efa', 'Small Entity': '#aaaaaa', 'Labour Party': '#DC241F', 'Conservative And Unionist Party': '#0087DC', 'Medium Entity': '#666666', 'Plaid Cymru - Party Of Wales': '#636efa', 'Single Donation Entity': '#e8e8e8', 'Large Entity': '#222222', 'Uk Independence Party (Ukip)': '#70147A', 'Green Party': '#78B943', 'Democratic Unionist Party': '#636efa', 'Liberal Party': '#636efa'}
2026-01-30 16:39:22 +0000 DEBUG:Missing color mappings for: ['Scottish National Party (Snp)', 'Plaid Cymru - Party Of Wales', 'Democratic Unionist Party', 'Liberal Party']
2026-01-30 16:39:22 +0000 DEBUG:Generated Figure: Figure({
    'data': [{'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Reform UK',
              'marker': {'color': '#12B6CF', 'pattern': {'shape': ''}},
              'name': 'Reform UK',
              'offsetgroup': 'Reform UK',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Reform UK'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'a1QcXZzW90A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Sinn Féin',
              'marker': {'color': '#326760', 'pattern': {'shape': ''}},
              'name': 'Sinn Féin',
              'offsetgroup': 'Sinn Féin',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Sinn Féin'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'L/RCL7Sj5UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Scottish National Party (Snp)',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Scottish National Party (Snp)',
              'offsetgroup': 'Scottish National Party (Snp)',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Scottish National Party (Snp)'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '8tdFD6aW4UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Small Entity',
              'marker': {'color': '#aaaaaa', 'pattern': {'shape': ''}},
              'name': 'Small Entity',
              'offsetgroup': 'Small Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Small Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'vX7y9j5i2EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Labour Party',
              'marker': {'color': '#DC241F', 'pattern': {'shape': ''}},
              'name': 'Labour Party',
              'offsetgroup': 'Labour Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Labour Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '9qMqD8oJ1EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Conservative And Unionist Party',
              'marker': {'color': '#0087DC', 'pattern': {'shape': ''}},
              'name': 'Conservative And Unionist Party',
              'offsetgroup': 'Conservative And Unionist Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Conservative And Unionist Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '65FU75my00A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Medium Entity',
              'marker': {'color': '#666666', 'pattern': {'shape': ''}},
              'name': 'Medium Entity',
              'offsetgroup': 'Medium Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Medium Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'nXsGuIjs0kA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Plaid Cymru - Party Of Wales',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Plaid Cymru - Party Of Wales',
              'offsetgroup': 'Plaid Cymru - Party Of Wales',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Plaid Cymru - Party Of Wales'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '7uOSEd/5zkA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Single Donation Entity',
              'marker': {'color': '#e8e8e8', 'pattern': {'shape': ''}},
              'name': 'Single Donation Entity',
              'offsetgroup': 'Single Donation Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Single Donation Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'hd1+THoUy0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Large Entity',
              'marker': {'color': '#222222', 'pattern': {'shape': ''}},
              'name': 'Large Entity',
              'offsetgroup': 'Large Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Large Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'lyJsZa5/x0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Uk Independence Party (Ukip)',
              'marker': {'color': '#70147A', 'pattern': {'shape': ''}},
              'name': 'Uk Independence Party (Ukip)',
              'offsetgroup': 'Uk Independence Party (Ukip)',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Uk Independence Party (Ukip)'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'U0xcerprw0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Green Party',
              'marker': {'color': '#78B943', 'pattern': {'shape': ''}},
              'name': 'Green Party',
              'offsetgroup': 'Green Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Green Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'LOWs9Tk8uEA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Democratic Unionist Party',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Democratic Unionist Party',
              'offsetgroup': 'Democratic Unionist Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Democratic Unionist Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'exSuR+FFrEA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Liberal Party',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Liberal Party',
              'offsetgroup': 'Liberal Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Liberal Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'blmrY4JvpkA=', 'dtype': 'f8'},
              'yaxis': 'y'}],
    'layout': {'barmode': 'group',
               'legend': {'title': {'text': 'Political Party'}, 'tracegroupgap': 0},
               'template': '...',
               'title': {'text': 'Average Donation per Party'},
               'xaxis': {'anchor': 'y',
                         'categoryarray': [Reform UK, Sinn Féin, Scottish National
                                           Party (Snp), Small Entity, Labour Party,
                                           Conservative And Unionist Party, Medium
                                           Entity, Plaid Cymru - Party Of Wales,
                                           Single Donation Entity, Large Entity, Uk
                                           Independence Party (Ukip), Green Party,
                                           Democratic Unionist Party, Liberal
                                           Party],
                         'categoryorder': 'array',
                         'domain': [0.0, 1.0],
                         'title': {'text': 'Political Party'}},
               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': 'Average Donation GBP'}}}
})
2026-01-30 16:39:22 +0000 INFO:Bar chart displayed successfully.
2026-01-30 16:39:22 +0000 INFO:hlf_body executed successfully
2026-01-30 16:39:22 +0000 INFO:pagesetup executed successfully
2026-01-30 16:39:22 +0000 INFO:Menu setup completed successfully.
2026-01-30 16:39:22 +0000 INFO:App is fully loaded and ready!
2026-01-30 16:39:37 +0000 INFO:Streamlit App Starting...
2026-01-30 16:39:37 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 16:39:37 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 16:39:37 +0000 INFO:Running App setup...
2026-01-30 16:39:37 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 16:39:37 +0000 INFO:Setting up the package
2026-01-30 16:39:37 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 16:39:37 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 16:39:37 +0000 INFO:get_git_version executed successfully
2026-01-30 16:39:37 +0000 INFO:Version: v50.201
2026-01-30 16:39:37 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 16:39:37 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 16:39:37 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:filenames already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:thresholds already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:filter_def already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:security already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:perc_target already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:directories already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:data_dir already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:output_dir already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:components_dir already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 16:39:37 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 16:39:37 +0000 INFO:Session_state variables initialized
2026-01-30 16:39:37 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 16:39:37 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 16:39:37 +0000 DEBUG:menu_selection: {'title': 'Donor Type Analysis', 'function': <function mod_donor_type at 0x0000019BF7C8FD90>}
2026-01-30 16:39:37 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 16:39:37 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 16:39:37 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 16:39:37 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 16:39:37 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 16:39:37 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 16:39:37 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 16:39:37 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 16:39:37 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 16:39:37 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 16:39:37 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 16:39:37 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 16:39:37 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 16:39:37 +0000 DEBUG:perc_target: 0.5
2026-01-30 16:39:37 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 16:39:37 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 16:39:37 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 16:39:37 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 16:39:37 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 16:39:37 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 16:39:37 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 16:39:37 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 16:39:37 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 16:39:37 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 16:39:37 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 16:39:37 +0000 DEBUG:Cash_ftr: None
2026-01-30 16:39:37 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 16:39:37 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 16:39:37 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 16:39:37 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 16:39:37 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 16:39:37 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 16:39:37 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 16:39:37 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 16:39:37 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 16:39:37 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 16:39:37 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 16:39:37 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 16:39:37 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 16:39:37 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 16:39:37 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 16:39:37 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 16:39:37 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 16:39:37 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 16:39:37 +0000 INFO:Session state Setup complete
2026-01-30 16:39:37 +0000 INFO:initialize_session_state executed successfully
2026-01-30 16:39:37 +0000 INFO:Package setup complete
2026-01-30 16:39:37 +0000 INFO:setup_package executed successfully
2026-01-30 16:39:37 +0000 INFO:Setup completed successfully.
2026-01-30 16:39:37 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 16:39:37 +0000 INFO:Running first load function.
2026-01-30 16:39:37 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 16:39:37 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 16:39:37 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 16:39:37 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 16:39:37 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 16:39:37 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 16:39:37 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 16:39:37 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 16:39:37 +0000 INFO:firstload executed successfully
2026-01-30 16:39:37 +0000 INFO:Data first load completed successfully.
2026-01-30 16:39:37 +0000 INFO:initialise_data executed successfully
2026-01-30 16:39:37 +0000 INFO:Running Menu setup...
2026-01-30 16:39:37 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 16:39:37 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 16:39:37 +0000 INFO:get_git_version executed successfully
2026-01-30 16:39:37 +0000 INFO:App Version: v50.239
2026-01-30 16:39:37 +0000 INFO:Switched to page: Donor Type Analysis
2026-01-30 16:39:37 +0000 DEBUG:Calling mod_donor_type with args={args}, kwargs={kwargs}
2026-01-30 16:39:37 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 16:39:37 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 16:39:37 +0000 INFO:mod_donor_type executed successfully
2026-01-30 16:39:37 +0000 INFO:pagesetup executed successfully
2026-01-30 16:39:37 +0000 INFO:Menu setup completed successfully.
2026-01-30 16:39:37 +0000 INFO:App is fully loaded and ready!
2026-01-30 16:39:39 +0000 INFO:Streamlit App Starting...
2026-01-30 16:39:39 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 16:39:39 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 16:39:39 +0000 INFO:Running App setup...
2026-01-30 16:39:39 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 16:39:39 +0000 INFO:Setting up the package
2026-01-30 16:39:39 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 16:39:39 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 16:39:39 +0000 INFO:get_git_version executed successfully
2026-01-30 16:39:39 +0000 INFO:Version: v50.201
2026-01-30 16:39:39 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 16:39:39 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 16:39:39 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:filenames already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:thresholds already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:filter_def already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:security already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:perc_target already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:directories already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:data_dir already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:output_dir already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:components_dir already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 16:39:39 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 16:39:39 +0000 INFO:Session_state variables initialized
2026-01-30 16:39:39 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 16:39:39 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 16:39:39 +0000 DEBUG:menu_selection: {'title': 'Donor Loyalty Analysis', 'function': <function mod_donor_loyalty at 0x0000019BF7C8EDD0>}
2026-01-30 16:39:39 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 16:39:39 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 16:39:39 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 16:39:39 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 16:39:39 +0000 DEBUG:metric_type_donor_type: Value of Donations
2026-01-30 16:39:39 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 16:39:39 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 16:39:39 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 16:39:39 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 16:39:39 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 16:39:39 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 16:39:39 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 16:39:39 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 16:39:39 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 16:39:39 +0000 DEBUG:perc_target: 0.5
2026-01-30 16:39:39 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 16:39:39 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 16:39:39 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 16:39:39 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 16:39:39 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 16:39:39 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 16:39:39 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 16:39:39 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 16:39:39 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 16:39:39 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 16:39:39 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 16:39:39 +0000 DEBUG:Cash_ftr: None
2026-01-30 16:39:39 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 16:39:39 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 16:39:39 +0000 DEBUG:sitting_select_donor_type: ['1997', '2001', '2005', '2010', '2015', '2017', '2019', '2024']
2026-01-30 16:39:39 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 16:39:39 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 16:39:39 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 16:39:39 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 16:39:39 +0000 DEBUG:view_type_donor_type: Actual
2026-01-30 16:39:39 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 16:39:39 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 16:39:39 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 16:39:39 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 16:39:39 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 16:39:39 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 16:39:39 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 16:39:39 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 16:39:39 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 16:39:39 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 16:39:39 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 16:39:39 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 16:39:39 +0000 INFO:Session state Setup complete
2026-01-30 16:39:39 +0000 INFO:initialize_session_state executed successfully
2026-01-30 16:39:39 +0000 INFO:Package setup complete
2026-01-30 16:39:39 +0000 INFO:setup_package executed successfully
2026-01-30 16:39:39 +0000 INFO:Setup completed successfully.
2026-01-30 16:39:39 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 16:39:39 +0000 INFO:Running first load function.
2026-01-30 16:39:39 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 16:39:39 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 16:39:39 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 16:39:39 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 16:39:39 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 16:39:39 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 16:39:39 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 16:39:39 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 16:39:39 +0000 INFO:firstload executed successfully
2026-01-30 16:39:39 +0000 INFO:Data first load completed successfully.
2026-01-30 16:39:39 +0000 INFO:initialise_data executed successfully
2026-01-30 16:39:39 +0000 INFO:Running Menu setup...
2026-01-30 16:39:39 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 16:39:39 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 16:39:39 +0000 INFO:get_git_version executed successfully
2026-01-30 16:39:39 +0000 INFO:App Version: v50.239
2026-01-30 16:39:39 +0000 INFO:Switched to page: Donor Loyalty Analysis
2026-01-30 16:39:39 +0000 DEBUG:Calling mod_donor_loyalty with args={args}, kwargs={kwargs}
2026-01-30 16:39:39 +0000 DEBUG:Calling display_donor_distribution with args={args}, kwargs={kwargs}
2026-01-30 16:39:41 +0000 INFO:display_donor_distribution executed successfully
2026-01-30 16:39:41 +0000 DEBUG:Calling display_government_period_analysis with args={args}, kwargs={kwargs}
2026-01-30 16:39:42 +0000 DEBUG:matplotlib data path: H:\python310\lib\site-packages\matplotlib\mpl-data
2026-01-30 16:39:42 +0000 DEBUG:CONFIGDIR=C:\Users\pgold\.matplotlib
2026-01-30 16:39:42 +0000 DEBUG:interactive is False
2026-01-30 16:39:42 +0000 DEBUG:platform is win32
2026-01-30 16:39:42 +0000 DEBUG:CACHEDIR=C:\Users\pgold\.matplotlib
2026-01-30 16:39:42 +0000 DEBUG:Using fontManager instance from C:\Users\pgold\.matplotlib\fontlist-v330.json
2026-01-30 16:39:43 +0000 INFO:display_government_period_analysis executed successfully
2026-01-30 16:39:43 +0000 DEBUG:Calling display_loyalty_metrics with args={args}, kwargs={kwargs}
2026-01-30 16:40:11 +0000 INFO:display_loyalty_metrics executed successfully
2026-01-30 16:40:11 +0000 INFO:mod_donor_loyalty executed successfully
2026-01-30 16:40:11 +0000 INFO:pagesetup executed successfully
2026-01-30 16:40:11 +0000 INFO:Menu setup completed successfully.
2026-01-30 16:40:11 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:15:07 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2026-01-30 17:15:07 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:15:11 +0000 INFO:get_git_version executed successfully
2026-01-30 17:15:11 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:15:15 +0000 INFO:get_git_version executed successfully
2026-01-30 17:15:15 +0000 INFO:Streamlit App Starting...
2026-01-30 17:15:15 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:15:15 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:15:15 +0000 INFO:Running App setup...
2026-01-30 17:15:15 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:15:15 +0000 INFO:Setting up the package
2026-01-30 17:15:15 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:15:15 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:15:20 +0000 INFO:get_git_version executed successfully
2026-01-30 17:15:20 +0000 INFO:Version: v50.201
2026-01-30 17:15:20 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:15:20 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:15:20 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2026-01-30 17:15:20 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:15:20 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2026-01-30 17:15:20 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2026-01-30 17:15:20 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:15:20 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:15:20 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:15:20 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:15:20 +0000 DEBUG:Initialised perc_target with value: 0.5
2026-01-30 17:15:20 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2026-01-30 17:15:20 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:15:20 +0000 DEBUG:Initialised electoral_cycle_rules with value: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:15:20 +0000 DEBUG:Initialised reference_dir with value: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:15:20 +0000 DEBUG:Initialised data_dir with value: H:\GitHub\dashboard_demo\data
2026-01-30 17:15:20 +0000 DEBUG:Initialised output_dir with value: H:\GitHub\dashboard_demo\output
2026-01-30 17:15:20 +0000 DEBUG:Initialised logs_dir with value: H:\GitHub\dashboard_demo\logs
2026-01-30 17:15:20 +0000 DEBUG:Initialised components_dir with value: H:\GitHub\dashboard_demo\components
2026-01-30 17:15:20 +0000 DEBUG:Initialised app_pages_dir with value: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:15:20 +0000 DEBUG:Initialised utils_dir with value: H:\GitHub\dashboard_demo\utils
2026-01-30 17:15:20 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:15:20 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:15:20 +0000 DEBUG:Initialised mppartymemb_fname with value: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:15:20 +0000 DEBUG:Initialised donor_map_fname with value: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:15:20 +0000 DEBUG:Initialised politician_party_fname with value: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:15:20 +0000 DEBUG:Initialised regentity_map_fname with value: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:15:20 +0000 DEBUG:Initialised original_data_fname with value: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:15:20 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:15:20 +0000 DEBUG:Initialised TEXT_FILE with value: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:15:20 +0000 DEBUG:Initialised ELECTION_DATES with value: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:15:20 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:15:20 +0000 DEBUG:Initialised cleaned_data_fname with value: cleaned_data.zip
2026-01-30 17:15:20 +0000 DEBUG:Initialised cleaned_donations_fname with value: cleaned_donations.zip
2026-01-30 17:15:20 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: cleaned_donorlist.zip
2026-01-30 17:15:20 +0000 DEBUG:Initialised cleaned_regentity_fname with value: cleaned_regentity.zip
2026-01-30 17:15:20 +0000 DEBUG:Initialised party_summary_fname with value: party_summary.zip
2026-01-30 17:15:20 +0000 DEBUG:Initialised imported_raw_fname with value: imported_raw.zip
2026-01-30 17:15:20 +0000 DEBUG:Initialised source_data_fname with value: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:15:20 +0000 DEBUG:Initialised Cash_ftr with value: None
2026-01-30 17:15:20 +0000 INFO:Session_state variables initialized
2026-01-30 17:15:20 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:15:20 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:15:20 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:15:20 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:15:20 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:15:20 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:15:20 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:15:20 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:15:20 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:15:20 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:15:20 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:15:20 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:15:20 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:15:20 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:15:20 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:15:20 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:15:20 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:15:20 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:15:20 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:15:20 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:15:20 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:15:20 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:15:20 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:15:20 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:15:20 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:15:20 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:15:20 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:15:20 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:15:20 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:15:20 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:15:20 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:15:20 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:15:20 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:15:20 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:15:20 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:15:20 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:15:20 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:15:20 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:15:20 +0000 INFO:Session state Setup complete
2026-01-30 17:15:20 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:15:20 +0000 INFO:Package setup complete
2026-01-30 17:15:20 +0000 INFO:setup_package executed successfully
2026-01-30 17:15:20 +0000 INFO:Setup completed successfully.
2026-01-30 17:15:20 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:15:20 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:15:23 +0000 INFO:get_git_version executed successfully
2026-01-30 17:15:23 +0000 INFO:Running first load function.
2026-01-30 17:15:23 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:15:23 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2026-01-30 17:15:23 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2026-01-30 17:15:23 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2026-01-30 17:15:23 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2026-01-30 17:15:23 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 17:15:23 +0000 INFO:Original file path: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:15:23 +0000 INFO:Saved file path: imported_raw.zip
2026-01-30 17:15:23 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 17:15:23 +0000 INFO:Checking if H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip has been updated.
2026-01-30 17:15:23 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 17:15:23 +0000 INFO:Getting modification time for H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:15:23 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 17:15:23 +0000 INFO:Current modification time: 1769774510.1556323
2026-01-30 17:15:23 +0000 INFO:Last modification time: 1769774510.1556323
2026-01-30 17:15:23 +0000 INFO:is_file_updated executed successfully
2026-01-30 17:15:23 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 17:15:23 +0000 INFO:Loading raw data...
2026-01-30 17:15:23 +0000 DEBUG:Original data file path post raw data load: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:15:23 +0000 DEBUG:Processed data file path post raw data load: imported_raw.zip
2026-01-30 17:15:23 +0000 INFO:Data loaded successfully. Data has 91341 rows and 29 columns
2026-01-30 17:15:25 +0000 INFO:Data saved to imported_raw.zip
2026-01-30 17:15:25 +0000 INFO:Data saved to sessionstate as 'raw_data'
2026-01-30 17:15:25 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2026-01-30 17:15:25 +0000 INFO:Cleaning up raw data
2026-01-30 17:15:25 +0000 ERROR:Session state variables not initialized!
2026-01-30 17:15:25 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 17:15:25 +0000 INFO:Original file path: None
2026-01-30 17:15:25 +0000 INFO:Saved file path: cleaned_donations.zip
2026-01-30 17:15:25 +0000 ERROR:Error: originalfilepath is None!
2026-01-30 17:15:25 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 17:15:25 +0000 INFO:Data loaded, shape: (91341, 29)
2026-01-30 17:15:26 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2026-01-30 17:15:26 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2026-01-30 17:15:27 +0000 INFO:File deduplication complete, shape: ECRef                            592
OriginalRegulatedEntityName      592
RegulatedEntityType              592
Value                            592
AcceptedDate                     574
AccountingUnitName               592
DonorName                        592
AccountingUnitsAsCentralParty    592
IsSponsorship                    592
DonorStatus                      592
RegulatedDoneeType               592
CompanyRegistrationNumber        592
Postcode                         592
DonationType                     592
NatureOfDonation                 592
PurposeOfVisit                   592
DonationAction                   592
ReceivedDate                     486
ReportedDate                     592
IsReportedPrePoll                423
ReportingPeriodName              592
IsBequest                        592
IsAggregation                    592
OriginalRegulatedEntityId        592
AccountingUnitId                 592
DonorId                          592
CampaigningName                  592
RegisterName                     592
IsIrishSource                    592
CleanedRegulatedEntityName       592
CleanedRegulatedEntityId         592
RegulatedEntityId                592
RegulatedEntityName              592
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10109
OriginalRegulatedEntityName      10109
RegulatedEntityType              10109
Value                            10107
AcceptedDate                      9796
AccountingUnitName               10109
DonorName                        10109
AccountingUnitsAsCentralParty    10109
IsSponsorship                    10109
DonorStatus                      10109
RegulatedDoneeType               10109
CompanyRegistrationNumber        10109
Postcode                         10109
DonationType                     10109
NatureOfDonation                 10109
PurposeOfVisit                   10109
DonationAction                   10109
ReceivedDate                      7075
ReportedDate                     10099
IsReportedPrePoll                 4878
ReportingPeriodName              10109
IsBequest                        10109
IsAggregation                    10109
OriginalRegulatedEntityId        10109
AccountingUnitId                 10109
DonorId                          10109
CampaigningName                  10109
RegisterName                     10109
IsIrishSource                    10109
CleanedRegulatedEntityName       10109
CleanedRegulatedEntityId         10109
RegulatedEntityId                10109
RegulatedEntityName              10109
dtype: int64 records updated with new RegulatedEntityName
2026-01-30 17:15:27 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3771
OriginalRegulatedEntityName      3771
RegulatedEntityType              3771
Value                            3771
AcceptedDate                     3667
AccountingUnitName               3771
DonorName                        3771
AccountingUnitsAsCentralParty    3771
IsSponsorship                    3771
DonorStatus                      3771
RegulatedDoneeType               3771
CompanyRegistrationNumber        3771
Postcode                         3771
DonationType                     3771
NatureOfDonation                 3771
PurposeOfVisit                   3771
DonationAction                   3771
ReceivedDate                     3297
ReportedDate                     3771
IsReportedPrePoll                 449
ReportingPeriodName              3771
IsBequest                        3771
IsAggregation                    3771
OriginalRegulatedEntityId        3771
AccountingUnitId                 3771
DonorId                          3771
CampaigningName                  3771
RegisterName                     3771
IsIrishSource                    3771
CleanedRegulatedEntityName        592
CleanedRegulatedEntityId          592
RegulatedEntityId                3771
RegulatedEntityName              3771
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13288
OriginalRegulatedEntityName      13288
RegulatedEntityType              13288
Value                            13286
AcceptedDate                     12889
AccountingUnitName               13288
DonorName                        13288
AccountingUnitsAsCentralParty    13288
IsSponsorship                    13288
DonorStatus                      13288
RegulatedDoneeType               13288
CompanyRegistrationNumber        13288
Postcode                         13288
DonationType                     13288
NatureOfDonation                 13288
PurposeOfVisit                   13288
DonationAction                   13288
ReceivedDate                      9886
ReportedDate                     13278
IsReportedPrePoll                 4904
ReportingPeriodName              13288
IsBequest                        13288
IsAggregation                    13288
OriginalRegulatedEntityId        13288
AccountingUnitId                 13288
DonorId                          13288
CampaigningName                  13288
RegisterName                     13288
IsIrishSource                    13288
CleanedRegulatedEntityName       10109
CleanedRegulatedEntityId         10109
RegulatedEntityId                13288
RegulatedEntityName              13288
dtype: int64 records updated with new RegulatedEntityName
2026-01-30 17:15:27 +0000 INFO:File deduplication complete, shape: (91341, 33)
2026-01-30 17:15:27 +0000 INFO:dedupe_entity_file executed successfully
2026-01-30 17:15:27 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2026-01-30 17:15:27 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2026-01-30 17:15:27 +0000 INFO:File deduplication complete, shape: ECRef                            34082
OriginalRegulatedEntityName      34082
RegulatedEntityType              34082
Value                            34079
AcceptedDate                     33689
AccountingUnitName               34082
OriginalDonorName                34082
AccountingUnitsAsCentralParty    34082
IsSponsorship                    34082
DonorStatus                      34082
RegulatedDoneeType               34082
CompanyRegistrationNumber        34082
Postcode                         34082
DonationType                     34082
NatureOfDonation                 34082
PurposeOfVisit                   34082
DonationAction                   34082
ReceivedDate                     32487
ReportedDate                     34071
IsReportedPrePoll                22707
ReportingPeriodName              34082
IsBequest                        34082
IsAggregation                    34082
OriginalRegulatedEntityId        34082
AccountingUnitId                 34082
OriginalDonorId                  34082
CampaigningName                  34082
RegisterName                     34082
IsIrishSource                    34082
CleanedRegulatedEntityName       34082
CleanedRegulatedEntityId         34082
RegulatedEntityId                34082
RegulatedEntityName              34082
CleanedDonorName                 34082
CleanedDonorId                   34082
DonorId                          34082
DonorName                        34082
dtype: int64 records updated with new DonorId and ECRef                            20155
OriginalRegulatedEntityName      20155
RegulatedEntityType              20155
Value                            20153
AcceptedDate                     19834
AccountingUnitName               20155
OriginalDonorName                20155
AccountingUnitsAsCentralParty    20155
IsSponsorship                    20155
DonorStatus                      20155
RegulatedDoneeType               20155
CompanyRegistrationNumber        20155
Postcode                         20155
DonationType                     20155
NatureOfDonation                 20155
PurposeOfVisit                   20155
DonationAction                   20155
ReceivedDate                     19620
ReportedDate                     20146
IsReportedPrePoll                13414
ReportingPeriodName              20155
IsBequest                        20155
IsAggregation                    20155
OriginalRegulatedEntityId        20155
AccountingUnitId                 20155
OriginalDonorId                  20155
CampaigningName                  20155
RegisterName                     20155
IsIrishSource                    20155
CleanedRegulatedEntityName       20154
CleanedRegulatedEntityId         20154
RegulatedEntityId                20155
RegulatedEntityName              20155
CleanedDonorName                 20155
CleanedDonorId                   20155
DonorId                          20155
DonorName                        20155
dtype: int64 records updated with new DonorName
2026-01-30 17:15:27 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            52934
OriginalRegulatedEntityName      52934
RegulatedEntityType              52934
Value                            52931
AcceptedDate                     52138
AccountingUnitName               52934
OriginalDonorName                52934
AccountingUnitsAsCentralParty    52934
IsSponsorship                    52934
DonorStatus                      52934
RegulatedDoneeType               52934
CompanyRegistrationNumber        52934
Postcode                         52934
DonationType                     52934
NatureOfDonation                 52934
PurposeOfVisit                   52934
DonationAction                   52934
ReceivedDate                     50532
ReportedDate                     52923
IsReportedPrePoll                23658
ReportingPeriodName              52934
IsBequest                        52934
IsAggregation                    52934
OriginalRegulatedEntityId        52934
AccountingUnitId                 52934
OriginalDonorId                  52934
CampaigningName                  52934
RegisterName                     52934
IsIrishSource                    52934
CleanedRegulatedEntityName       49804
CleanedRegulatedEntityId         49804
RegulatedEntityId                52934
RegulatedEntityName              52934
CleanedDonorName                 34082
CleanedDonorId                   34082
DonorId                          52934
DonorName                        52934
dtype: int64 records updated with new DonorId and ECRef                            39007
OriginalRegulatedEntityName      39007
RegulatedEntityType              39007
Value                            39005
AcceptedDate                     38283
AccountingUnitName               39007
OriginalDonorName                39007
AccountingUnitsAsCentralParty    39007
IsSponsorship                    39007
DonorStatus                      39007
RegulatedDoneeType               39007
CompanyRegistrationNumber        39007
Postcode                         39007
DonationType                     39007
NatureOfDonation                 39007
PurposeOfVisit                   39007
DonationAction                   39007
ReceivedDate                     37665
ReportedDate                     38998
IsReportedPrePoll                14365
ReportingPeriodName              39007
IsBequest                        39007
IsAggregation                    39007
OriginalRegulatedEntityId        39007
AccountingUnitId                 39007
OriginalDonorId                  39007
CampaigningName                  39007
RegisterName                     39007
IsIrishSource                    39007
CleanedRegulatedEntityName       35876
CleanedRegulatedEntityId         35876
RegulatedEntityId                39007
RegulatedEntityName              39007
CleanedDonorName                 20155
CleanedDonorId                   20155
DonorId                          39007
DonorName                        39007
dtype: int64 records updated with new DonorName
2026-01-30 17:15:27 +0000 INFO:File deduplication complete, shape: (91341, 37)
2026-01-30 17:15:27 +0000 INFO:dedupe_entity_file executed successfully
2026-01-30 17:15:27 +0000 INFO:Raw Data cleanup completed
2026-01-30 17:15:27 +0000 INFO:Data shape: (91341, 37)
2026-01-30 17:15:29 +0000 INFO:Data saved to cleaned_donations.zip
2026-01-30 17:15:29 +0000 INFO:Data cleanup completed, shape: (91341, 37)
2026-01-30 17:15:29 +0000 INFO:raw_data_cleanup executed successfully
2026-01-30 17:15:29 +0000 INFO:load_raw_data executed successfully
2026-01-30 17:15:29 +0000 INFO:get_raw_data executed successfully
2026-01-30 17:15:29 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:15:29 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2026-01-30 17:15:29 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2026-01-30 17:15:29 +0000 DEBUG:Rows in Raw Data: 91341
2026-01-30 17:15:29 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 17:15:29 +0000 INFO:Original file path: cleaned_donations.zip
2026-01-30 17:15:29 +0000 INFO:Saved file path: cleaned_data.zip
2026-01-30 17:15:29 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 17:15:29 +0000 INFO:Checking if cleaned_donations.zip has been updated.
2026-01-30 17:15:29 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 17:15:29 +0000 INFO:Getting modification time for cleaned_donations.zip
2026-01-30 17:15:29 +0000 WARNING:File cleaned_donations.zip does not exist.
2026-01-30 17:15:29 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 17:15:29 +0000 INFO:Current modification time: None
2026-01-30 17:15:29 +0000 INFO:Last modification time: 1769774510.1556323
2026-01-30 17:15:29 +0000 WARNING:Cannot determine modification time for cleaned_donations.zip
2026-01-30 17:15:29 +0000 INFO:is_file_updated executed successfully
2026-01-30 17:15:29 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 17:15:29 +0000 ERROR:Failed to load data from cleaned_donations.zip
2026-01-30 17:15:29 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2026-01-30 17:15:29 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91341
2026-01-30 17:15:29 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91341
2026-01-30 17:15:31 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2026-01-30 17:15:31 +0000 DEBUG:Clean Data Prep 204: Map Party: 91341
2026-01-30 17:16:06 +0000 INFO:Added parliamentary_sitting column with 8 unique periods
2026-01-30 17:16:06 +0000 DEBUG:Group assignment with exceptions: {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}
2026-01-30 17:16:06 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28638
Labour Party                       22675
Liberal Democrats                  19030
Large Entity                        8611
Medium Entity                       3809
Small Entity                        1985
Uk Independence Party (Ukip)        1830
Green Party                         1673
Single Donation Entity              1353
Scottish National Party (Snp)        815
Plaid Cymru - Party Of Wales         517
Reform UK                            377
Liberal Party                         15
Sinn Féin                             13
Name: count, dtype: int64
2026-01-30 17:16:06 +0000 DEBUG:Group assignment: group
Single Donation Entity             1353
Small Entity                        839
Medium Entity                       614
Large Entity                        227
Conservative And Unionist Party       8
Labour Party                          8
Liberal Democrats                     8
Plaid Cymru - Party Of Wales          8
Scottish National Party (Snp)         8
Uk Independence Party (Ukip)          8
Green Party                           7
Liberal Party                         4
Reform UK                             3
Sinn Féin                             1
Name: count, dtype: int64
2026-01-30 17:16:06 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91341
2026-01-30 17:16:06 +0000 DEBUG:Group assignment with exceptions: {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}
2026-01-30 17:16:06 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32036
Labour Party                       27106
Large Entity                       24804
Uk Independence Party (Ukip)        1853
Green Party                         1694
Medium Entity                       1112
Scottish National Party (Snp)        881
Small Entity                         552
Plaid Cymru - Party Of Wales         525
Reform UK                            377
Single Donation Entity               372
Liberal Party                         15
Sinn Féin                             13
Democratic Unionist Party              1
Name: count, dtype: int64
2026-01-30 17:16:06 +0000 DEBUG:Group assignment: group
Single Donation Entity             372
Small Entity                       233
Medium Entity                      171
Large Entity                       120
Conservative And Unionist Party      8
Labour Party                         8
Plaid Cymru - Party Of Wales         8
Scottish National Party (Snp)        8
Uk Independence Party (Ukip)         8
Green Party                          7
Liberal Party                        4
Reform UK                            3
Democratic Unionist Party            1
Sinn Féin                            1
Name: count, dtype: int64
2026-01-30 17:16:06 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91341
2026-01-30 17:16:06 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2026-01-30 17:16:06 +0000 INFO:Loading election dates from pdpy.
2026-01-30 17:16:06 +0000 INFO:Election Dates loaded from pdpy.
2026-01-30 17:16:06 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2026-01-30 17:16:06 +0000 INFO:Election Dates Loaded Successfully.
2026-01-30 17:16:06 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:16:06 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:16:06 +0000 INFO:load_election_dates executed successfully
2026-01-30 17:16:07 +0000 DEBUG:Clean Data Prep 353: Election dates: 91341
2026-01-30 17:16:07 +0000 DEBUG:Clean Data Prep 386: End of clean: 91341
2026-01-30 17:16:09 +0000 INFO:Cleaned Data completed, shape: (91341, 57)
2026-01-30 17:16:09 +0000 INFO:load_cleaned_data executed successfully
2026-01-30 17:16:10 +0000 INFO:get_cleaned_data executed successfully
2026-01-30 17:16:10 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:16:10 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2026-01-30 17:16:10 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2026-01-30 17:16:10 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 17:16:10 +0000 INFO:Original file path: cleaned_data.zip
2026-01-30 17:16:10 +0000 INFO:Saved file path: cleaned_donorlist.zip
2026-01-30 17:16:10 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 17:16:10 +0000 INFO:Checking if cleaned_data.zip has been updated.
2026-01-30 17:16:10 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 17:16:10 +0000 INFO:Getting modification time for cleaned_data.zip
2026-01-30 17:16:10 +0000 WARNING:File cleaned_data.zip does not exist.
2026-01-30 17:16:10 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 17:16:10 +0000 INFO:Current modification time: None
2026-01-30 17:16:10 +0000 INFO:Last modification time: 1769718453.1764421
2026-01-30 17:16:10 +0000 WARNING:Cannot determine modification time for cleaned_data.zip
2026-01-30 17:16:10 +0000 INFO:is_file_updated executed successfully
2026-01-30 17:16:10 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 17:16:10 +0000 INFO:Donor data saved to cleaned_donorlist.zip
2026-01-30 17:16:10 +0000 INFO:Donor Data summary completed
2026-01-30 17:16:10 +0000 INFO:Data shape: (32070, 5)
2026-01-30 17:16:10 +0000 INFO:load_donorList_data executed successfully
2026-01-30 17:16:10 +0000 INFO:get_donor_data executed successfully
2026-01-30 17:16:10 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:16:10 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:16:10 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2026-01-30 17:16:10 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2026-01-30 17:16:10 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 17:16:10 +0000 INFO:Original file path: cleaned_data.zip
2026-01-30 17:16:10 +0000 INFO:Saved file path: cleaned_regentity.zip
2026-01-30 17:16:10 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 17:16:10 +0000 INFO:Checking if cleaned_data.zip has been updated.
2026-01-30 17:16:10 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 17:16:10 +0000 INFO:Getting modification time for cleaned_data.zip
2026-01-30 17:16:10 +0000 WARNING:File cleaned_data.zip does not exist.
2026-01-30 17:16:10 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 17:16:10 +0000 INFO:Current modification time: None
2026-01-30 17:16:10 +0000 INFO:Last modification time: 1769718453.1764421
2026-01-30 17:16:10 +0000 WARNING:Cannot determine modification time for cleaned_data.zip
2026-01-30 17:16:10 +0000 INFO:is_file_updated executed successfully
2026-01-30 17:16:10 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 17:16:10 +0000 INFO:Regulated entity data saved to cleaned_regentity.zip
2026-01-30 17:16:10 +0000 INFO:Raw Data cleanup completed
2026-01-30 17:16:10 +0000 INFO:Data shape: (2404, 6)
2026-01-30 17:16:10 +0000 INFO:load_regulated_entity_data executed successfully
2026-01-30 17:16:10 +0000 INFO:get_regentity_data executed successfully
2026-01-30 17:16:10 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:16:10 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:16:10 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:16:10 +0000 INFO:firstload executed successfully
2026-01-30 17:16:10 +0000 INFO:Data first load completed successfully.
2026-01-30 17:16:10 +0000 INFO:initialise_data executed successfully
2026-01-30 17:16:10 +0000 INFO:Running Menu setup...
2026-01-30 17:16:10 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:16:10 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:16:13 +0000 INFO:get_git_version executed successfully
2026-01-30 17:16:13 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:16:16 +0000 INFO:get_git_version executed successfully
2026-01-30 17:16:16 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:16:19 +0000 INFO:get_git_version executed successfully
2026-01-30 17:16:19 +0000 INFO:App Version: v50.239
2026-01-30 17:16:19 +0000 INFO:Switched to page: Introduction
2026-01-30 17:16:19 +0000 INFO:pagesetup executed successfully
2026-01-30 17:16:19 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:16:19 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:20:37 +0000 INFO:Streamlit App Starting...
2026-01-30 17:20:37 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:20:37 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:20:37 +0000 INFO:Running App setup...
2026-01-30 17:20:37 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:20:37 +0000 INFO:Setting up the package
2026-01-30 17:20:37 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:20:37 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:20:37 +0000 INFO:get_git_version executed successfully
2026-01-30 17:20:37 +0000 INFO:Version: v50.201
2026-01-30 17:20:37 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:20:37 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:20:37 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:security already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:directories already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:20:37 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:20:37 +0000 INFO:Session_state variables initialized
2026-01-30 17:20:37 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:20:37 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:20:37 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:20:37 +0000 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x000002DC886FE3B0>}
2026-01-30 17:20:37 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:20:37 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:20:37 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:20:37 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:20:37 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:20:37 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:20:37 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:20:37 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:20:37 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:20:37 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:20:37 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:20:37 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:20:37 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:20:37 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:20:37 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:20:37 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:20:37 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:20:37 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:20:37 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:20:37 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:20:37 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:20:37 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:20:37 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:20:37 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:20:37 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:20:37 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:20:37 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:20:37 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:20:37 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:20:37 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:20:37 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:20:37 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:20:37 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:20:37 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:20:37 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:20:37 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:20:37 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:20:37 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:20:37 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:20:37 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:20:37 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:20:37 +0000 INFO:Session state Setup complete
2026-01-30 17:20:37 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:20:37 +0000 INFO:Package setup complete
2026-01-30 17:20:37 +0000 INFO:setup_package executed successfully
2026-01-30 17:20:37 +0000 INFO:Setup completed successfully.
2026-01-30 17:20:37 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:20:37 +0000 INFO:Running first load function.
2026-01-30 17:20:37 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:20:37 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:20:37 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:20:37 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:20:37 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:20:37 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:20:37 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:20:37 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:20:37 +0000 INFO:firstload executed successfully
2026-01-30 17:20:37 +0000 INFO:Data first load completed successfully.
2026-01-30 17:20:37 +0000 INFO:initialise_data executed successfully
2026-01-30 17:20:37 +0000 INFO:Running Menu setup...
2026-01-30 17:20:37 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:20:37 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:20:37 +0000 INFO:get_git_version executed successfully
2026-01-30 17:20:37 +0000 INFO:App Version: v50.239
2026-01-30 17:20:37 +0000 INFO:Switched to page: Head Line Figures
2026-01-30 17:20:37 +0000 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2026-01-30 17:20:37 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:20:37 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:20:37 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:20:38 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:20:39 +0000 DEBUG:Aggregated DataFrame:                         Party_Group         Value
0   Conservative And Unionist Party  20170.405233
1         Democratic Unionist Party   3618.940000
2                       Green Party   6204.226405
3                      Labour Party  20519.157176
4                      Large Entity  12031.362470
5                     Liberal Party   2871.754667
6                     Medium Entity  19378.136232
7      Plaid Cymru - Party Of Wales  15859.742724
8                         Reform UK  97641.772732
9     Scottish National Party (Snp)  36021.189364
10           Single Donation Entity  13864.955459
11                        Sinn Féin  44317.630769
12                     Small Entity  24968.983822
13     Uk Independence Party (Ukip)   9943.456859
2026-01-30 17:20:39 +0000 DEBUG:Sorted DataFrame:                         Party_Group         Value
8                         Reform UK  97641.772732
11                        Sinn Féin  44317.630769
9     Scottish National Party (Snp)  36021.189364
12                     Small Entity  24968.983822
3                      Labour Party  20519.157176
0   Conservative And Unionist Party  20170.405233
6                     Medium Entity  19378.136232
7      Plaid Cymru - Party Of Wales  15859.742724
10           Single Donation Entity  13864.955459
4                      Large Entity  12031.362470
13     Uk Independence Party (Ukip)   9943.456859
2                       Green Party   6204.226405
1         Democratic Unionist Party   3618.940000
5                     Liberal Party   2871.754667
2026-01-30 17:20:39 +0000 DEBUG:Unique XValues: ['Reform UK' 'Sinn Féin' 'Scottish National Party (Snp)' 'Small Entity'
 'Labour Party' 'Conservative And Unionist Party' 'Medium Entity'
 'Plaid Cymru - Party Of Wales' 'Single Donation Entity' 'Large Entity'
 'Uk Independence Party (Ukip)' 'Green Party' 'Democratic Unionist Party'
 'Liberal Party']
2026-01-30 17:20:39 +0000 DEBUG:Final color_discrete_map: {'Reform UK': '#12B6CF', 'Sinn Féin': '#326760', 'Scottish National Party (Snp)': '#636efa', 'Small Entity': '#aaaaaa', 'Labour Party': '#DC241F', 'Conservative And Unionist Party': '#0087DC', 'Medium Entity': '#666666', 'Plaid Cymru - Party Of Wales': '#636efa', 'Single Donation Entity': '#e8e8e8', 'Large Entity': '#222222', 'Uk Independence Party (Ukip)': '#70147A', 'Green Party': '#78B943', 'Democratic Unionist Party': '#636efa', 'Liberal Party': '#636efa'}
2026-01-30 17:20:39 +0000 DEBUG:Missing color mappings for: ['Scottish National Party (Snp)', 'Plaid Cymru - Party Of Wales', 'Democratic Unionist Party', 'Liberal Party']
2026-01-30 17:20:39 +0000 DEBUG:Generated Figure: Figure({
    'data': [{'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Reform UK',
              'marker': {'color': '#12B6CF', 'pattern': {'shape': ''}},
              'name': 'Reform UK',
              'offsetgroup': 'Reform UK',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Reform UK'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'a1QcXZzW90A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Sinn Féin',
              'marker': {'color': '#326760', 'pattern': {'shape': ''}},
              'name': 'Sinn Féin',
              'offsetgroup': 'Sinn Féin',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Sinn Féin'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'L/RCL7Sj5UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Scottish National Party (Snp)',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Scottish National Party (Snp)',
              'offsetgroup': 'Scottish National Party (Snp)',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Scottish National Party (Snp)'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '8tdFD6aW4UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Small Entity',
              'marker': {'color': '#aaaaaa', 'pattern': {'shape': ''}},
              'name': 'Small Entity',
              'offsetgroup': 'Small Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Small Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'vX7y9j5i2EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Labour Party',
              'marker': {'color': '#DC241F', 'pattern': {'shape': ''}},
              'name': 'Labour Party',
              'offsetgroup': 'Labour Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Labour Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '9qMqD8oJ1EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Conservative And Unionist Party',
              'marker': {'color': '#0087DC', 'pattern': {'shape': ''}},
              'name': 'Conservative And Unionist Party',
              'offsetgroup': 'Conservative And Unionist Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Conservative And Unionist Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '65FU75my00A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Medium Entity',
              'marker': {'color': '#666666', 'pattern': {'shape': ''}},
              'name': 'Medium Entity',
              'offsetgroup': 'Medium Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Medium Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'nXsGuIjs0kA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Plaid Cymru - Party Of Wales',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Plaid Cymru - Party Of Wales',
              'offsetgroup': 'Plaid Cymru - Party Of Wales',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Plaid Cymru - Party Of Wales'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '7uOSEd/5zkA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Single Donation Entity',
              'marker': {'color': '#e8e8e8', 'pattern': {'shape': ''}},
              'name': 'Single Donation Entity',
              'offsetgroup': 'Single Donation Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Single Donation Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'hd1+THoUy0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Large Entity',
              'marker': {'color': '#222222', 'pattern': {'shape': ''}},
              'name': 'Large Entity',
              'offsetgroup': 'Large Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Large Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'lyJsZa5/x0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Uk Independence Party (Ukip)',
              'marker': {'color': '#70147A', 'pattern': {'shape': ''}},
              'name': 'Uk Independence Party (Ukip)',
              'offsetgroup': 'Uk Independence Party (Ukip)',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Uk Independence Party (Ukip)'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'U0xcerprw0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Green Party',
              'marker': {'color': '#78B943', 'pattern': {'shape': ''}},
              'name': 'Green Party',
              'offsetgroup': 'Green Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Green Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'LOWs9Tk8uEA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Democratic Unionist Party',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Democratic Unionist Party',
              'offsetgroup': 'Democratic Unionist Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Democratic Unionist Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'exSuR+FFrEA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Liberal Party',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Liberal Party',
              'offsetgroup': 'Liberal Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Liberal Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'blmrY4JvpkA=', 'dtype': 'f8'},
              'yaxis': 'y'}],
    'layout': {'barmode': 'group',
               'legend': {'title': {'text': 'Political Party'}, 'tracegroupgap': 0},
               'template': '...',
               'title': {'text': 'Average Donation per Party'},
               'xaxis': {'anchor': 'y',
                         'categoryarray': [Reform UK, Sinn Féin, Scottish National
                                           Party (Snp), Small Entity, Labour Party,
                                           Conservative And Unionist Party, Medium
                                           Entity, Plaid Cymru - Party Of Wales,
                                           Single Donation Entity, Large Entity, Uk
                                           Independence Party (Ukip), Green Party,
                                           Democratic Unionist Party, Liberal
                                           Party],
                         'categoryorder': 'array',
                         'domain': [0.0, 1.0],
                         'title': {'text': 'Political Party'}},
               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': 'Average Donation GBP'}}}
})
2026-01-30 17:20:39 +0000 INFO:Bar chart displayed successfully.
2026-01-30 17:20:39 +0000 INFO:hlf_body executed successfully
2026-01-30 17:20:39 +0000 INFO:pagesetup executed successfully
2026-01-30 17:20:39 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:20:39 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:20:52 +0000 INFO:Streamlit App Starting...
2026-01-30 17:20:52 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:20:52 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:20:52 +0000 INFO:Running App setup...
2026-01-30 17:20:52 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:20:52 +0000 INFO:Setting up the package
2026-01-30 17:20:52 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:20:52 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:20:52 +0000 INFO:get_git_version executed successfully
2026-01-30 17:20:52 +0000 INFO:Version: v50.201
2026-01-30 17:20:52 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:20:52 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:20:52 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:security already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:directories already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:20:52 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:20:52 +0000 INFO:Session_state variables initialized
2026-01-30 17:20:52 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:20:52 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:20:52 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:20:52 +0000 DEBUG:menu_selection: {'title': 'Cash Donations', 'function': <function mod_cash_donations at 0x000002DC886FF760>}
2026-01-30 17:20:52 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:20:52 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:20:52 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:20:52 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:20:52 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:20:52 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:20:52 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:20:52 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:20:52 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:20:52 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:20:52 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:20:52 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:20:52 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:20:52 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:20:52 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:20:52 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:20:52 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:20:52 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:20:52 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:20:52 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:20:52 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:20:52 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:20:52 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:20:52 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:20:52 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:20:52 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:20:52 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:20:52 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:20:52 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:20:52 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:20:52 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:20:52 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:20:52 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:20:52 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:20:52 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:20:52 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:20:52 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:20:52 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:20:52 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:20:52 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:20:52 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:20:52 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:20:52 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:20:52 +0000 INFO:Session state Setup complete
2026-01-30 17:20:52 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:20:52 +0000 INFO:Package setup complete
2026-01-30 17:20:52 +0000 INFO:setup_package executed successfully
2026-01-30 17:20:52 +0000 INFO:Setup completed successfully.
2026-01-30 17:20:52 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:20:52 +0000 INFO:Running first load function.
2026-01-30 17:20:52 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:20:52 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:20:52 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:20:52 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:20:52 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:20:52 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:20:52 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:20:52 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:20:52 +0000 INFO:firstload executed successfully
2026-01-30 17:20:52 +0000 INFO:Data first load completed successfully.
2026-01-30 17:20:52 +0000 INFO:initialise_data executed successfully
2026-01-30 17:20:52 +0000 INFO:Running Menu setup...
2026-01-30 17:20:52 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:20:52 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:20:52 +0000 INFO:get_git_version executed successfully
2026-01-30 17:20:52 +0000 INFO:App Version: v50.239
2026-01-30 17:20:52 +0000 INFO:Switched to page: Cash Donations
2026-01-30 17:20:52 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:20:52 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:20:52 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:20:52 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:20:52 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:20:52 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:20:52 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:20:52 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:20:52 +0000 DEBUG:Page texts: {'Para1': {'text': 'Except for in 2016', 'is_deleted': False}, 'Para 2': {'text': 'More useful information', 'is_deleted': False}}
2026-01-30 17:20:52 +0000 DEBUG:Calling manage_text_elements with args={args}, kwargs={kwargs}
2026-01-30 17:20:52 +0000 DEBUG:Not logged in as admin.
2026-01-30 17:20:52 +0000 INFO:manage_text_elements executed successfully
2026-01-30 17:20:52 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:20:52 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:20:53 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:20:53 +0000 INFO:display_data_page executed successfully
2026-01-30 17:20:53 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:20:53 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:20:53 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:20:53 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:20:53 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:20:53 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:20:53 +0000 DEBUG:Page texts: {}
2026-01-30 17:20:53 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:20:53 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:20:54 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:20:54 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:20:54 +0000 INFO:pagesetup executed successfully
2026-01-30 17:20:54 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:20:54 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:21:04 +0000 INFO:Streamlit App Starting...
2026-01-30 17:21:04 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:21:04 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:21:04 +0000 INFO:Running App setup...
2026-01-30 17:21:04 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:21:04 +0000 INFO:Setting up the package
2026-01-30 17:21:04 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:21:04 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:21:04 +0000 INFO:get_git_version executed successfully
2026-01-30 17:21:04 +0000 INFO:Version: v50.201
2026-01-30 17:21:04 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:21:04 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:21:04 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:security already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:directories already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:21:04 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:21:04 +0000 INFO:Session_state variables initialized
2026-01-30 17:21:04 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:21:04 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:21:04 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:21:04 +0000 DEBUG:menu_selection: {'title': 'Non Cash Donations', 'function': <function mod_non_cash_donations at 0x000002DC886FF7F0>}
2026-01-30 17:21:04 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:21:04 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:21:04 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:21:04 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:21:04 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:21:04 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:21:04 +0000 DEBUG:mod_cash_donations_per_donor_None_mod_cash_donations_per_donorCash Donations per DonorNone_group_entity_select: Donor
2026-01-30 17:21:04 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:21:04 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:21:04 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:21:04 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:21:04 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:21:04 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:21:04 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:21:04 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:21:04 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:21:04 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:21:04 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:21:04 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:21:04 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:21:04 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:21:04 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:21:04 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:21:04 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:21:04 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:21:04 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:21:04 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:21:04 +0000 DEBUG:date_range_mod_cash_donations_per_donor_mod_cash_donations_per_donorCash Donations per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:21:04 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:21:04 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:21:04 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:21:04 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:21:04 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:21:04 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:21:04 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:21:04 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:21:04 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:21:04 +0000 DEBUG:selected_entity_name: All
2026-01-30 17:21:04 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:21:04 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:21:04 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:21:04 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:21:04 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:21:04 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:21:04 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:21:04 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:21:04 +0000 INFO:Session state Setup complete
2026-01-30 17:21:04 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:21:04 +0000 INFO:Package setup complete
2026-01-30 17:21:04 +0000 INFO:setup_package executed successfully
2026-01-30 17:21:04 +0000 INFO:Setup completed successfully.
2026-01-30 17:21:04 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:21:04 +0000 INFO:Running first load function.
2026-01-30 17:21:04 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:21:04 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:21:04 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:21:04 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:21:04 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:21:04 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:21:04 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:21:04 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:21:04 +0000 INFO:firstload executed successfully
2026-01-30 17:21:04 +0000 INFO:Data first load completed successfully.
2026-01-30 17:21:04 +0000 INFO:initialise_data executed successfully
2026-01-30 17:21:04 +0000 INFO:Running Menu setup...
2026-01-30 17:21:04 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:21:04 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:21:04 +0000 INFO:get_git_version executed successfully
2026-01-30 17:21:04 +0000 INFO:App Version: v50.239
2026-01-30 17:21:04 +0000 INFO:Switched to page: Non Cash Donations
2026-01-30 17:21:04 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:21:04 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:21:04 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:21:04 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:21:04 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:21:04 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:21:04 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:21:04 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:21:04 +0000 DEBUG:Page texts: {}
2026-01-30 17:21:04 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:21:04 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:21:05 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:21:05 +0000 INFO:display_data_page executed successfully
2026-01-30 17:21:05 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:21:05 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:21:05 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:21:05 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:21:05 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:21:05 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:21:05 +0000 DEBUG:Page texts: {}
2026-01-30 17:21:05 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:21:05 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:21:05 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:21:05 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:21:05 +0000 INFO:pagesetup executed successfully
2026-01-30 17:21:05 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:21:05 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:21:08 +0000 INFO:Streamlit App Starting...
2026-01-30 17:21:08 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:21:08 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:21:08 +0000 INFO:Running App setup...
2026-01-30 17:21:08 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:21:08 +0000 INFO:Setting up the package
2026-01-30 17:21:08 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:21:08 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:21:08 +0000 INFO:get_git_version executed successfully
2026-01-30 17:21:08 +0000 INFO:Version: v50.201
2026-01-30 17:21:08 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:21:08 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:21:08 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:security already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:directories already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:21:08 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:21:08 +0000 INFO:Session_state variables initialized
2026-01-30 17:21:08 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:21:08 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:21:08 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:21:08 +0000 DEBUG:menu_selection: {'title': 'Bequests', 'function': <function mod_bequeths at 0x000002DC886FF370>}
2026-01-30 17:21:08 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:21:08 +0000 DEBUG:date_range_mod_non_cash_donations_per_donor_mod_non_cash_donations_per_donorNon Cash Donations per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:21:08 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:21:08 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:21:08 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:21:08 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:21:08 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:21:08 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:21:08 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:21:08 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:21:08 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:21:08 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:21:08 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:21:08 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:21:08 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:21:08 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:21:08 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:21:08 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:21:08 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:21:08 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:21:08 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:21:08 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:21:08 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:21:08 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:21:08 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:21:08 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:21:08 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:21:08 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:21:08 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:21:08 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:21:08 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:21:08 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:21:08 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:21:08 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:21:08 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:21:08 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:21:08 +0000 DEBUG:selected_entity_name: All
2026-01-30 17:21:08 +0000 DEBUG:mod_non_cash_donations_per_donor_None_mod_non_cash_donations_per_donorNon Cash Donations per DonorNone_group_entity_select: Donor
2026-01-30 17:21:08 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:21:08 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:21:08 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:21:08 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:21:08 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:21:08 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:21:08 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:21:08 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:21:08 +0000 INFO:Session state Setup complete
2026-01-30 17:21:08 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:21:08 +0000 INFO:Package setup complete
2026-01-30 17:21:08 +0000 INFO:setup_package executed successfully
2026-01-30 17:21:08 +0000 INFO:Setup completed successfully.
2026-01-30 17:21:08 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:21:08 +0000 INFO:Running first load function.
2026-01-30 17:21:08 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:21:08 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:21:08 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:21:08 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:21:08 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:21:08 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:21:08 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:21:08 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:21:08 +0000 INFO:firstload executed successfully
2026-01-30 17:21:08 +0000 INFO:Data first load completed successfully.
2026-01-30 17:21:08 +0000 INFO:initialise_data executed successfully
2026-01-30 17:21:08 +0000 INFO:Running Menu setup...
2026-01-30 17:21:08 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:21:08 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:21:08 +0000 INFO:get_git_version executed successfully
2026-01-30 17:21:08 +0000 INFO:App Version: v50.239
2026-01-30 17:21:08 +0000 INFO:Switched to page: Bequests
2026-01-30 17:21:08 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:21:08 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:21:08 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:21:08 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:21:08 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:21:08 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:21:08 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:21:08 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:21:08 +0000 DEBUG:Page texts: {}
2026-01-30 17:21:08 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:21:08 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:21:08 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:21:08 +0000 INFO:display_data_page executed successfully
2026-01-30 17:21:08 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:21:09 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:21:09 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:21:09 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:21:09 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:21:09 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:21:09 +0000 DEBUG:Page texts: {}
2026-01-30 17:21:09 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:21:09 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:21:09 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:21:09 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:21:09 +0000 INFO:pagesetup executed successfully
2026-01-30 17:21:09 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:21:09 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:21:20 +0000 INFO:Streamlit App Starting...
2026-01-30 17:21:20 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:21:20 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:21:20 +0000 INFO:Running App setup...
2026-01-30 17:21:20 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:21:20 +0000 INFO:Setting up the package
2026-01-30 17:21:20 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:21:20 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:21:20 +0000 INFO:get_git_version executed successfully
2026-01-30 17:21:20 +0000 INFO:Version: v50.201
2026-01-30 17:21:20 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:21:20 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:21:20 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:security already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:directories already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:21:20 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:21:20 +0000 INFO:Session_state variables initialized
2026-01-30 17:21:20 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:21:21 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:21:21 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:21:21 +0000 DEBUG:date_range_mod_bequeths_per_donor_mod_bequeths_per_donorBequest per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:21:21 +0000 DEBUG:menu_selection: {'title': 'Corporate Donations', 'function': <function mod_corporate_donations at 0x000002DC886FF400>}
2026-01-30 17:21:21 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:21:21 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:21:21 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:21:21 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:21:21 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:21:21 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:21:21 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:21:21 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:21:21 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:21:21 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:21:21 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:21:21 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:21:21 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:21:21 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:21:21 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:21:21 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:21:21 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:21:21 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:21:21 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:21:21 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:21:21 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:21:21 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:21:21 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:21:21 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:21:21 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:21:21 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:21:21 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:21:21 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:21:21 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:21:21 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:21:21 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:21:21 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:21:21 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:21:21 +0000 DEBUG:mod_bequeths_per_donor_None_mod_bequeths_per_donorBequest per DonorNone_group_entity_select: Donor
2026-01-30 17:21:21 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:21:21 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:21:21 +0000 DEBUG:selected_entity_name: All
2026-01-30 17:21:21 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:21:21 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:21:21 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:21:21 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:21:21 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:21:21 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:21:21 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:21:21 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:21:21 +0000 INFO:Session state Setup complete
2026-01-30 17:21:21 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:21:21 +0000 INFO:Package setup complete
2026-01-30 17:21:21 +0000 INFO:setup_package executed successfully
2026-01-30 17:21:21 +0000 INFO:Setup completed successfully.
2026-01-30 17:21:21 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:21:21 +0000 INFO:Running first load function.
2026-01-30 17:21:21 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:21:21 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:21:21 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:21:21 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:21:21 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:21:21 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:21:21 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:21:21 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:21:21 +0000 INFO:firstload executed successfully
2026-01-30 17:21:21 +0000 INFO:Data first load completed successfully.
2026-01-30 17:21:21 +0000 INFO:initialise_data executed successfully
2026-01-30 17:21:21 +0000 INFO:Running Menu setup...
2026-01-30 17:21:21 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:21:21 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:21:21 +0000 INFO:get_git_version executed successfully
2026-01-30 17:21:21 +0000 INFO:App Version: v50.239
2026-01-30 17:21:21 +0000 INFO:Switched to page: Corporate Donations
2026-01-30 17:21:21 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:21:21 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:21:21 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:21:21 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:21:21 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:21:21 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:21:21 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:21:21 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:21:21 +0000 DEBUG:Page texts: {}
2026-01-30 17:21:21 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:21:21 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:21:21 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:21:21 +0000 INFO:display_data_page executed successfully
2026-01-30 17:21:21 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:21:21 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:21:22 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:21:22 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:21:22 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:21:22 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:21:22 +0000 DEBUG:Page texts: {}
2026-01-30 17:21:22 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:21:22 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:21:22 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:21:22 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:21:22 +0000 INFO:pagesetup executed successfully
2026-01-30 17:21:22 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:21:22 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:21:24 +0000 INFO:Streamlit App Starting...
2026-01-30 17:21:24 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:21:24 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:21:24 +0000 INFO:Running App setup...
2026-01-30 17:21:24 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:21:24 +0000 INFO:Setting up the package
2026-01-30 17:21:24 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:21:24 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:21:24 +0000 INFO:get_git_version executed successfully
2026-01-30 17:21:24 +0000 INFO:Version: v50.201
2026-01-30 17:21:24 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:21:24 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:21:24 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:security already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:directories already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:21:24 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:21:24 +0000 INFO:Session_state variables initialized
2026-01-30 17:21:24 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:21:24 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:21:24 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:21:24 +0000 DEBUG:menu_selection: {'title': 'Sponsorships', 'function': <function mod_sponsorships at 0x000002DC886FF2E0>}
2026-01-30 17:21:24 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:21:24 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:21:24 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:21:24 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:21:24 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:21:24 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:21:24 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:21:24 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:21:24 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:21:24 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:21:24 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:21:24 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:21:24 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:21:24 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:21:24 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:21:24 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:21:24 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:21:24 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:21:24 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:21:24 +0000 DEBUG:mod_corporate_donations_per_donor_None_mod_corporate_donations_per_donorCorporate Donation per DonorNone_group_entity_select: Donor
2026-01-30 17:21:24 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:21:24 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:21:24 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:21:24 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:21:24 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:21:24 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:21:24 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:21:24 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:21:24 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:21:24 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:21:24 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:21:24 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:21:24 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:21:24 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:21:24 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:21:24 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:21:24 +0000 DEBUG:selected_entity_name: All
2026-01-30 17:21:24 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:21:24 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:21:24 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:21:24 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:21:24 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:21:24 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:21:24 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:21:24 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:21:24 +0000 DEBUG:date_range_mod_corporate_donations_per_donor_mod_corporate_donations_per_donorCorporate Donation per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:21:24 +0000 INFO:Session state Setup complete
2026-01-30 17:21:24 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:21:24 +0000 INFO:Package setup complete
2026-01-30 17:21:24 +0000 INFO:setup_package executed successfully
2026-01-30 17:21:24 +0000 INFO:Setup completed successfully.
2026-01-30 17:21:24 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:21:24 +0000 INFO:Running first load function.
2026-01-30 17:21:24 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:21:24 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:21:24 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:21:24 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:21:24 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:21:24 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:21:24 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:21:24 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:21:24 +0000 INFO:firstload executed successfully
2026-01-30 17:21:24 +0000 INFO:Data first load completed successfully.
2026-01-30 17:21:24 +0000 INFO:initialise_data executed successfully
2026-01-30 17:21:24 +0000 INFO:Running Menu setup...
2026-01-30 17:21:24 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:21:24 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:21:24 +0000 INFO:get_git_version executed successfully
2026-01-30 17:21:24 +0000 INFO:App Version: v50.239
2026-01-30 17:21:24 +0000 INFO:Switched to page: Sponsorships
2026-01-30 17:21:24 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:21:24 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:21:24 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:21:24 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:21:25 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:21:25 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:21:25 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:21:25 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:21:25 +0000 DEBUG:Page texts: {}
2026-01-30 17:21:25 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:21:25 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:21:25 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:21:25 +0000 INFO:display_data_page executed successfully
2026-01-30 17:21:25 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:21:25 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:21:25 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:21:25 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:21:25 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:21:25 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:21:25 +0000 DEBUG:Page texts: {}
2026-01-30 17:21:25 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:21:25 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:21:25 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:21:25 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:21:25 +0000 INFO:pagesetup executed successfully
2026-01-30 17:21:25 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:21:25 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:21:27 +0000 INFO:Streamlit App Starting...
2026-01-30 17:21:27 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:21:27 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:21:27 +0000 INFO:Running App setup...
2026-01-30 17:21:27 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:21:27 +0000 INFO:Setting up the package
2026-01-30 17:21:27 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:21:27 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:21:27 +0000 INFO:get_git_version executed successfully
2026-01-30 17:21:27 +0000 INFO:Version: v50.201
2026-01-30 17:21:27 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:21:27 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:21:27 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:security already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:directories already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:21:27 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:21:27 +0000 INFO:Session_state variables initialized
2026-01-30 17:21:27 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:21:27 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:21:27 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:21:27 +0000 DEBUG:menu_selection: {'title': 'Paid Visits', 'function': <function mod_visits at 0x000002DC886FE560>}
2026-01-30 17:21:27 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:21:27 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:21:27 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:21:27 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:21:27 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:21:27 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:21:27 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:21:27 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:21:27 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:21:27 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:21:27 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:21:27 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:21:27 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:21:27 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:21:27 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:21:27 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:21:27 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:21:27 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:21:27 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:21:27 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:21:27 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:21:27 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:21:27 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:21:27 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:21:27 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:21:27 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:21:27 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:21:27 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:21:27 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:21:27 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:21:27 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:21:27 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:21:27 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:21:27 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:21:27 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:21:27 +0000 DEBUG:selected_entity_name: All
2026-01-30 17:21:27 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:21:27 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:21:27 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:21:27 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:21:27 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:21:27 +0000 DEBUG:mod_sponsorships_per_donor_None_mod_sponsorships_per_donorSponsorships per DonorNone_group_entity_select: Donor
2026-01-30 17:21:27 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:21:27 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:21:27 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:21:27 +0000 DEBUG:date_range_mod_sponsorships_per_donor_mod_sponsorships_per_donorSponsorships per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:21:27 +0000 INFO:Session state Setup complete
2026-01-30 17:21:27 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:21:27 +0000 INFO:Package setup complete
2026-01-30 17:21:27 +0000 INFO:setup_package executed successfully
2026-01-30 17:21:27 +0000 INFO:Setup completed successfully.
2026-01-30 17:21:27 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:21:27 +0000 INFO:Running first load function.
2026-01-30 17:21:27 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:21:27 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:21:27 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:21:27 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:21:27 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:21:27 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:21:27 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:21:27 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:21:27 +0000 INFO:firstload executed successfully
2026-01-30 17:21:27 +0000 INFO:Data first load completed successfully.
2026-01-30 17:21:27 +0000 INFO:initialise_data executed successfully
2026-01-30 17:21:27 +0000 INFO:Running Menu setup...
2026-01-30 17:21:27 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:21:27 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:21:27 +0000 INFO:get_git_version executed successfully
2026-01-30 17:21:27 +0000 INFO:App Version: v50.239
2026-01-30 17:21:27 +0000 INFO:Switched to page: Paid Visits
2026-01-30 17:21:27 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:21:27 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:21:27 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:21:27 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:21:27 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:21:27 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:21:27 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:21:27 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:21:27 +0000 DEBUG:Page texts: {}
2026-01-30 17:21:27 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:21:27 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:21:27 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:21:27 +0000 INFO:display_data_page executed successfully
2026-01-30 17:21:27 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:21:28 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:21:28 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:21:28 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:21:28 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:21:28 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:21:28 +0000 DEBUG:Page texts: {}
2026-01-30 17:21:28 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:21:28 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:21:28 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:21:28 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:21:28 +0000 INFO:pagesetup executed successfully
2026-01-30 17:21:28 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:21:28 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:21:31 +0000 INFO:Streamlit App Starting...
2026-01-30 17:21:31 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:21:31 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:21:31 +0000 INFO:Running App setup...
2026-01-30 17:21:31 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:21:31 +0000 INFO:Setting up the package
2026-01-30 17:21:31 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:21:31 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:21:31 +0000 INFO:get_git_version executed successfully
2026-01-30 17:21:31 +0000 INFO:Version: v50.201
2026-01-30 17:21:31 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:21:31 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:21:31 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:security already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:directories already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:21:31 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:21:31 +0000 INFO:Session_state variables initialized
2026-01-30 17:21:31 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:21:31 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:21:31 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:21:31 +0000 DEBUG:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors at 0x000002DC886FF6D0>}
2026-01-30 17:21:31 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:21:31 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:21:31 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:21:31 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:21:31 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:21:31 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:21:31 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:21:31 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:21:31 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:21:31 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:21:31 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:21:31 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:21:31 +0000 DEBUG:mod_visits_per_donor_None_mod_visits_per_donorDonated Visits per DonorNone_group_entity_select: Donor
2026-01-30 17:21:31 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:21:31 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:21:31 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:21:31 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:21:31 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:21:31 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:21:31 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:21:31 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:21:31 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:21:31 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:21:31 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:21:31 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:21:31 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:21:31 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:21:31 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:21:31 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:21:31 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:21:31 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:21:31 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:21:31 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:21:31 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:21:31 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:21:31 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:21:31 +0000 DEBUG:selected_entity_name: All
2026-01-30 17:21:31 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:21:31 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:21:31 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:21:31 +0000 DEBUG:date_range_mod_visits_per_donor_mod_visits_per_donorDonated Visits per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:21:31 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:21:31 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:21:31 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:21:31 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:21:31 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:21:31 +0000 INFO:Session state Setup complete
2026-01-30 17:21:31 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:21:31 +0000 INFO:Package setup complete
2026-01-30 17:21:31 +0000 INFO:setup_package executed successfully
2026-01-30 17:21:31 +0000 INFO:Setup completed successfully.
2026-01-30 17:21:31 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:21:31 +0000 INFO:Running first load function.
2026-01-30 17:21:31 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:21:31 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:21:31 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:21:31 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:21:31 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:21:31 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:21:31 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:21:31 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:21:31 +0000 INFO:firstload executed successfully
2026-01-30 17:21:31 +0000 INFO:Data first load completed successfully.
2026-01-30 17:21:31 +0000 INFO:initialise_data executed successfully
2026-01-30 17:21:31 +0000 INFO:Running Menu setup...
2026-01-30 17:21:31 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:21:31 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:21:31 +0000 INFO:get_git_version executed successfully
2026-01-30 17:21:31 +0000 INFO:App Version: v50.239
2026-01-30 17:21:31 +0000 INFO:Switched to page: Dubious Donors
2026-01-30 17:21:31 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:21:31 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:21:31 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:21:31 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:21:31 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:21:31 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:21:31 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:21:31 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:21:31 +0000 DEBUG:Page texts: {}
2026-01-30 17:21:31 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:21:31 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:21:31 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:21:31 +0000 INFO:display_data_page executed successfully
2026-01-30 17:21:31 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:21:32 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:21:32 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:21:32 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:21:32 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:21:32 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:21:32 +0000 DEBUG:Page texts: {}
2026-01-30 17:21:32 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:21:32 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:21:32 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:21:32 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:21:32 +0000 INFO:pagesetup executed successfully
2026-01-30 17:21:32 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:21:32 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:21:34 +0000 INFO:Streamlit App Starting...
2026-01-30 17:21:34 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:21:34 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:21:34 +0000 INFO:Running App setup...
2026-01-30 17:21:34 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:21:34 +0000 INFO:Setting up the package
2026-01-30 17:21:34 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:21:34 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:21:34 +0000 INFO:get_git_version executed successfully
2026-01-30 17:21:34 +0000 INFO:Version: v50.201
2026-01-30 17:21:34 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:21:34 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:21:34 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:security already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:directories already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:21:34 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:21:34 +0000 INFO:Session_state variables initialized
2026-01-30 17:21:34 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:21:35 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:21:35 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:21:35 +0000 DEBUG:menu_selection: {'title': 'Dubious Donations', 'function': <function mod_dubious_donations at 0x000002DC886FF490>}
2026-01-30 17:21:35 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:21:35 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:21:35 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:21:35 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:21:35 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:21:35 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:21:35 +0000 DEBUG:date_range_mod_dubious_donors_per_entity_mod_dubious_donors_per_entityDubious Donors per EntityNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:21:35 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:21:35 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:21:35 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:21:35 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:21:35 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:21:35 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:21:35 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:21:35 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:21:35 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:21:35 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:21:35 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:21:35 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:21:35 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:21:35 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:21:35 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:21:35 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:21:35 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:21:35 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:21:35 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:21:35 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:21:35 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:21:35 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:21:35 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:21:35 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:21:35 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:21:35 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:21:35 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:21:35 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:21:35 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:21:35 +0000 DEBUG:mod_dubious_donors_per_entity_None_mod_dubious_donors_per_entityDubious Donors per EntityNone_group_entity_select: Donor
2026-01-30 17:21:35 +0000 DEBUG:selected_entity_name: All
2026-01-30 17:21:35 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:21:35 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:21:35 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:21:35 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:21:35 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:21:35 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:21:35 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:21:35 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:21:35 +0000 INFO:Session state Setup complete
2026-01-30 17:21:35 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:21:35 +0000 INFO:Package setup complete
2026-01-30 17:21:35 +0000 INFO:setup_package executed successfully
2026-01-30 17:21:35 +0000 INFO:Setup completed successfully.
2026-01-30 17:21:35 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:21:35 +0000 INFO:Running first load function.
2026-01-30 17:21:35 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:21:35 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:21:35 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:21:35 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:21:35 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:21:35 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:21:35 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:21:35 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:21:35 +0000 INFO:firstload executed successfully
2026-01-30 17:21:35 +0000 INFO:Data first load completed successfully.
2026-01-30 17:21:35 +0000 INFO:initialise_data executed successfully
2026-01-30 17:21:35 +0000 INFO:Running Menu setup...
2026-01-30 17:21:35 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:21:35 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:21:35 +0000 INFO:get_git_version executed successfully
2026-01-30 17:21:35 +0000 INFO:App Version: v50.239
2026-01-30 17:21:35 +0000 INFO:Switched to page: Dubious Donations
2026-01-30 17:21:35 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:21:35 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:21:35 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:21:35 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:21:35 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:21:35 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:21:35 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:21:35 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:21:35 +0000 DEBUG:Page texts: {}
2026-01-30 17:21:35 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:21:35 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:21:35 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:21:35 +0000 INFO:display_data_page executed successfully
2026-01-30 17:21:35 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:21:35 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:21:35 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:21:35 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:21:35 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:21:35 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:21:35 +0000 DEBUG:Page texts: {}
2026-01-30 17:21:35 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:21:35 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:21:36 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:21:36 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:21:36 +0000 INFO:pagesetup executed successfully
2026-01-30 17:21:36 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:21:36 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:21:38 +0000 INFO:Streamlit App Starting...
2026-01-30 17:21:38 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:21:38 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:21:38 +0000 INFO:Running App setup...
2026-01-30 17:21:38 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:21:38 +0000 INFO:Setting up the package
2026-01-30 17:21:38 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:21:38 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:21:38 +0000 INFO:get_git_version executed successfully
2026-01-30 17:21:38 +0000 INFO:Version: v50.201
2026-01-30 17:21:38 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:21:38 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:21:38 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:security already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:directories already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:21:38 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:21:38 +0000 INFO:Session_state variables initialized
2026-01-30 17:21:38 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:21:38 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:21:38 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:21:38 +0000 DEBUG:menu_selection: {'title': 'Internal Political Party Donations', 'function': <function mod_donations_per_political_party at 0x000002DC886FF520>}
2026-01-30 17:21:38 +0000 DEBUG:date_range_mod_dubious_donations_per_donor_mod_dubious_donations_per_donorDubious Donations per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:21:38 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:21:38 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:21:38 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:21:38 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:21:38 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:21:38 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:21:38 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:21:38 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:21:38 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:21:38 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:21:38 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:21:38 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:21:38 +0000 DEBUG:mod_dubious_donations_per_donor_None_mod_dubious_donations_per_donorDubious Donations per DonorNone_group_entity_select: Donor
2026-01-30 17:21:38 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:21:38 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:21:38 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:21:38 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:21:38 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:21:38 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:21:38 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:21:38 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:21:38 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:21:38 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:21:38 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:21:38 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:21:38 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:21:38 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:21:38 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:21:38 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:21:38 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:21:38 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:21:38 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:21:38 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:21:38 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:21:38 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:21:38 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:21:38 +0000 DEBUG:selected_entity_name: All
2026-01-30 17:21:38 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:21:38 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:21:38 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:21:38 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:21:38 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:21:38 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:21:38 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:21:38 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:21:38 +0000 INFO:Session state Setup complete
2026-01-30 17:21:38 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:21:38 +0000 INFO:Package setup complete
2026-01-30 17:21:38 +0000 INFO:setup_package executed successfully
2026-01-30 17:21:38 +0000 INFO:Setup completed successfully.
2026-01-30 17:21:38 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:21:38 +0000 INFO:Running first load function.
2026-01-30 17:21:38 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:21:38 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:21:38 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:21:38 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:21:38 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:21:38 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:21:38 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:21:38 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:21:38 +0000 INFO:firstload executed successfully
2026-01-30 17:21:38 +0000 INFO:Data first load completed successfully.
2026-01-30 17:21:38 +0000 INFO:initialise_data executed successfully
2026-01-30 17:21:38 +0000 INFO:Running Menu setup...
2026-01-30 17:21:38 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:21:38 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:21:38 +0000 INFO:get_git_version executed successfully
2026-01-30 17:21:38 +0000 INFO:App Version: v50.239
2026-01-30 17:21:38 +0000 INFO:Switched to page: Internal Political Party Donations
2026-01-30 17:21:38 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:21:38 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:21:38 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:21:38 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:21:38 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:21:38 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:21:38 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:21:38 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:21:38 +0000 DEBUG:Page texts: {}
2026-01-30 17:21:38 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:21:38 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:21:38 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:21:38 +0000 INFO:display_data_page executed successfully
2026-01-30 17:21:38 +0000 INFO:pagesetup executed successfully
2026-01-30 17:21:38 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:21:38 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:22:00 +0000 INFO:Streamlit App Starting...
2026-01-30 17:22:00 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:22:00 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:22:00 +0000 INFO:Running App setup...
2026-01-30 17:22:00 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:22:00 +0000 INFO:Setting up the package
2026-01-30 17:22:00 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:22:00 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:22:00 +0000 INFO:get_git_version executed successfully
2026-01-30 17:22:00 +0000 INFO:Version: v50.201
2026-01-30 17:22:00 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:22:00 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:22:00 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:security already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:directories already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:22:00 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:22:00 +0000 INFO:Session_state variables initialized
2026-01-30 17:22:00 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:22:00 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:22:00 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:22:00 +0000 DEBUG:menu_selection: {'title': 'Regulated Donor per Entity', 'function': <function mod_regulated_donor_per_entity at 0x000002DC886FF5B0>}
2026-01-30 17:22:00 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:22:00 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:22:00 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:22:00 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:22:00 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:22:00 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:22:00 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:22:00 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:22:00 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:22:00 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:22:00 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:22:00 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:22:00 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:22:00 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:22:00 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:22:00 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:22:00 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:22:00 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:22:00 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:22:00 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:22:00 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:22:00 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:22:00 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:22:00 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:22:00 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:22:00 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:22:00 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:22:00 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:22:00 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:22:00 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:22:00 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:22:00 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:22:00 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:22:00 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:22:00 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:22:00 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:22:00 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:22:00 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:22:00 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:22:00 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:22:00 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:22:00 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:22:00 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:22:00 +0000 INFO:Session state Setup complete
2026-01-30 17:22:00 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:22:00 +0000 INFO:Package setup complete
2026-01-30 17:22:00 +0000 INFO:setup_package executed successfully
2026-01-30 17:22:00 +0000 INFO:Setup completed successfully.
2026-01-30 17:22:00 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:22:00 +0000 INFO:Running first load function.
2026-01-30 17:22:00 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:22:00 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:22:00 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:22:00 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:22:00 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:22:00 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:22:00 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:22:00 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:22:00 +0000 INFO:firstload executed successfully
2026-01-30 17:22:00 +0000 INFO:Data first load completed successfully.
2026-01-30 17:22:00 +0000 INFO:initialise_data executed successfully
2026-01-30 17:22:00 +0000 INFO:Running Menu setup...
2026-01-30 17:22:00 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:22:00 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:22:00 +0000 INFO:get_git_version executed successfully
2026-01-30 17:22:00 +0000 INFO:App Version: v50.239
2026-01-30 17:22:00 +0000 INFO:Switched to page: Regulated Donor per Entity
2026-01-30 17:22:00 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:22:00 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:22:00 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:22:00 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:22:00 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:22:00 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:22:00 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:22:00 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:22:00 +0000 DEBUG:Page texts: {}
2026-01-30 17:22:00 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:22:00 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:22:00 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:22:00 +0000 INFO:display_data_page executed successfully
2026-01-30 17:22:00 +0000 INFO:pagesetup executed successfully
2026-01-30 17:22:00 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:22:00 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:22:36 +0000 INFO:Streamlit App Starting...
2026-01-30 17:22:36 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:22:36 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:22:36 +0000 INFO:Running App setup...
2026-01-30 17:22:36 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:22:36 +0000 INFO:Setting up the package
2026-01-30 17:22:36 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:22:36 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:22:36 +0000 INFO:get_git_version executed successfully
2026-01-30 17:22:36 +0000 INFO:Version: v50.201
2026-01-30 17:22:36 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:22:36 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:22:36 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:security already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:directories already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:22:36 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:22:36 +0000 INFO:Session_state variables initialized
2026-01-30 17:22:36 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:22:36 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:22:36 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:22:36 +0000 DEBUG:menu_selection: {'title': 'Regulated Entity per Donor', 'function': <function mod_regulated_entity_per_donor at 0x000002DC886FF640>}
2026-01-30 17:22:36 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:22:36 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:22:36 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:22:36 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:22:36 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:22:36 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:22:36 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:22:36 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:22:36 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:22:36 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:22:36 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:22:36 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:22:36 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:22:36 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:22:36 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:22:36 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:22:36 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:22:36 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:22:36 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:22:36 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:22:36 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:22:36 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:22:36 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:22:36 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:22:36 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:22:36 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:22:36 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:22:36 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:22:36 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:22:36 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:22:36 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:22:36 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:22:36 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:22:36 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:22:36 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:22:36 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:22:36 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:22:36 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:22:36 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:22:36 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:22:36 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:22:36 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:22:36 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:22:36 +0000 INFO:Session state Setup complete
2026-01-30 17:22:36 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:22:36 +0000 INFO:Package setup complete
2026-01-30 17:22:36 +0000 INFO:setup_package executed successfully
2026-01-30 17:22:36 +0000 INFO:Setup completed successfully.
2026-01-30 17:22:36 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:22:36 +0000 INFO:Running first load function.
2026-01-30 17:22:36 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:22:36 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:22:36 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:22:36 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:22:36 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:22:36 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:22:36 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:22:36 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:22:36 +0000 INFO:firstload executed successfully
2026-01-30 17:22:36 +0000 INFO:Data first load completed successfully.
2026-01-30 17:22:36 +0000 INFO:initialise_data executed successfully
2026-01-30 17:22:36 +0000 INFO:Running Menu setup...
2026-01-30 17:22:36 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:22:36 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:22:36 +0000 INFO:get_git_version executed successfully
2026-01-30 17:22:36 +0000 INFO:App Version: v50.239
2026-01-30 17:22:36 +0000 INFO:Switched to page: Regulated Entity per Donor
2026-01-30 17:22:36 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:22:36 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:22:36 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:22:36 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:22:36 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:22:36 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:22:36 +0000 DEBUG:Page texts: {}
2026-01-30 17:22:36 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:22:36 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:22:37 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:22:37 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:22:37 +0000 INFO:pagesetup executed successfully
2026-01-30 17:22:37 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:22:37 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:22:41 +0000 INFO:Streamlit App Starting...
2026-01-30 17:22:41 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:22:41 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:22:41 +0000 INFO:Running App setup...
2026-01-30 17:22:41 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:22:41 +0000 INFO:Setting up the package
2026-01-30 17:22:41 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:22:41 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:22:41 +0000 INFO:get_git_version executed successfully
2026-01-30 17:22:41 +0000 INFO:Version: v50.201
2026-01-30 17:22:41 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:22:41 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:22:41 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:security already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:directories already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:22:41 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:22:41 +0000 INFO:Session_state variables initialized
2026-01-30 17:22:41 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:22:41 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:22:41 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:22:41 +0000 DEBUG:menu_selection: {'title': 'Donor Loyalty Analysis', 'function': <function mod_donor_loyalty at 0x000002DC886FEEF0>}
2026-01-30 17:22:41 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:22:41 +0000 DEBUG:mod_regulated_donor_per_entity_None_mod_regulated_donor_per_entityRegulated Entity by DonorNone_group_entity_select: Donor
2026-01-30 17:22:41 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:22:41 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:22:41 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:22:41 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:22:41 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:22:41 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:22:41 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:22:41 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:22:41 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:22:41 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:22:41 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:22:41 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:22:41 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:22:41 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:22:41 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:22:41 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:22:41 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:22:41 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:22:41 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:22:41 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:22:41 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:22:41 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:22:41 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:22:41 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:22:41 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:22:41 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:22:41 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:22:41 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:22:41 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:22:41 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:22:41 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:22:41 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:22:41 +0000 DEBUG:date_range_mod_regulated_donor_per_entity_mod_regulated_donor_per_entityRegulated Entity by DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:22:41 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:22:41 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:22:41 +0000 DEBUG:selected_entity_name: All
2026-01-30 17:22:41 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:22:41 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:22:41 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:22:41 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:22:41 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:22:41 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:22:41 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:22:41 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:22:41 +0000 INFO:Session state Setup complete
2026-01-30 17:22:41 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:22:41 +0000 INFO:Package setup complete
2026-01-30 17:22:41 +0000 INFO:setup_package executed successfully
2026-01-30 17:22:41 +0000 INFO:Setup completed successfully.
2026-01-30 17:22:41 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:22:41 +0000 INFO:Running first load function.
2026-01-30 17:22:41 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:22:41 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:22:41 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:22:41 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:22:41 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:22:41 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:22:41 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:22:41 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:22:41 +0000 INFO:firstload executed successfully
2026-01-30 17:22:41 +0000 INFO:Data first load completed successfully.
2026-01-30 17:22:41 +0000 INFO:initialise_data executed successfully
2026-01-30 17:22:41 +0000 INFO:Running Menu setup...
2026-01-30 17:22:41 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:22:41 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:22:41 +0000 INFO:get_git_version executed successfully
2026-01-30 17:22:41 +0000 INFO:App Version: v50.239
2026-01-30 17:22:41 +0000 INFO:Switched to page: Donor Loyalty Analysis
2026-01-30 17:22:41 +0000 DEBUG:Calling mod_donor_loyalty with args={args}, kwargs={kwargs}
2026-01-30 17:22:41 +0000 DEBUG:Calling display_donor_distribution with args={args}, kwargs={kwargs}
2026-01-30 17:22:41 +0000 DEBUG:Aggregated DataFrame:    Parties_Per_Donor  Count
0                  1  18611
1                 10      4
2                 11      1
3                 12      2
4                 13      2
5                 14      2
6                 17      2
7                 18      1
8                  2   1299
9                  3    185
10                 4     70
11                 5     24
12                 6     17
13                 7     10
14                 8      3
15                83      1
16                 9      3
2026-01-30 17:22:41 +0000 DEBUG:Sorted DataFrame:    Parties_Per_Donor  Count
0                  1  18611
8                  2   1299
9                  3    185
10                 4     70
11                 5     24
12                 6     17
13                 7     10
1                 10      4
14                 8      3
16                 9      3
3                 12      2
4                 13      2
5                 14      2
6                 17      2
2                 11      1
7                 18      1
15                83      1
2026-01-30 17:22:41 +0000 DEBUG:Unique XValues: ['1' '2' '3' '4' '5' '6' '7' '10' '8' '9' '12' '13' '14' '17' '11' '18'
 '83']
2026-01-30 17:22:41 +0000 DEBUG:Final color_discrete_map: {'1': '#636efa', '2': '#636efa', '3': '#636efa', '4': '#636efa', '5': '#636efa', '6': '#636efa', '7': '#636efa', '10': '#636efa', '8': '#636efa', '9': '#636efa', '12': '#636efa', '13': '#636efa', '14': '#636efa', '17': '#636efa', '11': '#636efa', '18': '#636efa', '83': '#636efa'}
2026-01-30 17:22:41 +0000 DEBUG:Missing color mappings for: ['1', '2', '3', '4', '5', '6', '7', '10', '8', '9', '12', '13', '14', '17', '11', '18', '83']
2026-01-30 17:22:41 +0000 DEBUG:Generated Figure: Figure({
    'data': [{'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '1',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '1',
              'offsetgroup': '1',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['1'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 's0g=', 'dtype': 'i2'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '2',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '2',
              'offsetgroup': '2',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['2'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'EwU=', 'dtype': 'i2'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '3',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '3',
              'offsetgroup': '3',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['3'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'uQA=', 'dtype': 'i2'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '4',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '4',
              'offsetgroup': '4',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['4'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Rg==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '5',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '5',
              'offsetgroup': '5',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['5'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'GA==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '6',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '6',
              'offsetgroup': '6',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['6'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'EQ==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '7',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '7',
              'offsetgroup': '7',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['7'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Cg==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '10',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '10',
              'offsetgroup': '10',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['10'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'BA==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '8',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '8',
              'offsetgroup': '8',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['8'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Aw==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '9',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '9',
              'offsetgroup': '9',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['9'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Aw==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '12',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '12',
              'offsetgroup': '12',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['12'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Ag==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '13',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '13',
              'offsetgroup': '13',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['13'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Ag==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '14',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '14',
              'offsetgroup': '14',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['14'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Ag==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '17',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '17',
              'offsetgroup': '17',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['17'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Ag==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '11',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '11',
              'offsetgroup': '11',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['11'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AQ==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '18',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '18',
              'offsetgroup': '18',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['18'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AQ==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '83',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '83',
              'offsetgroup': '83',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['83'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AQ==', 'dtype': 'i1'},
              'yaxis': 'y'}],
    'layout': {'barmode': 'group',
               'legend': {'title': {'text': 'Number of Parties'}, 'tracegroupgap': 0},
               'template': '...',
               'title': {'text': 'Distribution of Parties per Donor'},
               'xaxis': {'anchor': 'y',
                         'categoryarray': [1, 2, 3, 4, 5, 6, 7, 10, 8, 9, 12, 13,
                                           14, 17, 11, 18, 83],
                         'categoryorder': 'array',
                         'domain': [0.0, 1.0],
                         'title': {'text': 'Number of Parties'}},
               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': 'Number of Donors'}}}
})
2026-01-30 17:22:41 +0000 INFO:Bar chart displayed successfully.
2026-01-30 17:22:41 +0000 INFO:display_donor_distribution executed successfully
2026-01-30 17:22:41 +0000 DEBUG:Calling display_government_period_analysis with args={args}, kwargs={kwargs}
2026-01-30 17:22:41 +0000 DEBUG:matplotlib data path: H:\python310\lib\site-packages\matplotlib\mpl-data
2026-01-30 17:22:41 +0000 DEBUG:CONFIGDIR=C:\Users\pgold\.matplotlib
2026-01-30 17:22:41 +0000 DEBUG:interactive is False
2026-01-30 17:22:41 +0000 DEBUG:platform is win32
2026-01-30 17:22:42 +0000 DEBUG:CACHEDIR=C:\Users\pgold\.matplotlib
2026-01-30 17:22:42 +0000 DEBUG:Using fontManager instance from C:\Users\pgold\.matplotlib\fontlist-v330.json
2026-01-30 17:22:42 +0000 INFO:display_government_period_analysis executed successfully
2026-01-30 17:22:42 +0000 DEBUG:Calling display_loyalty_metrics with args={args}, kwargs={kwargs}
2026-01-30 17:23:09 +0000 INFO:display_loyalty_metrics executed successfully
2026-01-30 17:23:10 +0000 INFO:mod_donor_loyalty executed successfully
2026-01-30 17:23:10 +0000 INFO:pagesetup executed successfully
2026-01-30 17:23:10 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:23:10 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:24:21 +0000 INFO:Streamlit App Starting...
2026-01-30 17:24:21 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:24:21 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:24:21 +0000 INFO:Running App setup...
2026-01-30 17:24:21 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:24:21 +0000 INFO:Setting up the package
2026-01-30 17:24:21 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:24:21 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:24:21 +0000 INFO:get_git_version executed successfully
2026-01-30 17:24:21 +0000 INFO:Version: v50.201
2026-01-30 17:24:21 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:24:21 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:24:21 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:security already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:directories already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:24:21 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:24:21 +0000 INFO:Session_state variables initialized
2026-01-30 17:24:21 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:24:21 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:24:21 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:24:21 +0000 DEBUG:menu_selection: {'title': 'Donor Type Analysis', 'function': <function mod_donor_type at 0x000002DC8864C040>}
2026-01-30 17:24:21 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:24:21 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:24:21 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:24:21 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:24:21 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:24:21 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:24:21 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:24:21 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:24:21 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:24:21 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:24:21 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:24:21 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:24:21 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:24:21 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:24:21 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:24:21 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:24:21 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:24:21 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:24:21 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:24:21 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:24:21 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:24:21 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:24:21 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:24:21 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:24:21 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:24:21 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:24:21 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:24:21 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:24:21 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:24:21 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:24:21 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:24:21 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:24:21 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:24:21 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:24:21 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:24:21 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:24:21 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:24:21 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:24:21 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:24:21 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:24:21 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:24:21 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:24:21 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:24:21 +0000 INFO:Session state Setup complete
2026-01-30 17:24:21 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:24:21 +0000 INFO:Package setup complete
2026-01-30 17:24:21 +0000 INFO:setup_package executed successfully
2026-01-30 17:24:21 +0000 INFO:Setup completed successfully.
2026-01-30 17:24:21 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:24:21 +0000 INFO:Running first load function.
2026-01-30 17:24:21 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:24:21 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:24:21 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:24:21 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:24:21 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:24:21 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:24:21 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:24:21 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:24:21 +0000 INFO:firstload executed successfully
2026-01-30 17:24:21 +0000 INFO:Data first load completed successfully.
2026-01-30 17:24:21 +0000 INFO:initialise_data executed successfully
2026-01-30 17:24:21 +0000 INFO:Running Menu setup...
2026-01-30 17:24:21 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:24:21 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:24:21 +0000 INFO:get_git_version executed successfully
2026-01-30 17:24:21 +0000 INFO:App Version: v50.239
2026-01-30 17:24:21 +0000 INFO:Switched to page: Donor Type Analysis
2026-01-30 17:24:21 +0000 DEBUG:Calling mod_donor_type with args={args}, kwargs={kwargs}
2026-01-30 17:24:21 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:24:21 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:24:22 +0000 INFO:mod_donor_type executed successfully
2026-01-30 17:24:22 +0000 INFO:pagesetup executed successfully
2026-01-30 17:24:22 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:24:22 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:24:30 +0000 INFO:Streamlit App Starting...
2026-01-30 17:24:30 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:24:30 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:24:30 +0000 INFO:Running App setup...
2026-01-30 17:24:30 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:24:30 +0000 INFO:Setting up the package
2026-01-30 17:24:30 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:24:30 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:24:30 +0000 INFO:get_git_version executed successfully
2026-01-30 17:24:30 +0000 INFO:Version: v50.201
2026-01-30 17:24:30 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:24:30 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:24:30 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:security already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:directories already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:24:30 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:24:30 +0000 INFO:Session_state variables initialized
2026-01-30 17:24:30 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:24:30 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:24:30 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:24:30 +0000 DEBUG:menu_selection: {'title': 'Donor Type Analysis', 'function': <function mod_donor_type at 0x000002DC8864C040>}
2026-01-30 17:24:30 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:24:30 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:24:30 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:24:30 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:24:30 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:24:30 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:24:30 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:24:30 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:24:30 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:24:30 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:24:30 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:24:30 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:24:30 +0000 DEBUG:metric_type_donor_type: Value of Donations
2026-01-30 17:24:30 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:24:30 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:24:30 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:24:30 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:24:30 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:24:30 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:24:30 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:24:30 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:24:30 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:24:30 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:24:30 +0000 DEBUG:sitting_select_donor_type: ['2001', '2005', '2010', '2015', '2017', '2019', '2024']
2026-01-30 17:24:30 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:24:30 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:24:30 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:24:30 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:24:30 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:24:30 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:24:30 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:24:30 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:24:30 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:24:30 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:24:30 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:24:30 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:24:30 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:24:30 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:24:30 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:24:30 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:24:30 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:24:30 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:24:30 +0000 DEBUG:view_type_donor_type: Actual
2026-01-30 17:24:30 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:24:30 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:24:30 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:24:30 +0000 INFO:Session state Setup complete
2026-01-30 17:24:30 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:24:30 +0000 INFO:Package setup complete
2026-01-30 17:24:30 +0000 INFO:setup_package executed successfully
2026-01-30 17:24:30 +0000 INFO:Setup completed successfully.
2026-01-30 17:24:30 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:24:30 +0000 INFO:Running first load function.
2026-01-30 17:24:30 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:24:30 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:24:30 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:24:30 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:24:30 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:24:30 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:24:30 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:24:30 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:24:30 +0000 INFO:firstload executed successfully
2026-01-30 17:24:30 +0000 INFO:Data first load completed successfully.
2026-01-30 17:24:30 +0000 INFO:initialise_data executed successfully
2026-01-30 17:24:30 +0000 INFO:Running Menu setup...
2026-01-30 17:24:30 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:24:30 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:24:30 +0000 INFO:get_git_version executed successfully
2026-01-30 17:24:30 +0000 INFO:App Version: v50.239
2026-01-30 17:24:30 +0000 INFO:Switched to page: Donor Type Analysis
2026-01-30 17:24:30 +0000 DEBUG:Calling mod_donor_type with args={args}, kwargs={kwargs}
2026-01-30 17:24:30 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:24:30 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:24:30 +0000 INFO:mod_donor_type executed successfully
2026-01-30 17:24:30 +0000 INFO:pagesetup executed successfully
2026-01-30 17:24:30 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:24:30 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:24:31 +0000 INFO:Streamlit App Starting...
2026-01-30 17:24:31 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:24:31 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:24:31 +0000 INFO:Running App setup...
2026-01-30 17:24:31 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:24:31 +0000 INFO:Setting up the package
2026-01-30 17:24:31 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:24:31 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:24:31 +0000 INFO:get_git_version executed successfully
2026-01-30 17:24:31 +0000 INFO:Version: v50.201
2026-01-30 17:24:31 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:24:31 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:24:31 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:security already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:directories already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:24:31 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:24:31 +0000 INFO:Session_state variables initialized
2026-01-30 17:24:31 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:24:31 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:24:31 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:24:31 +0000 DEBUG:menu_selection: {'title': 'Donor Type Analysis', 'function': <function mod_donor_type at 0x000002DC8864C040>}
2026-01-30 17:24:31 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:24:31 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:24:31 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:24:31 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:24:31 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:24:31 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:24:31 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:24:31 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:24:31 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:24:31 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:24:31 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:24:31 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:24:31 +0000 DEBUG:metric_type_donor_type: Value of Donations
2026-01-30 17:24:31 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:24:31 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:24:31 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:24:31 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:24:31 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:24:31 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:24:31 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:24:31 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:24:31 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:24:31 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:24:31 +0000 DEBUG:sitting_select_donor_type: ['2005', '2010', '2015', '2017', '2019', '2024']
2026-01-30 17:24:31 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:24:31 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:24:31 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:24:31 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:24:31 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:24:31 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:24:31 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:24:31 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:24:31 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:24:31 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:24:31 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:24:31 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:24:31 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:24:31 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:24:31 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:24:31 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:24:31 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:24:31 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:24:31 +0000 DEBUG:view_type_donor_type: Actual
2026-01-30 17:24:31 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:24:31 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:24:31 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:24:31 +0000 INFO:Session state Setup complete
2026-01-30 17:24:31 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:24:31 +0000 INFO:Package setup complete
2026-01-30 17:24:31 +0000 INFO:setup_package executed successfully
2026-01-30 17:24:31 +0000 INFO:Setup completed successfully.
2026-01-30 17:24:31 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:24:31 +0000 INFO:Running first load function.
2026-01-30 17:24:31 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:24:31 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:24:31 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:24:31 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:24:31 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:24:31 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:24:31 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:24:31 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:24:31 +0000 INFO:firstload executed successfully
2026-01-30 17:24:31 +0000 INFO:Data first load completed successfully.
2026-01-30 17:24:31 +0000 INFO:initialise_data executed successfully
2026-01-30 17:24:31 +0000 INFO:Running Menu setup...
2026-01-30 17:24:31 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:24:31 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:24:31 +0000 INFO:get_git_version executed successfully
2026-01-30 17:24:31 +0000 INFO:App Version: v50.239
2026-01-30 17:24:31 +0000 INFO:Switched to page: Donor Type Analysis
2026-01-30 17:24:31 +0000 DEBUG:Calling mod_donor_type with args={args}, kwargs={kwargs}
2026-01-30 17:24:31 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:24:31 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:24:31 +0000 INFO:mod_donor_type executed successfully
2026-01-30 17:24:31 +0000 INFO:pagesetup executed successfully
2026-01-30 17:24:31 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:24:31 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:24:33 +0000 INFO:Streamlit App Starting...
2026-01-30 17:24:33 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:24:33 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:24:33 +0000 INFO:Running App setup...
2026-01-30 17:24:33 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:24:33 +0000 INFO:Setting up the package
2026-01-30 17:24:33 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:24:33 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:24:33 +0000 INFO:get_git_version executed successfully
2026-01-30 17:24:33 +0000 INFO:Version: v50.201
2026-01-30 17:24:33 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:24:33 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:24:33 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:security already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:directories already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:24:33 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:24:33 +0000 INFO:Session_state variables initialized
2026-01-30 17:24:33 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:24:33 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:24:33 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:24:33 +0000 DEBUG:menu_selection: {'title': 'Donor Type Analysis', 'function': <function mod_donor_type at 0x000002DC8864C040>}
2026-01-30 17:24:33 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:24:33 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:24:33 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:24:33 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:24:33 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:24:33 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:24:33 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:24:33 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:24:33 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:24:33 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:24:34 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:24:34 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:24:34 +0000 DEBUG:metric_type_donor_type: Value of Donations
2026-01-30 17:24:34 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:24:34 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:24:34 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:24:34 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:24:34 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:24:34 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:24:34 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:24:34 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:24:34 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:24:34 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:24:34 +0000 DEBUG:sitting_select_donor_type: ['2010', '2015', '2017', '2019', '2024']
2026-01-30 17:24:34 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:24:34 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:24:34 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:24:34 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:24:34 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:24:34 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:24:34 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:24:34 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:24:34 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:24:34 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:24:34 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:24:34 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:24:34 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:24:34 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:24:34 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:24:34 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:24:34 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:24:34 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:24:34 +0000 DEBUG:view_type_donor_type: Actual
2026-01-30 17:24:34 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:24:34 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:24:34 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:24:34 +0000 INFO:Session state Setup complete
2026-01-30 17:24:34 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:24:34 +0000 INFO:Package setup complete
2026-01-30 17:24:34 +0000 INFO:setup_package executed successfully
2026-01-30 17:24:34 +0000 INFO:Setup completed successfully.
2026-01-30 17:24:34 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:24:34 +0000 INFO:Running first load function.
2026-01-30 17:24:34 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:24:34 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:24:34 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:24:34 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:24:34 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:24:34 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:24:34 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:24:34 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:24:34 +0000 INFO:firstload executed successfully
2026-01-30 17:24:34 +0000 INFO:Data first load completed successfully.
2026-01-30 17:24:34 +0000 INFO:initialise_data executed successfully
2026-01-30 17:24:34 +0000 INFO:Running Menu setup...
2026-01-30 17:24:34 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:24:34 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:24:34 +0000 INFO:get_git_version executed successfully
2026-01-30 17:24:34 +0000 INFO:App Version: v50.239
2026-01-30 17:24:34 +0000 INFO:Switched to page: Donor Type Analysis
2026-01-30 17:24:34 +0000 DEBUG:Calling mod_donor_type with args={args}, kwargs={kwargs}
2026-01-30 17:24:34 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:24:34 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:24:34 +0000 INFO:mod_donor_type executed successfully
2026-01-30 17:24:34 +0000 INFO:pagesetup executed successfully
2026-01-30 17:24:34 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:24:34 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:24:34 +0000 INFO:Streamlit App Starting...
2026-01-30 17:24:34 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:24:34 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:24:34 +0000 INFO:Running App setup...
2026-01-30 17:24:34 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:24:34 +0000 INFO:Setting up the package
2026-01-30 17:24:34 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:24:34 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:24:34 +0000 INFO:get_git_version executed successfully
2026-01-30 17:24:34 +0000 INFO:Version: v50.201
2026-01-30 17:24:34 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:24:34 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:24:34 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:24:34 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:24:34 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:24:34 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:24:34 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:24:34 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:24:34 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:24:34 +0000 DEBUG:security already exists in session state
2026-01-30 17:24:34 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:directories already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:24:35 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:24:35 +0000 INFO:Session_state variables initialized
2026-01-30 17:24:35 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:24:35 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:24:35 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:24:35 +0000 DEBUG:menu_selection: {'title': 'Donor Type Analysis', 'function': <function mod_donor_type at 0x000002DC8864C040>}
2026-01-30 17:24:35 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:24:35 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:24:35 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:24:35 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:24:35 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:24:35 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:24:35 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:24:35 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:24:35 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:24:35 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:24:35 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:24:35 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:24:35 +0000 DEBUG:metric_type_donor_type: Value of Donations
2026-01-30 17:24:35 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:24:35 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:24:35 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:24:35 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:24:35 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:24:35 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:24:35 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:24:35 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:24:35 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:24:35 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:24:35 +0000 DEBUG:sitting_select_donor_type: ['2015', '2017', '2019', '2024']
2026-01-30 17:24:35 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:24:35 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:24:35 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:24:35 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:24:35 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:24:35 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:24:35 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:24:35 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:24:35 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:24:35 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:24:35 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:24:35 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:24:35 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:24:35 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:24:35 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:24:35 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:24:35 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:24:35 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:24:35 +0000 DEBUG:view_type_donor_type: Actual
2026-01-30 17:24:35 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:24:35 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:24:35 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:24:35 +0000 INFO:Session state Setup complete
2026-01-30 17:24:35 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:24:35 +0000 INFO:Package setup complete
2026-01-30 17:24:35 +0000 INFO:setup_package executed successfully
2026-01-30 17:24:35 +0000 INFO:Setup completed successfully.
2026-01-30 17:24:35 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:24:35 +0000 INFO:Running first load function.
2026-01-30 17:24:35 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:24:35 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:24:35 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:24:35 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:24:35 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:24:35 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:24:35 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:24:35 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:24:35 +0000 INFO:firstload executed successfully
2026-01-30 17:24:35 +0000 INFO:Data first load completed successfully.
2026-01-30 17:24:35 +0000 INFO:initialise_data executed successfully
2026-01-30 17:24:35 +0000 INFO:Running Menu setup...
2026-01-30 17:24:35 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:24:35 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:24:35 +0000 INFO:get_git_version executed successfully
2026-01-30 17:24:35 +0000 INFO:App Version: v50.239
2026-01-30 17:24:35 +0000 INFO:Switched to page: Donor Type Analysis
2026-01-30 17:24:35 +0000 DEBUG:Calling mod_donor_type with args={args}, kwargs={kwargs}
2026-01-30 17:24:35 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:24:35 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:24:35 +0000 INFO:mod_donor_type executed successfully
2026-01-30 17:24:35 +0000 INFO:pagesetup executed successfully
2026-01-30 17:24:35 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:24:35 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:24:36 +0000 INFO:Streamlit App Starting...
2026-01-30 17:24:36 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:24:36 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:24:36 +0000 INFO:Running App setup...
2026-01-30 17:24:36 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:24:36 +0000 INFO:Setting up the package
2026-01-30 17:24:36 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:24:36 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:24:36 +0000 INFO:get_git_version executed successfully
2026-01-30 17:24:36 +0000 INFO:Version: v50.201
2026-01-30 17:24:36 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:24:36 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:24:36 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:security already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:directories already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:24:36 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:24:36 +0000 INFO:Session_state variables initialized
2026-01-30 17:24:36 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:24:36 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:24:36 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:24:36 +0000 DEBUG:menu_selection: {'title': 'Donor Type Analysis', 'function': <function mod_donor_type at 0x000002DC8864C040>}
2026-01-30 17:24:36 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:24:36 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:24:36 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:24:36 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:24:36 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:24:36 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:24:36 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:24:36 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:24:36 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:24:36 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:24:36 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:24:36 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:24:36 +0000 DEBUG:metric_type_donor_type: Value of Donations
2026-01-30 17:24:36 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:24:36 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:24:36 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:24:36 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:24:36 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:24:36 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:24:36 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:24:36 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:24:36 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:24:36 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:24:36 +0000 DEBUG:sitting_select_donor_type: ['2017', '2019', '2024']
2026-01-30 17:24:36 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:24:36 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:24:36 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:24:36 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:24:36 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:24:36 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:24:36 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:24:36 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:24:36 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:24:36 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:24:36 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:24:36 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:24:36 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:24:36 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:24:36 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:24:36 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:24:36 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:24:36 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:24:36 +0000 DEBUG:view_type_donor_type: Actual
2026-01-30 17:24:36 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:24:36 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:24:36 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:24:36 +0000 INFO:Session state Setup complete
2026-01-30 17:24:36 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:24:36 +0000 INFO:Package setup complete
2026-01-30 17:24:36 +0000 INFO:setup_package executed successfully
2026-01-30 17:24:36 +0000 INFO:Setup completed successfully.
2026-01-30 17:24:36 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:24:36 +0000 INFO:Running first load function.
2026-01-30 17:24:36 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:24:36 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:24:36 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:24:36 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:24:36 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:24:36 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:24:36 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:24:36 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:24:36 +0000 INFO:firstload executed successfully
2026-01-30 17:24:36 +0000 INFO:Data first load completed successfully.
2026-01-30 17:24:36 +0000 INFO:initialise_data executed successfully
2026-01-30 17:24:36 +0000 INFO:Running Menu setup...
2026-01-30 17:24:36 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:24:36 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:24:36 +0000 INFO:get_git_version executed successfully
2026-01-30 17:24:36 +0000 INFO:App Version: v50.239
2026-01-30 17:24:36 +0000 INFO:Switched to page: Donor Type Analysis
2026-01-30 17:24:36 +0000 DEBUG:Calling mod_donor_type with args={args}, kwargs={kwargs}
2026-01-30 17:24:36 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:24:36 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:24:36 +0000 INFO:mod_donor_type executed successfully
2026-01-30 17:24:36 +0000 INFO:pagesetup executed successfully
2026-01-30 17:24:36 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:24:36 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:24:38 +0000 INFO:Streamlit App Starting...
2026-01-30 17:24:38 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:24:38 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:24:38 +0000 INFO:Running App setup...
2026-01-30 17:24:38 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:24:38 +0000 INFO:Setting up the package
2026-01-30 17:24:38 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:24:38 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:24:38 +0000 INFO:get_git_version executed successfully
2026-01-30 17:24:38 +0000 INFO:Version: v50.201
2026-01-30 17:24:38 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:24:38 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:24:38 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:security already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:directories already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:24:38 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:24:38 +0000 INFO:Session_state variables initialized
2026-01-30 17:24:38 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:24:38 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:24:38 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:24:38 +0000 DEBUG:menu_selection: {'title': 'Donor Type Analysis', 'function': <function mod_donor_type at 0x000002DC8864C040>}
2026-01-30 17:24:38 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:24:38 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:24:38 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:24:38 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:24:38 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:24:38 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:24:38 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:24:38 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:24:38 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:24:38 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:24:38 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:24:38 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:24:38 +0000 DEBUG:metric_type_donor_type: Value of Donations
2026-01-30 17:24:38 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:24:38 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:24:38 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:24:38 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:24:38 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:24:38 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:24:38 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:24:38 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:24:38 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:24:38 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:24:38 +0000 DEBUG:sitting_select_donor_type: ['2019', '2024']
2026-01-30 17:24:38 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:24:38 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:24:38 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:24:38 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:24:38 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:24:38 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:24:38 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:24:38 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:24:38 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:24:38 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:24:38 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:24:38 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:24:38 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:24:38 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:24:38 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:24:38 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:24:38 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:24:38 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:24:38 +0000 DEBUG:view_type_donor_type: Actual
2026-01-30 17:24:38 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:24:38 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:24:38 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:24:38 +0000 INFO:Session state Setup complete
2026-01-30 17:24:38 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:24:38 +0000 INFO:Package setup complete
2026-01-30 17:24:38 +0000 INFO:setup_package executed successfully
2026-01-30 17:24:38 +0000 INFO:Setup completed successfully.
2026-01-30 17:24:38 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:24:38 +0000 INFO:Running first load function.
2026-01-30 17:24:38 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:24:38 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:24:38 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:24:38 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:24:38 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:24:38 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:24:38 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:24:38 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:24:38 +0000 INFO:firstload executed successfully
2026-01-30 17:24:38 +0000 INFO:Data first load completed successfully.
2026-01-30 17:24:38 +0000 INFO:initialise_data executed successfully
2026-01-30 17:24:38 +0000 INFO:Running Menu setup...
2026-01-30 17:24:38 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:24:38 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:24:38 +0000 INFO:get_git_version executed successfully
2026-01-30 17:24:38 +0000 INFO:App Version: v50.239
2026-01-30 17:24:38 +0000 INFO:Switched to page: Donor Type Analysis
2026-01-30 17:24:38 +0000 DEBUG:Calling mod_donor_type with args={args}, kwargs={kwargs}
2026-01-30 17:24:38 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:24:38 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:24:39 +0000 INFO:mod_donor_type executed successfully
2026-01-30 17:24:39 +0000 INFO:pagesetup executed successfully
2026-01-30 17:24:39 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:24:39 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:25:09 +0000 INFO:Streamlit App Starting...
2026-01-30 17:25:09 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:25:09 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:25:09 +0000 INFO:Running App setup...
2026-01-30 17:25:09 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:25:09 +0000 INFO:Setting up the package
2026-01-30 17:25:09 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:25:09 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:25:09 +0000 INFO:get_git_version executed successfully
2026-01-30 17:25:09 +0000 INFO:Version: v50.201
2026-01-30 17:25:09 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:25:09 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:25:09 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:security already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:directories already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:25:09 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:25:09 +0000 INFO:Session_state variables initialized
2026-01-30 17:25:09 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:25:09 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:25:09 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:25:09 +0000 DEBUG:menu_selection: {'title': 'Introduction', 'function': <function introduction_body at 0x000002DC827CC310>}
2026-01-30 17:25:09 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:25:09 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:25:09 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:25:09 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:25:09 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:25:09 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:25:09 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:25:09 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:25:09 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:25:09 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:25:09 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:25:09 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:25:09 +0000 DEBUG:metric_type_donor_type: Value of Donations
2026-01-30 17:25:09 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:25:09 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:25:09 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:25:09 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:25:09 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:25:09 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:25:09 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:25:09 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:25:09 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:25:09 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:25:09 +0000 DEBUG:sitting_select_donor_type: ['2019', '2024']
2026-01-30 17:25:09 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:25:09 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:25:09 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:25:09 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:25:09 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:25:09 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:25:09 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:25:09 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:25:09 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:25:09 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:25:09 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:25:09 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:25:09 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:25:09 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:25:09 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:25:09 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:25:09 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:25:09 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:25:09 +0000 DEBUG:view_type_donor_type: Actual
2026-01-30 17:25:09 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:25:09 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:25:09 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:25:09 +0000 INFO:Session state Setup complete
2026-01-30 17:25:09 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:25:09 +0000 INFO:Package setup complete
2026-01-30 17:25:09 +0000 INFO:setup_package executed successfully
2026-01-30 17:25:09 +0000 INFO:Setup completed successfully.
2026-01-30 17:25:09 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:25:09 +0000 INFO:Running first load function.
2026-01-30 17:25:09 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:25:09 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:25:09 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:25:09 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:25:09 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:25:09 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:25:09 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:25:09 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:25:09 +0000 INFO:firstload executed successfully
2026-01-30 17:25:09 +0000 INFO:Data first load completed successfully.
2026-01-30 17:25:09 +0000 INFO:initialise_data executed successfully
2026-01-30 17:25:09 +0000 INFO:Running Menu setup...
2026-01-30 17:25:09 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:25:09 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:25:09 +0000 INFO:get_git_version executed successfully
2026-01-30 17:25:09 +0000 INFO:App Version: v50.239
2026-01-30 17:25:09 +0000 INFO:Switched to page: Introduction
2026-01-30 17:25:09 +0000 INFO:pagesetup executed successfully
2026-01-30 17:25:09 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:25:09 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:38:54 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2026-01-30 17:38:54 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:38:57 +0000 INFO:get_git_version executed successfully
2026-01-30 17:38:58 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:39:01 +0000 INFO:get_git_version executed successfully
2026-01-30 17:39:01 +0000 INFO:Streamlit App Starting...
2026-01-30 17:39:01 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:39:01 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:39:01 +0000 INFO:Running App setup...
2026-01-30 17:39:01 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:39:01 +0000 INFO:Setting up the package
2026-01-30 17:39:01 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:39:01 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:39:04 +0000 INFO:get_git_version executed successfully
2026-01-30 17:39:04 +0000 INFO:Version: v50.201
2026-01-30 17:39:04 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:39:04 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:39:04 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2026-01-30 17:39:04 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:39:04 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2026-01-30 17:39:04 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2026-01-30 17:39:04 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:39:04 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:39:04 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:39:04 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:39:04 +0000 DEBUG:Initialised perc_target with value: 0.5
2026-01-30 17:39:04 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2026-01-30 17:39:04 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:39:04 +0000 DEBUG:Initialised electoral_cycle_rules with value: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:39:04 +0000 DEBUG:Initialised reference_dir with value: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:39:04 +0000 DEBUG:Initialised data_dir with value: H:\GitHub\dashboard_demo\data
2026-01-30 17:39:04 +0000 DEBUG:Initialised output_dir with value: H:\GitHub\dashboard_demo\output
2026-01-30 17:39:04 +0000 DEBUG:Initialised logs_dir with value: H:\GitHub\dashboard_demo\logs
2026-01-30 17:39:04 +0000 DEBUG:Initialised components_dir with value: H:\GitHub\dashboard_demo\components
2026-01-30 17:39:04 +0000 DEBUG:Initialised app_pages_dir with value: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:39:04 +0000 DEBUG:Initialised utils_dir with value: H:\GitHub\dashboard_demo\utils
2026-01-30 17:39:04 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:39:04 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:39:04 +0000 DEBUG:Initialised mppartymemb_fname with value: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:39:04 +0000 DEBUG:Initialised donor_map_fname with value: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:39:04 +0000 DEBUG:Initialised politician_party_fname with value: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:39:04 +0000 DEBUG:Initialised regentity_map_fname with value: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:39:04 +0000 DEBUG:Initialised original_data_fname with value: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:39:04 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:39:04 +0000 DEBUG:Initialised TEXT_FILE with value: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:39:04 +0000 DEBUG:Initialised ELECTION_DATES with value: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:39:04 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:39:04 +0000 DEBUG:Initialised cleaned_data_fname with value: cleaned_data.zip
2026-01-30 17:39:04 +0000 DEBUG:Initialised cleaned_donations_fname with value: cleaned_donations.zip
2026-01-30 17:39:04 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: cleaned_donorlist.zip
2026-01-30 17:39:04 +0000 DEBUG:Initialised cleaned_regentity_fname with value: cleaned_regentity.zip
2026-01-30 17:39:04 +0000 DEBUG:Initialised party_summary_fname with value: party_summary.zip
2026-01-30 17:39:04 +0000 DEBUG:Initialised imported_raw_fname with value: imported_raw.zip
2026-01-30 17:39:04 +0000 DEBUG:Initialised source_data_fname with value: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:39:04 +0000 DEBUG:Initialised Cash_ftr with value: None
2026-01-30 17:39:04 +0000 INFO:Session_state variables initialized
2026-01-30 17:39:04 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:39:04 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:39:04 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:39:04 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:39:04 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:39:04 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:39:04 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:39:04 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:39:04 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:39:04 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:39:04 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:39:04 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:39:04 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:39:04 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:39:04 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:39:04 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:39:04 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:39:04 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:39:04 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:39:04 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:39:04 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:39:04 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:39:04 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:39:04 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:39:04 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:39:04 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:39:04 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:39:04 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:39:04 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:39:04 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:39:04 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:39:04 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:39:04 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:39:04 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:39:04 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:39:04 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:39:04 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:39:04 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:39:04 +0000 INFO:Session state Setup complete
2026-01-30 17:39:04 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:39:04 +0000 INFO:Package setup complete
2026-01-30 17:39:04 +0000 INFO:setup_package executed successfully
2026-01-30 17:39:04 +0000 INFO:Setup completed successfully.
2026-01-30 17:39:04 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:39:04 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:39:07 +0000 INFO:get_git_version executed successfully
2026-01-30 17:39:07 +0000 INFO:Running first load function.
2026-01-30 17:39:07 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:39:07 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2026-01-30 17:39:07 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2026-01-30 17:39:07 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2026-01-30 17:39:07 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2026-01-30 17:39:07 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 17:39:07 +0000 INFO:Original file path: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:39:07 +0000 INFO:Saved file path: imported_raw.zip
2026-01-30 17:39:07 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 17:39:07 +0000 INFO:Checking if H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip has been updated.
2026-01-30 17:39:07 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 17:39:07 +0000 INFO:Getting modification time for H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:39:07 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 17:39:07 +0000 INFO:Current modification time: 1769774510.1556323
2026-01-30 17:39:07 +0000 INFO:Last modification time: 1769774510.1556323
2026-01-30 17:39:07 +0000 INFO:is_file_updated executed successfully
2026-01-30 17:39:07 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 17:39:07 +0000 INFO:Loading raw data...
2026-01-30 17:39:07 +0000 DEBUG:Original data file path post raw data load: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:39:07 +0000 DEBUG:Processed data file path post raw data load: imported_raw.zip
2026-01-30 17:39:07 +0000 INFO:Data loaded successfully. Data has 91341 rows and 29 columns
2026-01-30 17:39:08 +0000 INFO:Data saved to imported_raw.zip
2026-01-30 17:39:08 +0000 INFO:Data saved to sessionstate as 'raw_data'
2026-01-30 17:39:08 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2026-01-30 17:39:08 +0000 INFO:Cleaning up raw data
2026-01-30 17:39:08 +0000 ERROR:Session state variables not initialized!
2026-01-30 17:39:08 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 17:39:08 +0000 INFO:Original file path: None
2026-01-30 17:39:08 +0000 INFO:Saved file path: cleaned_donations.zip
2026-01-30 17:39:08 +0000 ERROR:Error: originalfilepath is None!
2026-01-30 17:39:08 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 17:39:08 +0000 INFO:Data loaded, shape: (91341, 29)
2026-01-30 17:39:10 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2026-01-30 17:39:10 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2026-01-30 17:39:10 +0000 INFO:File deduplication complete, shape: ECRef                            592
OriginalRegulatedEntityName      592
RegulatedEntityType              592
Value                            592
AcceptedDate                     574
AccountingUnitName               592
DonorName                        592
AccountingUnitsAsCentralParty    592
IsSponsorship                    592
DonorStatus                      592
RegulatedDoneeType               592
CompanyRegistrationNumber        592
Postcode                         592
DonationType                     592
NatureOfDonation                 592
PurposeOfVisit                   592
DonationAction                   592
ReceivedDate                     486
ReportedDate                     592
IsReportedPrePoll                423
ReportingPeriodName              592
IsBequest                        592
IsAggregation                    592
OriginalRegulatedEntityId        592
AccountingUnitId                 592
DonorId                          592
CampaigningName                  592
RegisterName                     592
IsIrishSource                    592
CleanedRegulatedEntityName       592
CleanedRegulatedEntityId         592
RegulatedEntityId                592
RegulatedEntityName              592
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10109
OriginalRegulatedEntityName      10109
RegulatedEntityType              10109
Value                            10107
AcceptedDate                      9796
AccountingUnitName               10109
DonorName                        10109
AccountingUnitsAsCentralParty    10109
IsSponsorship                    10109
DonorStatus                      10109
RegulatedDoneeType               10109
CompanyRegistrationNumber        10109
Postcode                         10109
DonationType                     10109
NatureOfDonation                 10109
PurposeOfVisit                   10109
DonationAction                   10109
ReceivedDate                      7075
ReportedDate                     10099
IsReportedPrePoll                 4878
ReportingPeriodName              10109
IsBequest                        10109
IsAggregation                    10109
OriginalRegulatedEntityId        10109
AccountingUnitId                 10109
DonorId                          10109
CampaigningName                  10109
RegisterName                     10109
IsIrishSource                    10109
CleanedRegulatedEntityName       10109
CleanedRegulatedEntityId         10109
RegulatedEntityId                10109
RegulatedEntityName              10109
dtype: int64 records updated with new RegulatedEntityName
2026-01-30 17:39:10 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3771
OriginalRegulatedEntityName      3771
RegulatedEntityType              3771
Value                            3771
AcceptedDate                     3667
AccountingUnitName               3771
DonorName                        3771
AccountingUnitsAsCentralParty    3771
IsSponsorship                    3771
DonorStatus                      3771
RegulatedDoneeType               3771
CompanyRegistrationNumber        3771
Postcode                         3771
DonationType                     3771
NatureOfDonation                 3771
PurposeOfVisit                   3771
DonationAction                   3771
ReceivedDate                     3297
ReportedDate                     3771
IsReportedPrePoll                 449
ReportingPeriodName              3771
IsBequest                        3771
IsAggregation                    3771
OriginalRegulatedEntityId        3771
AccountingUnitId                 3771
DonorId                          3771
CampaigningName                  3771
RegisterName                     3771
IsIrishSource                    3771
CleanedRegulatedEntityName        592
CleanedRegulatedEntityId          592
RegulatedEntityId                3771
RegulatedEntityName              3771
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13288
OriginalRegulatedEntityName      13288
RegulatedEntityType              13288
Value                            13286
AcceptedDate                     12889
AccountingUnitName               13288
DonorName                        13288
AccountingUnitsAsCentralParty    13288
IsSponsorship                    13288
DonorStatus                      13288
RegulatedDoneeType               13288
CompanyRegistrationNumber        13288
Postcode                         13288
DonationType                     13288
NatureOfDonation                 13288
PurposeOfVisit                   13288
DonationAction                   13288
ReceivedDate                      9886
ReportedDate                     13278
IsReportedPrePoll                 4904
ReportingPeriodName              13288
IsBequest                        13288
IsAggregation                    13288
OriginalRegulatedEntityId        13288
AccountingUnitId                 13288
DonorId                          13288
CampaigningName                  13288
RegisterName                     13288
IsIrishSource                    13288
CleanedRegulatedEntityName       10109
CleanedRegulatedEntityId         10109
RegulatedEntityId                13288
RegulatedEntityName              13288
dtype: int64 records updated with new RegulatedEntityName
2026-01-30 17:39:10 +0000 INFO:File deduplication complete, shape: (91341, 33)
2026-01-30 17:39:10 +0000 INFO:dedupe_entity_file executed successfully
2026-01-30 17:39:10 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2026-01-30 17:39:10 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2026-01-30 17:39:11 +0000 INFO:File deduplication complete, shape: ECRef                            34082
OriginalRegulatedEntityName      34082
RegulatedEntityType              34082
Value                            34079
AcceptedDate                     33689
AccountingUnitName               34082
OriginalDonorName                34082
AccountingUnitsAsCentralParty    34082
IsSponsorship                    34082
DonorStatus                      34082
RegulatedDoneeType               34082
CompanyRegistrationNumber        34082
Postcode                         34082
DonationType                     34082
NatureOfDonation                 34082
PurposeOfVisit                   34082
DonationAction                   34082
ReceivedDate                     32487
ReportedDate                     34071
IsReportedPrePoll                22707
ReportingPeriodName              34082
IsBequest                        34082
IsAggregation                    34082
OriginalRegulatedEntityId        34082
AccountingUnitId                 34082
OriginalDonorId                  34082
CampaigningName                  34082
RegisterName                     34082
IsIrishSource                    34082
CleanedRegulatedEntityName       34082
CleanedRegulatedEntityId         34082
RegulatedEntityId                34082
RegulatedEntityName              34082
CleanedDonorName                 34082
CleanedDonorId                   34082
DonorId                          34082
DonorName                        34082
dtype: int64 records updated with new DonorId and ECRef                            20155
OriginalRegulatedEntityName      20155
RegulatedEntityType              20155
Value                            20153
AcceptedDate                     19834
AccountingUnitName               20155
OriginalDonorName                20155
AccountingUnitsAsCentralParty    20155
IsSponsorship                    20155
DonorStatus                      20155
RegulatedDoneeType               20155
CompanyRegistrationNumber        20155
Postcode                         20155
DonationType                     20155
NatureOfDonation                 20155
PurposeOfVisit                   20155
DonationAction                   20155
ReceivedDate                     19620
ReportedDate                     20146
IsReportedPrePoll                13414
ReportingPeriodName              20155
IsBequest                        20155
IsAggregation                    20155
OriginalRegulatedEntityId        20155
AccountingUnitId                 20155
OriginalDonorId                  20155
CampaigningName                  20155
RegisterName                     20155
IsIrishSource                    20155
CleanedRegulatedEntityName       20154
CleanedRegulatedEntityId         20154
RegulatedEntityId                20155
RegulatedEntityName              20155
CleanedDonorName                 20155
CleanedDonorId                   20155
DonorId                          20155
DonorName                        20155
dtype: int64 records updated with new DonorName
2026-01-30 17:39:11 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            52934
OriginalRegulatedEntityName      52934
RegulatedEntityType              52934
Value                            52931
AcceptedDate                     52138
AccountingUnitName               52934
OriginalDonorName                52934
AccountingUnitsAsCentralParty    52934
IsSponsorship                    52934
DonorStatus                      52934
RegulatedDoneeType               52934
CompanyRegistrationNumber        52934
Postcode                         52934
DonationType                     52934
NatureOfDonation                 52934
PurposeOfVisit                   52934
DonationAction                   52934
ReceivedDate                     50532
ReportedDate                     52923
IsReportedPrePoll                23658
ReportingPeriodName              52934
IsBequest                        52934
IsAggregation                    52934
OriginalRegulatedEntityId        52934
AccountingUnitId                 52934
OriginalDonorId                  52934
CampaigningName                  52934
RegisterName                     52934
IsIrishSource                    52934
CleanedRegulatedEntityName       49804
CleanedRegulatedEntityId         49804
RegulatedEntityId                52934
RegulatedEntityName              52934
CleanedDonorName                 34082
CleanedDonorId                   34082
DonorId                          52934
DonorName                        52934
dtype: int64 records updated with new DonorId and ECRef                            39007
OriginalRegulatedEntityName      39007
RegulatedEntityType              39007
Value                            39005
AcceptedDate                     38283
AccountingUnitName               39007
OriginalDonorName                39007
AccountingUnitsAsCentralParty    39007
IsSponsorship                    39007
DonorStatus                      39007
RegulatedDoneeType               39007
CompanyRegistrationNumber        39007
Postcode                         39007
DonationType                     39007
NatureOfDonation                 39007
PurposeOfVisit                   39007
DonationAction                   39007
ReceivedDate                     37665
ReportedDate                     38998
IsReportedPrePoll                14365
ReportingPeriodName              39007
IsBequest                        39007
IsAggregation                    39007
OriginalRegulatedEntityId        39007
AccountingUnitId                 39007
OriginalDonorId                  39007
CampaigningName                  39007
RegisterName                     39007
IsIrishSource                    39007
CleanedRegulatedEntityName       35876
CleanedRegulatedEntityId         35876
RegulatedEntityId                39007
RegulatedEntityName              39007
CleanedDonorName                 20155
CleanedDonorId                   20155
DonorId                          39007
DonorName                        39007
dtype: int64 records updated with new DonorName
2026-01-30 17:39:11 +0000 INFO:File deduplication complete, shape: (91341, 37)
2026-01-30 17:39:11 +0000 INFO:dedupe_entity_file executed successfully
2026-01-30 17:39:11 +0000 INFO:Raw Data cleanup completed
2026-01-30 17:39:11 +0000 INFO:Data shape: (91341, 37)
2026-01-30 17:39:12 +0000 INFO:Data saved to cleaned_donations.zip
2026-01-30 17:39:12 +0000 INFO:Data cleanup completed, shape: (91341, 37)
2026-01-30 17:39:12 +0000 INFO:raw_data_cleanup executed successfully
2026-01-30 17:39:12 +0000 INFO:load_raw_data executed successfully
2026-01-30 17:39:13 +0000 INFO:get_raw_data executed successfully
2026-01-30 17:39:13 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:39:13 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2026-01-30 17:39:13 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2026-01-30 17:39:13 +0000 DEBUG:Rows in Raw Data: 91341
2026-01-30 17:39:13 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 17:39:13 +0000 INFO:Original file path: cleaned_donations.zip
2026-01-30 17:39:13 +0000 INFO:Saved file path: cleaned_data.zip
2026-01-30 17:39:13 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 17:39:13 +0000 INFO:Checking if cleaned_donations.zip has been updated.
2026-01-30 17:39:13 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 17:39:13 +0000 INFO:Getting modification time for cleaned_donations.zip
2026-01-30 17:39:13 +0000 WARNING:File cleaned_donations.zip does not exist.
2026-01-30 17:39:13 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 17:39:13 +0000 INFO:Current modification time: None
2026-01-30 17:39:13 +0000 INFO:Last modification time: 1769774510.1556323
2026-01-30 17:39:13 +0000 WARNING:Cannot determine modification time for cleaned_donations.zip
2026-01-30 17:39:13 +0000 INFO:is_file_updated executed successfully
2026-01-30 17:39:13 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 17:39:13 +0000 ERROR:Failed to load data from cleaned_donations.zip
2026-01-30 17:39:13 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2026-01-30 17:39:13 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91341
2026-01-30 17:39:13 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91341
2026-01-30 17:39:15 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2026-01-30 17:39:15 +0000 DEBUG:Clean Data Prep 204: Map Party: 91341
2026-01-30 17:39:49 +0000 INFO:Added parliamentary_sitting column with 8 unique periods
2026-01-30 17:39:49 +0000 DEBUG:Group assignment with exceptions: {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}
2026-01-30 17:39:49 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28638
Labour Party                       22675
Liberal Democrats                  19030
Large Entity                        8611
Medium Entity                       3809
Small Entity                        1985
Uk Independence Party (Ukip)        1830
Green Party                         1673
Single Donation Entity              1353
Scottish National Party (Snp)        815
Plaid Cymru - Party Of Wales         517
Reform UK                            377
Liberal Party                         15
Sinn Féin                             13
Name: count, dtype: int64
2026-01-30 17:39:49 +0000 DEBUG:Group assignment: group
Single Donation Entity             1353
Small Entity                        839
Medium Entity                       614
Large Entity                        227
Conservative And Unionist Party       8
Labour Party                          8
Liberal Democrats                     8
Plaid Cymru - Party Of Wales          8
Scottish National Party (Snp)         8
Uk Independence Party (Ukip)          8
Green Party                           7
Liberal Party                         4
Reform UK                             3
Sinn Féin                             1
Name: count, dtype: int64
2026-01-30 17:39:49 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91341
2026-01-30 17:39:49 +0000 DEBUG:Group assignment with exceptions: {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}
2026-01-30 17:39:49 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32036
Labour Party                       27106
Large Entity                       24804
Uk Independence Party (Ukip)        1853
Green Party                         1694
Medium Entity                       1112
Scottish National Party (Snp)        881
Small Entity                         552
Plaid Cymru - Party Of Wales         525
Reform UK                            377
Single Donation Entity               372
Liberal Party                         15
Sinn Féin                             13
Democratic Unionist Party              1
Name: count, dtype: int64
2026-01-30 17:39:49 +0000 DEBUG:Group assignment: group
Single Donation Entity             372
Small Entity                       233
Medium Entity                      171
Large Entity                       120
Conservative And Unionist Party      8
Labour Party                         8
Plaid Cymru - Party Of Wales         8
Scottish National Party (Snp)        8
Uk Independence Party (Ukip)         8
Green Party                          7
Liberal Party                        4
Reform UK                            3
Democratic Unionist Party            1
Sinn Féin                            1
Name: count, dtype: int64
2026-01-30 17:39:49 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91341
2026-01-30 17:39:50 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2026-01-30 17:39:50 +0000 INFO:Loading election dates from pdpy.
2026-01-30 17:39:50 +0000 INFO:Election Dates loaded from pdpy.
2026-01-30 17:39:50 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2026-01-30 17:39:50 +0000 INFO:Election Dates Loaded Successfully.
2026-01-30 17:39:50 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:39:50 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:39:50 +0000 INFO:load_election_dates executed successfully
2026-01-30 17:39:50 +0000 DEBUG:Clean Data Prep 353: Election dates: 91341
2026-01-30 17:39:50 +0000 DEBUG:Clean Data Prep 386: End of clean: 91341
2026-01-30 17:39:53 +0000 INFO:Cleaned Data completed, shape: (91341, 57)
2026-01-30 17:39:53 +0000 INFO:load_cleaned_data executed successfully
2026-01-30 17:39:53 +0000 INFO:get_cleaned_data executed successfully
2026-01-30 17:39:53 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:39:53 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2026-01-30 17:39:53 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2026-01-30 17:39:53 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 17:39:53 +0000 INFO:Original file path: cleaned_data.zip
2026-01-30 17:39:53 +0000 INFO:Saved file path: cleaned_donorlist.zip
2026-01-30 17:39:53 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 17:39:53 +0000 INFO:Checking if cleaned_data.zip has been updated.
2026-01-30 17:39:53 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 17:39:53 +0000 INFO:Getting modification time for cleaned_data.zip
2026-01-30 17:39:53 +0000 WARNING:File cleaned_data.zip does not exist.
2026-01-30 17:39:53 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 17:39:53 +0000 INFO:Current modification time: None
2026-01-30 17:39:53 +0000 INFO:Last modification time: 1769718453.1764421
2026-01-30 17:39:53 +0000 WARNING:Cannot determine modification time for cleaned_data.zip
2026-01-30 17:39:53 +0000 INFO:is_file_updated executed successfully
2026-01-30 17:39:53 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 17:39:53 +0000 INFO:Donor data saved to cleaned_donorlist.zip
2026-01-30 17:39:53 +0000 INFO:Donor Data summary completed
2026-01-30 17:39:53 +0000 INFO:Data shape: (32070, 5)
2026-01-30 17:39:53 +0000 INFO:load_donorList_data executed successfully
2026-01-30 17:39:53 +0000 INFO:get_donor_data executed successfully
2026-01-30 17:39:53 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:39:53 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:39:53 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2026-01-30 17:39:53 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2026-01-30 17:39:53 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 17:39:53 +0000 INFO:Original file path: cleaned_data.zip
2026-01-30 17:39:53 +0000 INFO:Saved file path: cleaned_regentity.zip
2026-01-30 17:39:53 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 17:39:53 +0000 INFO:Checking if cleaned_data.zip has been updated.
2026-01-30 17:39:53 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 17:39:53 +0000 INFO:Getting modification time for cleaned_data.zip
2026-01-30 17:39:53 +0000 WARNING:File cleaned_data.zip does not exist.
2026-01-30 17:39:53 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 17:39:53 +0000 INFO:Current modification time: None
2026-01-30 17:39:53 +0000 INFO:Last modification time: 1769718453.1764421
2026-01-30 17:39:53 +0000 WARNING:Cannot determine modification time for cleaned_data.zip
2026-01-30 17:39:53 +0000 INFO:is_file_updated executed successfully
2026-01-30 17:39:53 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 17:39:53 +0000 INFO:Regulated entity data saved to cleaned_regentity.zip
2026-01-30 17:39:53 +0000 INFO:Raw Data cleanup completed
2026-01-30 17:39:53 +0000 INFO:Data shape: (2404, 6)
2026-01-30 17:39:53 +0000 INFO:load_regulated_entity_data executed successfully
2026-01-30 17:39:53 +0000 INFO:get_regentity_data executed successfully
2026-01-30 17:39:53 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:39:53 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:39:53 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:39:53 +0000 INFO:firstload executed successfully
2026-01-30 17:39:53 +0000 INFO:Data first load completed successfully.
2026-01-30 17:39:53 +0000 INFO:initialise_data executed successfully
2026-01-30 17:39:53 +0000 INFO:Running Menu setup...
2026-01-30 17:39:53 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:39:53 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:39:56 +0000 INFO:get_git_version executed successfully
2026-01-30 17:39:56 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:39:59 +0000 INFO:get_git_version executed successfully
2026-01-30 17:39:59 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:40:03 +0000 INFO:get_git_version executed successfully
2026-01-30 17:40:03 +0000 INFO:App Version: v50.239
2026-01-30 17:40:03 +0000 INFO:Switched to page: Introduction
2026-01-30 17:40:03 +0000 INFO:pagesetup executed successfully
2026-01-30 17:40:03 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:40:03 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:40:12 +0000 INFO:Streamlit App Starting...
2026-01-30 17:40:12 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:40:12 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:40:12 +0000 INFO:Running App setup...
2026-01-30 17:40:12 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:40:12 +0000 INFO:Setting up the package
2026-01-30 17:40:12 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:40:12 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:40:12 +0000 INFO:get_git_version executed successfully
2026-01-30 17:40:12 +0000 INFO:Version: v50.201
2026-01-30 17:40:12 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:40:12 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:40:12 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:security already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:directories already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:40:12 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:40:12 +0000 INFO:Session_state variables initialized
2026-01-30 17:40:12 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:40:12 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:40:12 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:40:12 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:40:12 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:40:12 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:40:12 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:40:12 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:40:12 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:40:12 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:40:12 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:40:12 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:40:12 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:40:12 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:40:12 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:40:12 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:40:12 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:40:12 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:40:12 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:40:12 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:40:12 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:40:12 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:40:12 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:40:12 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:40:12 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:40:12 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:40:12 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:40:12 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:40:12 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:40:12 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:40:12 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:40:12 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:40:12 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:40:12 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:40:12 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:40:12 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:40:12 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:40:12 +0000 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x000001C18D4363B0>}
2026-01-30 17:40:12 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:40:12 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:40:12 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:40:12 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:40:12 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:40:12 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:40:12 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:40:12 +0000 INFO:Session state Setup complete
2026-01-30 17:40:12 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:40:12 +0000 INFO:Package setup complete
2026-01-30 17:40:12 +0000 INFO:setup_package executed successfully
2026-01-30 17:40:12 +0000 INFO:Setup completed successfully.
2026-01-30 17:40:12 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:40:12 +0000 INFO:Running first load function.
2026-01-30 17:40:12 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:40:12 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:40:12 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:40:12 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:40:12 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:40:12 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:40:12 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:40:12 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:40:12 +0000 INFO:firstload executed successfully
2026-01-30 17:40:12 +0000 INFO:Data first load completed successfully.
2026-01-30 17:40:12 +0000 INFO:initialise_data executed successfully
2026-01-30 17:40:12 +0000 INFO:Running Menu setup...
2026-01-30 17:40:12 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:40:12 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:40:12 +0000 INFO:get_git_version executed successfully
2026-01-30 17:40:12 +0000 INFO:App Version: v50.239
2026-01-30 17:40:12 +0000 INFO:Switched to page: Head Line Figures
2026-01-30 17:40:12 +0000 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2026-01-30 17:40:12 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:40:12 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:40:12 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:40:12 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:40:14 +0000 DEBUG:Aggregated DataFrame:                         Party_Group         Value
0   Conservative And Unionist Party  20170.405233
1         Democratic Unionist Party   3618.940000
2                       Green Party   6204.226405
3                      Labour Party  20519.157176
4                      Large Entity  12031.362470
5                     Liberal Party   2871.754667
6                     Medium Entity  19378.136232
7      Plaid Cymru - Party Of Wales  15859.742724
8                         Reform UK  97641.772732
9     Scottish National Party (Snp)  36021.189364
10           Single Donation Entity  13864.955459
11                        Sinn Féin  44317.630769
12                     Small Entity  24968.983822
13     Uk Independence Party (Ukip)   9943.456859
2026-01-30 17:40:14 +0000 DEBUG:Sorted DataFrame:                         Party_Group         Value
8                         Reform UK  97641.772732
11                        Sinn Féin  44317.630769
9     Scottish National Party (Snp)  36021.189364
12                     Small Entity  24968.983822
3                      Labour Party  20519.157176
0   Conservative And Unionist Party  20170.405233
6                     Medium Entity  19378.136232
7      Plaid Cymru - Party Of Wales  15859.742724
10           Single Donation Entity  13864.955459
4                      Large Entity  12031.362470
13     Uk Independence Party (Ukip)   9943.456859
2                       Green Party   6204.226405
1         Democratic Unionist Party   3618.940000
5                     Liberal Party   2871.754667
2026-01-30 17:40:14 +0000 DEBUG:Unique XValues: ['Reform UK' 'Sinn Féin' 'Scottish National Party (Snp)' 'Small Entity'
 'Labour Party' 'Conservative And Unionist Party' 'Medium Entity'
 'Plaid Cymru - Party Of Wales' 'Single Donation Entity' 'Large Entity'
 'Uk Independence Party (Ukip)' 'Green Party' 'Democratic Unionist Party'
 'Liberal Party']
2026-01-30 17:40:14 +0000 DEBUG:Final color_discrete_map: {'Reform UK': '#12B6CF', 'Sinn Féin': '#326760', 'Scottish National Party (Snp)': '#636efa', 'Small Entity': '#aaaaaa', 'Labour Party': '#DC241F', 'Conservative And Unionist Party': '#0087DC', 'Medium Entity': '#666666', 'Plaid Cymru - Party Of Wales': '#636efa', 'Single Donation Entity': '#e8e8e8', 'Large Entity': '#222222', 'Uk Independence Party (Ukip)': '#70147A', 'Green Party': '#78B943', 'Democratic Unionist Party': '#636efa', 'Liberal Party': '#636efa'}
2026-01-30 17:40:14 +0000 DEBUG:Missing color mappings for: ['Scottish National Party (Snp)', 'Plaid Cymru - Party Of Wales', 'Democratic Unionist Party', 'Liberal Party']
2026-01-30 17:40:14 +0000 DEBUG:Generated Figure: Figure({
    'data': [{'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Reform UK',
              'marker': {'color': '#12B6CF', 'pattern': {'shape': ''}},
              'name': 'Reform UK',
              'offsetgroup': 'Reform UK',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Reform UK'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'a1QcXZzW90A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Sinn Féin',
              'marker': {'color': '#326760', 'pattern': {'shape': ''}},
              'name': 'Sinn Féin',
              'offsetgroup': 'Sinn Féin',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Sinn Féin'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'L/RCL7Sj5UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Scottish National Party (Snp)',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Scottish National Party (Snp)',
              'offsetgroup': 'Scottish National Party (Snp)',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Scottish National Party (Snp)'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '8tdFD6aW4UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Small Entity',
              'marker': {'color': '#aaaaaa', 'pattern': {'shape': ''}},
              'name': 'Small Entity',
              'offsetgroup': 'Small Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Small Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'vX7y9j5i2EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Labour Party',
              'marker': {'color': '#DC241F', 'pattern': {'shape': ''}},
              'name': 'Labour Party',
              'offsetgroup': 'Labour Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Labour Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '9qMqD8oJ1EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Conservative And Unionist Party',
              'marker': {'color': '#0087DC', 'pattern': {'shape': ''}},
              'name': 'Conservative And Unionist Party',
              'offsetgroup': 'Conservative And Unionist Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Conservative And Unionist Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '65FU75my00A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Medium Entity',
              'marker': {'color': '#666666', 'pattern': {'shape': ''}},
              'name': 'Medium Entity',
              'offsetgroup': 'Medium Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Medium Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'nXsGuIjs0kA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Plaid Cymru - Party Of Wales',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Plaid Cymru - Party Of Wales',
              'offsetgroup': 'Plaid Cymru - Party Of Wales',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Plaid Cymru - Party Of Wales'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '7uOSEd/5zkA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Single Donation Entity',
              'marker': {'color': '#e8e8e8', 'pattern': {'shape': ''}},
              'name': 'Single Donation Entity',
              'offsetgroup': 'Single Donation Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Single Donation Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'hd1+THoUy0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Large Entity',
              'marker': {'color': '#222222', 'pattern': {'shape': ''}},
              'name': 'Large Entity',
              'offsetgroup': 'Large Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Large Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'lyJsZa5/x0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Uk Independence Party (Ukip)',
              'marker': {'color': '#70147A', 'pattern': {'shape': ''}},
              'name': 'Uk Independence Party (Ukip)',
              'offsetgroup': 'Uk Independence Party (Ukip)',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Uk Independence Party (Ukip)'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'U0xcerprw0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Green Party',
              'marker': {'color': '#78B943', 'pattern': {'shape': ''}},
              'name': 'Green Party',
              'offsetgroup': 'Green Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Green Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'LOWs9Tk8uEA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Democratic Unionist Party',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Democratic Unionist Party',
              'offsetgroup': 'Democratic Unionist Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Democratic Unionist Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'exSuR+FFrEA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Liberal Party',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Liberal Party',
              'offsetgroup': 'Liberal Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Liberal Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'blmrY4JvpkA=', 'dtype': 'f8'},
              'yaxis': 'y'}],
    'layout': {'barmode': 'group',
               'legend': {'title': {'text': 'Political Party'}, 'tracegroupgap': 0},
               'template': '...',
               'title': {'text': 'Average Donation per Party'},
               'xaxis': {'anchor': 'y',
                         'categoryarray': [Reform UK, Sinn Féin, Scottish National
                                           Party (Snp), Small Entity, Labour Party,
                                           Conservative And Unionist Party, Medium
                                           Entity, Plaid Cymru - Party Of Wales,
                                           Single Donation Entity, Large Entity, Uk
                                           Independence Party (Ukip), Green Party,
                                           Democratic Unionist Party, Liberal
                                           Party],
                         'categoryorder': 'array',
                         'domain': [0.0, 1.0],
                         'title': {'text': 'Political Party'}},
               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': 'Average Donation GBP'}}}
})
2026-01-30 17:40:14 +0000 INFO:Bar chart displayed successfully.
2026-01-30 17:40:14 +0000 INFO:hlf_body executed successfully
2026-01-30 17:40:14 +0000 INFO:pagesetup executed successfully
2026-01-30 17:40:14 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:40:14 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:41:02 +0000 INFO:Streamlit App Starting...
2026-01-30 17:41:02 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:41:02 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:41:02 +0000 INFO:Running App setup...
2026-01-30 17:41:02 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:41:02 +0000 INFO:Setting up the package
2026-01-30 17:41:02 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:41:02 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:41:02 +0000 INFO:get_git_version executed successfully
2026-01-30 17:41:02 +0000 INFO:Version: v50.201
2026-01-30 17:41:02 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:41:02 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:41:02 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:security already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:directories already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:41:02 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:41:02 +0000 INFO:Session_state variables initialized
2026-01-30 17:41:02 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:41:02 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:41:02 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:41:02 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:41:02 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:41:02 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:41:02 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:41:02 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:41:02 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:41:02 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:41:02 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:41:02 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:41:02 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:41:02 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:41:02 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:41:02 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:41:02 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:41:02 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:41:02 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:41:02 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:41:02 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:41:02 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:41:02 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:41:02 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:41:02 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:41:02 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:41:02 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:41:02 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:41:02 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:41:02 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:41:02 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:41:02 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:41:02 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:41:02 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:41:02 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:41:02 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:41:02 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:41:02 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:41:02 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:41:02 +0000 DEBUG:menu_selection: {'title': 'Cash Donations', 'function': <function mod_cash_donations at 0x000001C18D4377F0>}
2026-01-30 17:41:02 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:41:02 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:41:02 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:41:02 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:41:02 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:41:02 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:41:02 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:41:02 +0000 INFO:Session state Setup complete
2026-01-30 17:41:02 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:41:02 +0000 INFO:Package setup complete
2026-01-30 17:41:02 +0000 INFO:setup_package executed successfully
2026-01-30 17:41:02 +0000 INFO:Setup completed successfully.
2026-01-30 17:41:02 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:41:02 +0000 INFO:Running first load function.
2026-01-30 17:41:02 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:41:02 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:41:02 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:41:02 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:41:02 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:41:02 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:41:02 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:41:02 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:41:02 +0000 INFO:firstload executed successfully
2026-01-30 17:41:02 +0000 INFO:Data first load completed successfully.
2026-01-30 17:41:02 +0000 INFO:initialise_data executed successfully
2026-01-30 17:41:02 +0000 INFO:Running Menu setup...
2026-01-30 17:41:02 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:41:02 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:41:02 +0000 INFO:get_git_version executed successfully
2026-01-30 17:41:02 +0000 INFO:App Version: v50.239
2026-01-30 17:41:02 +0000 INFO:Switched to page: Cash Donations
2026-01-30 17:41:02 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:41:02 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:41:02 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:41:02 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:41:03 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:41:03 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:41:03 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:41:03 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:41:03 +0000 DEBUG:Page texts: {'Para1': {'text': 'Except for in 2016', 'is_deleted': False}, 'Para 2': {'text': 'More useful information', 'is_deleted': False}}
2026-01-30 17:41:03 +0000 DEBUG:Calling manage_text_elements with args={args}, kwargs={kwargs}
2026-01-30 17:41:03 +0000 DEBUG:Not logged in as admin.
2026-01-30 17:41:03 +0000 INFO:manage_text_elements executed successfully
2026-01-30 17:41:03 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:41:03 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:41:03 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:41:03 +0000 INFO:display_data_page executed successfully
2026-01-30 17:41:03 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:41:03 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:41:04 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:41:04 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:41:04 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:41:04 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:41:04 +0000 DEBUG:Page texts: {}
2026-01-30 17:41:04 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:41:04 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:41:04 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:41:04 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:41:04 +0000 INFO:pagesetup executed successfully
2026-01-30 17:41:04 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:41:04 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:41:25 +0000 INFO:Streamlit App Starting...
2026-01-30 17:41:25 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:41:25 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:41:25 +0000 INFO:Running App setup...
2026-01-30 17:41:25 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:41:25 +0000 INFO:Setting up the package
2026-01-30 17:41:25 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:41:25 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:41:25 +0000 INFO:get_git_version executed successfully
2026-01-30 17:41:25 +0000 INFO:Version: v50.201
2026-01-30 17:41:25 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:41:25 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:41:25 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:security already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:directories already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:41:25 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:41:25 +0000 INFO:Session_state variables initialized
2026-01-30 17:41:25 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:41:25 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:41:25 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:41:25 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:41:25 +0000 DEBUG:date_range_mod_cash_donations_per_donor_mod_cash_donations_per_donorCash Donations per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:41:25 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:41:25 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:41:25 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:41:25 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:41:25 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:41:25 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:41:25 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:41:25 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:41:25 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:41:25 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:41:25 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:41:25 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:41:25 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:41:25 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:41:25 +0000 DEBUG:selected_entity_name: All
2026-01-30 17:41:25 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:41:25 +0000 DEBUG:mod_cash_donations_per_donor_None_mod_cash_donations_per_donorCash Donations per DonorNone_group_entity_select: Donor
2026-01-30 17:41:25 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:41:25 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:41:25 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:41:25 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:41:25 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:41:25 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:41:25 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:41:25 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:41:25 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:41:25 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:41:25 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:41:25 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:41:25 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:41:25 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:41:25 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:41:25 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:41:25 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:41:25 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:41:25 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:41:25 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:41:25 +0000 DEBUG:menu_selection: {'title': 'Non Cash Donations', 'function': <function mod_non_cash_donations at 0x000001C18D437880>}
2026-01-30 17:41:25 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:41:25 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:41:25 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:41:25 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:41:25 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:41:25 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:41:25 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:41:25 +0000 INFO:Session state Setup complete
2026-01-30 17:41:25 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:41:25 +0000 INFO:Package setup complete
2026-01-30 17:41:25 +0000 INFO:setup_package executed successfully
2026-01-30 17:41:25 +0000 INFO:Setup completed successfully.
2026-01-30 17:41:25 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:41:25 +0000 INFO:Running first load function.
2026-01-30 17:41:25 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:41:25 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:41:25 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:41:25 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:41:25 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:41:25 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:41:25 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:41:25 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:41:25 +0000 INFO:firstload executed successfully
2026-01-30 17:41:25 +0000 INFO:Data first load completed successfully.
2026-01-30 17:41:25 +0000 INFO:initialise_data executed successfully
2026-01-30 17:41:25 +0000 INFO:Running Menu setup...
2026-01-30 17:41:25 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:41:25 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:41:25 +0000 INFO:get_git_version executed successfully
2026-01-30 17:41:25 +0000 INFO:App Version: v50.239
2026-01-30 17:41:25 +0000 INFO:Switched to page: Non Cash Donations
2026-01-30 17:41:25 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:41:25 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:41:25 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:41:25 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:41:26 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:41:26 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:41:26 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:41:26 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:41:26 +0000 DEBUG:Page texts: {}
2026-01-30 17:41:26 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:41:26 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:41:26 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:41:26 +0000 INFO:display_data_page executed successfully
2026-01-30 17:41:26 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:41:26 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:41:26 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:41:26 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:41:26 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:41:26 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:41:26 +0000 DEBUG:Page texts: {}
2026-01-30 17:41:26 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:41:26 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:41:26 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:41:26 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:41:26 +0000 INFO:pagesetup executed successfully
2026-01-30 17:41:26 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:41:26 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:41:40 +0000 INFO:Streamlit App Starting...
2026-01-30 17:41:40 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:41:40 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:41:40 +0000 INFO:Running App setup...
2026-01-30 17:41:40 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:41:40 +0000 INFO:Setting up the package
2026-01-30 17:41:40 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:41:40 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:41:40 +0000 INFO:get_git_version executed successfully
2026-01-30 17:41:40 +0000 INFO:Version: v50.201
2026-01-30 17:41:40 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:41:40 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:41:40 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:security already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:directories already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:41:40 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:41:40 +0000 INFO:Session_state variables initialized
2026-01-30 17:41:40 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:41:40 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:41:40 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:41:40 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:41:40 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:41:40 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:41:40 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:41:40 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:41:40 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:41:40 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:41:40 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:41:40 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:41:40 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:41:40 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:41:40 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:41:40 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:41:40 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:41:40 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:41:40 +0000 DEBUG:selected_entity_name: All
2026-01-30 17:41:40 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:41:40 +0000 DEBUG:date_range_mod_non_cash_donations_per_donor_mod_non_cash_donations_per_donorNon Cash Donations per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:41:40 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:41:40 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:41:40 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:41:40 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:41:40 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:41:40 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:41:40 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:41:40 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:41:40 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:41:40 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:41:40 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:41:40 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:41:40 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:41:40 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:41:40 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:41:40 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:41:40 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:41:40 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:41:40 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:41:40 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:41:40 +0000 DEBUG:menu_selection: {'title': 'Public Fund Donations', 'function': <function mod_publicfund_donations at 0x000001C18D437910>}
2026-01-30 17:41:40 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:41:40 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:41:40 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:41:40 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:41:40 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:41:40 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:41:40 +0000 DEBUG:mod_non_cash_donations_per_donor_None_mod_non_cash_donations_per_donorNon Cash Donations per DonorNone_group_entity_select: Donor
2026-01-30 17:41:40 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:41:40 +0000 INFO:Session state Setup complete
2026-01-30 17:41:40 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:41:40 +0000 INFO:Package setup complete
2026-01-30 17:41:40 +0000 INFO:setup_package executed successfully
2026-01-30 17:41:40 +0000 INFO:Setup completed successfully.
2026-01-30 17:41:40 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:41:40 +0000 INFO:Running first load function.
2026-01-30 17:41:40 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:41:40 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:41:40 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:41:40 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:41:40 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:41:40 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:41:40 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:41:40 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:41:40 +0000 INFO:firstload executed successfully
2026-01-30 17:41:40 +0000 INFO:Data first load completed successfully.
2026-01-30 17:41:40 +0000 INFO:initialise_data executed successfully
2026-01-30 17:41:40 +0000 INFO:Running Menu setup...
2026-01-30 17:41:40 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:41:40 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:41:40 +0000 INFO:get_git_version executed successfully
2026-01-30 17:41:40 +0000 INFO:App Version: v50.239
2026-01-30 17:41:40 +0000 INFO:Switched to page: Public Fund Donations
2026-01-30 17:41:40 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:41:40 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:41:40 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:41:40 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:41:40 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:41:40 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:41:40 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:41:40 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:41:40 +0000 DEBUG:Page texts: {}
2026-01-30 17:41:40 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:41:40 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:41:40 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:41:40 +0000 INFO:display_data_page executed successfully
2026-01-30 17:41:40 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:41:41 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:41:41 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:41:41 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:41:41 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:41:41 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:41:41 +0000 DEBUG:Page texts: {}
2026-01-30 17:41:41 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:41:41 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:41:41 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:41:41 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:41:41 +0000 INFO:pagesetup executed successfully
2026-01-30 17:41:41 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:41:41 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:41:45 +0000 INFO:Streamlit App Starting...
2026-01-30 17:41:45 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:41:45 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:41:45 +0000 INFO:Running App setup...
2026-01-30 17:41:45 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:41:45 +0000 INFO:Setting up the package
2026-01-30 17:41:45 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:41:45 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:41:45 +0000 INFO:get_git_version executed successfully
2026-01-30 17:41:45 +0000 INFO:Version: v50.201
2026-01-30 17:41:45 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:41:45 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:41:45 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:security already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:directories already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:41:45 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:41:45 +0000 INFO:Session_state variables initialized
2026-01-30 17:41:45 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:41:45 +0000 DEBUG:mod_publicfund_donations_per_donor_None_mod_publicfund_donations_per_donorPublic Fund Donation per DonorNone_group_entity_select: Donor
2026-01-30 17:41:45 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:41:45 +0000 DEBUG:date_range_mod_publicfund_donations_per_donor_mod_publicfund_donations_per_donorPublic Fund Donation per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:41:45 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:41:45 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:41:45 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:41:45 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:41:45 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:41:45 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:41:45 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:41:45 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:41:45 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:41:45 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:41:45 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:41:45 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:41:45 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:41:45 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:41:45 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:41:45 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:41:45 +0000 DEBUG:selected_entity_name: All
2026-01-30 17:41:45 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:41:45 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:41:45 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:41:45 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:41:45 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:41:45 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:41:45 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:41:45 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:41:45 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:41:45 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:41:45 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:41:45 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:41:45 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:41:45 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:41:45 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:41:45 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:41:45 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:41:45 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:41:45 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:41:45 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:41:45 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:41:45 +0000 DEBUG:menu_selection: {'title': 'Bequests', 'function': <function mod_bequeths at 0x000001C18D437400>}
2026-01-30 17:41:45 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:41:45 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:41:45 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:41:45 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:41:45 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:41:45 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:41:45 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:41:45 +0000 INFO:Session state Setup complete
2026-01-30 17:41:45 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:41:45 +0000 INFO:Package setup complete
2026-01-30 17:41:45 +0000 INFO:setup_package executed successfully
2026-01-30 17:41:45 +0000 INFO:Setup completed successfully.
2026-01-30 17:41:45 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:41:45 +0000 INFO:Running first load function.
2026-01-30 17:41:45 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:41:45 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:41:45 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:41:45 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:41:45 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:41:45 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:41:45 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:41:45 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:41:45 +0000 INFO:firstload executed successfully
2026-01-30 17:41:45 +0000 INFO:Data first load completed successfully.
2026-01-30 17:41:45 +0000 INFO:initialise_data executed successfully
2026-01-30 17:41:45 +0000 INFO:Running Menu setup...
2026-01-30 17:41:45 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:41:45 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:41:45 +0000 INFO:get_git_version executed successfully
2026-01-30 17:41:45 +0000 INFO:App Version: v50.239
2026-01-30 17:41:45 +0000 INFO:Switched to page: Bequests
2026-01-30 17:41:45 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:41:45 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:41:45 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:41:45 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:41:45 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:41:45 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:41:45 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:41:45 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:41:45 +0000 DEBUG:Page texts: {}
2026-01-30 17:41:45 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:41:45 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:41:45 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:41:45 +0000 INFO:display_data_page executed successfully
2026-01-30 17:41:45 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:41:46 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:41:46 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:41:46 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:41:46 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:41:46 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:41:46 +0000 DEBUG:Page texts: {}
2026-01-30 17:41:46 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:41:46 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:41:46 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:41:46 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:41:46 +0000 INFO:pagesetup executed successfully
2026-01-30 17:41:46 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:41:46 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:41:48 +0000 INFO:Streamlit App Starting...
2026-01-30 17:41:48 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:41:48 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:41:48 +0000 INFO:Running App setup...
2026-01-30 17:41:48 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:41:48 +0000 INFO:Setting up the package
2026-01-30 17:41:48 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:41:48 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:41:48 +0000 INFO:get_git_version executed successfully
2026-01-30 17:41:48 +0000 INFO:Version: v50.201
2026-01-30 17:41:48 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:41:48 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:41:48 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:security already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:directories already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:41:48 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:41:48 +0000 INFO:Session_state variables initialized
2026-01-30 17:41:48 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:41:48 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:41:48 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:41:48 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:41:48 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:41:48 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:41:48 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:41:48 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:41:48 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:41:48 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:41:48 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:41:48 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:41:48 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:41:48 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:41:48 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:41:48 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:41:48 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:41:48 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:41:48 +0000 DEBUG:selected_entity_name: All
2026-01-30 17:41:48 +0000 DEBUG:mod_bequeths_per_donor_None_mod_bequeths_per_donorBequest per DonorNone_group_entity_select: Donor
2026-01-30 17:41:48 +0000 DEBUG:date_range_mod_bequeths_per_donor_mod_bequeths_per_donorBequest per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:41:48 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:41:48 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:41:48 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:41:48 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:41:48 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:41:48 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:41:48 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:41:48 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:41:48 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:41:48 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:41:48 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:41:48 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:41:48 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:41:48 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:41:48 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:41:48 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:41:48 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:41:48 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:41:48 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:41:48 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:41:48 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:41:48 +0000 DEBUG:menu_selection: {'title': 'Corporate Donations', 'function': <function mod_corporate_donations at 0x000001C18D437490>}
2026-01-30 17:41:48 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:41:48 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:41:48 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:41:48 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:41:48 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:41:48 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:41:48 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:41:48 +0000 INFO:Session state Setup complete
2026-01-30 17:41:48 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:41:48 +0000 INFO:Package setup complete
2026-01-30 17:41:48 +0000 INFO:setup_package executed successfully
2026-01-30 17:41:48 +0000 INFO:Setup completed successfully.
2026-01-30 17:41:48 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:41:48 +0000 INFO:Running first load function.
2026-01-30 17:41:48 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:41:48 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:41:48 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:41:48 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:41:48 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:41:48 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:41:48 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:41:48 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:41:48 +0000 INFO:firstload executed successfully
2026-01-30 17:41:48 +0000 INFO:Data first load completed successfully.
2026-01-30 17:41:48 +0000 INFO:initialise_data executed successfully
2026-01-30 17:41:48 +0000 INFO:Running Menu setup...
2026-01-30 17:41:48 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:41:48 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:41:48 +0000 INFO:get_git_version executed successfully
2026-01-30 17:41:48 +0000 INFO:App Version: v50.239
2026-01-30 17:41:48 +0000 INFO:Switched to page: Corporate Donations
2026-01-30 17:41:48 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:41:48 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:41:48 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:41:48 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:41:48 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:41:48 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:41:48 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:41:48 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:41:48 +0000 DEBUG:Page texts: {}
2026-01-30 17:41:48 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:41:48 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:41:48 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:41:48 +0000 INFO:display_data_page executed successfully
2026-01-30 17:41:48 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:41:49 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:41:49 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:41:49 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:41:49 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:41:49 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:41:49 +0000 DEBUG:Page texts: {}
2026-01-30 17:41:49 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:41:49 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:41:49 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:41:49 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:41:49 +0000 INFO:pagesetup executed successfully
2026-01-30 17:41:49 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:41:49 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:41:52 +0000 INFO:Streamlit App Starting...
2026-01-30 17:41:52 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:41:52 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:41:52 +0000 INFO:Running App setup...
2026-01-30 17:41:52 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:41:52 +0000 INFO:Setting up the package
2026-01-30 17:41:52 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:41:52 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:41:52 +0000 INFO:get_git_version executed successfully
2026-01-30 17:41:52 +0000 INFO:Version: v50.201
2026-01-30 17:41:52 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:41:52 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:41:52 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:security already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:directories already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:41:52 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:41:52 +0000 INFO:Session_state variables initialized
2026-01-30 17:41:52 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:41:52 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:41:52 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:41:52 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:41:52 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:41:52 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:41:52 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:41:52 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:41:52 +0000 DEBUG:mod_corporate_donations_per_donor_None_mod_corporate_donations_per_donorCorporate Donation per DonorNone_group_entity_select: Donor
2026-01-30 17:41:52 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:41:52 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:41:52 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:41:52 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:41:53 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:41:53 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:41:53 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:41:53 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:41:53 +0000 DEBUG:date_range_mod_corporate_donations_per_donor_mod_corporate_donations_per_donorCorporate Donation per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:41:53 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:41:53 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:41:53 +0000 DEBUG:selected_entity_name: All
2026-01-30 17:41:53 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:41:53 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:41:53 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:41:53 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:41:53 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:41:53 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:41:53 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:41:53 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:41:53 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:41:53 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:41:53 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:41:53 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:41:53 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:41:53 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:41:53 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:41:53 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:41:53 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:41:53 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:41:53 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:41:53 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:41:53 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:41:53 +0000 DEBUG:menu_selection: {'title': 'Sponsorships', 'function': <function mod_sponsorships at 0x000001C18D437370>}
2026-01-30 17:41:53 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:41:53 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:41:53 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:41:53 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:41:53 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:41:53 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:41:53 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:41:53 +0000 INFO:Session state Setup complete
2026-01-30 17:41:53 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:41:53 +0000 INFO:Package setup complete
2026-01-30 17:41:53 +0000 INFO:setup_package executed successfully
2026-01-30 17:41:53 +0000 INFO:Setup completed successfully.
2026-01-30 17:41:53 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:41:53 +0000 INFO:Running first load function.
2026-01-30 17:41:53 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:41:53 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:41:53 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:41:53 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:41:53 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:41:53 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:41:53 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:41:53 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:41:53 +0000 INFO:firstload executed successfully
2026-01-30 17:41:53 +0000 INFO:Data first load completed successfully.
2026-01-30 17:41:53 +0000 INFO:initialise_data executed successfully
2026-01-30 17:41:53 +0000 INFO:Running Menu setup...
2026-01-30 17:41:53 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:41:53 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:41:53 +0000 INFO:get_git_version executed successfully
2026-01-30 17:41:53 +0000 INFO:App Version: v50.239
2026-01-30 17:41:53 +0000 INFO:Switched to page: Sponsorships
2026-01-30 17:41:53 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:41:53 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:41:53 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:41:53 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:41:53 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:41:53 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:41:53 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:41:53 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:41:53 +0000 DEBUG:Page texts: {}
2026-01-30 17:41:53 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:41:53 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:41:53 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:41:53 +0000 INFO:display_data_page executed successfully
2026-01-30 17:41:53 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:41:53 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:41:53 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:41:53 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:41:53 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:41:53 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:41:53 +0000 DEBUG:Page texts: {}
2026-01-30 17:41:53 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:41:53 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:41:53 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:41:53 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:41:53 +0000 INFO:pagesetup executed successfully
2026-01-30 17:41:53 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:41:53 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:41:57 +0000 INFO:Streamlit App Starting...
2026-01-30 17:41:57 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:41:57 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:41:57 +0000 INFO:Running App setup...
2026-01-30 17:41:57 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:41:57 +0000 INFO:Setting up the package
2026-01-30 17:41:57 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:41:57 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:41:57 +0000 INFO:get_git_version executed successfully
2026-01-30 17:41:57 +0000 INFO:Version: v50.201
2026-01-30 17:41:57 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:41:57 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:41:57 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:security already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:directories already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:41:57 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:41:57 +0000 INFO:Session_state variables initialized
2026-01-30 17:41:57 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:41:57 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:41:57 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:41:57 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:41:57 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:41:57 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:41:57 +0000 DEBUG:date_range_mod_sponsorships_per_donor_mod_sponsorships_per_donorSponsorships per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:41:57 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:41:57 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:41:57 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:41:57 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:41:57 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:41:57 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:41:57 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:41:57 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:41:57 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:41:57 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:41:57 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:41:57 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:41:57 +0000 DEBUG:selected_entity_name: All
2026-01-30 17:41:57 +0000 DEBUG:mod_sponsorships_per_donor_None_mod_sponsorships_per_donorSponsorships per DonorNone_group_entity_select: Donor
2026-01-30 17:41:57 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:41:57 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:41:57 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:41:57 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:41:57 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:41:57 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:41:57 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:41:57 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:41:57 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:41:57 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:41:57 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:41:57 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:41:57 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:41:57 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:41:57 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:41:57 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:41:57 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:41:57 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:41:57 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:41:57 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:41:57 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:41:57 +0000 DEBUG:menu_selection: {'title': 'Paid Visits', 'function': <function mod_visits at 0x000001C18D4365F0>}
2026-01-30 17:41:57 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:41:57 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:41:57 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:41:57 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:41:57 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:41:57 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:41:57 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:41:57 +0000 INFO:Session state Setup complete
2026-01-30 17:41:57 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:41:57 +0000 INFO:Package setup complete
2026-01-30 17:41:57 +0000 INFO:setup_package executed successfully
2026-01-30 17:41:57 +0000 INFO:Setup completed successfully.
2026-01-30 17:41:57 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:41:57 +0000 INFO:Running first load function.
2026-01-30 17:41:57 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:41:57 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:41:57 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:41:57 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:41:57 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:41:57 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:41:57 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:41:57 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:41:57 +0000 INFO:firstload executed successfully
2026-01-30 17:41:57 +0000 INFO:Data first load completed successfully.
2026-01-30 17:41:57 +0000 INFO:initialise_data executed successfully
2026-01-30 17:41:57 +0000 INFO:Running Menu setup...
2026-01-30 17:41:57 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:41:57 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:41:57 +0000 INFO:get_git_version executed successfully
2026-01-30 17:41:57 +0000 INFO:App Version: v50.239
2026-01-30 17:41:57 +0000 INFO:Switched to page: Paid Visits
2026-01-30 17:41:57 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:41:57 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:41:57 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:41:57 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:41:57 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:41:57 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:41:57 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:41:57 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:41:57 +0000 DEBUG:Page texts: {}
2026-01-30 17:41:57 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:41:57 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:41:57 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:41:57 +0000 INFO:display_data_page executed successfully
2026-01-30 17:41:57 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:41:58 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:41:58 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:41:58 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:41:58 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:41:58 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:41:58 +0000 DEBUG:Page texts: {}
2026-01-30 17:41:58 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:41:58 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:41:58 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:41:58 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:41:58 +0000 INFO:pagesetup executed successfully
2026-01-30 17:41:58 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:41:58 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:41:59 +0000 INFO:Streamlit App Starting...
2026-01-30 17:41:59 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:41:59 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:41:59 +0000 INFO:Running App setup...
2026-01-30 17:41:59 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:41:59 +0000 INFO:Setting up the package
2026-01-30 17:41:59 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:41:59 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:41:59 +0000 INFO:get_git_version executed successfully
2026-01-30 17:41:59 +0000 INFO:Version: v50.201
2026-01-30 17:41:59 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:41:59 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:41:59 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:security already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:directories already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:41:59 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:41:59 +0000 INFO:Session_state variables initialized
2026-01-30 17:41:59 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:41:59 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:41:59 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:41:59 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:41:59 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:41:59 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:41:59 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:41:59 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:41:59 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:41:59 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:41:59 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:41:59 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:41:59 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:41:59 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:41:59 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:41:59 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:41:59 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:41:59 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:41:59 +0000 DEBUG:selected_entity_name: All
2026-01-30 17:41:59 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:41:59 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:41:59 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:41:59 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:41:59 +0000 DEBUG:mod_visits_per_donor_None_mod_visits_per_donorDonated Visits per DonorNone_group_entity_select: Donor
2026-01-30 17:41:59 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:41:59 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:41:59 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:41:59 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:41:59 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:41:59 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:41:59 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:41:59 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:41:59 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:41:59 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:41:59 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:41:59 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:41:59 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:41:59 +0000 DEBUG:date_range_mod_visits_per_donor_mod_visits_per_donorDonated Visits per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:41:59 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:41:59 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:41:59 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:41:59 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:41:59 +0000 DEBUG:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors at 0x000001C18D437760>}
2026-01-30 17:41:59 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:41:59 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:41:59 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:41:59 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:41:59 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:41:59 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:41:59 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:41:59 +0000 INFO:Session state Setup complete
2026-01-30 17:41:59 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:41:59 +0000 INFO:Package setup complete
2026-01-30 17:41:59 +0000 INFO:setup_package executed successfully
2026-01-30 17:41:59 +0000 INFO:Setup completed successfully.
2026-01-30 17:41:59 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:41:59 +0000 INFO:Running first load function.
2026-01-30 17:41:59 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:41:59 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:41:59 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:41:59 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:41:59 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:41:59 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:41:59 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:41:59 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:41:59 +0000 INFO:firstload executed successfully
2026-01-30 17:41:59 +0000 INFO:Data first load completed successfully.
2026-01-30 17:41:59 +0000 INFO:initialise_data executed successfully
2026-01-30 17:41:59 +0000 INFO:Running Menu setup...
2026-01-30 17:41:59 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:41:59 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:41:59 +0000 INFO:get_git_version executed successfully
2026-01-30 17:41:59 +0000 INFO:App Version: v50.239
2026-01-30 17:41:59 +0000 INFO:Switched to page: Dubious Donors
2026-01-30 17:41:59 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:41:59 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:41:59 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:41:59 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:41:59 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:41:59 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:41:59 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:41:59 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:41:59 +0000 DEBUG:Page texts: {}
2026-01-30 17:41:59 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:41:59 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:41:59 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:41:59 +0000 INFO:display_data_page executed successfully
2026-01-30 17:41:59 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:42:00 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:42:00 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:42:00 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:42:00 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:42:00 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:42:00 +0000 DEBUG:Page texts: {}
2026-01-30 17:42:00 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:42:00 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:42:00 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:42:00 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:42:00 +0000 INFO:pagesetup executed successfully
2026-01-30 17:42:00 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:42:00 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:42:09 +0000 INFO:Streamlit App Starting...
2026-01-30 17:42:09 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:42:09 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:42:09 +0000 INFO:Running App setup...
2026-01-30 17:42:09 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:42:09 +0000 INFO:Setting up the package
2026-01-30 17:42:09 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:42:09 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:42:09 +0000 INFO:get_git_version executed successfully
2026-01-30 17:42:09 +0000 INFO:Version: v50.201
2026-01-30 17:42:09 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:42:09 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:42:09 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:security already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:directories already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:42:09 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:42:09 +0000 INFO:Session_state variables initialized
2026-01-30 17:42:09 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:42:09 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:42:09 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:42:09 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:42:09 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:42:09 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:42:09 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:42:09 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:42:09 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:42:09 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:42:09 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:42:09 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:42:09 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:42:09 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:42:09 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:42:09 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:42:09 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:42:09 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:42:09 +0000 DEBUG:selected_entity_name: All
2026-01-30 17:42:09 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:42:09 +0000 DEBUG:mod_dubious_donors_per_entity_None_mod_dubious_donors_per_entityDubious Donors per EntityNone_group_entity_select: Parliament Election Year
2026-01-30 17:42:09 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:42:09 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:42:09 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:42:09 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:42:09 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:42:09 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:42:09 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:42:09 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:42:09 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:42:09 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:42:09 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:42:09 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:42:09 +0000 DEBUG:date_range_mod_dubious_donors_per_entity_mod_dubious_donors_per_entityDubious Donors per EntityNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:42:09 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:42:09 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:42:09 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:42:09 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:42:09 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:42:09 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:42:09 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:42:09 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:42:09 +0000 DEBUG:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors at 0x000001C18D437760>}
2026-01-30 17:42:09 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:42:09 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:42:09 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:42:09 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:42:09 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:42:09 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:42:09 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:42:09 +0000 INFO:Session state Setup complete
2026-01-30 17:42:09 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:42:09 +0000 INFO:Package setup complete
2026-01-30 17:42:09 +0000 INFO:setup_package executed successfully
2026-01-30 17:42:09 +0000 INFO:Setup completed successfully.
2026-01-30 17:42:09 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:42:09 +0000 INFO:Running first load function.
2026-01-30 17:42:09 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:42:09 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:42:09 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:42:09 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:42:09 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:42:09 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:42:09 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:42:09 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:42:09 +0000 INFO:firstload executed successfully
2026-01-30 17:42:09 +0000 INFO:Data first load completed successfully.
2026-01-30 17:42:09 +0000 INFO:initialise_data executed successfully
2026-01-30 17:42:09 +0000 INFO:Running Menu setup...
2026-01-30 17:42:09 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:42:09 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:42:09 +0000 INFO:get_git_version executed successfully
2026-01-30 17:42:09 +0000 INFO:App Version: v50.239
2026-01-30 17:42:09 +0000 INFO:Switched to page: Dubious Donors
2026-01-30 17:42:09 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:42:09 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:42:09 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:42:09 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:42:09 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:42:09 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:42:09 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:42:09 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:42:09 +0000 DEBUG:Page texts: {}
2026-01-30 17:42:09 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:42:09 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:42:09 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:42:09 +0000 INFO:display_data_page executed successfully
2026-01-30 17:42:09 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:42:09 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:42:10 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:42:10 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:42:10 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:42:10 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:42:10 +0000 DEBUG:Page texts: {}
2026-01-30 17:42:10 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:42:10 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:42:10 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:42:10 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:42:10 +0000 INFO:pagesetup executed successfully
2026-01-30 17:42:10 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:42:10 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:42:12 +0000 INFO:Streamlit App Starting...
2026-01-30 17:42:12 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:42:12 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:42:12 +0000 INFO:Running App setup...
2026-01-30 17:42:12 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:42:12 +0000 INFO:Setting up the package
2026-01-30 17:42:12 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:42:12 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:42:12 +0000 INFO:get_git_version executed successfully
2026-01-30 17:42:12 +0000 INFO:Version: v50.201
2026-01-30 17:42:12 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:42:12 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:42:12 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:security already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:directories already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:42:12 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:42:12 +0000 INFO:Session_state variables initialized
2026-01-30 17:42:12 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:42:12 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:42:12 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:42:12 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:42:12 +0000 DEBUG:selected_entity_name: 2017
2026-01-30 17:42:12 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:42:12 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:42:12 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:42:12 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:42:12 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:42:12 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:42:12 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:42:12 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:42:12 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:42:12 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:42:12 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:42:12 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:42:12 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:42:12 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:42:12 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:42:12 +0000 DEBUG:mod_dubious_donors_per_entity_None_mod_dubious_donors_per_entityDubious Donors per EntityNone_group_entity_select: Parliament Election Year
2026-01-30 17:42:12 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:42:12 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:42:12 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:42:12 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:42:12 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:42:12 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:42:12 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:42:12 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:42:12 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:42:12 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:42:12 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:42:12 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:42:12 +0000 DEBUG:date_range_mod_dubious_donors_per_entity_mod_dubious_donors_per_entityDubious Donors per EntityNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:42:12 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:42:12 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:42:12 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:42:12 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:42:12 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:42:12 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:42:12 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:42:12 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:42:12 +0000 DEBUG:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors at 0x000001C18D437760>}
2026-01-30 17:42:12 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:42:12 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:42:12 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:42:12 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:42:13 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:42:13 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:42:13 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:42:13 +0000 INFO:Session state Setup complete
2026-01-30 17:42:13 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:42:13 +0000 INFO:Package setup complete
2026-01-30 17:42:13 +0000 INFO:setup_package executed successfully
2026-01-30 17:42:13 +0000 INFO:Setup completed successfully.
2026-01-30 17:42:13 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:42:13 +0000 INFO:Running first load function.
2026-01-30 17:42:13 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:42:13 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:42:13 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:42:13 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:42:13 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:42:13 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:42:13 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:42:13 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:42:13 +0000 INFO:firstload executed successfully
2026-01-30 17:42:13 +0000 INFO:Data first load completed successfully.
2026-01-30 17:42:13 +0000 INFO:initialise_data executed successfully
2026-01-30 17:42:13 +0000 INFO:Running Menu setup...
2026-01-30 17:42:13 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:42:13 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:42:13 +0000 INFO:get_git_version executed successfully
2026-01-30 17:42:13 +0000 INFO:App Version: v50.239
2026-01-30 17:42:13 +0000 INFO:Switched to page: Dubious Donors
2026-01-30 17:42:13 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:42:13 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:42:13 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:42:13 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:42:13 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:42:13 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:42:13 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:42:13 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:42:13 +0000 DEBUG:Page texts: {}
2026-01-30 17:42:13 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:42:13 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:42:13 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:42:13 +0000 INFO:display_data_page executed successfully
2026-01-30 17:42:13 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:42:13 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:42:13 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:42:13 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:42:13 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:42:13 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:42:13 +0000 DEBUG:Page texts: {}
2026-01-30 17:42:13 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:42:13 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:42:13 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:42:13 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:42:13 +0000 INFO:pagesetup executed successfully
2026-01-30 17:42:13 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:42:13 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:42:16 +0000 INFO:Streamlit App Starting...
2026-01-30 17:42:16 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:42:16 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:42:16 +0000 INFO:Running App setup...
2026-01-30 17:42:16 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:42:16 +0000 INFO:Setting up the package
2026-01-30 17:42:16 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:42:16 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:42:16 +0000 INFO:get_git_version executed successfully
2026-01-30 17:42:16 +0000 INFO:Version: v50.201
2026-01-30 17:42:16 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:42:16 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:42:16 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:security already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:directories already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:42:16 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:42:16 +0000 INFO:Session_state variables initialized
2026-01-30 17:42:16 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:42:16 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:42:16 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:42:16 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:42:16 +0000 DEBUG:selected_entity_name: 2019
2026-01-30 17:42:16 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:42:16 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:42:16 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:42:16 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:42:16 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:42:16 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:42:16 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:42:16 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:42:17 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:42:17 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:42:17 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:42:17 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:42:17 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:42:17 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:42:17 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:42:17 +0000 DEBUG:mod_dubious_donors_per_entity_None_mod_dubious_donors_per_entityDubious Donors per EntityNone_group_entity_select: Parliament Election Year
2026-01-30 17:42:17 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:42:17 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:42:17 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:42:17 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:42:17 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:42:17 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:42:17 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:42:17 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:42:17 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:42:17 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:42:17 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:42:17 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:42:17 +0000 DEBUG:date_range_mod_dubious_donors_per_entity_mod_dubious_donors_per_entityDubious Donors per EntityNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:42:17 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:42:17 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:42:17 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:42:17 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:42:17 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:42:17 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:42:17 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:42:17 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:42:17 +0000 DEBUG:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors at 0x000001C18D437760>}
2026-01-30 17:42:17 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:42:17 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:42:17 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:42:17 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:42:17 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:42:17 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:42:17 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:42:17 +0000 INFO:Session state Setup complete
2026-01-30 17:42:17 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:42:17 +0000 INFO:Package setup complete
2026-01-30 17:42:17 +0000 INFO:setup_package executed successfully
2026-01-30 17:42:17 +0000 INFO:Setup completed successfully.
2026-01-30 17:42:17 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:42:17 +0000 INFO:Running first load function.
2026-01-30 17:42:17 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:42:17 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:42:17 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:42:17 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:42:17 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:42:17 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:42:17 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:42:17 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:42:17 +0000 INFO:firstload executed successfully
2026-01-30 17:42:17 +0000 INFO:Data first load completed successfully.
2026-01-30 17:42:17 +0000 INFO:initialise_data executed successfully
2026-01-30 17:42:17 +0000 INFO:Running Menu setup...
2026-01-30 17:42:17 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:42:17 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:42:17 +0000 INFO:get_git_version executed successfully
2026-01-30 17:42:17 +0000 INFO:App Version: v50.239
2026-01-30 17:42:17 +0000 INFO:Switched to page: Dubious Donors
2026-01-30 17:42:17 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:42:17 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:42:17 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:42:17 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:42:17 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:42:17 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:42:17 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:42:17 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:42:17 +0000 DEBUG:Page texts: {}
2026-01-30 17:42:17 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:42:17 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:42:17 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:42:17 +0000 INFO:display_data_page executed successfully
2026-01-30 17:42:17 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:42:17 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:42:17 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:42:17 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:42:17 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:42:17 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:42:17 +0000 DEBUG:Page texts: {}
2026-01-30 17:42:17 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:42:17 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:42:17 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:42:17 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:42:17 +0000 INFO:pagesetup executed successfully
2026-01-30 17:42:17 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:42:17 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:42:24 +0000 INFO:Streamlit App Starting...
2026-01-30 17:42:24 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:42:24 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:42:24 +0000 INFO:Running App setup...
2026-01-30 17:42:24 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:42:24 +0000 INFO:Setting up the package
2026-01-30 17:42:24 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:42:24 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:42:24 +0000 INFO:get_git_version executed successfully
2026-01-30 17:42:24 +0000 INFO:Version: v50.201
2026-01-30 17:42:24 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:42:24 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:42:24 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:security already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:directories already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:42:24 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:42:24 +0000 INFO:Session_state variables initialized
2026-01-30 17:42:24 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:42:24 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:42:24 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:42:24 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:42:24 +0000 DEBUG:selected_entity_name: 2024
2026-01-30 17:42:24 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:42:24 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:42:24 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:42:24 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:42:24 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:42:24 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:42:24 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:42:24 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:42:24 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:42:24 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:42:24 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:42:24 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:42:24 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:42:24 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:42:24 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:42:24 +0000 DEBUG:mod_dubious_donors_per_entity_None_mod_dubious_donors_per_entityDubious Donors per EntityNone_group_entity_select: Parliament Election Year
2026-01-30 17:42:24 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:42:24 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:42:24 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:42:24 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:42:24 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:42:24 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:42:24 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:42:24 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:42:24 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:42:24 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:42:24 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:42:24 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:42:24 +0000 DEBUG:date_range_mod_dubious_donors_per_entity_mod_dubious_donors_per_entityDubious Donors per EntityNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:42:24 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:42:24 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:42:24 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:42:24 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:42:24 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:42:24 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:42:24 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:42:24 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:42:24 +0000 DEBUG:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors at 0x000001C18D437760>}
2026-01-30 17:42:24 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:42:24 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:42:24 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:42:24 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:42:24 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:42:24 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:42:24 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:42:24 +0000 INFO:Session state Setup complete
2026-01-30 17:42:24 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:42:24 +0000 INFO:Package setup complete
2026-01-30 17:42:24 +0000 INFO:setup_package executed successfully
2026-01-30 17:42:24 +0000 INFO:Setup completed successfully.
2026-01-30 17:42:24 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:42:24 +0000 INFO:Running first load function.
2026-01-30 17:42:24 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:42:24 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:42:24 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:42:24 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:42:24 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:42:24 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:42:24 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:42:24 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:42:24 +0000 INFO:firstload executed successfully
2026-01-30 17:42:24 +0000 INFO:Data first load completed successfully.
2026-01-30 17:42:24 +0000 INFO:initialise_data executed successfully
2026-01-30 17:42:24 +0000 INFO:Running Menu setup...
2026-01-30 17:42:24 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:42:24 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:42:24 +0000 INFO:get_git_version executed successfully
2026-01-30 17:42:24 +0000 INFO:App Version: v50.239
2026-01-30 17:42:24 +0000 INFO:Switched to page: Dubious Donors
2026-01-30 17:42:24 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:42:24 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:42:24 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:42:24 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:42:24 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:42:24 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:42:24 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:42:24 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:42:24 +0000 DEBUG:Page texts: {}
2026-01-30 17:42:24 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:42:24 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:42:24 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:42:24 +0000 INFO:display_data_page executed successfully
2026-01-30 17:42:24 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:42:25 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:42:25 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:42:25 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:42:25 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:42:25 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:42:25 +0000 DEBUG:Page texts: {}
2026-01-30 17:42:25 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:42:25 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:42:25 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:42:25 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:42:25 +0000 INFO:pagesetup executed successfully
2026-01-30 17:42:25 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:42:25 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:42:27 +0000 INFO:Streamlit App Starting...
2026-01-30 17:42:27 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:42:27 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:42:27 +0000 INFO:Running App setup...
2026-01-30 17:42:27 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:42:27 +0000 INFO:Setting up the package
2026-01-30 17:42:27 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:42:27 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:42:27 +0000 INFO:get_git_version executed successfully
2026-01-30 17:42:27 +0000 INFO:Version: v50.201
2026-01-30 17:42:27 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:42:27 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:42:27 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:security already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:directories already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:42:27 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:42:27 +0000 INFO:Session_state variables initialized
2026-01-30 17:42:27 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:42:27 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:42:27 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:42:27 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:42:27 +0000 DEBUG:selected_entity_name: 1997
2026-01-30 17:42:27 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:42:27 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:42:27 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:42:27 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:42:27 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:42:27 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:42:27 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:42:27 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:42:28 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:42:28 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:42:28 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:42:28 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:42:28 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:42:28 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:42:28 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:42:28 +0000 DEBUG:mod_dubious_donors_per_entity_None_mod_dubious_donors_per_entityDubious Donors per EntityNone_group_entity_select: Parliament Election Year
2026-01-30 17:42:28 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:42:28 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:42:28 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:42:28 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:42:28 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:42:28 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:42:28 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:42:28 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:42:28 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:42:28 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:42:28 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:42:28 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:42:28 +0000 DEBUG:date_range_mod_dubious_donors_per_entity_mod_dubious_donors_per_entityDubious Donors per EntityNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:42:28 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:42:28 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:42:28 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:42:28 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:42:28 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:42:28 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:42:28 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:42:28 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:42:28 +0000 DEBUG:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors at 0x000001C18D437760>}
2026-01-30 17:42:28 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:42:28 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:42:28 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:42:28 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:42:28 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:42:28 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:42:28 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:42:28 +0000 INFO:Session state Setup complete
2026-01-30 17:42:28 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:42:28 +0000 INFO:Package setup complete
2026-01-30 17:42:28 +0000 INFO:setup_package executed successfully
2026-01-30 17:42:28 +0000 INFO:Setup completed successfully.
2026-01-30 17:42:28 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:42:28 +0000 INFO:Running first load function.
2026-01-30 17:42:28 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:42:28 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:42:28 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:42:28 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:42:28 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:42:28 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:42:28 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:42:28 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:42:28 +0000 INFO:firstload executed successfully
2026-01-30 17:42:28 +0000 INFO:Data first load completed successfully.
2026-01-30 17:42:28 +0000 INFO:initialise_data executed successfully
2026-01-30 17:42:28 +0000 INFO:Running Menu setup...
2026-01-30 17:42:28 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:42:28 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:42:28 +0000 INFO:get_git_version executed successfully
2026-01-30 17:42:28 +0000 INFO:App Version: v50.239
2026-01-30 17:42:28 +0000 INFO:Switched to page: Dubious Donors
2026-01-30 17:42:28 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:42:28 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:42:28 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:42:28 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:42:28 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:42:28 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:42:28 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:42:28 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:42:28 +0000 DEBUG:Page texts: {}
2026-01-30 17:42:28 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:42:28 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:42:28 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:42:28 +0000 INFO:display_data_page executed successfully
2026-01-30 17:42:28 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:42:28 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:42:28 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:42:28 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:42:28 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:42:28 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:42:28 +0000 DEBUG:Page texts: {}
2026-01-30 17:42:28 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:42:28 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:42:28 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:42:28 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:42:28 +0000 INFO:pagesetup executed successfully
2026-01-30 17:42:28 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:42:28 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:42:31 +0000 INFO:Streamlit App Starting...
2026-01-30 17:42:31 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:42:31 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:42:31 +0000 INFO:Running App setup...
2026-01-30 17:42:31 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:42:31 +0000 INFO:Setting up the package
2026-01-30 17:42:31 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:42:31 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:42:31 +0000 INFO:get_git_version executed successfully
2026-01-30 17:42:31 +0000 INFO:Version: v50.201
2026-01-30 17:42:31 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:42:31 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:42:31 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:security already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:directories already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:42:31 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:42:31 +0000 INFO:Session_state variables initialized
2026-01-30 17:42:31 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:42:31 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:42:31 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:42:31 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:42:31 +0000 DEBUG:selected_entity_name: 2010
2026-01-30 17:42:31 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:42:31 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:42:31 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:42:31 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:42:31 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:42:31 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:42:31 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:42:31 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:42:31 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:42:31 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:42:31 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:42:31 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:42:31 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:42:31 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:42:31 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:42:31 +0000 DEBUG:mod_dubious_donors_per_entity_None_mod_dubious_donors_per_entityDubious Donors per EntityNone_group_entity_select: Parliament Election Year
2026-01-30 17:42:31 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:42:31 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:42:31 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:42:31 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:42:31 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:42:31 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:42:31 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:42:31 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:42:31 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:42:31 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:42:31 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:42:31 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:42:31 +0000 DEBUG:date_range_mod_dubious_donors_per_entity_mod_dubious_donors_per_entityDubious Donors per EntityNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:42:31 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:42:31 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:42:31 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:42:31 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:42:31 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:42:31 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:42:31 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:42:31 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:42:31 +0000 DEBUG:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors at 0x000001C18D437760>}
2026-01-30 17:42:31 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:42:31 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:42:31 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:42:31 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:42:31 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:42:31 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:42:31 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:42:31 +0000 INFO:Session state Setup complete
2026-01-30 17:42:31 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:42:31 +0000 INFO:Package setup complete
2026-01-30 17:42:31 +0000 INFO:setup_package executed successfully
2026-01-30 17:42:31 +0000 INFO:Setup completed successfully.
2026-01-30 17:42:31 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:42:31 +0000 INFO:Running first load function.
2026-01-30 17:42:31 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:42:31 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:42:31 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:42:31 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:42:31 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:42:31 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:42:31 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:42:31 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:42:31 +0000 INFO:firstload executed successfully
2026-01-30 17:42:31 +0000 INFO:Data first load completed successfully.
2026-01-30 17:42:31 +0000 INFO:initialise_data executed successfully
2026-01-30 17:42:31 +0000 INFO:Running Menu setup...
2026-01-30 17:42:31 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:42:31 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:42:31 +0000 INFO:get_git_version executed successfully
2026-01-30 17:42:31 +0000 INFO:App Version: v50.239
2026-01-30 17:42:31 +0000 INFO:Switched to page: Dubious Donors
2026-01-30 17:42:31 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:42:31 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:42:31 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:42:31 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:42:31 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:42:31 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:42:31 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:42:31 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:42:31 +0000 DEBUG:Page texts: {}
2026-01-30 17:42:31 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:42:31 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:42:32 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:42:32 +0000 INFO:display_data_page executed successfully
2026-01-30 17:42:32 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:42:32 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:42:32 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:42:32 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:42:32 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:42:32 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:42:32 +0000 DEBUG:Page texts: {}
2026-01-30 17:42:32 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:42:32 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:42:32 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:42:32 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:42:32 +0000 INFO:pagesetup executed successfully
2026-01-30 17:42:32 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:42:32 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:42:48 +0000 INFO:Streamlit App Starting...
2026-01-30 17:42:48 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:42:48 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:42:48 +0000 INFO:Running App setup...
2026-01-30 17:42:48 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:42:48 +0000 INFO:Setting up the package
2026-01-30 17:42:48 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:42:48 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:42:48 +0000 INFO:get_git_version executed successfully
2026-01-30 17:42:48 +0000 INFO:Version: v50.201
2026-01-30 17:42:48 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:42:48 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:42:48 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:security already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:directories already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:42:48 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:42:48 +0000 INFO:Session_state variables initialized
2026-01-30 17:42:48 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:42:48 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:42:48 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:42:48 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:42:48 +0000 DEBUG:selected_entity_name: 2024
2026-01-30 17:42:48 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:42:48 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:42:48 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:42:48 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:42:48 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:42:48 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:42:48 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:42:48 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:42:48 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:42:48 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:42:48 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:42:48 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:42:48 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:42:48 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:42:48 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:42:48 +0000 DEBUG:mod_dubious_donors_per_entity_None_mod_dubious_donors_per_entityDubious Donors per EntityNone_group_entity_select: Parliament Election Year
2026-01-30 17:42:48 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:42:48 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:42:48 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:42:48 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:42:48 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:42:48 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:42:48 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:42:48 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:42:48 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:42:48 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:42:48 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:42:48 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:42:48 +0000 DEBUG:date_range_mod_dubious_donors_per_entity_mod_dubious_donors_per_entityDubious Donors per EntityNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:42:48 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:42:48 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:42:48 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:42:48 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:42:48 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:42:48 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:42:48 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:42:48 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:42:48 +0000 DEBUG:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors at 0x000001C18D437760>}
2026-01-30 17:42:48 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:42:48 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:42:48 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:42:48 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:42:48 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:42:48 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:42:48 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:42:48 +0000 INFO:Session state Setup complete
2026-01-30 17:42:48 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:42:48 +0000 INFO:Package setup complete
2026-01-30 17:42:48 +0000 INFO:setup_package executed successfully
2026-01-30 17:42:48 +0000 INFO:Setup completed successfully.
2026-01-30 17:42:48 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:42:48 +0000 INFO:Running first load function.
2026-01-30 17:42:48 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:42:48 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:42:48 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:42:48 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:42:48 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:42:48 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:42:48 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:42:48 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:42:48 +0000 INFO:firstload executed successfully
2026-01-30 17:42:48 +0000 INFO:Data first load completed successfully.
2026-01-30 17:42:48 +0000 INFO:initialise_data executed successfully
2026-01-30 17:42:48 +0000 INFO:Running Menu setup...
2026-01-30 17:42:48 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:42:48 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:42:48 +0000 INFO:get_git_version executed successfully
2026-01-30 17:42:48 +0000 INFO:App Version: v50.239
2026-01-30 17:42:48 +0000 INFO:Switched to page: Dubious Donors
2026-01-30 17:42:48 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:42:48 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:42:48 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:42:48 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:42:48 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:42:48 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:42:48 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:42:48 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:42:48 +0000 DEBUG:Page texts: {}
2026-01-30 17:42:48 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:42:48 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:42:48 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:42:48 +0000 INFO:display_data_page executed successfully
2026-01-30 17:42:48 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:42:48 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:42:48 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:42:48 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:42:48 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:42:48 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:42:48 +0000 DEBUG:Page texts: {}
2026-01-30 17:42:48 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:42:48 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:42:49 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:42:49 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:42:49 +0000 INFO:pagesetup executed successfully
2026-01-30 17:42:49 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:42:49 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:42:54 +0000 INFO:Streamlit App Starting...
2026-01-30 17:42:54 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:42:54 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:42:54 +0000 INFO:Running App setup...
2026-01-30 17:42:54 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:42:54 +0000 INFO:Setting up the package
2026-01-30 17:42:54 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:42:54 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:42:54 +0000 INFO:get_git_version executed successfully
2026-01-30 17:42:54 +0000 INFO:Version: v50.201
2026-01-30 17:42:54 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:42:54 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:42:54 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:security already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:directories already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:42:54 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:42:54 +0000 INFO:Session_state variables initialized
2026-01-30 17:42:54 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:42:54 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:42:54 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:42:54 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:42:54 +0000 DEBUG:selected_entity_name: 2019
2026-01-30 17:42:54 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:42:54 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:42:54 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:42:54 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:42:54 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:42:54 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:42:54 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:42:54 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:42:54 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:42:54 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:42:54 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:42:54 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:42:54 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:42:54 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:42:54 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:42:54 +0000 DEBUG:mod_dubious_donors_per_entity_None_mod_dubious_donors_per_entityDubious Donors per EntityNone_group_entity_select: Parliament Election Year
2026-01-30 17:42:54 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:42:54 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:42:54 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:42:54 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:42:54 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:42:54 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:42:54 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:42:54 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:42:54 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:42:54 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:42:54 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:42:54 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:42:54 +0000 DEBUG:date_range_mod_dubious_donors_per_entity_mod_dubious_donors_per_entityDubious Donors per EntityNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:42:54 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:42:54 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:42:54 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:42:54 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:42:54 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:42:54 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:42:54 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:42:54 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:42:54 +0000 DEBUG:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors at 0x000001C18D437760>}
2026-01-30 17:42:54 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:42:54 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:42:54 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:42:54 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:42:54 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:42:54 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:42:54 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:42:54 +0000 INFO:Session state Setup complete
2026-01-30 17:42:54 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:42:54 +0000 INFO:Package setup complete
2026-01-30 17:42:54 +0000 INFO:setup_package executed successfully
2026-01-30 17:42:54 +0000 INFO:Setup completed successfully.
2026-01-30 17:42:54 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:42:54 +0000 INFO:Running first load function.
2026-01-30 17:42:54 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:42:54 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:42:54 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:42:54 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:42:54 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:42:54 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:42:54 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:42:54 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:42:54 +0000 INFO:firstload executed successfully
2026-01-30 17:42:54 +0000 INFO:Data first load completed successfully.
2026-01-30 17:42:54 +0000 INFO:initialise_data executed successfully
2026-01-30 17:42:54 +0000 INFO:Running Menu setup...
2026-01-30 17:42:54 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:42:54 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:42:54 +0000 INFO:get_git_version executed successfully
2026-01-30 17:42:54 +0000 INFO:App Version: v50.239
2026-01-30 17:42:54 +0000 INFO:Switched to page: Dubious Donors
2026-01-30 17:42:54 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:42:54 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:42:54 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:42:54 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:42:54 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:42:54 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:42:54 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:42:54 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:42:54 +0000 DEBUG:Page texts: {}
2026-01-30 17:42:54 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:42:54 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:42:55 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:42:55 +0000 INFO:display_data_page executed successfully
2026-01-30 17:42:55 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:42:55 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:42:55 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:42:55 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:42:55 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:42:55 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:42:55 +0000 DEBUG:Page texts: {}
2026-01-30 17:42:55 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:42:55 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:42:55 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:42:55 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:42:55 +0000 INFO:pagesetup executed successfully
2026-01-30 17:42:55 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:42:55 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:42:57 +0000 INFO:Streamlit App Starting...
2026-01-30 17:42:57 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:42:57 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:42:57 +0000 INFO:Running App setup...
2026-01-30 17:42:57 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:42:57 +0000 INFO:Setting up the package
2026-01-30 17:42:57 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:42:57 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:42:57 +0000 INFO:get_git_version executed successfully
2026-01-30 17:42:57 +0000 INFO:Version: v50.201
2026-01-30 17:42:57 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:42:57 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:42:57 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:security already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:directories already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:42:57 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:42:57 +0000 INFO:Session_state variables initialized
2026-01-30 17:42:57 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:42:57 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:42:57 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:42:57 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:42:57 +0000 DEBUG:selected_entity_name: 2015
2026-01-30 17:42:57 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:42:57 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:42:57 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:42:57 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:42:57 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:42:57 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:42:57 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:42:57 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:42:57 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:42:58 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:42:58 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:42:58 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:42:58 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:42:58 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:42:58 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:42:58 +0000 DEBUG:mod_dubious_donors_per_entity_None_mod_dubious_donors_per_entityDubious Donors per EntityNone_group_entity_select: Parliament Election Year
2026-01-30 17:42:58 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:42:58 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:42:58 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:42:58 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:42:58 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:42:58 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:42:58 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:42:58 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:42:58 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:42:58 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:42:58 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:42:58 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:42:58 +0000 DEBUG:date_range_mod_dubious_donors_per_entity_mod_dubious_donors_per_entityDubious Donors per EntityNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:42:58 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:42:58 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:42:58 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:42:58 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:42:58 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:42:58 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:42:58 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:42:58 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:42:58 +0000 DEBUG:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors at 0x000001C18D437760>}
2026-01-30 17:42:58 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:42:58 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:42:58 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:42:58 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:42:58 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:42:58 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:42:58 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:42:58 +0000 INFO:Session state Setup complete
2026-01-30 17:42:58 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:42:58 +0000 INFO:Package setup complete
2026-01-30 17:42:58 +0000 INFO:setup_package executed successfully
2026-01-30 17:42:58 +0000 INFO:Setup completed successfully.
2026-01-30 17:42:58 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:42:58 +0000 INFO:Running first load function.
2026-01-30 17:42:58 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:42:58 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:42:58 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:42:58 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:42:58 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:42:58 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:42:58 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:42:58 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:42:58 +0000 INFO:firstload executed successfully
2026-01-30 17:42:58 +0000 INFO:Data first load completed successfully.
2026-01-30 17:42:58 +0000 INFO:initialise_data executed successfully
2026-01-30 17:42:58 +0000 INFO:Running Menu setup...
2026-01-30 17:42:58 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:42:58 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:42:58 +0000 INFO:get_git_version executed successfully
2026-01-30 17:42:58 +0000 INFO:App Version: v50.239
2026-01-30 17:42:58 +0000 INFO:Switched to page: Dubious Donors
2026-01-30 17:42:58 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:42:58 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:42:58 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:42:58 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:42:58 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:42:58 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:42:58 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:42:58 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:42:58 +0000 DEBUG:Page texts: {}
2026-01-30 17:42:58 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:42:58 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:42:58 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:42:58 +0000 INFO:display_data_page executed successfully
2026-01-30 17:42:58 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:42:58 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:42:58 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:42:58 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:42:58 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:42:58 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:42:58 +0000 DEBUG:Page texts: {}
2026-01-30 17:42:58 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:42:58 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:42:58 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:42:58 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:42:58 +0000 INFO:pagesetup executed successfully
2026-01-30 17:42:58 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:42:58 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:43:00 +0000 INFO:Streamlit App Starting...
2026-01-30 17:43:00 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:43:00 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:43:00 +0000 INFO:Running App setup...
2026-01-30 17:43:00 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:43:00 +0000 INFO:Setting up the package
2026-01-30 17:43:00 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:43:00 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:43:00 +0000 INFO:get_git_version executed successfully
2026-01-30 17:43:00 +0000 INFO:Version: v50.201
2026-01-30 17:43:00 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:43:00 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:43:00 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:security already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:directories already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:43:00 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:43:00 +0000 INFO:Session_state variables initialized
2026-01-30 17:43:00 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:43:00 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:43:00 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:43:00 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:43:00 +0000 DEBUG:selected_entity_name: 2017
2026-01-30 17:43:00 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:43:00 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:43:00 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:43:00 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:43:00 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:43:00 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:43:00 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:43:00 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:43:00 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:43:00 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:43:00 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:43:00 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:43:00 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:43:00 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:43:00 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:43:00 +0000 DEBUG:mod_dubious_donors_per_entity_None_mod_dubious_donors_per_entityDubious Donors per EntityNone_group_entity_select: Parliament Election Year
2026-01-30 17:43:00 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:43:00 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:43:00 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:43:00 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:43:00 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:43:00 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:43:00 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:43:00 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:43:00 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:43:00 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:43:00 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:43:00 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:43:00 +0000 DEBUG:date_range_mod_dubious_donors_per_entity_mod_dubious_donors_per_entityDubious Donors per EntityNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:43:00 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:43:00 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:43:00 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:43:00 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:43:00 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:43:00 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:43:00 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:43:00 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:43:00 +0000 DEBUG:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors at 0x000001C18D437760>}
2026-01-30 17:43:00 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:43:00 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:43:00 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:43:00 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:43:00 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:43:00 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:43:00 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:43:00 +0000 INFO:Session state Setup complete
2026-01-30 17:43:00 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:43:00 +0000 INFO:Package setup complete
2026-01-30 17:43:00 +0000 INFO:setup_package executed successfully
2026-01-30 17:43:00 +0000 INFO:Setup completed successfully.
2026-01-30 17:43:00 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:43:00 +0000 INFO:Running first load function.
2026-01-30 17:43:00 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:43:00 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:43:00 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:43:00 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:43:00 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:43:00 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:43:00 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:43:00 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:43:00 +0000 INFO:firstload executed successfully
2026-01-30 17:43:00 +0000 INFO:Data first load completed successfully.
2026-01-30 17:43:00 +0000 INFO:initialise_data executed successfully
2026-01-30 17:43:00 +0000 INFO:Running Menu setup...
2026-01-30 17:43:00 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:43:00 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:43:00 +0000 INFO:get_git_version executed successfully
2026-01-30 17:43:00 +0000 INFO:App Version: v50.239
2026-01-30 17:43:00 +0000 INFO:Switched to page: Dubious Donors
2026-01-30 17:43:00 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:43:00 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:43:00 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:43:00 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:43:01 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:43:01 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:43:01 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:43:01 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:43:01 +0000 DEBUG:Page texts: {}
2026-01-30 17:43:01 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:43:01 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:43:01 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:43:01 +0000 INFO:display_data_page executed successfully
2026-01-30 17:43:01 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:43:01 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:43:01 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:43:01 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:43:01 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:43:01 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:43:01 +0000 DEBUG:Page texts: {}
2026-01-30 17:43:01 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:43:01 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:43:01 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:43:01 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:43:01 +0000 INFO:pagesetup executed successfully
2026-01-30 17:43:01 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:43:01 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:43:03 +0000 INFO:Streamlit App Starting...
2026-01-30 17:43:03 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:43:03 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:43:03 +0000 INFO:Running App setup...
2026-01-30 17:43:03 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:43:03 +0000 INFO:Setting up the package
2026-01-30 17:43:03 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:43:03 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:43:03 +0000 INFO:get_git_version executed successfully
2026-01-30 17:43:03 +0000 INFO:Version: v50.201
2026-01-30 17:43:03 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:43:03 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:43:03 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:security already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:directories already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:43:03 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:43:03 +0000 INFO:Session_state variables initialized
2026-01-30 17:43:03 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:43:03 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:43:03 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:43:03 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:43:03 +0000 DEBUG:selected_entity_name: 2010
2026-01-30 17:43:03 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:43:03 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:43:03 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:43:03 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:43:03 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:43:03 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:43:03 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:43:03 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:43:03 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:43:03 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:43:03 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:43:03 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:43:03 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:43:03 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:43:03 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:43:03 +0000 DEBUG:mod_dubious_donors_per_entity_None_mod_dubious_donors_per_entityDubious Donors per EntityNone_group_entity_select: Parliament Election Year
2026-01-30 17:43:03 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:43:03 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:43:03 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:43:03 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:43:03 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:43:03 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:43:03 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:43:03 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:43:03 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:43:03 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:43:03 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:43:03 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:43:03 +0000 DEBUG:date_range_mod_dubious_donors_per_entity_mod_dubious_donors_per_entityDubious Donors per EntityNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:43:03 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:43:03 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:43:03 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:43:03 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:43:03 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:43:03 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:43:03 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:43:03 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:43:03 +0000 DEBUG:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors at 0x000001C18D437760>}
2026-01-30 17:43:03 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:43:03 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:43:03 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:43:03 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:43:03 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:43:03 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:43:03 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:43:03 +0000 INFO:Session state Setup complete
2026-01-30 17:43:03 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:43:03 +0000 INFO:Package setup complete
2026-01-30 17:43:03 +0000 INFO:setup_package executed successfully
2026-01-30 17:43:03 +0000 INFO:Setup completed successfully.
2026-01-30 17:43:03 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:43:03 +0000 INFO:Running first load function.
2026-01-30 17:43:03 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:43:03 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:43:03 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:43:03 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:43:03 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:43:03 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:43:03 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:43:03 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:43:03 +0000 INFO:firstload executed successfully
2026-01-30 17:43:03 +0000 INFO:Data first load completed successfully.
2026-01-30 17:43:03 +0000 INFO:initialise_data executed successfully
2026-01-30 17:43:03 +0000 INFO:Running Menu setup...
2026-01-30 17:43:03 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:43:03 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:43:03 +0000 INFO:get_git_version executed successfully
2026-01-30 17:43:03 +0000 INFO:App Version: v50.239
2026-01-30 17:43:03 +0000 INFO:Switched to page: Dubious Donors
2026-01-30 17:43:03 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:43:03 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:43:03 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:43:03 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:43:03 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:43:03 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:43:03 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:43:03 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:43:03 +0000 DEBUG:Page texts: {}
2026-01-30 17:43:03 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:43:03 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:43:04 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:43:04 +0000 INFO:display_data_page executed successfully
2026-01-30 17:43:04 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:43:04 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:43:04 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:43:04 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:43:04 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:43:04 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:43:04 +0000 DEBUG:Page texts: {}
2026-01-30 17:43:04 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:43:04 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:43:04 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:43:04 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:43:04 +0000 INFO:pagesetup executed successfully
2026-01-30 17:43:04 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:43:04 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:43:06 +0000 INFO:Streamlit App Starting...
2026-01-30 17:43:06 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:43:06 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:43:06 +0000 INFO:Running App setup...
2026-01-30 17:43:06 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:43:06 +0000 INFO:Setting up the package
2026-01-30 17:43:06 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:43:06 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:43:06 +0000 INFO:get_git_version executed successfully
2026-01-30 17:43:06 +0000 INFO:Version: v50.201
2026-01-30 17:43:06 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:43:06 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:43:06 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:security already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:directories already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:43:06 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:43:06 +0000 INFO:Session_state variables initialized
2026-01-30 17:43:06 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:43:06 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:43:06 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:43:06 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:43:06 +0000 DEBUG:selected_entity_name: 2005
2026-01-30 17:43:06 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:43:06 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:43:06 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:43:06 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:43:06 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:43:06 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:43:06 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:43:06 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:43:06 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:43:06 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:43:06 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:43:06 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:43:06 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:43:06 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:43:06 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:43:06 +0000 DEBUG:mod_dubious_donors_per_entity_None_mod_dubious_donors_per_entityDubious Donors per EntityNone_group_entity_select: Parliament Election Year
2026-01-30 17:43:06 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:43:06 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:43:06 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:43:06 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:43:06 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:43:06 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:43:06 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:43:06 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:43:06 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:43:06 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:43:06 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:43:06 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:43:06 +0000 DEBUG:date_range_mod_dubious_donors_per_entity_mod_dubious_donors_per_entityDubious Donors per EntityNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:43:06 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:43:06 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:43:06 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:43:06 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:43:06 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:43:06 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:43:06 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:43:06 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:43:06 +0000 DEBUG:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors at 0x000001C18D437760>}
2026-01-30 17:43:06 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:43:06 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:43:06 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:43:06 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:43:06 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:43:06 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:43:06 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:43:06 +0000 INFO:Session state Setup complete
2026-01-30 17:43:06 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:43:06 +0000 INFO:Package setup complete
2026-01-30 17:43:06 +0000 INFO:setup_package executed successfully
2026-01-30 17:43:06 +0000 INFO:Setup completed successfully.
2026-01-30 17:43:06 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:43:06 +0000 INFO:Running first load function.
2026-01-30 17:43:06 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:43:06 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:43:06 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:43:06 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:43:06 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:43:06 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:43:06 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:43:06 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:43:06 +0000 INFO:firstload executed successfully
2026-01-30 17:43:06 +0000 INFO:Data first load completed successfully.
2026-01-30 17:43:06 +0000 INFO:initialise_data executed successfully
2026-01-30 17:43:06 +0000 INFO:Running Menu setup...
2026-01-30 17:43:06 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:43:06 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:43:06 +0000 INFO:get_git_version executed successfully
2026-01-30 17:43:06 +0000 INFO:App Version: v50.239
2026-01-30 17:43:06 +0000 INFO:Switched to page: Dubious Donors
2026-01-30 17:43:06 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:43:06 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:43:06 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:43:06 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:43:07 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:43:07 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:43:07 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:43:07 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:43:07 +0000 DEBUG:Page texts: {}
2026-01-30 17:43:07 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:43:07 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:43:07 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:43:07 +0000 INFO:display_data_page executed successfully
2026-01-30 17:43:07 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:43:07 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:43:07 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:43:07 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:43:07 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:43:07 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:43:07 +0000 DEBUG:Page texts: {}
2026-01-30 17:43:07 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:43:07 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:43:07 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:43:07 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:43:07 +0000 INFO:pagesetup executed successfully
2026-01-30 17:43:07 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:43:07 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:43:10 +0000 INFO:Streamlit App Starting...
2026-01-30 17:43:10 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:43:10 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:43:10 +0000 INFO:Running App setup...
2026-01-30 17:43:10 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:43:10 +0000 INFO:Setting up the package
2026-01-30 17:43:10 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:43:10 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:43:10 +0000 INFO:get_git_version executed successfully
2026-01-30 17:43:10 +0000 INFO:Version: v50.201
2026-01-30 17:43:10 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:43:10 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:43:10 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:security already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:directories already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:43:10 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:43:10 +0000 INFO:Session_state variables initialized
2026-01-30 17:43:10 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:43:10 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:43:10 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:43:10 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:43:10 +0000 DEBUG:selected_entity_name: 2001
2026-01-30 17:43:10 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:43:10 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:43:10 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:43:10 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:43:10 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:43:10 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:43:10 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:43:10 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:43:10 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:43:10 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:43:10 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:43:10 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:43:10 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:43:10 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:43:10 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:43:10 +0000 DEBUG:mod_dubious_donors_per_entity_None_mod_dubious_donors_per_entityDubious Donors per EntityNone_group_entity_select: Parliament Election Year
2026-01-30 17:43:10 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:43:10 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:43:10 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:43:10 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:43:10 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:43:10 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:43:10 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:43:10 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:43:10 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:43:10 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:43:10 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:43:10 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:43:10 +0000 DEBUG:date_range_mod_dubious_donors_per_entity_mod_dubious_donors_per_entityDubious Donors per EntityNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:43:10 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:43:10 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:43:10 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:43:10 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:43:10 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:43:10 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:43:10 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:43:10 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:43:10 +0000 DEBUG:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors at 0x000001C18D437760>}
2026-01-30 17:43:10 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:43:10 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:43:10 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:43:10 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:43:10 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:43:10 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:43:10 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:43:10 +0000 INFO:Session state Setup complete
2026-01-30 17:43:10 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:43:10 +0000 INFO:Package setup complete
2026-01-30 17:43:10 +0000 INFO:setup_package executed successfully
2026-01-30 17:43:10 +0000 INFO:Setup completed successfully.
2026-01-30 17:43:10 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:43:10 +0000 INFO:Running first load function.
2026-01-30 17:43:10 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:43:10 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:43:10 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:43:10 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:43:10 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:43:10 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:43:10 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:43:10 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:43:10 +0000 INFO:firstload executed successfully
2026-01-30 17:43:10 +0000 INFO:Data first load completed successfully.
2026-01-30 17:43:10 +0000 INFO:initialise_data executed successfully
2026-01-30 17:43:10 +0000 INFO:Running Menu setup...
2026-01-30 17:43:10 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:43:10 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:43:10 +0000 INFO:get_git_version executed successfully
2026-01-30 17:43:10 +0000 INFO:App Version: v50.239
2026-01-30 17:43:10 +0000 INFO:Switched to page: Dubious Donors
2026-01-30 17:43:10 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:43:10 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:43:10 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:43:10 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:43:10 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:43:10 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:43:10 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:43:10 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:43:10 +0000 DEBUG:Page texts: {}
2026-01-30 17:43:10 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:43:10 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:43:10 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:43:10 +0000 INFO:display_data_page executed successfully
2026-01-30 17:43:10 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:43:11 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:43:11 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:43:11 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:43:11 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:43:11 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:43:11 +0000 DEBUG:Page texts: {}
2026-01-30 17:43:11 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:43:11 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:43:11 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:43:11 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:43:11 +0000 INFO:pagesetup executed successfully
2026-01-30 17:43:11 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:43:11 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:43:13 +0000 INFO:Streamlit App Starting...
2026-01-30 17:43:13 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:43:13 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:43:13 +0000 INFO:Running App setup...
2026-01-30 17:43:13 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:43:13 +0000 INFO:Setting up the package
2026-01-30 17:43:13 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:43:13 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:43:13 +0000 INFO:get_git_version executed successfully
2026-01-30 17:43:13 +0000 INFO:Version: v50.201
2026-01-30 17:43:13 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:43:13 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:43:13 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:security already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:directories already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:43:13 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:43:13 +0000 INFO:Session_state variables initialized
2026-01-30 17:43:13 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:43:13 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:43:13 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:43:13 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:43:13 +0000 DEBUG:selected_entity_name: 1997
2026-01-30 17:43:13 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:43:13 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:43:13 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:43:13 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:43:13 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:43:13 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:43:13 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:43:13 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:43:13 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:43:13 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:43:13 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:43:13 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:43:13 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:43:13 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:43:13 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:43:13 +0000 DEBUG:mod_dubious_donors_per_entity_None_mod_dubious_donors_per_entityDubious Donors per EntityNone_group_entity_select: Parliament Election Year
2026-01-30 17:43:13 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:43:13 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:43:13 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:43:13 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:43:13 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:43:13 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:43:13 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:43:13 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:43:13 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:43:13 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:43:13 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:43:13 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:43:13 +0000 DEBUG:date_range_mod_dubious_donors_per_entity_mod_dubious_donors_per_entityDubious Donors per EntityNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:43:13 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:43:13 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:43:13 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:43:13 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:43:13 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:43:13 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:43:13 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:43:13 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:43:13 +0000 DEBUG:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors at 0x000001C18D437760>}
2026-01-30 17:43:13 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:43:13 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:43:13 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:43:13 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:43:13 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:43:13 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:43:13 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:43:13 +0000 INFO:Session state Setup complete
2026-01-30 17:43:13 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:43:13 +0000 INFO:Package setup complete
2026-01-30 17:43:13 +0000 INFO:setup_package executed successfully
2026-01-30 17:43:13 +0000 INFO:Setup completed successfully.
2026-01-30 17:43:13 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:43:13 +0000 INFO:Running first load function.
2026-01-30 17:43:13 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:43:13 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:43:13 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:43:13 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:43:13 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:43:13 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:43:13 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:43:13 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:43:13 +0000 INFO:firstload executed successfully
2026-01-30 17:43:13 +0000 INFO:Data first load completed successfully.
2026-01-30 17:43:13 +0000 INFO:initialise_data executed successfully
2026-01-30 17:43:13 +0000 INFO:Running Menu setup...
2026-01-30 17:43:13 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:43:13 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:43:13 +0000 INFO:get_git_version executed successfully
2026-01-30 17:43:13 +0000 INFO:App Version: v50.239
2026-01-30 17:43:13 +0000 INFO:Switched to page: Dubious Donors
2026-01-30 17:43:13 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:43:13 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:43:13 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:43:13 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:43:13 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:43:13 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:43:13 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:43:13 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:43:13 +0000 DEBUG:Page texts: {}
2026-01-30 17:43:13 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:43:13 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:43:13 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:43:13 +0000 INFO:display_data_page executed successfully
2026-01-30 17:43:13 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:43:13 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:43:13 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:43:13 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:43:13 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:43:13 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:43:13 +0000 DEBUG:Page texts: {}
2026-01-30 17:43:13 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:43:13 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:43:13 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:43:13 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:43:13 +0000 INFO:pagesetup executed successfully
2026-01-30 17:43:13 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:43:14 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:43:16 +0000 INFO:Streamlit App Starting...
2026-01-30 17:43:16 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:43:16 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:43:16 +0000 INFO:Running App setup...
2026-01-30 17:43:16 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:43:16 +0000 INFO:Setting up the package
2026-01-30 17:43:16 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:43:16 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:43:16 +0000 INFO:get_git_version executed successfully
2026-01-30 17:43:16 +0000 INFO:Version: v50.201
2026-01-30 17:43:16 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:43:16 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:43:16 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:security already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:directories already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:43:16 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:43:16 +0000 INFO:Session_state variables initialized
2026-01-30 17:43:16 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:43:16 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:43:16 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:43:16 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:43:16 +0000 DEBUG:selected_entity_name: 1997
2026-01-30 17:43:16 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:43:16 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:43:16 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:43:16 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:43:16 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:43:16 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:43:16 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:43:16 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:43:16 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:43:16 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:43:16 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:43:16 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:43:16 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:43:16 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:43:16 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:43:16 +0000 DEBUG:mod_dubious_donors_per_entity_None_mod_dubious_donors_per_entityDubious Donors per EntityNone_group_entity_select: Parliament Election Year
2026-01-30 17:43:16 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:43:16 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:43:16 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:43:16 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:43:16 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:43:16 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:43:16 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:43:16 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:43:16 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:43:16 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:43:16 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:43:16 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:43:16 +0000 DEBUG:date_range_mod_dubious_donors_per_entity_mod_dubious_donors_per_entityDubious Donors per EntityNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:43:16 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:43:16 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:43:16 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:43:16 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:43:16 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:43:16 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:43:16 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:43:16 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:43:16 +0000 DEBUG:menu_selection: {'title': 'Dubious Donations', 'function': <function mod_dubious_donations at 0x000001C18D437520>}
2026-01-30 17:43:16 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:43:16 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:43:16 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:43:16 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:43:16 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:43:16 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:43:16 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:43:16 +0000 INFO:Session state Setup complete
2026-01-30 17:43:16 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:43:16 +0000 INFO:Package setup complete
2026-01-30 17:43:16 +0000 INFO:setup_package executed successfully
2026-01-30 17:43:16 +0000 INFO:Setup completed successfully.
2026-01-30 17:43:16 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:43:16 +0000 INFO:Running first load function.
2026-01-30 17:43:16 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:43:16 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:43:16 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:43:16 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:43:16 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:43:16 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:43:16 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:43:16 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:43:16 +0000 INFO:firstload executed successfully
2026-01-30 17:43:16 +0000 INFO:Data first load completed successfully.
2026-01-30 17:43:16 +0000 INFO:initialise_data executed successfully
2026-01-30 17:43:16 +0000 INFO:Running Menu setup...
2026-01-30 17:43:16 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:43:16 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:43:16 +0000 INFO:get_git_version executed successfully
2026-01-30 17:43:16 +0000 INFO:App Version: v50.239
2026-01-30 17:43:16 +0000 INFO:Switched to page: Dubious Donations
2026-01-30 17:43:16 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:43:16 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:43:16 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:43:16 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:43:16 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:43:16 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:43:16 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:43:16 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:43:16 +0000 DEBUG:Page texts: {}
2026-01-30 17:43:16 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:43:16 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:43:17 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:43:17 +0000 INFO:display_data_page executed successfully
2026-01-30 17:43:17 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:43:17 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:43:17 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:43:17 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:43:17 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:43:17 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:43:17 +0000 DEBUG:Page texts: {}
2026-01-30 17:43:17 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:43:17 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:43:17 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:43:17 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:43:17 +0000 INFO:pagesetup executed successfully
2026-01-30 17:43:17 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:43:17 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:43:26 +0000 INFO:Streamlit App Starting...
2026-01-30 17:43:26 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:43:26 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:43:26 +0000 INFO:Running App setup...
2026-01-30 17:43:26 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:43:26 +0000 INFO:Setting up the package
2026-01-30 17:43:26 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:43:26 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:43:26 +0000 INFO:get_git_version executed successfully
2026-01-30 17:43:26 +0000 INFO:Version: v50.201
2026-01-30 17:43:26 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:43:26 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:43:26 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:security already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:directories already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:43:26 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:43:26 +0000 INFO:Session_state variables initialized
2026-01-30 17:43:26 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:43:26 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:43:26 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:43:26 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:43:26 +0000 DEBUG:date_range_mod_dubious_donations_per_donor_mod_dubious_donations_per_donorDubious Donations per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:43:26 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:43:26 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:43:26 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:43:26 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:43:26 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:43:26 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:43:26 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:43:26 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:43:26 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:43:26 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:43:26 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:43:26 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:43:26 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:43:26 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:43:26 +0000 DEBUG:selected_entity_name: All
2026-01-30 17:43:26 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:43:26 +0000 DEBUG:mod_dubious_donations_per_donor_None_mod_dubious_donations_per_donorDubious Donations per DonorNone_group_entity_select: Parliament Election Year
2026-01-30 17:43:26 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:43:26 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:43:26 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:43:26 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:43:26 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:43:26 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:43:26 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:43:26 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:43:26 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:43:26 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:43:26 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:43:26 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:43:26 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:43:26 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:43:26 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:43:26 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:43:26 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:43:26 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:43:26 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:43:26 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:43:26 +0000 DEBUG:menu_selection: {'title': 'Dubious Donations', 'function': <function mod_dubious_donations at 0x000001C18D437520>}
2026-01-30 17:43:26 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:43:26 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:43:26 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:43:26 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:43:26 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:43:26 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:43:26 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:43:26 +0000 INFO:Session state Setup complete
2026-01-30 17:43:26 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:43:26 +0000 INFO:Package setup complete
2026-01-30 17:43:26 +0000 INFO:setup_package executed successfully
2026-01-30 17:43:26 +0000 INFO:Setup completed successfully.
2026-01-30 17:43:26 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:43:26 +0000 INFO:Running first load function.
2026-01-30 17:43:26 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:43:26 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:43:26 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:43:26 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:43:26 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:43:26 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:43:26 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:43:26 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:43:26 +0000 INFO:firstload executed successfully
2026-01-30 17:43:26 +0000 INFO:Data first load completed successfully.
2026-01-30 17:43:26 +0000 INFO:initialise_data executed successfully
2026-01-30 17:43:26 +0000 INFO:Running Menu setup...
2026-01-30 17:43:26 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:43:26 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:43:26 +0000 INFO:get_git_version executed successfully
2026-01-30 17:43:26 +0000 INFO:App Version: v50.239
2026-01-30 17:43:26 +0000 INFO:Switched to page: Dubious Donations
2026-01-30 17:43:26 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:43:26 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:43:26 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:43:26 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:43:26 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:43:26 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:43:26 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:43:26 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:43:26 +0000 DEBUG:Page texts: {}
2026-01-30 17:43:26 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:43:26 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:43:26 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:43:26 +0000 INFO:display_data_page executed successfully
2026-01-30 17:43:26 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:43:27 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:43:27 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:43:27 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:43:27 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:43:27 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:43:27 +0000 DEBUG:Page texts: {}
2026-01-30 17:43:27 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:43:27 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:43:27 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:43:27 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:43:27 +0000 INFO:pagesetup executed successfully
2026-01-30 17:43:27 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:43:27 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:43:28 +0000 INFO:Streamlit App Starting...
2026-01-30 17:43:28 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:43:28 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:43:28 +0000 INFO:Running App setup...
2026-01-30 17:43:28 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:43:28 +0000 INFO:Setting up the package
2026-01-30 17:43:28 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:43:28 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:43:28 +0000 INFO:get_git_version executed successfully
2026-01-30 17:43:28 +0000 INFO:Version: v50.201
2026-01-30 17:43:28 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:43:28 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:43:28 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:security already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:directories already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:43:28 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:43:28 +0000 INFO:Session_state variables initialized
2026-01-30 17:43:28 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:43:28 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:43:28 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:43:28 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:43:28 +0000 DEBUG:selected_entity_name: 2001
2026-01-30 17:43:28 +0000 DEBUG:date_range_mod_dubious_donations_per_donor_mod_dubious_donations_per_donorDubious Donations per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:43:28 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:43:28 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:43:28 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:43:28 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:43:28 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:43:28 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:43:28 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:43:28 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:43:28 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:43:28 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:43:28 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:43:28 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:43:28 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:43:28 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:43:28 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:43:28 +0000 DEBUG:mod_dubious_donations_per_donor_None_mod_dubious_donations_per_donorDubious Donations per DonorNone_group_entity_select: Parliament Election Year
2026-01-30 17:43:28 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:43:28 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:43:28 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:43:28 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:43:28 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:43:28 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:43:28 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:43:28 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:43:28 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:43:28 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:43:28 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:43:28 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:43:28 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:43:28 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:43:28 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:43:28 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:43:28 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:43:28 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:43:28 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:43:28 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:43:28 +0000 DEBUG:menu_selection: {'title': 'Dubious Donations', 'function': <function mod_dubious_donations at 0x000001C18D437520>}
2026-01-30 17:43:28 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:43:28 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:43:28 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:43:28 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:43:28 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:43:28 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:43:28 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:43:28 +0000 INFO:Session state Setup complete
2026-01-30 17:43:28 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:43:28 +0000 INFO:Package setup complete
2026-01-30 17:43:28 +0000 INFO:setup_package executed successfully
2026-01-30 17:43:28 +0000 INFO:Setup completed successfully.
2026-01-30 17:43:28 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:43:28 +0000 INFO:Running first load function.
2026-01-30 17:43:28 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:43:28 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:43:28 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:43:28 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:43:28 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:43:28 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:43:28 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:43:28 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:43:28 +0000 INFO:firstload executed successfully
2026-01-30 17:43:28 +0000 INFO:Data first load completed successfully.
2026-01-30 17:43:28 +0000 INFO:initialise_data executed successfully
2026-01-30 17:43:28 +0000 INFO:Running Menu setup...
2026-01-30 17:43:28 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:43:28 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:43:28 +0000 INFO:get_git_version executed successfully
2026-01-30 17:43:28 +0000 INFO:App Version: v50.239
2026-01-30 17:43:28 +0000 INFO:Switched to page: Dubious Donations
2026-01-30 17:43:28 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:43:28 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:43:28 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:43:28 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:43:28 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:43:28 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:43:28 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:43:28 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:43:28 +0000 DEBUG:Page texts: {}
2026-01-30 17:43:28 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:43:28 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:43:29 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:43:29 +0000 INFO:display_data_page executed successfully
2026-01-30 17:43:29 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:43:29 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:43:29 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:43:29 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:43:29 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:43:29 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:43:29 +0000 DEBUG:Page texts: {}
2026-01-30 17:43:29 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:43:29 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:43:29 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:43:29 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:43:29 +0000 INFO:pagesetup executed successfully
2026-01-30 17:43:29 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:43:29 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:43:35 +0000 INFO:Streamlit App Starting...
2026-01-30 17:43:35 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:43:35 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:43:35 +0000 INFO:Running App setup...
2026-01-30 17:43:35 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:43:35 +0000 INFO:Setting up the package
2026-01-30 17:43:35 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:43:35 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:43:35 +0000 INFO:get_git_version executed successfully
2026-01-30 17:43:35 +0000 INFO:Version: v50.201
2026-01-30 17:43:35 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:43:35 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:43:35 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:security already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:directories already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:43:35 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:43:35 +0000 INFO:Session_state variables initialized
2026-01-30 17:43:35 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:43:35 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:43:35 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:43:35 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:43:35 +0000 DEBUG:selected_entity_name: 2024
2026-01-30 17:43:35 +0000 DEBUG:date_range_mod_dubious_donations_per_donor_mod_dubious_donations_per_donorDubious Donations per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:43:35 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:43:35 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:43:35 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:43:35 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:43:35 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:43:35 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:43:35 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:43:35 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:43:35 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:43:35 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:43:35 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:43:35 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:43:35 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:43:35 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:43:35 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:43:35 +0000 DEBUG:mod_dubious_donations_per_donor_None_mod_dubious_donations_per_donorDubious Donations per DonorNone_group_entity_select: Parliament Election Year
2026-01-30 17:43:35 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:43:35 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:43:35 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:43:35 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:43:35 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:43:35 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:43:35 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:43:35 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:43:35 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:43:35 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:43:35 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:43:35 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:43:35 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:43:35 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:43:35 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:43:35 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:43:35 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:43:35 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:43:35 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:43:35 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:43:35 +0000 DEBUG:menu_selection: {'title': 'Dubious Donations', 'function': <function mod_dubious_donations at 0x000001C18D437520>}
2026-01-30 17:43:35 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:43:35 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:43:35 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:43:35 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:43:35 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:43:35 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:43:35 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:43:35 +0000 INFO:Session state Setup complete
2026-01-30 17:43:35 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:43:35 +0000 INFO:Package setup complete
2026-01-30 17:43:35 +0000 INFO:setup_package executed successfully
2026-01-30 17:43:35 +0000 INFO:Setup completed successfully.
2026-01-30 17:43:35 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:43:35 +0000 INFO:Running first load function.
2026-01-30 17:43:35 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:43:35 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:43:35 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:43:35 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:43:35 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:43:35 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:43:35 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:43:35 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:43:35 +0000 INFO:firstload executed successfully
2026-01-30 17:43:35 +0000 INFO:Data first load completed successfully.
2026-01-30 17:43:35 +0000 INFO:initialise_data executed successfully
2026-01-30 17:43:35 +0000 INFO:Running Menu setup...
2026-01-30 17:43:35 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:43:35 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:43:35 +0000 INFO:get_git_version executed successfully
2026-01-30 17:43:35 +0000 INFO:App Version: v50.239
2026-01-30 17:43:35 +0000 INFO:Switched to page: Dubious Donations
2026-01-30 17:43:35 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:43:35 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:43:35 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:43:35 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:43:35 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:43:35 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:43:35 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:43:35 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:43:35 +0000 DEBUG:Page texts: {}
2026-01-30 17:43:35 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:43:35 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:43:36 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:43:36 +0000 INFO:display_data_page executed successfully
2026-01-30 17:43:36 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:43:36 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:43:36 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:43:36 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:43:36 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:43:36 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:43:36 +0000 DEBUG:Page texts: {}
2026-01-30 17:43:36 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:43:36 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:43:36 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:43:36 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:43:36 +0000 INFO:pagesetup executed successfully
2026-01-30 17:43:36 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:43:36 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:43:41 +0000 INFO:Streamlit App Starting...
2026-01-30 17:43:41 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:43:41 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:43:41 +0000 INFO:Running App setup...
2026-01-30 17:43:41 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:43:41 +0000 INFO:Setting up the package
2026-01-30 17:43:41 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:43:41 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:43:41 +0000 INFO:get_git_version executed successfully
2026-01-30 17:43:41 +0000 INFO:Version: v50.201
2026-01-30 17:43:41 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:43:41 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:43:41 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:security already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:directories already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:43:41 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:43:41 +0000 INFO:Session_state variables initialized
2026-01-30 17:43:41 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:43:41 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:43:41 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:43:41 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:43:41 +0000 DEBUG:selected_entity_name: 2024
2026-01-30 17:43:41 +0000 DEBUG:date_range_mod_dubious_donations_per_donor_mod_dubious_donations_per_donorDubious Donations per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:43:41 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:43:41 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:43:41 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:43:41 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:43:41 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:43:41 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:43:41 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:43:41 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:43:41 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:43:41 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:43:41 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:43:41 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:43:41 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:43:41 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:43:41 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:43:41 +0000 DEBUG:mod_dubious_donations_per_donor_None_mod_dubious_donations_per_donorDubious Donations per DonorNone_group_entity_select: Parliament Election Year
2026-01-30 17:43:41 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:43:41 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:43:41 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:43:41 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:43:41 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:43:41 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:43:41 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:43:41 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:43:41 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:43:41 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:43:41 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:43:41 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:43:41 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:43:41 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:43:41 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:43:41 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:43:41 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:43:41 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:43:41 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:43:41 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:43:41 +0000 DEBUG:menu_selection: {'title': 'Internal Political Party Donations', 'function': <function mod_donations_per_political_party at 0x000001C18D4375B0>}
2026-01-30 17:43:41 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:43:41 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:43:41 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:43:41 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:43:41 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:43:41 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:43:41 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:43:41 +0000 INFO:Session state Setup complete
2026-01-30 17:43:41 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:43:41 +0000 INFO:Package setup complete
2026-01-30 17:43:41 +0000 INFO:setup_package executed successfully
2026-01-30 17:43:41 +0000 INFO:Setup completed successfully.
2026-01-30 17:43:41 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:43:41 +0000 INFO:Running first load function.
2026-01-30 17:43:41 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:43:41 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:43:41 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:43:41 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:43:41 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:43:41 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:43:41 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:43:41 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:43:41 +0000 INFO:firstload executed successfully
2026-01-30 17:43:41 +0000 INFO:Data first load completed successfully.
2026-01-30 17:43:41 +0000 INFO:initialise_data executed successfully
2026-01-30 17:43:41 +0000 INFO:Running Menu setup...
2026-01-30 17:43:41 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:43:41 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:43:41 +0000 INFO:get_git_version executed successfully
2026-01-30 17:43:41 +0000 INFO:App Version: v50.239
2026-01-30 17:43:41 +0000 INFO:Switched to page: Internal Political Party Donations
2026-01-30 17:43:41 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:43:41 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:43:41 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:43:41 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:43:42 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:43:42 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:43:42 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:43:42 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:43:42 +0000 DEBUG:Page texts: {}
2026-01-30 17:43:42 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:43:42 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:43:42 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:43:42 +0000 INFO:display_data_page executed successfully
2026-01-30 17:43:42 +0000 INFO:pagesetup executed successfully
2026-01-30 17:43:42 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:43:42 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:44:38 +0000 INFO:Streamlit App Starting...
2026-01-30 17:44:38 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:44:38 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:44:38 +0000 INFO:Running App setup...
2026-01-30 17:44:38 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:44:38 +0000 INFO:Setting up the package
2026-01-30 17:44:38 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:44:38 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:44:38 +0000 INFO:get_git_version executed successfully
2026-01-30 17:44:38 +0000 INFO:Version: v50.201
2026-01-30 17:44:38 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:44:38 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:44:38 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:security already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:directories already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:44:38 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:44:38 +0000 INFO:Session_state variables initialized
2026-01-30 17:44:38 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:44:38 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:44:38 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:44:38 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:44:38 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:44:38 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:44:38 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:44:38 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:44:38 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:44:38 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:44:38 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:44:38 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:44:38 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:44:38 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:44:38 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:44:38 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:44:38 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:44:38 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:44:38 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:44:38 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:44:38 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:44:38 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:44:38 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:44:38 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:44:38 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:44:38 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:44:38 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:44:38 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:44:38 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:44:38 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:44:38 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:44:38 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:44:38 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:44:38 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:44:38 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:44:38 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:44:38 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:44:38 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:44:38 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:44:38 +0000 DEBUG:menu_selection: {'title': 'Regulated Donor per Entity', 'function': <function mod_regulated_donor_per_entity at 0x000001C18D437640>}
2026-01-30 17:44:38 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:44:38 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:44:38 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:44:38 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:44:38 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:44:38 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:44:38 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:44:38 +0000 INFO:Session state Setup complete
2026-01-30 17:44:38 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:44:38 +0000 INFO:Package setup complete
2026-01-30 17:44:38 +0000 INFO:setup_package executed successfully
2026-01-30 17:44:38 +0000 INFO:Setup completed successfully.
2026-01-30 17:44:38 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:44:38 +0000 INFO:Running first load function.
2026-01-30 17:44:38 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:44:38 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:44:38 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:44:38 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:44:38 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:44:38 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:44:38 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:44:38 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:44:38 +0000 INFO:firstload executed successfully
2026-01-30 17:44:38 +0000 INFO:Data first load completed successfully.
2026-01-30 17:44:38 +0000 INFO:initialise_data executed successfully
2026-01-30 17:44:38 +0000 INFO:Running Menu setup...
2026-01-30 17:44:38 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:44:38 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:44:38 +0000 INFO:get_git_version executed successfully
2026-01-30 17:44:38 +0000 INFO:App Version: v50.239
2026-01-30 17:44:38 +0000 INFO:Switched to page: Regulated Donor per Entity
2026-01-30 17:44:38 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:44:38 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:44:38 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:44:38 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:44:39 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:44:39 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:44:39 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:44:39 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:44:39 +0000 DEBUG:Page texts: {}
2026-01-30 17:44:39 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:44:39 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:44:39 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:44:39 +0000 INFO:display_data_page executed successfully
2026-01-30 17:44:39 +0000 INFO:pagesetup executed successfully
2026-01-30 17:44:39 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:44:39 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:44:55 +0000 INFO:Streamlit App Starting...
2026-01-30 17:44:55 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:44:55 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:44:55 +0000 INFO:Running App setup...
2026-01-30 17:44:55 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:44:55 +0000 INFO:Setting up the package
2026-01-30 17:44:55 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:44:55 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:44:55 +0000 INFO:get_git_version executed successfully
2026-01-30 17:44:55 +0000 INFO:Version: v50.201
2026-01-30 17:44:55 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:44:55 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:44:55 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:security already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:directories already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:44:55 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:44:55 +0000 INFO:Session_state variables initialized
2026-01-30 17:44:55 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:44:55 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:44:55 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:44:55 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:44:56 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:44:56 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:44:56 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:44:56 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:44:56 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:44:56 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:44:56 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:44:56 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:44:56 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:44:56 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:44:56 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:44:56 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:44:56 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:44:56 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:44:56 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:44:56 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:44:56 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:44:56 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:44:56 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:44:56 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:44:56 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:44:56 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:44:56 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:44:56 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:44:56 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:44:56 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:44:56 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:44:56 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:44:56 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:44:56 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:44:56 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:44:56 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:44:56 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:44:56 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:44:56 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:44:56 +0000 DEBUG:menu_selection: {'title': 'Regulated Entity per Donor', 'function': <function mod_regulated_entity_per_donor at 0x000001C18D4376D0>}
2026-01-30 17:44:56 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:44:56 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:44:56 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:44:56 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:44:56 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:44:56 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:44:56 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:44:56 +0000 INFO:Session state Setup complete
2026-01-30 17:44:56 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:44:56 +0000 INFO:Package setup complete
2026-01-30 17:44:56 +0000 INFO:setup_package executed successfully
2026-01-30 17:44:56 +0000 INFO:Setup completed successfully.
2026-01-30 17:44:56 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:44:56 +0000 INFO:Running first load function.
2026-01-30 17:44:56 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:44:56 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:44:56 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:44:56 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:44:56 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:44:56 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:44:56 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:44:56 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:44:56 +0000 INFO:firstload executed successfully
2026-01-30 17:44:56 +0000 INFO:Data first load completed successfully.
2026-01-30 17:44:56 +0000 INFO:initialise_data executed successfully
2026-01-30 17:44:56 +0000 INFO:Running Menu setup...
2026-01-30 17:44:56 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:44:56 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:44:56 +0000 INFO:get_git_version executed successfully
2026-01-30 17:44:56 +0000 INFO:App Version: v50.239
2026-01-30 17:44:56 +0000 INFO:Switched to page: Regulated Entity per Donor
2026-01-30 17:44:56 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:44:56 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:44:56 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:44:56 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:44:56 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:44:56 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:44:56 +0000 DEBUG:Page texts: {}
2026-01-30 17:44:56 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:44:56 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:44:57 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:44:57 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:44:57 +0000 INFO:pagesetup executed successfully
2026-01-30 17:44:57 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:44:57 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:45:04 +0000 INFO:Streamlit App Starting...
2026-01-30 17:45:04 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:45:04 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:45:04 +0000 INFO:Running App setup...
2026-01-30 17:45:04 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:45:04 +0000 INFO:Setting up the package
2026-01-30 17:45:04 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:45:04 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:45:04 +0000 INFO:get_git_version executed successfully
2026-01-30 17:45:04 +0000 INFO:Version: v50.201
2026-01-30 17:45:04 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:45:04 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:45:04 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:security already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:directories already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:45:04 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:45:04 +0000 INFO:Session_state variables initialized
2026-01-30 17:45:04 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:45:04 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:45:04 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:45:04 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:45:04 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:45:04 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:45:04 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:45:04 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:45:04 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:45:04 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:45:04 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:45:04 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:45:05 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:45:05 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:45:05 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:45:05 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:45:05 +0000 DEBUG:mod_regulated_donor_per_entity_None_mod_regulated_donor_per_entityRegulated Entity by DonorNone_group_entity_select: Donor
2026-01-30 17:45:05 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:45:05 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:45:05 +0000 DEBUG:selected_entity_name: All
2026-01-30 17:45:05 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:45:05 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:45:05 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:45:05 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:45:05 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:45:05 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:45:05 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:45:05 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:45:05 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:45:05 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:45:05 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:45:05 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:45:05 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:45:05 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:45:05 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:45:05 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:45:05 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:45:05 +0000 DEBUG:date_range_mod_regulated_donor_per_entity_mod_regulated_donor_per_entityRegulated Entity by DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:45:05 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:45:05 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:45:05 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:45:05 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:45:05 +0000 DEBUG:menu_selection: {'title': 'Regulated Donor per Entity', 'function': <function mod_regulated_donor_per_entity at 0x000001C18D437640>}
2026-01-30 17:45:05 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:45:05 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:45:05 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:45:05 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:45:05 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:45:05 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:45:05 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:45:05 +0000 INFO:Session state Setup complete
2026-01-30 17:45:05 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:45:05 +0000 INFO:Package setup complete
2026-01-30 17:45:05 +0000 INFO:setup_package executed successfully
2026-01-30 17:45:05 +0000 INFO:Setup completed successfully.
2026-01-30 17:45:05 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:45:05 +0000 INFO:Running first load function.
2026-01-30 17:45:05 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:45:05 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:45:05 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:45:05 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:45:05 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:45:05 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:45:05 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:45:05 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:45:05 +0000 INFO:firstload executed successfully
2026-01-30 17:45:05 +0000 INFO:Data first load completed successfully.
2026-01-30 17:45:05 +0000 INFO:initialise_data executed successfully
2026-01-30 17:45:05 +0000 INFO:Running Menu setup...
2026-01-30 17:45:05 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:45:05 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:45:05 +0000 INFO:get_git_version executed successfully
2026-01-30 17:45:05 +0000 INFO:App Version: v50.239
2026-01-30 17:45:05 +0000 INFO:Switched to page: Regulated Donor per Entity
2026-01-30 17:45:05 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:45:05 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:45:05 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:45:05 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:45:05 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:45:05 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:45:05 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:45:05 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:45:05 +0000 DEBUG:Page texts: {}
2026-01-30 17:45:05 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:45:05 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:45:05 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:45:05 +0000 INFO:display_data_page executed successfully
2026-01-30 17:45:05 +0000 INFO:pagesetup executed successfully
2026-01-30 17:45:05 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:45:05 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:45:07 +0000 INFO:Streamlit App Starting...
2026-01-30 17:45:07 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:45:07 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:45:07 +0000 INFO:Running App setup...
2026-01-30 17:45:07 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:45:07 +0000 INFO:Setting up the package
2026-01-30 17:45:07 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:45:07 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:45:07 +0000 INFO:get_git_version executed successfully
2026-01-30 17:45:07 +0000 INFO:Version: v50.201
2026-01-30 17:45:07 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:45:07 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:45:07 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:security already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:directories already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:45:07 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:45:07 +0000 INFO:Session_state variables initialized
2026-01-30 17:45:07 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:45:07 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:45:07 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:45:07 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:45:07 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:45:07 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:45:07 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:45:07 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:45:07 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:45:07 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:45:07 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:45:07 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:45:07 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:45:07 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:45:07 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:45:07 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:45:07 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:45:07 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:45:07 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:45:07 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:45:07 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:45:07 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:45:07 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:45:07 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:45:07 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:45:07 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:45:07 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:45:07 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:45:07 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:45:07 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:45:07 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:45:07 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:45:07 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:45:07 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:45:07 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:45:07 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:45:07 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:45:07 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:45:07 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:45:07 +0000 DEBUG:menu_selection: {'title': 'Donor Loyalty Analysis', 'function': <function mod_donor_loyalty at 0x000001C18D436F80>}
2026-01-30 17:45:07 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:45:07 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:45:07 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:45:07 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:45:07 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:45:07 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:45:07 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:45:07 +0000 INFO:Session state Setup complete
2026-01-30 17:45:07 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:45:07 +0000 INFO:Package setup complete
2026-01-30 17:45:07 +0000 INFO:setup_package executed successfully
2026-01-30 17:45:07 +0000 INFO:Setup completed successfully.
2026-01-30 17:45:07 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:45:07 +0000 INFO:Running first load function.
2026-01-30 17:45:07 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:45:07 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:45:07 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:45:07 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:45:07 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:45:07 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:45:07 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:45:07 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:45:07 +0000 INFO:firstload executed successfully
2026-01-30 17:45:07 +0000 INFO:Data first load completed successfully.
2026-01-30 17:45:07 +0000 INFO:initialise_data executed successfully
2026-01-30 17:45:07 +0000 INFO:Running Menu setup...
2026-01-30 17:45:07 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:45:07 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:45:07 +0000 INFO:get_git_version executed successfully
2026-01-30 17:45:07 +0000 INFO:App Version: v50.239
2026-01-30 17:45:07 +0000 INFO:Switched to page: Donor Loyalty Analysis
2026-01-30 17:45:07 +0000 DEBUG:Calling mod_donor_loyalty with args={args}, kwargs={kwargs}
2026-01-30 17:45:08 +0000 DEBUG:Calling display_donor_distribution with args={args}, kwargs={kwargs}
2026-01-30 17:45:08 +0000 DEBUG:Aggregated DataFrame:    Parties_Per_Donor  Count
0                  1  18611
1                 10      4
2                 11      1
3                 12      2
4                 13      2
5                 14      2
6                 17      2
7                 18      1
8                  2   1299
9                  3    185
10                 4     70
11                 5     24
12                 6     17
13                 7     10
14                 8      3
15                83      1
16                 9      3
2026-01-30 17:45:08 +0000 DEBUG:Sorted DataFrame:    Parties_Per_Donor  Count
0                  1  18611
8                  2   1299
9                  3    185
10                 4     70
11                 5     24
12                 6     17
13                 7     10
1                 10      4
14                 8      3
16                 9      3
3                 12      2
4                 13      2
5                 14      2
6                 17      2
2                 11      1
7                 18      1
15                83      1
2026-01-30 17:45:08 +0000 DEBUG:Unique XValues: ['1' '2' '3' '4' '5' '6' '7' '10' '8' '9' '12' '13' '14' '17' '11' '18'
 '83']
2026-01-30 17:45:08 +0000 DEBUG:Final color_discrete_map: {'1': '#636efa', '2': '#636efa', '3': '#636efa', '4': '#636efa', '5': '#636efa', '6': '#636efa', '7': '#636efa', '10': '#636efa', '8': '#636efa', '9': '#636efa', '12': '#636efa', '13': '#636efa', '14': '#636efa', '17': '#636efa', '11': '#636efa', '18': '#636efa', '83': '#636efa'}
2026-01-30 17:45:08 +0000 DEBUG:Missing color mappings for: ['1', '2', '3', '4', '5', '6', '7', '10', '8', '9', '12', '13', '14', '17', '11', '18', '83']
2026-01-30 17:45:08 +0000 DEBUG:Generated Figure: Figure({
    'data': [{'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '1',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '1',
              'offsetgroup': '1',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['1'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 's0g=', 'dtype': 'i2'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '2',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '2',
              'offsetgroup': '2',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['2'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'EwU=', 'dtype': 'i2'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '3',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '3',
              'offsetgroup': '3',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['3'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'uQA=', 'dtype': 'i2'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '4',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '4',
              'offsetgroup': '4',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['4'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Rg==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '5',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '5',
              'offsetgroup': '5',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['5'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'GA==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '6',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '6',
              'offsetgroup': '6',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['6'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'EQ==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '7',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '7',
              'offsetgroup': '7',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['7'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Cg==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '10',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '10',
              'offsetgroup': '10',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['10'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'BA==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '8',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '8',
              'offsetgroup': '8',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['8'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Aw==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '9',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '9',
              'offsetgroup': '9',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['9'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Aw==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '12',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '12',
              'offsetgroup': '12',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['12'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Ag==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '13',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '13',
              'offsetgroup': '13',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['13'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Ag==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '14',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '14',
              'offsetgroup': '14',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['14'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Ag==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '17',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '17',
              'offsetgroup': '17',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['17'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Ag==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '11',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '11',
              'offsetgroup': '11',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['11'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AQ==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '18',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '18',
              'offsetgroup': '18',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['18'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AQ==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '83',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '83',
              'offsetgroup': '83',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['83'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AQ==', 'dtype': 'i1'},
              'yaxis': 'y'}],
    'layout': {'barmode': 'group',
               'legend': {'title': {'text': 'Number of Parties'}, 'tracegroupgap': 0},
               'template': '...',
               'title': {'text': 'Distribution of Parties per Donor'},
               'xaxis': {'anchor': 'y',
                         'categoryarray': [1, 2, 3, 4, 5, 6, 7, 10, 8, 9, 12, 13,
                                           14, 17, 11, 18, 83],
                         'categoryorder': 'array',
                         'domain': [0.0, 1.0],
                         'title': {'text': 'Number of Parties'}},
               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': 'Number of Donors'}}}
})
2026-01-30 17:45:08 +0000 INFO:Bar chart displayed successfully.
2026-01-30 17:45:08 +0000 INFO:display_donor_distribution executed successfully
2026-01-30 17:45:08 +0000 DEBUG:Calling display_government_period_analysis with args={args}, kwargs={kwargs}
2026-01-30 17:45:08 +0000 DEBUG:matplotlib data path: H:\python310\lib\site-packages\matplotlib\mpl-data
2026-01-30 17:45:08 +0000 DEBUG:CONFIGDIR=C:\Users\pgold\.matplotlib
2026-01-30 17:45:08 +0000 DEBUG:interactive is False
2026-01-30 17:45:08 +0000 DEBUG:platform is win32
2026-01-30 17:45:08 +0000 DEBUG:CACHEDIR=C:\Users\pgold\.matplotlib
2026-01-30 17:45:08 +0000 DEBUG:Using fontManager instance from C:\Users\pgold\.matplotlib\fontlist-v330.json
2026-01-30 17:45:08 +0000 INFO:display_government_period_analysis executed successfully
2026-01-30 17:45:08 +0000 DEBUG:Calling display_loyalty_metrics with args={args}, kwargs={kwargs}
2026-01-30 17:45:15 +0000 INFO:Streamlit App Starting...
2026-01-30 17:45:15 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:45:15 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:45:15 +0000 INFO:Running App setup...
2026-01-30 17:45:15 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:45:15 +0000 INFO:Setting up the package
2026-01-30 17:45:15 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:45:15 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:45:15 +0000 INFO:get_git_version executed successfully
2026-01-30 17:45:15 +0000 INFO:Version: v50.201
2026-01-30 17:45:15 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:45:15 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:45:15 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:45:15 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:45:15 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:45:15 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:45:15 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:45:15 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:45:15 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:45:15 +0000 DEBUG:security already exists in session state
2026-01-30 17:45:15 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:45:15 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:45:15 +0000 DEBUG:directories already exists in session state
2026-01-30 17:45:15 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:45:16 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:45:16 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:45:16 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:45:16 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:45:16 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:45:16 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:45:16 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:45:16 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:45:16 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:45:16 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:45:16 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:45:16 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:45:16 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:45:16 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:45:16 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:45:16 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:45:16 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:45:16 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:45:16 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:45:16 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:45:16 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:45:16 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:45:16 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:45:16 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:45:16 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:45:16 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:45:16 +0000 INFO:Session_state variables initialized
2026-01-30 17:45:16 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:45:16 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:45:16 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:45:16 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:45:16 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:45:16 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:45:16 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:45:16 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:45:16 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:45:16 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:45:16 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:45:16 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:45:16 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:45:16 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:45:16 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:45:16 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:45:16 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:45:16 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:45:16 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:45:16 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:45:16 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:45:16 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:45:16 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:45:16 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:45:16 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:45:16 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:45:16 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:45:16 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:45:16 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:45:16 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:45:16 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:45:16 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:45:16 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:45:16 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:45:16 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:45:16 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:45:16 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:45:16 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:45:16 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:45:16 +0000 DEBUG:menu_selection: {'title': 'Donor Type Analysis', 'function': <function mod_donor_type at 0x000001C18D437C70>}
2026-01-30 17:45:16 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:45:17 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:45:17 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:45:17 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:45:17 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:45:17 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:45:17 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:45:17 +0000 INFO:Session state Setup complete
2026-01-30 17:45:17 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:45:17 +0000 INFO:Package setup complete
2026-01-30 17:45:17 +0000 INFO:setup_package executed successfully
2026-01-30 17:45:17 +0000 INFO:Setup completed successfully.
2026-01-30 17:45:17 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:45:17 +0000 INFO:Running first load function.
2026-01-30 17:45:17 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:45:17 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:45:17 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:45:17 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:45:17 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:45:17 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:45:17 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:45:17 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:45:17 +0000 INFO:firstload executed successfully
2026-01-30 17:45:17 +0000 INFO:Data first load completed successfully.
2026-01-30 17:45:17 +0000 INFO:initialise_data executed successfully
2026-01-30 17:45:17 +0000 INFO:Running Menu setup...
2026-01-30 17:45:17 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:45:17 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:45:17 +0000 INFO:get_git_version executed successfully
2026-01-30 17:45:17 +0000 INFO:App Version: v50.239
2026-01-30 17:45:17 +0000 INFO:Switched to page: Donor Type Analysis
2026-01-30 17:45:17 +0000 DEBUG:Calling mod_donor_type with args={args}, kwargs={kwargs}
2026-01-30 17:45:17 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:45:17 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:45:18 +0000 INFO:mod_donor_type executed successfully
2026-01-30 17:45:18 +0000 INFO:pagesetup executed successfully
2026-01-30 17:45:18 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:45:19 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:47:53 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2026-01-30 17:47:53 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:47:56 +0000 INFO:get_git_version executed successfully
2026-01-30 17:47:57 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:48:00 +0000 INFO:get_git_version executed successfully
2026-01-30 17:48:00 +0000 INFO:Streamlit App Starting...
2026-01-30 17:48:00 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:48:00 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:48:00 +0000 INFO:Running App setup...
2026-01-30 17:48:00 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:48:00 +0000 INFO:Setting up the package
2026-01-30 17:48:00 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:48:00 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:48:03 +0000 INFO:get_git_version executed successfully
2026-01-30 17:48:03 +0000 INFO:Version: v50.201
2026-01-30 17:48:03 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:48:03 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:48:03 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2026-01-30 17:48:03 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:48:03 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2026-01-30 17:48:03 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2026-01-30 17:48:03 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:48:03 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:48:03 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:48:03 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:48:03 +0000 DEBUG:Initialised perc_target with value: 0.5
2026-01-30 17:48:03 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2026-01-30 17:48:03 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:48:03 +0000 DEBUG:Initialised electoral_cycle_rules with value: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:48:03 +0000 DEBUG:Initialised reference_dir with value: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:48:03 +0000 DEBUG:Initialised data_dir with value: H:\GitHub\dashboard_demo\data
2026-01-30 17:48:03 +0000 DEBUG:Initialised output_dir with value: H:\GitHub\dashboard_demo\output
2026-01-30 17:48:03 +0000 DEBUG:Initialised logs_dir with value: H:\GitHub\dashboard_demo\logs
2026-01-30 17:48:03 +0000 DEBUG:Initialised components_dir with value: H:\GitHub\dashboard_demo\components
2026-01-30 17:48:03 +0000 DEBUG:Initialised app_pages_dir with value: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:48:03 +0000 DEBUG:Initialised utils_dir with value: H:\GitHub\dashboard_demo\utils
2026-01-30 17:48:03 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:48:03 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:48:03 +0000 DEBUG:Initialised mppartymemb_fname with value: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:48:03 +0000 DEBUG:Initialised donor_map_fname with value: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:48:03 +0000 DEBUG:Initialised politician_party_fname with value: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:48:03 +0000 DEBUG:Initialised regentity_map_fname with value: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:48:03 +0000 DEBUG:Initialised original_data_fname with value: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:48:03 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:48:03 +0000 DEBUG:Initialised TEXT_FILE with value: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:48:03 +0000 DEBUG:Initialised ELECTION_DATES with value: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:48:03 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:48:03 +0000 DEBUG:Initialised cleaned_data_fname with value: cleaned_data.zip
2026-01-30 17:48:03 +0000 DEBUG:Initialised cleaned_donations_fname with value: cleaned_donations.zip
2026-01-30 17:48:03 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: cleaned_donorlist.zip
2026-01-30 17:48:03 +0000 DEBUG:Initialised cleaned_regentity_fname with value: cleaned_regentity.zip
2026-01-30 17:48:03 +0000 DEBUG:Initialised party_summary_fname with value: party_summary.zip
2026-01-30 17:48:03 +0000 DEBUG:Initialised imported_raw_fname with value: imported_raw.zip
2026-01-30 17:48:03 +0000 DEBUG:Initialised source_data_fname with value: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:48:03 +0000 DEBUG:Initialised Cash_ftr with value: None
2026-01-30 17:48:03 +0000 INFO:Session_state variables initialized
2026-01-30 17:48:03 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:48:03 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:48:03 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:48:03 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:48:03 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:48:03 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:48:03 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:48:03 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:48:03 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:48:03 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:48:03 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:48:03 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:48:03 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:48:03 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:48:03 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:48:03 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:48:03 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:48:03 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:48:03 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:48:03 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:48:03 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:48:03 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:48:03 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:48:03 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:48:03 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:48:03 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:48:03 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:48:03 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:48:03 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:48:03 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:48:03 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:48:03 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:48:03 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:48:03 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:48:03 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:48:03 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:48:03 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:48:03 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:48:03 +0000 INFO:Session state Setup complete
2026-01-30 17:48:03 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:48:03 +0000 INFO:Package setup complete
2026-01-30 17:48:03 +0000 INFO:setup_package executed successfully
2026-01-30 17:48:03 +0000 INFO:Setup completed successfully.
2026-01-30 17:48:03 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:48:03 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:48:06 +0000 INFO:get_git_version executed successfully
2026-01-30 17:48:06 +0000 INFO:Running first load function.
2026-01-30 17:48:06 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:48:06 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2026-01-30 17:48:06 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2026-01-30 17:48:06 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2026-01-30 17:48:06 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2026-01-30 17:48:06 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 17:48:06 +0000 INFO:Original file path: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:48:06 +0000 INFO:Saved file path: imported_raw.zip
2026-01-30 17:48:06 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 17:48:06 +0000 INFO:Checking if H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip has been updated.
2026-01-30 17:48:06 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 17:48:06 +0000 INFO:Getting modification time for H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:48:06 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 17:48:06 +0000 INFO:Current modification time: 1769774510.1556323
2026-01-30 17:48:06 +0000 INFO:Last modification time: 1769774510.1556323
2026-01-30 17:48:06 +0000 INFO:is_file_updated executed successfully
2026-01-30 17:48:06 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 17:48:06 +0000 INFO:Loading raw data...
2026-01-30 17:48:06 +0000 DEBUG:Original data file path post raw data load: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:48:06 +0000 DEBUG:Processed data file path post raw data load: imported_raw.zip
2026-01-30 17:48:06 +0000 INFO:Data loaded successfully. Data has 91341 rows and 29 columns
2026-01-30 17:48:07 +0000 INFO:Data saved to imported_raw.zip
2026-01-30 17:48:07 +0000 INFO:Data saved to sessionstate as 'raw_data'
2026-01-30 17:48:07 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2026-01-30 17:48:07 +0000 INFO:Cleaning up raw data
2026-01-30 17:48:07 +0000 ERROR:Session state variables not initialized!
2026-01-30 17:48:07 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 17:48:07 +0000 INFO:Original file path: None
2026-01-30 17:48:07 +0000 INFO:Saved file path: cleaned_donations.zip
2026-01-30 17:48:07 +0000 ERROR:Error: originalfilepath is None!
2026-01-30 17:48:07 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 17:48:07 +0000 INFO:Data loaded, shape: (91341, 29)
2026-01-30 17:48:09 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2026-01-30 17:48:09 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2026-01-30 17:48:09 +0000 INFO:File deduplication complete, shape: ECRef                            592
OriginalRegulatedEntityName      592
RegulatedEntityType              592
Value                            592
AcceptedDate                     574
AccountingUnitName               592
DonorName                        592
AccountingUnitsAsCentralParty    592
IsSponsorship                    592
DonorStatus                      592
RegulatedDoneeType               592
CompanyRegistrationNumber        592
Postcode                         592
DonationType                     592
NatureOfDonation                 592
PurposeOfVisit                   592
DonationAction                   592
ReceivedDate                     486
ReportedDate                     592
IsReportedPrePoll                423
ReportingPeriodName              592
IsBequest                        592
IsAggregation                    592
OriginalRegulatedEntityId        592
AccountingUnitId                 592
DonorId                          592
CampaigningName                  592
RegisterName                     592
IsIrishSource                    592
CleanedRegulatedEntityName       592
CleanedRegulatedEntityId         592
RegulatedEntityId                592
RegulatedEntityName              592
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10109
OriginalRegulatedEntityName      10109
RegulatedEntityType              10109
Value                            10107
AcceptedDate                      9796
AccountingUnitName               10109
DonorName                        10109
AccountingUnitsAsCentralParty    10109
IsSponsorship                    10109
DonorStatus                      10109
RegulatedDoneeType               10109
CompanyRegistrationNumber        10109
Postcode                         10109
DonationType                     10109
NatureOfDonation                 10109
PurposeOfVisit                   10109
DonationAction                   10109
ReceivedDate                      7075
ReportedDate                     10099
IsReportedPrePoll                 4878
ReportingPeriodName              10109
IsBequest                        10109
IsAggregation                    10109
OriginalRegulatedEntityId        10109
AccountingUnitId                 10109
DonorId                          10109
CampaigningName                  10109
RegisterName                     10109
IsIrishSource                    10109
CleanedRegulatedEntityName       10109
CleanedRegulatedEntityId         10109
RegulatedEntityId                10109
RegulatedEntityName              10109
dtype: int64 records updated with new RegulatedEntityName
2026-01-30 17:48:09 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3771
OriginalRegulatedEntityName      3771
RegulatedEntityType              3771
Value                            3771
AcceptedDate                     3667
AccountingUnitName               3771
DonorName                        3771
AccountingUnitsAsCentralParty    3771
IsSponsorship                    3771
DonorStatus                      3771
RegulatedDoneeType               3771
CompanyRegistrationNumber        3771
Postcode                         3771
DonationType                     3771
NatureOfDonation                 3771
PurposeOfVisit                   3771
DonationAction                   3771
ReceivedDate                     3297
ReportedDate                     3771
IsReportedPrePoll                 449
ReportingPeriodName              3771
IsBequest                        3771
IsAggregation                    3771
OriginalRegulatedEntityId        3771
AccountingUnitId                 3771
DonorId                          3771
CampaigningName                  3771
RegisterName                     3771
IsIrishSource                    3771
CleanedRegulatedEntityName        592
CleanedRegulatedEntityId          592
RegulatedEntityId                3771
RegulatedEntityName              3771
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13288
OriginalRegulatedEntityName      13288
RegulatedEntityType              13288
Value                            13286
AcceptedDate                     12889
AccountingUnitName               13288
DonorName                        13288
AccountingUnitsAsCentralParty    13288
IsSponsorship                    13288
DonorStatus                      13288
RegulatedDoneeType               13288
CompanyRegistrationNumber        13288
Postcode                         13288
DonationType                     13288
NatureOfDonation                 13288
PurposeOfVisit                   13288
DonationAction                   13288
ReceivedDate                      9886
ReportedDate                     13278
IsReportedPrePoll                 4904
ReportingPeriodName              13288
IsBequest                        13288
IsAggregation                    13288
OriginalRegulatedEntityId        13288
AccountingUnitId                 13288
DonorId                          13288
CampaigningName                  13288
RegisterName                     13288
IsIrishSource                    13288
CleanedRegulatedEntityName       10109
CleanedRegulatedEntityId         10109
RegulatedEntityId                13288
RegulatedEntityName              13288
dtype: int64 records updated with new RegulatedEntityName
2026-01-30 17:48:09 +0000 INFO:File deduplication complete, shape: (91341, 33)
2026-01-30 17:48:09 +0000 INFO:dedupe_entity_file executed successfully
2026-01-30 17:48:09 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2026-01-30 17:48:09 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2026-01-30 17:48:10 +0000 INFO:File deduplication complete, shape: ECRef                            34082
OriginalRegulatedEntityName      34082
RegulatedEntityType              34082
Value                            34079
AcceptedDate                     33689
AccountingUnitName               34082
OriginalDonorName                34082
AccountingUnitsAsCentralParty    34082
IsSponsorship                    34082
DonorStatus                      34082
RegulatedDoneeType               34082
CompanyRegistrationNumber        34082
Postcode                         34082
DonationType                     34082
NatureOfDonation                 34082
PurposeOfVisit                   34082
DonationAction                   34082
ReceivedDate                     32487
ReportedDate                     34071
IsReportedPrePoll                22707
ReportingPeriodName              34082
IsBequest                        34082
IsAggregation                    34082
OriginalRegulatedEntityId        34082
AccountingUnitId                 34082
OriginalDonorId                  34082
CampaigningName                  34082
RegisterName                     34082
IsIrishSource                    34082
CleanedRegulatedEntityName       34082
CleanedRegulatedEntityId         34082
RegulatedEntityId                34082
RegulatedEntityName              34082
CleanedDonorName                 34082
CleanedDonorId                   34082
DonorId                          34082
DonorName                        34082
dtype: int64 records updated with new DonorId and ECRef                            20155
OriginalRegulatedEntityName      20155
RegulatedEntityType              20155
Value                            20153
AcceptedDate                     19834
AccountingUnitName               20155
OriginalDonorName                20155
AccountingUnitsAsCentralParty    20155
IsSponsorship                    20155
DonorStatus                      20155
RegulatedDoneeType               20155
CompanyRegistrationNumber        20155
Postcode                         20155
DonationType                     20155
NatureOfDonation                 20155
PurposeOfVisit                   20155
DonationAction                   20155
ReceivedDate                     19620
ReportedDate                     20146
IsReportedPrePoll                13414
ReportingPeriodName              20155
IsBequest                        20155
IsAggregation                    20155
OriginalRegulatedEntityId        20155
AccountingUnitId                 20155
OriginalDonorId                  20155
CampaigningName                  20155
RegisterName                     20155
IsIrishSource                    20155
CleanedRegulatedEntityName       20154
CleanedRegulatedEntityId         20154
RegulatedEntityId                20155
RegulatedEntityName              20155
CleanedDonorName                 20155
CleanedDonorId                   20155
DonorId                          20155
DonorName                        20155
dtype: int64 records updated with new DonorName
2026-01-30 17:48:10 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            52934
OriginalRegulatedEntityName      52934
RegulatedEntityType              52934
Value                            52931
AcceptedDate                     52138
AccountingUnitName               52934
OriginalDonorName                52934
AccountingUnitsAsCentralParty    52934
IsSponsorship                    52934
DonorStatus                      52934
RegulatedDoneeType               52934
CompanyRegistrationNumber        52934
Postcode                         52934
DonationType                     52934
NatureOfDonation                 52934
PurposeOfVisit                   52934
DonationAction                   52934
ReceivedDate                     50532
ReportedDate                     52923
IsReportedPrePoll                23658
ReportingPeriodName              52934
IsBequest                        52934
IsAggregation                    52934
OriginalRegulatedEntityId        52934
AccountingUnitId                 52934
OriginalDonorId                  52934
CampaigningName                  52934
RegisterName                     52934
IsIrishSource                    52934
CleanedRegulatedEntityName       49804
CleanedRegulatedEntityId         49804
RegulatedEntityId                52934
RegulatedEntityName              52934
CleanedDonorName                 34082
CleanedDonorId                   34082
DonorId                          52934
DonorName                        52934
dtype: int64 records updated with new DonorId and ECRef                            39007
OriginalRegulatedEntityName      39007
RegulatedEntityType              39007
Value                            39005
AcceptedDate                     38283
AccountingUnitName               39007
OriginalDonorName                39007
AccountingUnitsAsCentralParty    39007
IsSponsorship                    39007
DonorStatus                      39007
RegulatedDoneeType               39007
CompanyRegistrationNumber        39007
Postcode                         39007
DonationType                     39007
NatureOfDonation                 39007
PurposeOfVisit                   39007
DonationAction                   39007
ReceivedDate                     37665
ReportedDate                     38998
IsReportedPrePoll                14365
ReportingPeriodName              39007
IsBequest                        39007
IsAggregation                    39007
OriginalRegulatedEntityId        39007
AccountingUnitId                 39007
OriginalDonorId                  39007
CampaigningName                  39007
RegisterName                     39007
IsIrishSource                    39007
CleanedRegulatedEntityName       35876
CleanedRegulatedEntityId         35876
RegulatedEntityId                39007
RegulatedEntityName              39007
CleanedDonorName                 20155
CleanedDonorId                   20155
DonorId                          39007
DonorName                        39007
dtype: int64 records updated with new DonorName
2026-01-30 17:48:10 +0000 INFO:File deduplication complete, shape: (91341, 37)
2026-01-30 17:48:10 +0000 INFO:dedupe_entity_file executed successfully
2026-01-30 17:48:10 +0000 INFO:Raw Data cleanup completed
2026-01-30 17:48:10 +0000 INFO:Data shape: (91341, 37)
2026-01-30 17:48:12 +0000 INFO:Data saved to cleaned_donations.zip
2026-01-30 17:48:12 +0000 INFO:Data cleanup completed, shape: (91341, 37)
2026-01-30 17:48:12 +0000 INFO:raw_data_cleanup executed successfully
2026-01-30 17:48:12 +0000 INFO:load_raw_data executed successfully
2026-01-30 17:48:12 +0000 INFO:get_raw_data executed successfully
2026-01-30 17:48:12 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:48:12 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2026-01-30 17:48:12 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2026-01-30 17:48:12 +0000 DEBUG:Rows in Raw Data: 91341
2026-01-30 17:48:12 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 17:48:12 +0000 INFO:Original file path: cleaned_donations.zip
2026-01-30 17:48:12 +0000 INFO:Saved file path: cleaned_data.zip
2026-01-30 17:48:12 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 17:48:12 +0000 INFO:Checking if cleaned_donations.zip has been updated.
2026-01-30 17:48:12 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 17:48:12 +0000 INFO:Getting modification time for cleaned_donations.zip
2026-01-30 17:48:12 +0000 WARNING:File cleaned_donations.zip does not exist.
2026-01-30 17:48:12 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 17:48:12 +0000 INFO:Current modification time: None
2026-01-30 17:48:12 +0000 INFO:Last modification time: 1769774510.1556323
2026-01-30 17:48:12 +0000 WARNING:Cannot determine modification time for cleaned_donations.zip
2026-01-30 17:48:12 +0000 INFO:is_file_updated executed successfully
2026-01-30 17:48:12 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 17:48:12 +0000 ERROR:Failed to load data from cleaned_donations.zip
2026-01-30 17:48:12 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2026-01-30 17:48:12 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91341
2026-01-30 17:48:12 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91341
2026-01-30 17:48:14 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2026-01-30 17:48:14 +0000 DEBUG:Clean Data Prep 204: Map Party: 91341
2026-01-30 17:48:48 +0000 INFO:Added parliamentary_sitting column with 8 unique periods
2026-01-30 17:48:48 +0000 DEBUG:Group assignment with exceptions: {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}
2026-01-30 17:48:48 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28638
Labour Party                       22675
Liberal Democrats                  19030
Large Entity                        8611
Medium Entity                       3809
Small Entity                        1985
Uk Independence Party (Ukip)        1830
Green Party                         1673
Single Donation Entity              1353
Scottish National Party (Snp)        815
Plaid Cymru - Party Of Wales         517
Reform UK                            377
Liberal Party                         15
Sinn Féin                             13
Name: count, dtype: int64
2026-01-30 17:48:48 +0000 DEBUG:Group assignment: group
Single Donation Entity             1353
Small Entity                        839
Medium Entity                       614
Large Entity                        227
Conservative And Unionist Party       8
Labour Party                          8
Liberal Democrats                     8
Plaid Cymru - Party Of Wales          8
Scottish National Party (Snp)         8
Uk Independence Party (Ukip)          8
Green Party                           7
Liberal Party                         4
Reform UK                             3
Sinn Féin                             1
Name: count, dtype: int64
2026-01-30 17:48:48 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91341
2026-01-30 17:48:48 +0000 DEBUG:Group assignment with exceptions: {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}
2026-01-30 17:48:48 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32036
Labour Party                       27106
Large Entity                       24804
Uk Independence Party (Ukip)        1853
Green Party                         1694
Medium Entity                       1112
Scottish National Party (Snp)        881
Small Entity                         552
Plaid Cymru - Party Of Wales         525
Reform UK                            377
Single Donation Entity               372
Liberal Party                         15
Sinn Féin                             13
Democratic Unionist Party              1
Name: count, dtype: int64
2026-01-30 17:48:48 +0000 DEBUG:Group assignment: group
Single Donation Entity             372
Small Entity                       233
Medium Entity                      171
Large Entity                       120
Conservative And Unionist Party      8
Labour Party                         8
Plaid Cymru - Party Of Wales         8
Scottish National Party (Snp)        8
Uk Independence Party (Ukip)         8
Green Party                          7
Liberal Party                        4
Reform UK                            3
Democratic Unionist Party            1
Sinn Féin                            1
Name: count, dtype: int64
2026-01-30 17:48:48 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91341
2026-01-30 17:48:48 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2026-01-30 17:48:48 +0000 INFO:Loading election dates from pdpy.
2026-01-30 17:48:48 +0000 INFO:Election Dates loaded from pdpy.
2026-01-30 17:48:48 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2026-01-30 17:48:48 +0000 INFO:Election Dates Loaded Successfully.
2026-01-30 17:48:48 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:48:48 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:48:48 +0000 INFO:load_election_dates executed successfully
2026-01-30 17:48:49 +0000 DEBUG:Clean Data Prep 353: Election dates: 91341
2026-01-30 17:48:49 +0000 DEBUG:Clean Data Prep 386: End of clean: 91341
2026-01-30 17:48:51 +0000 INFO:Cleaned Data completed, shape: (91341, 57)
2026-01-30 17:48:51 +0000 INFO:load_cleaned_data executed successfully
2026-01-30 17:48:51 +0000 INFO:get_cleaned_data executed successfully
2026-01-30 17:48:51 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:48:51 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2026-01-30 17:48:51 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2026-01-30 17:48:51 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 17:48:51 +0000 INFO:Original file path: cleaned_data.zip
2026-01-30 17:48:51 +0000 INFO:Saved file path: cleaned_donorlist.zip
2026-01-30 17:48:51 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 17:48:51 +0000 INFO:Checking if cleaned_data.zip has been updated.
2026-01-30 17:48:51 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 17:48:51 +0000 INFO:Getting modification time for cleaned_data.zip
2026-01-30 17:48:51 +0000 WARNING:File cleaned_data.zip does not exist.
2026-01-30 17:48:51 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 17:48:51 +0000 INFO:Current modification time: None
2026-01-30 17:48:51 +0000 INFO:Last modification time: 1769718453.1764421
2026-01-30 17:48:51 +0000 WARNING:Cannot determine modification time for cleaned_data.zip
2026-01-30 17:48:51 +0000 INFO:is_file_updated executed successfully
2026-01-30 17:48:51 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 17:48:51 +0000 INFO:Donor data saved to cleaned_donorlist.zip
2026-01-30 17:48:51 +0000 INFO:Donor Data summary completed
2026-01-30 17:48:51 +0000 INFO:Data shape: (32070, 5)
2026-01-30 17:48:51 +0000 INFO:load_donorList_data executed successfully
2026-01-30 17:48:51 +0000 INFO:get_donor_data executed successfully
2026-01-30 17:48:51 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:48:51 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:48:51 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2026-01-30 17:48:51 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2026-01-30 17:48:51 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 17:48:51 +0000 INFO:Original file path: cleaned_data.zip
2026-01-30 17:48:51 +0000 INFO:Saved file path: cleaned_regentity.zip
2026-01-30 17:48:51 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 17:48:51 +0000 INFO:Checking if cleaned_data.zip has been updated.
2026-01-30 17:48:51 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 17:48:51 +0000 INFO:Getting modification time for cleaned_data.zip
2026-01-30 17:48:51 +0000 WARNING:File cleaned_data.zip does not exist.
2026-01-30 17:48:51 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 17:48:51 +0000 INFO:Current modification time: None
2026-01-30 17:48:51 +0000 INFO:Last modification time: 1769718453.1764421
2026-01-30 17:48:51 +0000 WARNING:Cannot determine modification time for cleaned_data.zip
2026-01-30 17:48:51 +0000 INFO:is_file_updated executed successfully
2026-01-30 17:48:51 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 17:48:51 +0000 INFO:Regulated entity data saved to cleaned_regentity.zip
2026-01-30 17:48:51 +0000 INFO:Raw Data cleanup completed
2026-01-30 17:48:51 +0000 INFO:Data shape: (2404, 6)
2026-01-30 17:48:51 +0000 INFO:load_regulated_entity_data executed successfully
2026-01-30 17:48:51 +0000 INFO:get_regentity_data executed successfully
2026-01-30 17:48:51 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:48:51 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:48:51 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:48:51 +0000 INFO:firstload executed successfully
2026-01-30 17:48:51 +0000 INFO:Data first load completed successfully.
2026-01-30 17:48:51 +0000 INFO:initialise_data executed successfully
2026-01-30 17:48:51 +0000 INFO:Running Menu setup...
2026-01-30 17:48:51 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:48:51 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:48:56 +0000 INFO:get_git_version executed successfully
2026-01-30 17:48:56 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:48:59 +0000 INFO:get_git_version executed successfully
2026-01-30 17:48:59 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:49:02 +0000 INFO:get_git_version executed successfully
2026-01-30 17:49:02 +0000 INFO:App Version: v50.239
2026-01-30 17:49:02 +0000 INFO:Switched to page: Introduction
2026-01-30 17:49:02 +0000 INFO:pagesetup executed successfully
2026-01-30 17:49:02 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:49:02 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:49:20 +0000 INFO:Streamlit App Starting...
2026-01-30 17:49:20 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:49:20 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:49:20 +0000 INFO:Running App setup...
2026-01-30 17:49:20 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:49:20 +0000 INFO:Setting up the package
2026-01-30 17:49:20 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:49:20 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:49:20 +0000 INFO:get_git_version executed successfully
2026-01-30 17:49:20 +0000 INFO:Version: v50.201
2026-01-30 17:49:20 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:49:20 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:49:20 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:security already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:directories already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:49:20 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:49:20 +0000 INFO:Session_state variables initialized
2026-01-30 17:49:20 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:49:20 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:49:20 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:49:20 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:49:20 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:49:20 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:49:20 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:49:20 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:49:20 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:49:20 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:49:20 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:49:20 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:49:20 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:49:20 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:49:20 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:49:20 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:49:20 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:49:20 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:49:20 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:49:20 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:49:20 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:49:20 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:49:20 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:49:20 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:49:20 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:49:20 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:49:20 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:49:20 +0000 DEBUG:menu_selection: {'title': 'Donor Type Analysis', 'function': <function mod_donor_type at 0x000001A49811B010>}
2026-01-30 17:49:20 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:49:20 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:49:20 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:49:20 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:49:20 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:49:20 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:49:20 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:49:20 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:49:20 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:49:20 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:49:20 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:49:20 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:49:20 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:49:20 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:49:20 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:49:20 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:49:20 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:49:20 +0000 INFO:Session state Setup complete
2026-01-30 17:49:20 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:49:20 +0000 INFO:Package setup complete
2026-01-30 17:49:20 +0000 INFO:setup_package executed successfully
2026-01-30 17:49:20 +0000 INFO:Setup completed successfully.
2026-01-30 17:49:20 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:49:20 +0000 INFO:Running first load function.
2026-01-30 17:49:20 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:49:20 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:49:20 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:49:20 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:49:20 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:49:20 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:49:20 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:49:20 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:49:20 +0000 INFO:firstload executed successfully
2026-01-30 17:49:20 +0000 INFO:Data first load completed successfully.
2026-01-30 17:49:20 +0000 INFO:initialise_data executed successfully
2026-01-30 17:49:20 +0000 INFO:Running Menu setup...
2026-01-30 17:49:20 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:49:20 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:49:20 +0000 INFO:get_git_version executed successfully
2026-01-30 17:49:20 +0000 INFO:App Version: v50.239
2026-01-30 17:49:20 +0000 INFO:Switched to page: Donor Type Analysis
2026-01-30 17:49:20 +0000 DEBUG:Calling mod_donor_type with args={args}, kwargs={kwargs}
2026-01-30 17:49:20 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:49:20 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:49:21 +0000 INFO:mod_donor_type executed successfully
2026-01-30 17:49:21 +0000 INFO:pagesetup executed successfully
2026-01-30 17:49:21 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:49:21 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:49:25 +0000 INFO:Streamlit App Starting...
2026-01-30 17:49:25 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:49:25 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:49:25 +0000 INFO:Running App setup...
2026-01-30 17:49:25 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:49:25 +0000 INFO:Setting up the package
2026-01-30 17:49:25 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:49:25 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:49:25 +0000 INFO:get_git_version executed successfully
2026-01-30 17:49:25 +0000 INFO:Version: v50.201
2026-01-30 17:49:25 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:49:25 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:49:25 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:security already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:directories already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:49:25 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:49:25 +0000 INFO:Session_state variables initialized
2026-01-30 17:49:25 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:49:25 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:49:25 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:49:25 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:49:25 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:49:25 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:49:25 +0000 DEBUG:view_type_donor_type: Actual
2026-01-30 17:49:25 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:49:25 +0000 DEBUG:metric_type_donor_type: Value of Donations
2026-01-30 17:49:25 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:49:25 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:49:25 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:49:25 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:49:25 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:49:25 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:49:25 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:49:25 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:49:25 +0000 DEBUG:sitting_select_donor_type: ['1997', '2001', '2005', '2010', '2015', '2017', '2019', '2024']
2026-01-30 17:49:25 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:49:25 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:49:25 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:49:25 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:49:25 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:49:25 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:49:25 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:49:25 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:49:25 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:49:25 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:49:25 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:49:25 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:49:25 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:49:25 +0000 DEBUG:menu_selection: {'title': 'Donor Loyalty Analysis', 'function': <function mod_donor_loyalty at 0x000001A49811A320>}
2026-01-30 17:49:25 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:49:25 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:49:25 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:49:25 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:49:25 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:49:25 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:49:25 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:49:25 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:49:25 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:49:25 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:49:25 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:49:25 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:49:25 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:49:25 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:49:25 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:49:25 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:49:25 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:49:25 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:49:25 +0000 INFO:Session state Setup complete
2026-01-30 17:49:25 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:49:25 +0000 INFO:Package setup complete
2026-01-30 17:49:25 +0000 INFO:setup_package executed successfully
2026-01-30 17:49:25 +0000 INFO:Setup completed successfully.
2026-01-30 17:49:25 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:49:25 +0000 INFO:Running first load function.
2026-01-30 17:49:25 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:49:25 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:49:25 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:49:25 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:49:25 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:49:25 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:49:25 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:49:25 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:49:25 +0000 INFO:firstload executed successfully
2026-01-30 17:49:25 +0000 INFO:Data first load completed successfully.
2026-01-30 17:49:25 +0000 INFO:initialise_data executed successfully
2026-01-30 17:49:25 +0000 INFO:Running Menu setup...
2026-01-30 17:49:25 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:49:25 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:49:25 +0000 INFO:get_git_version executed successfully
2026-01-30 17:49:25 +0000 INFO:App Version: v50.239
2026-01-30 17:49:25 +0000 INFO:Switched to page: Donor Loyalty Analysis
2026-01-30 17:49:25 +0000 DEBUG:Calling mod_donor_loyalty with args={args}, kwargs={kwargs}
2026-01-30 17:49:25 +0000 DEBUG:Calling display_donor_distribution with args={args}, kwargs={kwargs}
2026-01-30 17:49:25 +0000 DEBUG:Aggregated DataFrame:    Parties_Per_Donor  Count
0                  1  18611
1                 10      4
2                 11      1
3                 12      2
4                 13      2
5                 14      2
6                 17      2
7                 18      1
8                  2   1299
9                  3    185
10                 4     70
11                 5     24
12                 6     17
13                 7     10
14                 8      3
15                83      1
16                 9      3
2026-01-30 17:49:25 +0000 DEBUG:Sorted DataFrame:    Parties_Per_Donor  Count
0                  1  18611
8                  2   1299
9                  3    185
10                 4     70
11                 5     24
12                 6     17
13                 7     10
1                 10      4
14                 8      3
16                 9      3
3                 12      2
4                 13      2
5                 14      2
6                 17      2
2                 11      1
7                 18      1
15                83      1
2026-01-30 17:49:25 +0000 DEBUG:Unique XValues: ['1' '2' '3' '4' '5' '6' '7' '10' '8' '9' '12' '13' '14' '17' '11' '18'
 '83']
2026-01-30 17:49:25 +0000 DEBUG:Final color_discrete_map: {'1': '#636efa', '2': '#636efa', '3': '#636efa', '4': '#636efa', '5': '#636efa', '6': '#636efa', '7': '#636efa', '10': '#636efa', '8': '#636efa', '9': '#636efa', '12': '#636efa', '13': '#636efa', '14': '#636efa', '17': '#636efa', '11': '#636efa', '18': '#636efa', '83': '#636efa'}
2026-01-30 17:49:25 +0000 DEBUG:Missing color mappings for: ['1', '2', '3', '4', '5', '6', '7', '10', '8', '9', '12', '13', '14', '17', '11', '18', '83']
2026-01-30 17:49:25 +0000 DEBUG:Generated Figure: Figure({
    'data': [{'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '1',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '1',
              'offsetgroup': '1',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['1'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 's0g=', 'dtype': 'i2'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '2',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '2',
              'offsetgroup': '2',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['2'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'EwU=', 'dtype': 'i2'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '3',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '3',
              'offsetgroup': '3',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['3'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'uQA=', 'dtype': 'i2'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '4',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '4',
              'offsetgroup': '4',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['4'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Rg==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '5',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '5',
              'offsetgroup': '5',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['5'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'GA==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '6',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '6',
              'offsetgroup': '6',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['6'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'EQ==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '7',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '7',
              'offsetgroup': '7',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['7'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Cg==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '10',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '10',
              'offsetgroup': '10',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['10'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'BA==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '8',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '8',
              'offsetgroup': '8',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['8'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Aw==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '9',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '9',
              'offsetgroup': '9',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['9'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Aw==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '12',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '12',
              'offsetgroup': '12',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['12'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Ag==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '13',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '13',
              'offsetgroup': '13',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['13'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Ag==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '14',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '14',
              'offsetgroup': '14',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['14'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Ag==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '17',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '17',
              'offsetgroup': '17',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['17'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Ag==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '11',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '11',
              'offsetgroup': '11',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['11'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AQ==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '18',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '18',
              'offsetgroup': '18',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['18'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AQ==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '83',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '83',
              'offsetgroup': '83',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['83'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AQ==', 'dtype': 'i1'},
              'yaxis': 'y'}],
    'layout': {'barmode': 'group',
               'legend': {'title': {'text': 'Number of Parties'}, 'tracegroupgap': 0},
               'template': '...',
               'title': {'text': 'Distribution of Parties per Donor'},
               'xaxis': {'anchor': 'y',
                         'categoryarray': [1, 2, 3, 4, 5, 6, 7, 10, 8, 9, 12, 13,
                                           14, 17, 11, 18, 83],
                         'categoryorder': 'array',
                         'domain': [0.0, 1.0],
                         'title': {'text': 'Number of Parties'}},
               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': 'Number of Donors'}}}
})
2026-01-30 17:49:25 +0000 INFO:Bar chart displayed successfully.
2026-01-30 17:49:25 +0000 INFO:display_donor_distribution executed successfully
2026-01-30 17:49:25 +0000 DEBUG:Calling display_government_period_analysis with args={args}, kwargs={kwargs}
2026-01-30 17:49:26 +0000 DEBUG:matplotlib data path: H:\python310\lib\site-packages\matplotlib\mpl-data
2026-01-30 17:49:26 +0000 DEBUG:CONFIGDIR=C:\Users\pgold\.matplotlib
2026-01-30 17:49:26 +0000 DEBUG:interactive is False
2026-01-30 17:49:26 +0000 DEBUG:platform is win32
2026-01-30 17:49:26 +0000 DEBUG:CACHEDIR=C:\Users\pgold\.matplotlib
2026-01-30 17:49:26 +0000 DEBUG:Using fontManager instance from C:\Users\pgold\.matplotlib\fontlist-v330.json
2026-01-30 17:49:26 +0000 INFO:display_government_period_analysis executed successfully
2026-01-30 17:49:26 +0000 DEBUG:Calling display_loyalty_metrics with args={args}, kwargs={kwargs}
2026-01-30 17:49:29 +0000 INFO:Streamlit App Starting...
2026-01-30 17:49:29 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:49:29 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:49:29 +0000 INFO:Running App setup...
2026-01-30 17:49:29 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:49:29 +0000 INFO:Setting up the package
2026-01-30 17:49:29 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:49:29 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:49:29 +0000 INFO:get_git_version executed successfully
2026-01-30 17:49:29 +0000 INFO:Version: v50.201
2026-01-30 17:49:29 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:49:29 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:49:29 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:49:29 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:49:29 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:49:29 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:49:29 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:49:29 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:49:29 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:49:29 +0000 DEBUG:security already exists in session state
2026-01-30 17:49:29 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:49:29 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:49:29 +0000 DEBUG:directories already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:49:30 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:49:30 +0000 INFO:Session_state variables initialized
2026-01-30 17:49:30 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:49:30 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:49:30 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:49:30 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:49:30 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:49:30 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:49:30 +0000 DEBUG:view_type_donor_type: Actual
2026-01-30 17:49:30 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:49:30 +0000 DEBUG:metric_type_donor_type: Value of Donations
2026-01-30 17:49:30 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:49:30 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:49:30 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:49:30 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:49:30 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:49:30 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:49:30 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:49:30 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:49:30 +0000 DEBUG:sitting_select_donor_type: ['1997', '2001', '2005', '2010', '2015', '2017', '2019', '2024']
2026-01-30 17:49:30 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:49:30 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:49:30 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:49:30 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:49:30 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:49:30 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:49:30 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:49:30 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:49:30 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:49:30 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:49:30 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:49:30 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:49:30 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:49:30 +0000 DEBUG:menu_selection: {'title': 'Regulated Entity per Donor', 'function': <function mod_regulated_entity_per_donor at 0x000001A49811AA70>}
2026-01-30 17:49:30 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:49:30 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:49:30 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:49:30 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:49:31 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:49:31 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:49:31 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:49:31 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:49:31 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:49:31 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:49:31 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:49:31 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:49:31 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:49:31 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:49:31 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:49:31 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:49:31 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:49:31 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:49:31 +0000 INFO:Session state Setup complete
2026-01-30 17:49:31 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:49:31 +0000 INFO:Package setup complete
2026-01-30 17:49:31 +0000 INFO:setup_package executed successfully
2026-01-30 17:49:31 +0000 INFO:Setup completed successfully.
2026-01-30 17:49:31 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:49:31 +0000 INFO:Running first load function.
2026-01-30 17:49:31 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:49:31 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:49:31 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:49:31 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:49:31 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:49:31 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:49:31 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:49:31 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:49:31 +0000 INFO:firstload executed successfully
2026-01-30 17:49:31 +0000 INFO:Data first load completed successfully.
2026-01-30 17:49:31 +0000 INFO:initialise_data executed successfully
2026-01-30 17:49:31 +0000 INFO:Running Menu setup...
2026-01-30 17:49:31 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:49:31 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:49:31 +0000 INFO:get_git_version executed successfully
2026-01-30 17:49:31 +0000 INFO:App Version: v50.239
2026-01-30 17:49:31 +0000 INFO:Switched to page: Regulated Entity per Donor
2026-01-30 17:49:31 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:49:34 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:49:36 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:49:36 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:49:36 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:49:36 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:49:36 +0000 DEBUG:Page texts: {}
2026-01-30 17:49:36 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:49:36 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:49:37 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:49:37 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:49:37 +0000 INFO:pagesetup executed successfully
2026-01-30 17:49:37 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:49:37 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:49:56 +0000 INFO:Streamlit App Starting...
2026-01-30 17:49:56 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:49:56 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:49:56 +0000 INFO:Running App setup...
2026-01-30 17:49:56 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:49:56 +0000 INFO:Setting up the package
2026-01-30 17:49:56 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:49:56 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:49:56 +0000 INFO:get_git_version executed successfully
2026-01-30 17:49:56 +0000 INFO:Version: v50.201
2026-01-30 17:49:56 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:49:56 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:49:56 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:security already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:directories already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:49:56 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:49:56 +0000 INFO:Session_state variables initialized
2026-01-30 17:49:56 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:49:56 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:49:56 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:49:56 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:49:56 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:49:56 +0000 DEBUG:date_range_mod_regulated_donor_per_entity_mod_regulated_donor_per_entityRegulated Entity by DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:49:56 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:49:56 +0000 DEBUG:view_type_donor_type: Actual
2026-01-30 17:49:56 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:49:56 +0000 DEBUG:metric_type_donor_type: Value of Donations
2026-01-30 17:49:56 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:49:56 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:49:56 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:49:56 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:49:56 +0000 DEBUG:mod_regulated_donor_per_entity_None_mod_regulated_donor_per_entityRegulated Entity by DonorNone_group_entity_select: Donor
2026-01-30 17:49:56 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:49:56 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:49:56 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:49:56 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:49:56 +0000 DEBUG:sitting_select_donor_type: ['1997', '2001', '2005', '2010', '2015', '2017', '2019', '2024']
2026-01-30 17:49:56 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:49:56 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:49:56 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:49:56 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:49:56 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:49:56 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:49:56 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:49:56 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:49:56 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:49:56 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:49:56 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:49:56 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:49:56 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:49:56 +0000 DEBUG:menu_selection: {'title': 'Regulated Donor per Entity', 'function': <function mod_regulated_donor_per_entity at 0x000001A49811A9E0>}
2026-01-30 17:49:56 +0000 DEBUG:selected_entity_name: All
2026-01-30 17:49:56 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:49:56 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:49:56 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:49:56 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:49:56 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:49:56 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:49:56 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:49:56 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:49:56 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:49:56 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:49:56 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:49:56 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:49:56 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:49:56 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:49:56 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:49:56 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:49:56 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:49:56 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:49:56 +0000 INFO:Session state Setup complete
2026-01-30 17:49:56 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:49:56 +0000 INFO:Package setup complete
2026-01-30 17:49:56 +0000 INFO:setup_package executed successfully
2026-01-30 17:49:56 +0000 INFO:Setup completed successfully.
2026-01-30 17:49:56 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:49:56 +0000 INFO:Running first load function.
2026-01-30 17:49:56 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:49:56 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:49:56 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:49:56 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:49:56 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:49:56 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:49:56 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:49:56 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:49:56 +0000 INFO:firstload executed successfully
2026-01-30 17:49:56 +0000 INFO:Data first load completed successfully.
2026-01-30 17:49:56 +0000 INFO:initialise_data executed successfully
2026-01-30 17:49:56 +0000 INFO:Running Menu setup...
2026-01-30 17:49:56 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:49:56 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:49:56 +0000 INFO:get_git_version executed successfully
2026-01-30 17:49:56 +0000 INFO:App Version: v50.239
2026-01-30 17:49:56 +0000 INFO:Switched to page: Regulated Donor per Entity
2026-01-30 17:49:56 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:49:56 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:49:56 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:49:56 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:49:56 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:49:56 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:49:56 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:49:56 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:49:56 +0000 DEBUG:Page texts: {}
2026-01-30 17:49:56 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:49:56 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:49:57 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:49:57 +0000 INFO:display_data_page executed successfully
2026-01-30 17:49:57 +0000 INFO:pagesetup executed successfully
2026-01-30 17:49:57 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:49:57 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:50:56 +0000 INFO:Streamlit App Starting...
2026-01-30 17:50:56 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:50:56 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:50:56 +0000 INFO:Running App setup...
2026-01-30 17:50:56 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:50:56 +0000 INFO:Setting up the package
2026-01-30 17:50:56 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:50:56 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:50:56 +0000 INFO:get_git_version executed successfully
2026-01-30 17:50:56 +0000 INFO:Version: v50.201
2026-01-30 17:50:56 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:50:56 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:50:56 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:security already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:directories already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:50:56 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:50:56 +0000 INFO:Session_state variables initialized
2026-01-30 17:50:56 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:50:56 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:50:56 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:50:56 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:50:56 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:50:56 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:50:56 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:50:56 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:50:56 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:50:56 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:50:56 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:50:56 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:50:56 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:50:56 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:50:56 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:50:56 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:50:56 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:50:56 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:50:56 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:50:56 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:50:56 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:50:56 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:50:56 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:50:56 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:50:56 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:50:56 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:50:56 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:50:56 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:50:56 +0000 DEBUG:menu_selection: {'title': 'Internal Political Party Donations', 'function': <function mod_donations_per_political_party at 0x000001A49811A950>}
2026-01-30 17:50:56 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:50:56 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:50:56 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:50:56 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:50:56 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:50:56 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:50:56 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:50:56 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:50:56 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:50:56 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:50:56 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:50:56 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:50:56 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:50:56 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:50:56 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:50:56 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:50:56 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:50:56 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:50:56 +0000 INFO:Session state Setup complete
2026-01-30 17:50:56 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:50:56 +0000 INFO:Package setup complete
2026-01-30 17:50:56 +0000 INFO:setup_package executed successfully
2026-01-30 17:50:56 +0000 INFO:Setup completed successfully.
2026-01-30 17:50:56 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:50:56 +0000 INFO:Running first load function.
2026-01-30 17:50:56 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:50:56 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:50:56 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:50:56 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:50:56 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:50:56 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:50:56 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:50:56 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:50:56 +0000 INFO:firstload executed successfully
2026-01-30 17:50:56 +0000 INFO:Data first load completed successfully.
2026-01-30 17:50:56 +0000 INFO:initialise_data executed successfully
2026-01-30 17:50:56 +0000 INFO:Running Menu setup...
2026-01-30 17:50:56 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:50:56 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:50:56 +0000 INFO:get_git_version executed successfully
2026-01-30 17:50:56 +0000 INFO:App Version: v50.239
2026-01-30 17:50:56 +0000 INFO:Switched to page: Internal Political Party Donations
2026-01-30 17:50:56 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:50:56 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:50:57 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:50:57 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:50:57 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:50:57 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:50:57 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:50:57 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:50:57 +0000 DEBUG:Page texts: {}
2026-01-30 17:50:57 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:50:57 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:50:57 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:50:57 +0000 INFO:display_data_page executed successfully
2026-01-30 17:50:57 +0000 INFO:pagesetup executed successfully
2026-01-30 17:50:57 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:50:57 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:50:58 +0000 INFO:Streamlit App Starting...
2026-01-30 17:50:58 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:50:58 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:50:58 +0000 INFO:Running App setup...
2026-01-30 17:50:58 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:50:58 +0000 INFO:Setting up the package
2026-01-30 17:50:58 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:50:58 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:50:58 +0000 INFO:get_git_version executed successfully
2026-01-30 17:50:58 +0000 INFO:Version: v50.201
2026-01-30 17:50:58 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:50:58 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:50:58 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:security already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:directories already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:50:58 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:50:58 +0000 INFO:Session_state variables initialized
2026-01-30 17:50:58 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:50:58 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:50:58 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:50:58 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:50:58 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:50:58 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:50:58 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:50:58 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:50:58 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:50:58 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:50:59 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:50:59 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:50:59 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:50:59 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:50:59 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:50:59 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:50:59 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:50:59 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:50:59 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:50:59 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:50:59 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:50:59 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:50:59 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:50:59 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:50:59 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:50:59 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:50:59 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:50:59 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:50:59 +0000 DEBUG:menu_selection: {'title': 'Dubious Donations', 'function': <function mod_dubious_donations at 0x000001A49811A8C0>}
2026-01-30 17:50:59 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:50:59 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:50:59 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:50:59 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:50:59 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:50:59 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:50:59 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:50:59 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:50:59 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:50:59 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:50:59 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:50:59 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:50:59 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:50:59 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:50:59 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:50:59 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:50:59 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:50:59 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:50:59 +0000 INFO:Session state Setup complete
2026-01-30 17:50:59 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:50:59 +0000 INFO:Package setup complete
2026-01-30 17:50:59 +0000 INFO:setup_package executed successfully
2026-01-30 17:50:59 +0000 INFO:Setup completed successfully.
2026-01-30 17:50:59 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:50:59 +0000 INFO:Running first load function.
2026-01-30 17:50:59 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:50:59 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:50:59 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:50:59 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:50:59 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:50:59 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:50:59 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:50:59 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:50:59 +0000 INFO:firstload executed successfully
2026-01-30 17:50:59 +0000 INFO:Data first load completed successfully.
2026-01-30 17:50:59 +0000 INFO:initialise_data executed successfully
2026-01-30 17:50:59 +0000 INFO:Running Menu setup...
2026-01-30 17:50:59 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:50:59 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:50:59 +0000 INFO:get_git_version executed successfully
2026-01-30 17:50:59 +0000 INFO:App Version: v50.239
2026-01-30 17:50:59 +0000 INFO:Switched to page: Dubious Donations
2026-01-30 17:50:59 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:50:59 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:50:59 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:50:59 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:50:59 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:50:59 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:50:59 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:50:59 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:50:59 +0000 DEBUG:Page texts: {}
2026-01-30 17:50:59 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:50:59 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:50:59 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:50:59 +0000 INFO:display_data_page executed successfully
2026-01-30 17:50:59 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:50:59 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:50:59 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:50:59 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:50:59 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:50:59 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:50:59 +0000 DEBUG:Page texts: {}
2026-01-30 17:50:59 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:50:59 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:51:00 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:51:00 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:51:00 +0000 INFO:pagesetup executed successfully
2026-01-30 17:51:00 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:51:00 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:51:06 +0000 INFO:Streamlit App Starting...
2026-01-30 17:51:06 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:51:06 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:51:06 +0000 INFO:Running App setup...
2026-01-30 17:51:06 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:51:06 +0000 INFO:Setting up the package
2026-01-30 17:51:06 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:51:06 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:51:06 +0000 INFO:get_git_version executed successfully
2026-01-30 17:51:06 +0000 INFO:Version: v50.201
2026-01-30 17:51:06 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:51:06 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:51:06 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:security already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:directories already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:51:06 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:51:06 +0000 INFO:Session_state variables initialized
2026-01-30 17:51:06 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:51:06 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:51:06 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:51:06 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:51:06 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:51:06 +0000 DEBUG:mod_dubious_donations_per_donor_None_mod_dubious_donations_per_donorDubious Donations per DonorNone_group_entity_select: Donor
2026-01-30 17:51:06 +0000 DEBUG:date_range_mod_dubious_donations_per_donor_mod_dubious_donations_per_donorDubious Donations per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:51:06 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:51:06 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:51:06 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:51:06 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:51:06 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:51:06 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:51:06 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:51:06 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:51:06 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:51:06 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:51:06 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:51:06 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:51:06 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:51:06 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:51:06 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:51:06 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:51:06 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:51:06 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:51:06 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:51:06 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:51:06 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:51:06 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:51:06 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:51:06 +0000 DEBUG:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors at 0x000001A49811AB00>}
2026-01-30 17:51:06 +0000 DEBUG:selected_entity_name: All
2026-01-30 17:51:06 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:51:06 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:51:06 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:51:06 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:51:06 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:51:06 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:51:06 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:51:06 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:51:06 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:51:06 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:51:06 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:51:06 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:51:06 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:51:06 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:51:06 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:51:06 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:51:06 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:51:06 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:51:06 +0000 INFO:Session state Setup complete
2026-01-30 17:51:06 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:51:06 +0000 INFO:Package setup complete
2026-01-30 17:51:06 +0000 INFO:setup_package executed successfully
2026-01-30 17:51:06 +0000 INFO:Setup completed successfully.
2026-01-30 17:51:06 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:51:06 +0000 INFO:Running first load function.
2026-01-30 17:51:06 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:51:06 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:51:06 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:51:06 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:51:06 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:51:06 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:51:06 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:51:06 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:51:06 +0000 INFO:firstload executed successfully
2026-01-30 17:51:06 +0000 INFO:Data first load completed successfully.
2026-01-30 17:51:06 +0000 INFO:initialise_data executed successfully
2026-01-30 17:51:06 +0000 INFO:Running Menu setup...
2026-01-30 17:51:06 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:51:06 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:51:06 +0000 INFO:get_git_version executed successfully
2026-01-30 17:51:06 +0000 INFO:App Version: v50.239
2026-01-30 17:51:06 +0000 INFO:Switched to page: Dubious Donors
2026-01-30 17:51:06 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:51:06 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:51:06 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:51:06 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:51:06 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:51:06 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:51:06 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:51:06 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:51:06 +0000 DEBUG:Page texts: {}
2026-01-30 17:51:06 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:51:06 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:51:06 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:51:06 +0000 INFO:display_data_page executed successfully
2026-01-30 17:51:06 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:51:07 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:51:07 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:51:07 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:51:07 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:51:07 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:51:07 +0000 DEBUG:Page texts: {}
2026-01-30 17:51:07 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:51:07 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:51:07 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:51:07 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:51:07 +0000 INFO:pagesetup executed successfully
2026-01-30 17:51:07 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:51:07 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:51:08 +0000 INFO:Streamlit App Starting...
2026-01-30 17:51:08 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:51:08 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:51:08 +0000 INFO:Running App setup...
2026-01-30 17:51:08 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:51:08 +0000 INFO:Setting up the package
2026-01-30 17:51:08 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:51:08 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:51:08 +0000 INFO:get_git_version executed successfully
2026-01-30 17:51:08 +0000 INFO:Version: v50.201
2026-01-30 17:51:08 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:51:08 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:51:08 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:security already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:directories already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:51:08 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:51:08 +0000 INFO:Session_state variables initialized
2026-01-30 17:51:08 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:51:08 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:51:08 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:51:08 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:51:08 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:51:08 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:51:08 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:51:08 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:51:08 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:51:08 +0000 DEBUG:date_range_mod_dubious_donors_per_entity_mod_dubious_donors_per_entityDubious Donors per EntityNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:51:08 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:51:08 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:51:08 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:51:08 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:51:08 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:51:08 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:51:08 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:51:08 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:51:08 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:51:08 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:51:08 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:51:08 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:51:08 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:51:08 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:51:08 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:51:08 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:51:08 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:51:08 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:51:08 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:51:08 +0000 DEBUG:menu_selection: {'title': 'Paid Visits', 'function': <function mod_visits at 0x000001A498119990>}
2026-01-30 17:51:08 +0000 DEBUG:selected_entity_name: All
2026-01-30 17:51:08 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:51:08 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:51:08 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:51:08 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:51:08 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:51:08 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:51:08 +0000 DEBUG:mod_dubious_donors_per_entity_None_mod_dubious_donors_per_entityDubious Donors per EntityNone_group_entity_select: Donor
2026-01-30 17:51:08 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:51:08 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:51:08 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:51:08 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:51:08 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:51:08 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:51:08 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:51:08 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:51:08 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:51:08 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:51:08 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:51:08 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:51:08 +0000 INFO:Session state Setup complete
2026-01-30 17:51:08 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:51:08 +0000 INFO:Package setup complete
2026-01-30 17:51:08 +0000 INFO:setup_package executed successfully
2026-01-30 17:51:08 +0000 INFO:Setup completed successfully.
2026-01-30 17:51:08 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:51:08 +0000 INFO:Running first load function.
2026-01-30 17:51:08 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:51:08 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:51:08 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:51:08 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:51:08 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:51:08 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:51:08 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:51:08 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:51:08 +0000 INFO:firstload executed successfully
2026-01-30 17:51:08 +0000 INFO:Data first load completed successfully.
2026-01-30 17:51:08 +0000 INFO:initialise_data executed successfully
2026-01-30 17:51:08 +0000 INFO:Running Menu setup...
2026-01-30 17:51:08 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:51:08 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:51:08 +0000 INFO:get_git_version executed successfully
2026-01-30 17:51:08 +0000 INFO:App Version: v50.239
2026-01-30 17:51:08 +0000 INFO:Switched to page: Paid Visits
2026-01-30 17:51:08 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:51:08 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:51:08 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:51:08 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:51:08 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:51:08 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:51:08 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:51:08 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:51:08 +0000 DEBUG:Page texts: {}
2026-01-30 17:51:08 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:51:08 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:51:08 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:51:08 +0000 INFO:display_data_page executed successfully
2026-01-30 17:51:08 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:51:09 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:51:09 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:51:09 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:51:09 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:51:09 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:51:09 +0000 DEBUG:Page texts: {}
2026-01-30 17:51:09 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:51:09 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:51:09 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:51:09 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:51:09 +0000 INFO:pagesetup executed successfully
2026-01-30 17:51:09 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:51:09 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:51:14 +0000 INFO:Streamlit App Starting...
2026-01-30 17:51:14 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:51:14 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:51:14 +0000 INFO:Running App setup...
2026-01-30 17:51:14 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:51:14 +0000 INFO:Setting up the package
2026-01-30 17:51:14 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:51:14 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:51:14 +0000 INFO:get_git_version executed successfully
2026-01-30 17:51:14 +0000 INFO:Version: v50.201
2026-01-30 17:51:14 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:51:14 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:51:14 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:security already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:directories already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:51:14 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:51:14 +0000 INFO:Session_state variables initialized
2026-01-30 17:51:14 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:51:14 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:51:14 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:51:14 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:51:14 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:51:14 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:51:14 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:51:14 +0000 DEBUG:date_range_mod_visits_per_donor_mod_visits_per_donorDonated Visits per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:51:14 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:51:14 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:51:14 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:51:14 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:51:14 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:51:14 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:51:14 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:51:14 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:51:14 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:51:14 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:51:14 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:51:14 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:51:14 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:51:14 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:51:14 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:51:14 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:51:14 +0000 DEBUG:mod_visits_per_donor_None_mod_visits_per_donorDonated Visits per DonorNone_group_entity_select: Donor
2026-01-30 17:51:14 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:51:14 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:51:14 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:51:14 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:51:14 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:51:14 +0000 DEBUG:menu_selection: {'title': 'Sponsorships', 'function': <function mod_sponsorships at 0x000001A49811A710>}
2026-01-30 17:51:14 +0000 DEBUG:selected_entity_name: All
2026-01-30 17:51:14 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:51:14 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:51:14 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:51:14 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:51:15 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:51:15 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:51:15 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:51:15 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:51:15 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:51:15 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:51:15 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:51:15 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:51:15 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:51:15 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:51:15 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:51:15 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:51:15 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:51:15 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:51:15 +0000 INFO:Session state Setup complete
2026-01-30 17:51:15 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:51:15 +0000 INFO:Package setup complete
2026-01-30 17:51:15 +0000 INFO:setup_package executed successfully
2026-01-30 17:51:15 +0000 INFO:Setup completed successfully.
2026-01-30 17:51:15 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:51:15 +0000 INFO:Running first load function.
2026-01-30 17:51:15 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:51:15 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:51:15 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:51:15 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:51:15 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:51:15 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:51:15 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:51:15 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:51:15 +0000 INFO:firstload executed successfully
2026-01-30 17:51:15 +0000 INFO:Data first load completed successfully.
2026-01-30 17:51:15 +0000 INFO:initialise_data executed successfully
2026-01-30 17:51:15 +0000 INFO:Running Menu setup...
2026-01-30 17:51:15 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:51:15 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:51:15 +0000 INFO:get_git_version executed successfully
2026-01-30 17:51:15 +0000 INFO:App Version: v50.239
2026-01-30 17:51:15 +0000 INFO:Switched to page: Sponsorships
2026-01-30 17:51:15 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:51:15 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:51:15 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:51:15 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:51:15 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:51:15 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:51:15 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:51:15 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:51:15 +0000 DEBUG:Page texts: {}
2026-01-30 17:51:15 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:51:15 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:51:15 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:51:15 +0000 INFO:display_data_page executed successfully
2026-01-30 17:51:15 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:51:15 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:51:15 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:51:15 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:51:15 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:51:15 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:51:15 +0000 DEBUG:Page texts: {}
2026-01-30 17:51:15 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:51:15 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:51:15 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:51:15 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:51:15 +0000 INFO:pagesetup executed successfully
2026-01-30 17:51:15 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:51:15 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:51:29 +0000 INFO:Streamlit App Starting...
2026-01-30 17:51:29 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:51:29 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:51:29 +0000 INFO:Running App setup...
2026-01-30 17:51:29 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:51:29 +0000 INFO:Setting up the package
2026-01-30 17:51:29 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:51:29 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:51:29 +0000 INFO:get_git_version executed successfully
2026-01-30 17:51:29 +0000 INFO:Version: v50.201
2026-01-30 17:51:29 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:51:29 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:51:29 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:security already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:directories already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:51:29 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:51:29 +0000 INFO:Session_state variables initialized
2026-01-30 17:51:29 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:51:29 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:51:29 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:51:29 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:51:29 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:51:29 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:51:29 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:51:29 +0000 DEBUG:date_range_mod_sponsorships_per_donor_mod_sponsorships_per_donorSponsorships per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:51:29 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:51:29 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:51:29 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:51:29 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:51:29 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:51:29 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:51:29 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:51:29 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:51:29 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:51:29 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:51:29 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:51:29 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:51:29 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:51:29 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:51:29 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:51:29 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:51:29 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:51:29 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:51:29 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:51:29 +0000 DEBUG:mod_sponsorships_per_donor_None_mod_sponsorships_per_donorSponsorships per DonorNone_group_entity_select: Donor
2026-01-30 17:51:29 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:51:29 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:51:29 +0000 DEBUG:menu_selection: {'title': 'Corporate Donations', 'function': <function mod_corporate_donations at 0x000001A49811A830>}
2026-01-30 17:51:29 +0000 DEBUG:selected_entity_name: All
2026-01-30 17:51:29 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:51:29 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:51:29 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:51:29 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:51:29 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:51:29 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:51:29 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:51:29 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:51:29 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:51:29 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:51:29 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:51:29 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:51:29 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:51:29 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:51:29 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:51:29 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:51:29 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:51:29 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:51:29 +0000 INFO:Session state Setup complete
2026-01-30 17:51:29 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:51:29 +0000 INFO:Package setup complete
2026-01-30 17:51:29 +0000 INFO:setup_package executed successfully
2026-01-30 17:51:29 +0000 INFO:Setup completed successfully.
2026-01-30 17:51:29 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:51:29 +0000 INFO:Running first load function.
2026-01-30 17:51:29 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:51:29 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:51:29 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:51:29 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:51:29 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:51:29 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:51:29 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:51:29 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:51:29 +0000 INFO:firstload executed successfully
2026-01-30 17:51:29 +0000 INFO:Data first load completed successfully.
2026-01-30 17:51:29 +0000 INFO:initialise_data executed successfully
2026-01-30 17:51:29 +0000 INFO:Running Menu setup...
2026-01-30 17:51:29 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:51:29 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:51:29 +0000 INFO:get_git_version executed successfully
2026-01-30 17:51:29 +0000 INFO:App Version: v50.239
2026-01-30 17:51:29 +0000 INFO:Switched to page: Corporate Donations
2026-01-30 17:51:29 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:51:29 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:51:29 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:51:29 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:51:29 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:51:29 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:51:29 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:51:29 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:51:29 +0000 DEBUG:Page texts: {}
2026-01-30 17:51:29 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:51:29 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:51:30 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:51:30 +0000 INFO:display_data_page executed successfully
2026-01-30 17:51:30 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:51:30 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:51:30 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:51:30 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:51:30 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:51:30 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:51:30 +0000 DEBUG:Page texts: {}
2026-01-30 17:51:30 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:51:30 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:51:30 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:51:30 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:51:30 +0000 INFO:pagesetup executed successfully
2026-01-30 17:51:30 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:51:30 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:51:34 +0000 INFO:Streamlit App Starting...
2026-01-30 17:51:34 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:51:34 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:51:34 +0000 INFO:Running App setup...
2026-01-30 17:51:34 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:51:34 +0000 INFO:Setting up the package
2026-01-30 17:51:34 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:51:34 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:51:34 +0000 INFO:get_git_version executed successfully
2026-01-30 17:51:34 +0000 INFO:Version: v50.201
2026-01-30 17:51:34 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:51:34 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:51:34 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:security already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:directories already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:51:34 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:51:34 +0000 INFO:Session_state variables initialized
2026-01-30 17:51:34 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:51:34 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:51:34 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:51:34 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:51:34 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:51:34 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:51:34 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:51:34 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:51:34 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:51:34 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:51:34 +0000 DEBUG:mod_corporate_donations_per_donor_None_mod_corporate_donations_per_donorCorporate Donation per DonorNone_group_entity_select: Donor
2026-01-30 17:51:34 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:51:34 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:51:34 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:51:34 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:51:34 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:51:34 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:51:34 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:51:34 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:51:34 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:51:34 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:51:34 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:51:34 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:51:34 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:51:34 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:51:34 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:51:34 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:51:34 +0000 DEBUG:date_range_mod_corporate_donations_per_donor_mod_corporate_donations_per_donorCorporate Donation per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:51:34 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:51:34 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:51:34 +0000 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x000001A498119750>}
2026-01-30 17:51:34 +0000 DEBUG:selected_entity_name: All
2026-01-30 17:51:34 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:51:34 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:51:34 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:51:34 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:51:34 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:51:34 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:51:34 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:51:34 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:51:34 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:51:34 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:51:34 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:51:34 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:51:34 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:51:34 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:51:34 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:51:34 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:51:34 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:51:34 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:51:34 +0000 INFO:Session state Setup complete
2026-01-30 17:51:34 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:51:34 +0000 INFO:Package setup complete
2026-01-30 17:51:34 +0000 INFO:setup_package executed successfully
2026-01-30 17:51:34 +0000 INFO:Setup completed successfully.
2026-01-30 17:51:34 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:51:34 +0000 INFO:Running first load function.
2026-01-30 17:51:34 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:51:34 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:51:34 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:51:34 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:51:34 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:51:34 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:51:34 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:51:34 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:51:34 +0000 INFO:firstload executed successfully
2026-01-30 17:51:34 +0000 INFO:Data first load completed successfully.
2026-01-30 17:51:34 +0000 INFO:initialise_data executed successfully
2026-01-30 17:51:34 +0000 INFO:Running Menu setup...
2026-01-30 17:51:34 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:51:34 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:51:34 +0000 INFO:get_git_version executed successfully
2026-01-30 17:51:34 +0000 INFO:App Version: v50.239
2026-01-30 17:51:34 +0000 INFO:Switched to page: Head Line Figures
2026-01-30 17:51:34 +0000 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2026-01-30 17:51:34 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:51:34 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:51:34 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:51:35 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:51:36 +0000 DEBUG:Aggregated DataFrame:                         Party_Group         Value
0   Conservative And Unionist Party  20170.405233
1         Democratic Unionist Party   3618.940000
2                       Green Party   6204.226405
3                      Labour Party  20519.157176
4                      Large Entity  12031.362470
5                     Liberal Party   2871.754667
6                     Medium Entity  19378.136232
7      Plaid Cymru - Party Of Wales  15859.742724
8                         Reform UK  97641.772732
9     Scottish National Party (Snp)  36021.189364
10           Single Donation Entity  13864.955459
11                        Sinn Féin  44317.630769
12                     Small Entity  24968.983822
13     Uk Independence Party (Ukip)   9943.456859
2026-01-30 17:51:36 +0000 DEBUG:Sorted DataFrame:                         Party_Group         Value
8                         Reform UK  97641.772732
11                        Sinn Féin  44317.630769
9     Scottish National Party (Snp)  36021.189364
12                     Small Entity  24968.983822
3                      Labour Party  20519.157176
0   Conservative And Unionist Party  20170.405233
6                     Medium Entity  19378.136232
7      Plaid Cymru - Party Of Wales  15859.742724
10           Single Donation Entity  13864.955459
4                      Large Entity  12031.362470
13     Uk Independence Party (Ukip)   9943.456859
2                       Green Party   6204.226405
1         Democratic Unionist Party   3618.940000
5                     Liberal Party   2871.754667
2026-01-30 17:51:36 +0000 DEBUG:Unique XValues: ['Reform UK' 'Sinn Féin' 'Scottish National Party (Snp)' 'Small Entity'
 'Labour Party' 'Conservative And Unionist Party' 'Medium Entity'
 'Plaid Cymru - Party Of Wales' 'Single Donation Entity' 'Large Entity'
 'Uk Independence Party (Ukip)' 'Green Party' 'Democratic Unionist Party'
 'Liberal Party']
2026-01-30 17:51:36 +0000 DEBUG:Final color_discrete_map: {'Reform UK': '#12B6CF', 'Sinn Féin': '#326760', 'Scottish National Party (Snp)': '#636efa', 'Small Entity': '#aaaaaa', 'Labour Party': '#DC241F', 'Conservative And Unionist Party': '#0087DC', 'Medium Entity': '#666666', 'Plaid Cymru - Party Of Wales': '#636efa', 'Single Donation Entity': '#e8e8e8', 'Large Entity': '#222222', 'Uk Independence Party (Ukip)': '#70147A', 'Green Party': '#78B943', 'Democratic Unionist Party': '#636efa', 'Liberal Party': '#636efa'}
2026-01-30 17:51:36 +0000 DEBUG:Missing color mappings for: ['Scottish National Party (Snp)', 'Plaid Cymru - Party Of Wales', 'Democratic Unionist Party', 'Liberal Party']
2026-01-30 17:51:36 +0000 DEBUG:Generated Figure: Figure({
    'data': [{'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Reform UK',
              'marker': {'color': '#12B6CF', 'pattern': {'shape': ''}},
              'name': 'Reform UK',
              'offsetgroup': 'Reform UK',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Reform UK'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'a1QcXZzW90A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Sinn Féin',
              'marker': {'color': '#326760', 'pattern': {'shape': ''}},
              'name': 'Sinn Féin',
              'offsetgroup': 'Sinn Féin',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Sinn Féin'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'L/RCL7Sj5UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Scottish National Party (Snp)',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Scottish National Party (Snp)',
              'offsetgroup': 'Scottish National Party (Snp)',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Scottish National Party (Snp)'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '8tdFD6aW4UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Small Entity',
              'marker': {'color': '#aaaaaa', 'pattern': {'shape': ''}},
              'name': 'Small Entity',
              'offsetgroup': 'Small Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Small Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'vX7y9j5i2EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Labour Party',
              'marker': {'color': '#DC241F', 'pattern': {'shape': ''}},
              'name': 'Labour Party',
              'offsetgroup': 'Labour Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Labour Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '9qMqD8oJ1EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Conservative And Unionist Party',
              'marker': {'color': '#0087DC', 'pattern': {'shape': ''}},
              'name': 'Conservative And Unionist Party',
              'offsetgroup': 'Conservative And Unionist Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Conservative And Unionist Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '65FU75my00A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Medium Entity',
              'marker': {'color': '#666666', 'pattern': {'shape': ''}},
              'name': 'Medium Entity',
              'offsetgroup': 'Medium Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Medium Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'nXsGuIjs0kA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Plaid Cymru - Party Of Wales',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Plaid Cymru - Party Of Wales',
              'offsetgroup': 'Plaid Cymru - Party Of Wales',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Plaid Cymru - Party Of Wales'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '7uOSEd/5zkA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Single Donation Entity',
              'marker': {'color': '#e8e8e8', 'pattern': {'shape': ''}},
              'name': 'Single Donation Entity',
              'offsetgroup': 'Single Donation Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Single Donation Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'hd1+THoUy0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Large Entity',
              'marker': {'color': '#222222', 'pattern': {'shape': ''}},
              'name': 'Large Entity',
              'offsetgroup': 'Large Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Large Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'lyJsZa5/x0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Uk Independence Party (Ukip)',
              'marker': {'color': '#70147A', 'pattern': {'shape': ''}},
              'name': 'Uk Independence Party (Ukip)',
              'offsetgroup': 'Uk Independence Party (Ukip)',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Uk Independence Party (Ukip)'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'U0xcerprw0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Green Party',
              'marker': {'color': '#78B943', 'pattern': {'shape': ''}},
              'name': 'Green Party',
              'offsetgroup': 'Green Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Green Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'LOWs9Tk8uEA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Democratic Unionist Party',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Democratic Unionist Party',
              'offsetgroup': 'Democratic Unionist Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Democratic Unionist Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'exSuR+FFrEA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Liberal Party',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Liberal Party',
              'offsetgroup': 'Liberal Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Liberal Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'blmrY4JvpkA=', 'dtype': 'f8'},
              'yaxis': 'y'}],
    'layout': {'barmode': 'group',
               'legend': {'title': {'text': 'Political Party'}, 'tracegroupgap': 0},
               'template': '...',
               'title': {'text': 'Average Donation per Party'},
               'xaxis': {'anchor': 'y',
                         'categoryarray': [Reform UK, Sinn Féin, Scottish National
                                           Party (Snp), Small Entity, Labour Party,
                                           Conservative And Unionist Party, Medium
                                           Entity, Plaid Cymru - Party Of Wales,
                                           Single Donation Entity, Large Entity, Uk
                                           Independence Party (Ukip), Green Party,
                                           Democratic Unionist Party, Liberal
                                           Party],
                         'categoryorder': 'array',
                         'domain': [0.0, 1.0],
                         'title': {'text': 'Political Party'}},
               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': 'Average Donation GBP'}}}
})
2026-01-30 17:51:36 +0000 INFO:Bar chart displayed successfully.
2026-01-30 17:51:36 +0000 INFO:hlf_body executed successfully
2026-01-30 17:51:36 +0000 INFO:pagesetup executed successfully
2026-01-30 17:51:36 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:51:36 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:53:14 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2026-01-30 17:53:14 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:53:17 +0000 INFO:get_git_version executed successfully
2026-01-30 17:53:18 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:53:23 +0000 INFO:get_git_version executed successfully
2026-01-30 17:53:23 +0000 INFO:Streamlit App Starting...
2026-01-30 17:53:23 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:53:23 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:53:23 +0000 INFO:Running App setup...
2026-01-30 17:53:23 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:53:23 +0000 INFO:Setting up the package
2026-01-30 17:53:23 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:53:23 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:53:26 +0000 INFO:get_git_version executed successfully
2026-01-30 17:53:26 +0000 INFO:Version: v50.201
2026-01-30 17:53:26 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:53:26 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:53:26 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2026-01-30 17:53:26 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:53:26 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2026-01-30 17:53:26 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2026-01-30 17:53:26 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:53:26 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:53:26 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:53:26 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:53:26 +0000 DEBUG:Initialised perc_target with value: 0.5
2026-01-30 17:53:26 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2026-01-30 17:53:26 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:53:26 +0000 DEBUG:Initialised electoral_cycle_rules with value: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:53:26 +0000 DEBUG:Initialised reference_dir with value: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:53:26 +0000 DEBUG:Initialised data_dir with value: H:\GitHub\dashboard_demo\data
2026-01-30 17:53:26 +0000 DEBUG:Initialised output_dir with value: H:\GitHub\dashboard_demo\output
2026-01-30 17:53:26 +0000 DEBUG:Initialised logs_dir with value: H:\GitHub\dashboard_demo\logs
2026-01-30 17:53:26 +0000 DEBUG:Initialised components_dir with value: H:\GitHub\dashboard_demo\components
2026-01-30 17:53:26 +0000 DEBUG:Initialised app_pages_dir with value: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:53:26 +0000 DEBUG:Initialised utils_dir with value: H:\GitHub\dashboard_demo\utils
2026-01-30 17:53:26 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:53:26 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:53:26 +0000 DEBUG:Initialised mppartymemb_fname with value: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:53:26 +0000 DEBUG:Initialised donor_map_fname with value: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:53:26 +0000 DEBUG:Initialised politician_party_fname with value: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:53:26 +0000 DEBUG:Initialised regentity_map_fname with value: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:53:26 +0000 DEBUG:Initialised original_data_fname with value: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:53:26 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:53:26 +0000 DEBUG:Initialised TEXT_FILE with value: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:53:26 +0000 DEBUG:Initialised ELECTION_DATES with value: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:53:26 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:53:26 +0000 DEBUG:Initialised cleaned_data_fname with value: cleaned_data.zip
2026-01-30 17:53:26 +0000 DEBUG:Initialised cleaned_donations_fname with value: cleaned_donations.zip
2026-01-30 17:53:26 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: cleaned_donorlist.zip
2026-01-30 17:53:26 +0000 DEBUG:Initialised cleaned_regentity_fname with value: cleaned_regentity.zip
2026-01-30 17:53:26 +0000 DEBUG:Initialised party_summary_fname with value: party_summary.zip
2026-01-30 17:53:26 +0000 DEBUG:Initialised imported_raw_fname with value: imported_raw.zip
2026-01-30 17:53:26 +0000 DEBUG:Initialised source_data_fname with value: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:53:26 +0000 DEBUG:Initialised Cash_ftr with value: None
2026-01-30 17:53:26 +0000 INFO:Session_state variables initialized
2026-01-30 17:53:26 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:53:26 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:53:26 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:53:26 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:53:26 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:53:26 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:53:26 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:53:26 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:53:26 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:53:26 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:53:26 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:53:26 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:53:26 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:53:26 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:53:26 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:53:26 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:53:26 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:53:26 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:53:26 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:53:26 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:53:26 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:53:26 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:53:26 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:53:26 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:53:26 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:53:26 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:53:26 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:53:26 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:53:26 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:53:26 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:53:26 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:53:26 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:53:26 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:53:26 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:53:26 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:53:26 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:53:26 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:53:26 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:53:26 +0000 INFO:Session state Setup complete
2026-01-30 17:53:26 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:53:26 +0000 INFO:Package setup complete
2026-01-30 17:53:26 +0000 INFO:setup_package executed successfully
2026-01-30 17:53:26 +0000 INFO:Setup completed successfully.
2026-01-30 17:53:26 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:53:26 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:53:29 +0000 INFO:get_git_version executed successfully
2026-01-30 17:53:29 +0000 INFO:Running first load function.
2026-01-30 17:53:29 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:53:29 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2026-01-30 17:53:29 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2026-01-30 17:53:29 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2026-01-30 17:53:29 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2026-01-30 17:53:29 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 17:53:29 +0000 INFO:Original file path: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:53:29 +0000 INFO:Saved file path: imported_raw.zip
2026-01-30 17:53:29 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 17:53:29 +0000 INFO:Checking if H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip has been updated.
2026-01-30 17:53:29 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 17:53:29 +0000 INFO:Getting modification time for H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:53:29 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 17:53:29 +0000 INFO:Current modification time: 1769774510.1556323
2026-01-30 17:53:29 +0000 INFO:Last modification time: 1769774510.1556323
2026-01-30 17:53:29 +0000 INFO:is_file_updated executed successfully
2026-01-30 17:53:29 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 17:53:29 +0000 INFO:Loading raw data...
2026-01-30 17:53:29 +0000 DEBUG:Original data file path post raw data load: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:53:29 +0000 DEBUG:Processed data file path post raw data load: imported_raw.zip
2026-01-30 17:53:29 +0000 INFO:Data loaded successfully. Data has 91341 rows and 29 columns
2026-01-30 17:53:31 +0000 INFO:Data saved to imported_raw.zip
2026-01-30 17:53:31 +0000 INFO:Data saved to sessionstate as 'raw_data'
2026-01-30 17:53:31 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2026-01-30 17:53:31 +0000 INFO:Cleaning up raw data
2026-01-30 17:53:31 +0000 ERROR:Session state variables not initialized!
2026-01-30 17:53:31 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 17:53:31 +0000 INFO:Original file path: None
2026-01-30 17:53:31 +0000 INFO:Saved file path: cleaned_donations.zip
2026-01-30 17:53:31 +0000 ERROR:Error: originalfilepath is None!
2026-01-30 17:53:31 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 17:53:31 +0000 INFO:Data loaded, shape: (91341, 29)
2026-01-30 17:53:32 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2026-01-30 17:53:32 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2026-01-30 17:53:32 +0000 INFO:File deduplication complete, shape: ECRef                            592
OriginalRegulatedEntityName      592
RegulatedEntityType              592
Value                            592
AcceptedDate                     574
AccountingUnitName               592
DonorName                        592
AccountingUnitsAsCentralParty    592
IsSponsorship                    592
DonorStatus                      592
RegulatedDoneeType               592
CompanyRegistrationNumber        592
Postcode                         592
DonationType                     592
NatureOfDonation                 592
PurposeOfVisit                   592
DonationAction                   592
ReceivedDate                     486
ReportedDate                     592
IsReportedPrePoll                423
ReportingPeriodName              592
IsBequest                        592
IsAggregation                    592
OriginalRegulatedEntityId        592
AccountingUnitId                 592
DonorId                          592
CampaigningName                  592
RegisterName                     592
IsIrishSource                    592
CleanedRegulatedEntityName       592
CleanedRegulatedEntityId         592
RegulatedEntityId                592
RegulatedEntityName              592
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10109
OriginalRegulatedEntityName      10109
RegulatedEntityType              10109
Value                            10107
AcceptedDate                      9796
AccountingUnitName               10109
DonorName                        10109
AccountingUnitsAsCentralParty    10109
IsSponsorship                    10109
DonorStatus                      10109
RegulatedDoneeType               10109
CompanyRegistrationNumber        10109
Postcode                         10109
DonationType                     10109
NatureOfDonation                 10109
PurposeOfVisit                   10109
DonationAction                   10109
ReceivedDate                      7075
ReportedDate                     10099
IsReportedPrePoll                 4878
ReportingPeriodName              10109
IsBequest                        10109
IsAggregation                    10109
OriginalRegulatedEntityId        10109
AccountingUnitId                 10109
DonorId                          10109
CampaigningName                  10109
RegisterName                     10109
IsIrishSource                    10109
CleanedRegulatedEntityName       10109
CleanedRegulatedEntityId         10109
RegulatedEntityId                10109
RegulatedEntityName              10109
dtype: int64 records updated with new RegulatedEntityName
2026-01-30 17:53:32 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3771
OriginalRegulatedEntityName      3771
RegulatedEntityType              3771
Value                            3771
AcceptedDate                     3667
AccountingUnitName               3771
DonorName                        3771
AccountingUnitsAsCentralParty    3771
IsSponsorship                    3771
DonorStatus                      3771
RegulatedDoneeType               3771
CompanyRegistrationNumber        3771
Postcode                         3771
DonationType                     3771
NatureOfDonation                 3771
PurposeOfVisit                   3771
DonationAction                   3771
ReceivedDate                     3297
ReportedDate                     3771
IsReportedPrePoll                 449
ReportingPeriodName              3771
IsBequest                        3771
IsAggregation                    3771
OriginalRegulatedEntityId        3771
AccountingUnitId                 3771
DonorId                          3771
CampaigningName                  3771
RegisterName                     3771
IsIrishSource                    3771
CleanedRegulatedEntityName        592
CleanedRegulatedEntityId          592
RegulatedEntityId                3771
RegulatedEntityName              3771
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13288
OriginalRegulatedEntityName      13288
RegulatedEntityType              13288
Value                            13286
AcceptedDate                     12889
AccountingUnitName               13288
DonorName                        13288
AccountingUnitsAsCentralParty    13288
IsSponsorship                    13288
DonorStatus                      13288
RegulatedDoneeType               13288
CompanyRegistrationNumber        13288
Postcode                         13288
DonationType                     13288
NatureOfDonation                 13288
PurposeOfVisit                   13288
DonationAction                   13288
ReceivedDate                      9886
ReportedDate                     13278
IsReportedPrePoll                 4904
ReportingPeriodName              13288
IsBequest                        13288
IsAggregation                    13288
OriginalRegulatedEntityId        13288
AccountingUnitId                 13288
DonorId                          13288
CampaigningName                  13288
RegisterName                     13288
IsIrishSource                    13288
CleanedRegulatedEntityName       10109
CleanedRegulatedEntityId         10109
RegulatedEntityId                13288
RegulatedEntityName              13288
dtype: int64 records updated with new RegulatedEntityName
2026-01-30 17:53:32 +0000 INFO:File deduplication complete, shape: (91341, 33)
2026-01-30 17:53:32 +0000 INFO:dedupe_entity_file executed successfully
2026-01-30 17:53:32 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2026-01-30 17:53:32 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2026-01-30 17:53:33 +0000 INFO:File deduplication complete, shape: ECRef                            34082
OriginalRegulatedEntityName      34082
RegulatedEntityType              34082
Value                            34079
AcceptedDate                     33689
AccountingUnitName               34082
OriginalDonorName                34082
AccountingUnitsAsCentralParty    34082
IsSponsorship                    34082
DonorStatus                      34082
RegulatedDoneeType               34082
CompanyRegistrationNumber        34082
Postcode                         34082
DonationType                     34082
NatureOfDonation                 34082
PurposeOfVisit                   34082
DonationAction                   34082
ReceivedDate                     32487
ReportedDate                     34071
IsReportedPrePoll                22707
ReportingPeriodName              34082
IsBequest                        34082
IsAggregation                    34082
OriginalRegulatedEntityId        34082
AccountingUnitId                 34082
OriginalDonorId                  34082
CampaigningName                  34082
RegisterName                     34082
IsIrishSource                    34082
CleanedRegulatedEntityName       34082
CleanedRegulatedEntityId         34082
RegulatedEntityId                34082
RegulatedEntityName              34082
CleanedDonorName                 34082
CleanedDonorId                   34082
DonorId                          34082
DonorName                        34082
dtype: int64 records updated with new DonorId and ECRef                            20155
OriginalRegulatedEntityName      20155
RegulatedEntityType              20155
Value                            20153
AcceptedDate                     19834
AccountingUnitName               20155
OriginalDonorName                20155
AccountingUnitsAsCentralParty    20155
IsSponsorship                    20155
DonorStatus                      20155
RegulatedDoneeType               20155
CompanyRegistrationNumber        20155
Postcode                         20155
DonationType                     20155
NatureOfDonation                 20155
PurposeOfVisit                   20155
DonationAction                   20155
ReceivedDate                     19620
ReportedDate                     20146
IsReportedPrePoll                13414
ReportingPeriodName              20155
IsBequest                        20155
IsAggregation                    20155
OriginalRegulatedEntityId        20155
AccountingUnitId                 20155
OriginalDonorId                  20155
CampaigningName                  20155
RegisterName                     20155
IsIrishSource                    20155
CleanedRegulatedEntityName       20154
CleanedRegulatedEntityId         20154
RegulatedEntityId                20155
RegulatedEntityName              20155
CleanedDonorName                 20155
CleanedDonorId                   20155
DonorId                          20155
DonorName                        20155
dtype: int64 records updated with new DonorName
2026-01-30 17:53:33 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            52934
OriginalRegulatedEntityName      52934
RegulatedEntityType              52934
Value                            52931
AcceptedDate                     52138
AccountingUnitName               52934
OriginalDonorName                52934
AccountingUnitsAsCentralParty    52934
IsSponsorship                    52934
DonorStatus                      52934
RegulatedDoneeType               52934
CompanyRegistrationNumber        52934
Postcode                         52934
DonationType                     52934
NatureOfDonation                 52934
PurposeOfVisit                   52934
DonationAction                   52934
ReceivedDate                     50532
ReportedDate                     52923
IsReportedPrePoll                23658
ReportingPeriodName              52934
IsBequest                        52934
IsAggregation                    52934
OriginalRegulatedEntityId        52934
AccountingUnitId                 52934
OriginalDonorId                  52934
CampaigningName                  52934
RegisterName                     52934
IsIrishSource                    52934
CleanedRegulatedEntityName       49804
CleanedRegulatedEntityId         49804
RegulatedEntityId                52934
RegulatedEntityName              52934
CleanedDonorName                 34082
CleanedDonorId                   34082
DonorId                          52934
DonorName                        52934
dtype: int64 records updated with new DonorId and ECRef                            39007
OriginalRegulatedEntityName      39007
RegulatedEntityType              39007
Value                            39005
AcceptedDate                     38283
AccountingUnitName               39007
OriginalDonorName                39007
AccountingUnitsAsCentralParty    39007
IsSponsorship                    39007
DonorStatus                      39007
RegulatedDoneeType               39007
CompanyRegistrationNumber        39007
Postcode                         39007
DonationType                     39007
NatureOfDonation                 39007
PurposeOfVisit                   39007
DonationAction                   39007
ReceivedDate                     37665
ReportedDate                     38998
IsReportedPrePoll                14365
ReportingPeriodName              39007
IsBequest                        39007
IsAggregation                    39007
OriginalRegulatedEntityId        39007
AccountingUnitId                 39007
OriginalDonorId                  39007
CampaigningName                  39007
RegisterName                     39007
IsIrishSource                    39007
CleanedRegulatedEntityName       35876
CleanedRegulatedEntityId         35876
RegulatedEntityId                39007
RegulatedEntityName              39007
CleanedDonorName                 20155
CleanedDonorId                   20155
DonorId                          39007
DonorName                        39007
dtype: int64 records updated with new DonorName
2026-01-30 17:53:33 +0000 INFO:File deduplication complete, shape: (91341, 37)
2026-01-30 17:53:33 +0000 INFO:dedupe_entity_file executed successfully
2026-01-30 17:53:33 +0000 INFO:Raw Data cleanup completed
2026-01-30 17:53:33 +0000 INFO:Data shape: (91341, 37)
2026-01-30 17:53:35 +0000 INFO:Data saved to cleaned_donations.zip
2026-01-30 17:53:35 +0000 INFO:Data cleanup completed, shape: (91341, 37)
2026-01-30 17:53:35 +0000 INFO:raw_data_cleanup executed successfully
2026-01-30 17:53:35 +0000 INFO:load_raw_data executed successfully
2026-01-30 17:53:35 +0000 INFO:get_raw_data executed successfully
2026-01-30 17:53:35 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:53:35 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2026-01-30 17:53:35 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2026-01-30 17:53:35 +0000 DEBUG:Rows in Raw Data: 91341
2026-01-30 17:53:35 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 17:53:35 +0000 INFO:Original file path: cleaned_donations.zip
2026-01-30 17:53:35 +0000 INFO:Saved file path: cleaned_data.zip
2026-01-30 17:53:35 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 17:53:35 +0000 INFO:Checking if cleaned_donations.zip has been updated.
2026-01-30 17:53:35 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 17:53:35 +0000 INFO:Getting modification time for cleaned_donations.zip
2026-01-30 17:53:35 +0000 WARNING:File cleaned_donations.zip does not exist.
2026-01-30 17:53:35 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 17:53:35 +0000 INFO:Current modification time: None
2026-01-30 17:53:35 +0000 INFO:Last modification time: 1769774510.1556323
2026-01-30 17:53:35 +0000 WARNING:Cannot determine modification time for cleaned_donations.zip
2026-01-30 17:53:35 +0000 INFO:is_file_updated executed successfully
2026-01-30 17:53:35 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 17:53:35 +0000 ERROR:Failed to load data from cleaned_donations.zip
2026-01-30 17:53:35 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2026-01-30 17:53:35 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91341
2026-01-30 17:53:35 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91341
2026-01-30 17:53:37 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2026-01-30 17:53:37 +0000 DEBUG:Clean Data Prep 204: Map Party: 91341
2026-01-30 17:54:10 +0000 INFO:Added parliamentary_sitting column with 8 unique periods
2026-01-30 17:54:10 +0000 DEBUG:Group assignment with exceptions: {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}
2026-01-30 17:54:10 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28638
Labour Party                       22675
Liberal Democrats                  19030
Large Entity                        8611
Medium Entity                       3809
Small Entity                        1985
Uk Independence Party (Ukip)        1830
Green Party                         1673
Single Donation Entity              1353
Scottish National Party (Snp)        815
Plaid Cymru - Party Of Wales         517
Reform UK                            377
Liberal Party                         15
Sinn Féin                             13
Name: count, dtype: int64
2026-01-30 17:54:10 +0000 DEBUG:Group assignment: group
Single Donation Entity             1353
Small Entity                        839
Medium Entity                       614
Large Entity                        227
Conservative And Unionist Party       8
Labour Party                          8
Liberal Democrats                     8
Plaid Cymru - Party Of Wales          8
Scottish National Party (Snp)         8
Uk Independence Party (Ukip)          8
Green Party                           7
Liberal Party                         4
Reform UK                             3
Sinn Féin                             1
Name: count, dtype: int64
2026-01-30 17:54:10 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91341
2026-01-30 17:54:10 +0000 DEBUG:Group assignment with exceptions: {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}
2026-01-30 17:54:10 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32036
Labour Party                       27106
Large Entity                       24804
Uk Independence Party (Ukip)        1853
Green Party                         1694
Medium Entity                       1112
Scottish National Party (Snp)        881
Small Entity                         552
Plaid Cymru - Party Of Wales         525
Reform UK                            377
Single Donation Entity               372
Liberal Party                         15
Sinn Féin                             13
Democratic Unionist Party              1
Name: count, dtype: int64
2026-01-30 17:54:10 +0000 DEBUG:Group assignment: group
Single Donation Entity             372
Small Entity                       233
Medium Entity                      171
Large Entity                       120
Conservative And Unionist Party      8
Labour Party                         8
Plaid Cymru - Party Of Wales         8
Scottish National Party (Snp)        8
Uk Independence Party (Ukip)         8
Green Party                          7
Liberal Party                        4
Reform UK                            3
Democratic Unionist Party            1
Sinn Féin                            1
Name: count, dtype: int64
2026-01-30 17:54:10 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91341
2026-01-30 17:54:10 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2026-01-30 17:54:10 +0000 INFO:Loading election dates from pdpy.
2026-01-30 17:54:10 +0000 INFO:Election Dates loaded from pdpy.
2026-01-30 17:54:10 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2026-01-30 17:54:10 +0000 INFO:Election Dates Loaded Successfully.
2026-01-30 17:54:10 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:54:10 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:54:10 +0000 INFO:load_election_dates executed successfully
2026-01-30 17:54:11 +0000 DEBUG:Clean Data Prep 353: Election dates: 91341
2026-01-30 17:54:11 +0000 DEBUG:Clean Data Prep 386: End of clean: 91341
2026-01-30 17:54:13 +0000 INFO:Cleaned Data completed, shape: (91341, 57)
2026-01-30 17:54:13 +0000 INFO:load_cleaned_data executed successfully
2026-01-30 17:54:14 +0000 INFO:get_cleaned_data executed successfully
2026-01-30 17:54:14 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:54:14 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2026-01-30 17:54:14 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2026-01-30 17:54:14 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 17:54:14 +0000 INFO:Original file path: cleaned_data.zip
2026-01-30 17:54:14 +0000 INFO:Saved file path: cleaned_donorlist.zip
2026-01-30 17:54:14 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 17:54:14 +0000 INFO:Checking if cleaned_data.zip has been updated.
2026-01-30 17:54:14 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 17:54:14 +0000 INFO:Getting modification time for cleaned_data.zip
2026-01-30 17:54:14 +0000 WARNING:File cleaned_data.zip does not exist.
2026-01-30 17:54:14 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 17:54:14 +0000 INFO:Current modification time: None
2026-01-30 17:54:14 +0000 INFO:Last modification time: 1769718453.1764421
2026-01-30 17:54:14 +0000 WARNING:Cannot determine modification time for cleaned_data.zip
2026-01-30 17:54:14 +0000 INFO:is_file_updated executed successfully
2026-01-30 17:54:14 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 17:54:14 +0000 INFO:Donor data saved to cleaned_donorlist.zip
2026-01-30 17:54:14 +0000 INFO:Donor Data summary completed
2026-01-30 17:54:14 +0000 INFO:Data shape: (32070, 5)
2026-01-30 17:54:14 +0000 INFO:load_donorList_data executed successfully
2026-01-30 17:54:14 +0000 INFO:get_donor_data executed successfully
2026-01-30 17:54:14 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:54:14 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:54:14 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2026-01-30 17:54:14 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2026-01-30 17:54:14 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 17:54:14 +0000 INFO:Original file path: cleaned_data.zip
2026-01-30 17:54:14 +0000 INFO:Saved file path: cleaned_regentity.zip
2026-01-30 17:54:14 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 17:54:14 +0000 INFO:Checking if cleaned_data.zip has been updated.
2026-01-30 17:54:14 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 17:54:14 +0000 INFO:Getting modification time for cleaned_data.zip
2026-01-30 17:54:14 +0000 WARNING:File cleaned_data.zip does not exist.
2026-01-30 17:54:14 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 17:54:14 +0000 INFO:Current modification time: None
2026-01-30 17:54:14 +0000 INFO:Last modification time: 1769718453.1764421
2026-01-30 17:54:14 +0000 WARNING:Cannot determine modification time for cleaned_data.zip
2026-01-30 17:54:14 +0000 INFO:is_file_updated executed successfully
2026-01-30 17:54:14 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 17:54:14 +0000 INFO:Regulated entity data saved to cleaned_regentity.zip
2026-01-30 17:54:14 +0000 INFO:Raw Data cleanup completed
2026-01-30 17:54:14 +0000 INFO:Data shape: (2404, 6)
2026-01-30 17:54:14 +0000 INFO:load_regulated_entity_data executed successfully
2026-01-30 17:54:14 +0000 INFO:get_regentity_data executed successfully
2026-01-30 17:54:14 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:54:14 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:54:14 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:54:14 +0000 INFO:firstload executed successfully
2026-01-30 17:54:14 +0000 INFO:Data first load completed successfully.
2026-01-30 17:54:14 +0000 INFO:initialise_data executed successfully
2026-01-30 17:54:14 +0000 INFO:Running Menu setup...
2026-01-30 17:54:14 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:54:14 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:54:19 +0000 INFO:get_git_version executed successfully
2026-01-30 17:54:19 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:54:22 +0000 INFO:get_git_version executed successfully
2026-01-30 17:54:22 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:54:25 +0000 INFO:get_git_version executed successfully
2026-01-30 17:54:25 +0000 INFO:App Version: v50.239
2026-01-30 17:54:25 +0000 INFO:Switched to page: Introduction
2026-01-30 17:54:25 +0000 INFO:pagesetup executed successfully
2026-01-30 17:54:25 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:54:25 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:54:45 +0000 INFO:Streamlit App Starting...
2026-01-30 17:54:45 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:54:45 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:54:45 +0000 INFO:Running App setup...
2026-01-30 17:54:45 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:54:45 +0000 INFO:Setting up the package
2026-01-30 17:54:45 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:54:45 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:54:45 +0000 INFO:get_git_version executed successfully
2026-01-30 17:54:45 +0000 INFO:Version: v50.201
2026-01-30 17:54:45 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:54:45 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:54:45 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:security already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:directories already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:54:45 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:54:45 +0000 INFO:Session_state variables initialized
2026-01-30 17:54:45 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:54:45 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:54:45 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:54:45 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:54:45 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:54:45 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:54:45 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:54:45 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:54:45 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:54:45 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:54:45 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:54:45 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:54:45 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:54:45 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:54:45 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:54:45 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:54:45 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:54:45 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:54:45 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:54:45 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:54:45 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:54:45 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:54:45 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:54:45 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:54:45 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:54:45 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:54:45 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:54:45 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:54:45 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:54:45 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:54:45 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:54:45 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:54:45 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:54:45 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:54:45 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:54:45 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:54:45 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:54:45 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:54:45 +0000 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x000002341D8D5750>}
2026-01-30 17:54:45 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:54:45 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:54:45 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:54:45 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:54:45 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:54:45 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:54:45 +0000 INFO:Session state Setup complete
2026-01-30 17:54:45 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:54:45 +0000 INFO:Package setup complete
2026-01-30 17:54:45 +0000 INFO:setup_package executed successfully
2026-01-30 17:54:45 +0000 INFO:Setup completed successfully.
2026-01-30 17:54:45 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:54:45 +0000 INFO:Running first load function.
2026-01-30 17:54:45 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:54:45 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:54:45 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:54:45 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:54:45 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:54:45 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:54:45 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:54:45 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:54:45 +0000 INFO:firstload executed successfully
2026-01-30 17:54:45 +0000 INFO:Data first load completed successfully.
2026-01-30 17:54:45 +0000 INFO:initialise_data executed successfully
2026-01-30 17:54:45 +0000 INFO:Running Menu setup...
2026-01-30 17:54:45 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:54:45 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:54:45 +0000 INFO:get_git_version executed successfully
2026-01-30 17:54:45 +0000 INFO:App Version: v50.239
2026-01-30 17:54:45 +0000 INFO:Switched to page: Head Line Figures
2026-01-30 17:54:45 +0000 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2026-01-30 17:54:45 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:54:45 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:54:45 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:54:45 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:54:46 +0000 DEBUG:Aggregated DataFrame:                         Party_Group         Value
0   Conservative And Unionist Party  20170.405233
1         Democratic Unionist Party   3618.940000
2                       Green Party   6204.226405
3                      Labour Party  20519.157176
4                      Large Entity  12031.362470
5                     Liberal Party   2871.754667
6                     Medium Entity  19378.136232
7      Plaid Cymru - Party Of Wales  15859.742724
8                         Reform UK  97641.772732
9     Scottish National Party (Snp)  36021.189364
10           Single Donation Entity  13864.955459
11                        Sinn Féin  44317.630769
12                     Small Entity  24968.983822
13     Uk Independence Party (Ukip)   9943.456859
2026-01-30 17:54:46 +0000 DEBUG:Sorted DataFrame:                         Party_Group         Value
8                         Reform UK  97641.772732
11                        Sinn Féin  44317.630769
9     Scottish National Party (Snp)  36021.189364
12                     Small Entity  24968.983822
3                      Labour Party  20519.157176
0   Conservative And Unionist Party  20170.405233
6                     Medium Entity  19378.136232
7      Plaid Cymru - Party Of Wales  15859.742724
10           Single Donation Entity  13864.955459
4                      Large Entity  12031.362470
13     Uk Independence Party (Ukip)   9943.456859
2                       Green Party   6204.226405
1         Democratic Unionist Party   3618.940000
5                     Liberal Party   2871.754667
2026-01-30 17:54:46 +0000 DEBUG:Unique XValues: ['Reform UK' 'Sinn Féin' 'Scottish National Party (Snp)' 'Small Entity'
 'Labour Party' 'Conservative And Unionist Party' 'Medium Entity'
 'Plaid Cymru - Party Of Wales' 'Single Donation Entity' 'Large Entity'
 'Uk Independence Party (Ukip)' 'Green Party' 'Democratic Unionist Party'
 'Liberal Party']
2026-01-30 17:54:46 +0000 DEBUG:Final color_discrete_map: {'Reform UK': '#12B6CF', 'Sinn Féin': '#326760', 'Scottish National Party (Snp)': '#636efa', 'Small Entity': '#aaaaaa', 'Labour Party': '#DC241F', 'Conservative And Unionist Party': '#0087DC', 'Medium Entity': '#666666', 'Plaid Cymru - Party Of Wales': '#636efa', 'Single Donation Entity': '#e8e8e8', 'Large Entity': '#222222', 'Uk Independence Party (Ukip)': '#70147A', 'Green Party': '#78B943', 'Democratic Unionist Party': '#636efa', 'Liberal Party': '#636efa'}
2026-01-30 17:54:47 +0000 DEBUG:Missing color mappings for: ['Scottish National Party (Snp)', 'Plaid Cymru - Party Of Wales', 'Democratic Unionist Party', 'Liberal Party']
2026-01-30 17:54:47 +0000 DEBUG:Generated Figure: Figure({
    'data': [{'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Reform UK',
              'marker': {'color': '#12B6CF', 'pattern': {'shape': ''}},
              'name': 'Reform UK',
              'offsetgroup': 'Reform UK',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Reform UK'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'a1QcXZzW90A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Sinn Féin',
              'marker': {'color': '#326760', 'pattern': {'shape': ''}},
              'name': 'Sinn Féin',
              'offsetgroup': 'Sinn Féin',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Sinn Féin'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'L/RCL7Sj5UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Scottish National Party (Snp)',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Scottish National Party (Snp)',
              'offsetgroup': 'Scottish National Party (Snp)',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Scottish National Party (Snp)'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '8tdFD6aW4UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Small Entity',
              'marker': {'color': '#aaaaaa', 'pattern': {'shape': ''}},
              'name': 'Small Entity',
              'offsetgroup': 'Small Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Small Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'vX7y9j5i2EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Labour Party',
              'marker': {'color': '#DC241F', 'pattern': {'shape': ''}},
              'name': 'Labour Party',
              'offsetgroup': 'Labour Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Labour Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '9qMqD8oJ1EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Conservative And Unionist Party',
              'marker': {'color': '#0087DC', 'pattern': {'shape': ''}},
              'name': 'Conservative And Unionist Party',
              'offsetgroup': 'Conservative And Unionist Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Conservative And Unionist Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '65FU75my00A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Medium Entity',
              'marker': {'color': '#666666', 'pattern': {'shape': ''}},
              'name': 'Medium Entity',
              'offsetgroup': 'Medium Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Medium Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'nXsGuIjs0kA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Plaid Cymru - Party Of Wales',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Plaid Cymru - Party Of Wales',
              'offsetgroup': 'Plaid Cymru - Party Of Wales',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Plaid Cymru - Party Of Wales'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '7uOSEd/5zkA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Single Donation Entity',
              'marker': {'color': '#e8e8e8', 'pattern': {'shape': ''}},
              'name': 'Single Donation Entity',
              'offsetgroup': 'Single Donation Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Single Donation Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'hd1+THoUy0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Large Entity',
              'marker': {'color': '#222222', 'pattern': {'shape': ''}},
              'name': 'Large Entity',
              'offsetgroup': 'Large Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Large Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'lyJsZa5/x0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Uk Independence Party (Ukip)',
              'marker': {'color': '#70147A', 'pattern': {'shape': ''}},
              'name': 'Uk Independence Party (Ukip)',
              'offsetgroup': 'Uk Independence Party (Ukip)',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Uk Independence Party (Ukip)'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'U0xcerprw0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Green Party',
              'marker': {'color': '#78B943', 'pattern': {'shape': ''}},
              'name': 'Green Party',
              'offsetgroup': 'Green Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Green Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'LOWs9Tk8uEA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Democratic Unionist Party',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Democratic Unionist Party',
              'offsetgroup': 'Democratic Unionist Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Democratic Unionist Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'exSuR+FFrEA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Liberal Party',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Liberal Party',
              'offsetgroup': 'Liberal Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Liberal Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'blmrY4JvpkA=', 'dtype': 'f8'},
              'yaxis': 'y'}],
    'layout': {'barmode': 'group',
               'legend': {'title': {'text': 'Political Party'}, 'tracegroupgap': 0},
               'template': '...',
               'title': {'text': 'Average Donation per Party'},
               'xaxis': {'anchor': 'y',
                         'categoryarray': [Reform UK, Sinn Féin, Scottish National
                                           Party (Snp), Small Entity, Labour Party,
                                           Conservative And Unionist Party, Medium
                                           Entity, Plaid Cymru - Party Of Wales,
                                           Single Donation Entity, Large Entity, Uk
                                           Independence Party (Ukip), Green Party,
                                           Democratic Unionist Party, Liberal
                                           Party],
                         'categoryorder': 'array',
                         'domain': [0.0, 1.0],
                         'title': {'text': 'Political Party'}},
               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': 'Average Donation GBP'}}}
})
2026-01-30 17:54:47 +0000 INFO:Bar chart displayed successfully.
2026-01-30 17:54:47 +0000 INFO:hlf_body executed successfully
2026-01-30 17:54:47 +0000 INFO:pagesetup executed successfully
2026-01-30 17:54:47 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:54:47 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:55:07 +0000 INFO:Streamlit App Starting...
2026-01-30 17:55:07 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:55:07 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:55:07 +0000 INFO:Running App setup...
2026-01-30 17:55:07 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:55:07 +0000 INFO:Setting up the package
2026-01-30 17:55:07 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:55:07 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:55:07 +0000 INFO:get_git_version executed successfully
2026-01-30 17:55:07 +0000 INFO:Version: v50.201
2026-01-30 17:55:07 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:55:07 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:55:07 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:security already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:directories already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:55:07 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:55:07 +0000 INFO:Session_state variables initialized
2026-01-30 17:55:07 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:55:07 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:55:07 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:55:07 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:55:07 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:55:07 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:55:07 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:55:07 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:55:07 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:55:07 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:55:07 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:55:07 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:55:07 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:55:07 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:55:07 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:55:07 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:55:07 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:55:07 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:55:07 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:55:07 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:55:07 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:55:07 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:55:07 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:55:07 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:55:07 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:55:07 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:55:07 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:55:07 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:55:07 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:55:07 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:55:07 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:55:07 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:55:07 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:55:07 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:55:07 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:55:07 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:55:07 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:55:07 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:55:07 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:55:07 +0000 DEBUG:menu_selection: {'title': 'Cash Donations', 'function': <function mod_cash_donations at 0x000002341D8D6B90>}
2026-01-30 17:55:07 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:55:07 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:55:07 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:55:07 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:55:07 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:55:07 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:55:07 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:55:07 +0000 INFO:Session state Setup complete
2026-01-30 17:55:07 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:55:07 +0000 INFO:Package setup complete
2026-01-30 17:55:07 +0000 INFO:setup_package executed successfully
2026-01-30 17:55:07 +0000 INFO:Setup completed successfully.
2026-01-30 17:55:07 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:55:07 +0000 INFO:Running first load function.
2026-01-30 17:55:07 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:55:07 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:55:07 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:55:07 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:55:07 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:55:07 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:55:07 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:55:07 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:55:07 +0000 INFO:firstload executed successfully
2026-01-30 17:55:07 +0000 INFO:Data first load completed successfully.
2026-01-30 17:55:07 +0000 INFO:initialise_data executed successfully
2026-01-30 17:55:07 +0000 INFO:Running Menu setup...
2026-01-30 17:55:07 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:55:07 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:55:07 +0000 INFO:get_git_version executed successfully
2026-01-30 17:55:07 +0000 INFO:App Version: v50.239
2026-01-30 17:55:07 +0000 INFO:Switched to page: Cash Donations
2026-01-30 17:55:07 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:55:08 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:55:08 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:55:08 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:55:08 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:55:08 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:55:08 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:55:08 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:55:08 +0000 DEBUG:Page texts: {'Para1': {'text': 'Except for in 2016', 'is_deleted': False}, 'Para 2': {'text': 'More useful information', 'is_deleted': False}}
2026-01-30 17:55:08 +0000 DEBUG:Calling manage_text_elements with args={args}, kwargs={kwargs}
2026-01-30 17:55:08 +0000 DEBUG:Not logged in as admin.
2026-01-30 17:55:08 +0000 INFO:manage_text_elements executed successfully
2026-01-30 17:55:08 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:55:08 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:55:08 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:55:08 +0000 INFO:display_data_page executed successfully
2026-01-30 17:55:08 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 17:55:09 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 17:55:09 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 17:55:09 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 17:55:09 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 17:55:09 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 17:55:09 +0000 DEBUG:Page texts: {}
2026-01-30 17:55:09 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 17:55:09 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 17:55:09 +0000 INFO:display_visualizations executed successfully
2026-01-30 17:55:09 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 17:55:09 +0000 INFO:pagesetup executed successfully
2026-01-30 17:55:09 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:55:09 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:55:14 +0000 INFO:Streamlit App Starting...
2026-01-30 17:55:14 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:55:14 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:55:14 +0000 INFO:Running App setup...
2026-01-30 17:55:14 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:55:14 +0000 INFO:Setting up the package
2026-01-30 17:55:14 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:55:14 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:55:14 +0000 INFO:get_git_version executed successfully
2026-01-30 17:55:14 +0000 INFO:Version: v50.201
2026-01-30 17:55:14 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:55:14 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:55:14 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:security already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:directories already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:55:14 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:55:14 +0000 INFO:Session_state variables initialized
2026-01-30 17:55:14 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:55:14 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:55:14 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:55:14 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:55:14 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:55:14 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:55:14 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:55:14 +0000 DEBUG:date_range_mod_cash_donations_per_donor_mod_cash_donations_per_donorCash Donations per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 17:55:14 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:55:14 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:55:14 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:55:14 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:55:14 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:55:14 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:55:14 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:55:14 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:55:14 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:55:14 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:55:14 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:55:14 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:55:14 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:55:14 +0000 DEBUG:selected_entity_name: All
2026-01-30 17:55:14 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:55:14 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:55:14 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:55:14 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:55:14 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:55:14 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:55:14 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:55:14 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:55:14 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:55:14 +0000 DEBUG:mod_cash_donations_per_donor_None_mod_cash_donations_per_donorCash Donations per DonorNone_group_entity_select: Donor
2026-01-30 17:55:14 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:55:14 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:55:14 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:55:14 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:55:14 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:55:14 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:55:14 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:55:14 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:55:14 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:55:14 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:55:14 +0000 DEBUG:menu_selection: {'title': 'Donor Type Analysis', 'function': <function mod_donor_type at 0x000002341D8D70A0>}
2026-01-30 17:55:14 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:55:14 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:55:14 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:55:14 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:55:14 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:55:14 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:55:14 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:55:14 +0000 INFO:Session state Setup complete
2026-01-30 17:55:14 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:55:14 +0000 INFO:Package setup complete
2026-01-30 17:55:14 +0000 INFO:setup_package executed successfully
2026-01-30 17:55:14 +0000 INFO:Setup completed successfully.
2026-01-30 17:55:14 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:55:14 +0000 INFO:Running first load function.
2026-01-30 17:55:14 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:55:14 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:55:14 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:55:14 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:55:14 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:55:14 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:55:14 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:55:14 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:55:14 +0000 INFO:firstload executed successfully
2026-01-30 17:55:14 +0000 INFO:Data first load completed successfully.
2026-01-30 17:55:14 +0000 INFO:initialise_data executed successfully
2026-01-30 17:55:14 +0000 INFO:Running Menu setup...
2026-01-30 17:55:14 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:55:14 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:55:14 +0000 INFO:get_git_version executed successfully
2026-01-30 17:55:14 +0000 INFO:App Version: v50.239
2026-01-30 17:55:14 +0000 INFO:Switched to page: Donor Type Analysis
2026-01-30 17:55:14 +0000 DEBUG:Calling mod_donor_type with args={args}, kwargs={kwargs}
2026-01-30 17:55:14 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 17:55:14 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 17:55:15 +0000 INFO:mod_donor_type executed successfully
2026-01-30 17:55:15 +0000 INFO:pagesetup executed successfully
2026-01-30 17:55:15 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:55:15 +0000 INFO:App is fully loaded and ready!
2026-01-30 17:55:17 +0000 INFO:Streamlit App Starting...
2026-01-30 17:55:17 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:55:17 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:55:17 +0000 INFO:Running App setup...
2026-01-30 17:55:17 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:55:17 +0000 INFO:Setting up the package
2026-01-30 17:55:17 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:55:17 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:55:17 +0000 INFO:get_git_version executed successfully
2026-01-30 17:55:17 +0000 INFO:Version: v50.201
2026-01-30 17:55:17 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:55:17 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:55:17 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:filenames already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:thresholds already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:filter_def already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:security already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:perc_target already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:directories already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:data_dir already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:output_dir already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:components_dir already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 17:55:17 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 17:55:17 +0000 INFO:Session_state variables initialized
2026-01-30 17:55:17 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 17:55:17 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:55:17 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 17:55:17 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:55:17 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:55:17 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:55:17 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:55:17 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:55:17 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:55:17 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:55:17 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 17:55:17 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:55:17 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:55:17 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:55:17 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:55:17 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:55:17 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:55:17 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:55:17 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:55:17 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:55:17 +0000 DEBUG:metric_type_donor_type: Value of Donations
2026-01-30 17:55:17 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:55:17 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:55:17 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:55:17 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:55:17 +0000 DEBUG:sitting_select_donor_type: ['1997', '2001', '2005', '2010', '2015', '2017', '2019', '2024']
2026-01-30 17:55:17 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:55:17 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:55:17 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:55:17 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:55:17 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:55:17 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:55:17 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:55:17 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:55:17 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:55:17 +0000 DEBUG:view_type_donor_type: Actual
2026-01-30 17:55:17 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:55:17 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:55:17 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 17:55:17 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:55:17 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:55:17 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 17:55:17 +0000 DEBUG:menu_selection: {'title': 'Donor Loyalty Analysis', 'function': <function mod_donor_loyalty at 0x000002341D8D6320>}
2026-01-30 17:55:17 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 17:55:17 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:55:17 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:55:17 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:55:17 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:55:17 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:55:17 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:55:17 +0000 INFO:Session state Setup complete
2026-01-30 17:55:17 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:55:17 +0000 INFO:Package setup complete
2026-01-30 17:55:17 +0000 INFO:setup_package executed successfully
2026-01-30 17:55:17 +0000 INFO:Setup completed successfully.
2026-01-30 17:55:17 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:55:17 +0000 INFO:Running first load function.
2026-01-30 17:55:17 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:55:17 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:55:17 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:55:17 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:55:17 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:55:17 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:55:17 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:55:17 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:55:17 +0000 INFO:firstload executed successfully
2026-01-30 17:55:17 +0000 INFO:Data first load completed successfully.
2026-01-30 17:55:17 +0000 INFO:initialise_data executed successfully
2026-01-30 17:55:17 +0000 INFO:Running Menu setup...
2026-01-30 17:55:17 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:55:17 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:55:17 +0000 INFO:get_git_version executed successfully
2026-01-30 17:55:17 +0000 INFO:App Version: v50.239
2026-01-30 17:55:17 +0000 INFO:Switched to page: Donor Loyalty Analysis
2026-01-30 17:55:17 +0000 DEBUG:Calling mod_donor_loyalty with args={args}, kwargs={kwargs}
2026-01-30 17:55:17 +0000 DEBUG:Calling display_donor_distribution with args={args}, kwargs={kwargs}
2026-01-30 17:55:17 +0000 DEBUG:Aggregated DataFrame:    Parties_Per_Donor  Count
0                  1  18611
1                 10      4
2                 11      1
3                 12      2
4                 13      2
5                 14      2
6                 17      2
7                 18      1
8                  2   1299
9                  3    185
10                 4     70
11                 5     24
12                 6     17
13                 7     10
14                 8      3
15                83      1
16                 9      3
2026-01-30 17:55:17 +0000 DEBUG:Sorted DataFrame:    Parties_Per_Donor  Count
0                  1  18611
8                  2   1299
9                  3    185
10                 4     70
11                 5     24
12                 6     17
13                 7     10
1                 10      4
14                 8      3
16                 9      3
3                 12      2
4                 13      2
5                 14      2
6                 17      2
2                 11      1
7                 18      1
15                83      1
2026-01-30 17:55:17 +0000 DEBUG:Unique XValues: ['1' '2' '3' '4' '5' '6' '7' '10' '8' '9' '12' '13' '14' '17' '11' '18'
 '83']
2026-01-30 17:55:17 +0000 DEBUG:Final color_discrete_map: {'1': '#636efa', '2': '#636efa', '3': '#636efa', '4': '#636efa', '5': '#636efa', '6': '#636efa', '7': '#636efa', '10': '#636efa', '8': '#636efa', '9': '#636efa', '12': '#636efa', '13': '#636efa', '14': '#636efa', '17': '#636efa', '11': '#636efa', '18': '#636efa', '83': '#636efa'}
2026-01-30 17:55:17 +0000 DEBUG:Missing color mappings for: ['1', '2', '3', '4', '5', '6', '7', '10', '8', '9', '12', '13', '14', '17', '11', '18', '83']
2026-01-30 17:55:17 +0000 DEBUG:Generated Figure: Figure({
    'data': [{'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '1',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '1',
              'offsetgroup': '1',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['1'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 's0g=', 'dtype': 'i2'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '2',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '2',
              'offsetgroup': '2',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['2'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'EwU=', 'dtype': 'i2'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '3',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '3',
              'offsetgroup': '3',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['3'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'uQA=', 'dtype': 'i2'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '4',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '4',
              'offsetgroup': '4',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['4'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Rg==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '5',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '5',
              'offsetgroup': '5',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['5'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'GA==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '6',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '6',
              'offsetgroup': '6',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['6'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'EQ==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '7',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '7',
              'offsetgroup': '7',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['7'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Cg==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '10',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '10',
              'offsetgroup': '10',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['10'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'BA==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '8',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '8',
              'offsetgroup': '8',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['8'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Aw==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '9',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '9',
              'offsetgroup': '9',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['9'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Aw==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '12',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '12',
              'offsetgroup': '12',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['12'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Ag==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '13',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '13',
              'offsetgroup': '13',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['13'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Ag==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '14',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '14',
              'offsetgroup': '14',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['14'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Ag==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '17',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '17',
              'offsetgroup': '17',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['17'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Ag==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '11',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '11',
              'offsetgroup': '11',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['11'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AQ==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '18',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '18',
              'offsetgroup': '18',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['18'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AQ==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '83',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '83',
              'offsetgroup': '83',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['83'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AQ==', 'dtype': 'i1'},
              'yaxis': 'y'}],
    'layout': {'barmode': 'group',
               'legend': {'title': {'text': 'Number of Parties'}, 'tracegroupgap': 0},
               'template': '...',
               'title': {'text': 'Distribution of Parties per Donor'},
               'xaxis': {'anchor': 'y',
                         'categoryarray': [1, 2, 3, 4, 5, 6, 7, 10, 8, 9, 12, 13,
                                           14, 17, 11, 18, 83],
                         'categoryorder': 'array',
                         'domain': [0.0, 1.0],
                         'title': {'text': 'Number of Parties'}},
               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': 'Number of Donors'}}}
})
2026-01-30 17:55:17 +0000 INFO:Bar chart displayed successfully.
2026-01-30 17:55:17 +0000 INFO:display_donor_distribution executed successfully
2026-01-30 17:55:17 +0000 DEBUG:Calling display_government_period_analysis with args={args}, kwargs={kwargs}
2026-01-30 17:55:18 +0000 DEBUG:matplotlib data path: H:\python310\lib\site-packages\matplotlib\mpl-data
2026-01-30 17:55:18 +0000 DEBUG:CONFIGDIR=C:\Users\pgold\.matplotlib
2026-01-30 17:55:18 +0000 DEBUG:interactive is False
2026-01-30 17:55:18 +0000 DEBUG:platform is win32
2026-01-30 17:55:18 +0000 DEBUG:CACHEDIR=C:\Users\pgold\.matplotlib
2026-01-30 17:55:18 +0000 DEBUG:Using fontManager instance from C:\Users\pgold\.matplotlib\fontlist-v330.json
2026-01-30 17:55:18 +0000 INFO:display_government_period_analysis executed successfully
2026-01-30 17:55:18 +0000 DEBUG:Calling display_loyalty_metrics with args={args}, kwargs={kwargs}
2026-01-30 17:58:46 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2026-01-30 17:58:46 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:58:50 +0000 INFO:get_git_version executed successfully
2026-01-30 17:58:50 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:58:53 +0000 INFO:get_git_version executed successfully
2026-01-30 17:58:53 +0000 INFO:Streamlit App Starting...
2026-01-30 17:58:53 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 17:58:53 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 17:58:53 +0000 INFO:Running App setup...
2026-01-30 17:58:53 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 17:58:53 +0000 INFO:Setting up the package
2026-01-30 17:58:53 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 17:58:53 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:58:56 +0000 INFO:get_git_version executed successfully
2026-01-30 17:58:56 +0000 INFO:Version: v50.201
2026-01-30 17:58:56 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 17:58:56 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:58:56 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2026-01-30 17:58:56 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:58:56 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2026-01-30 17:58:56 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2026-01-30 17:58:56 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:58:56 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:58:56 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:58:56 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:58:56 +0000 DEBUG:Initialised perc_target with value: 0.5
2026-01-30 17:58:56 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2026-01-30 17:58:56 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:58:56 +0000 DEBUG:Initialised electoral_cycle_rules with value: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:58:56 +0000 DEBUG:Initialised reference_dir with value: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:58:56 +0000 DEBUG:Initialised data_dir with value: H:\GitHub\dashboard_demo\data
2026-01-30 17:58:56 +0000 DEBUG:Initialised output_dir with value: H:\GitHub\dashboard_demo\output
2026-01-30 17:58:56 +0000 DEBUG:Initialised logs_dir with value: H:\GitHub\dashboard_demo\logs
2026-01-30 17:58:56 +0000 DEBUG:Initialised components_dir with value: H:\GitHub\dashboard_demo\components
2026-01-30 17:58:56 +0000 DEBUG:Initialised app_pages_dir with value: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:58:56 +0000 DEBUG:Initialised utils_dir with value: H:\GitHub\dashboard_demo\utils
2026-01-30 17:58:56 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:58:56 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:58:56 +0000 DEBUG:Initialised mppartymemb_fname with value: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:58:56 +0000 DEBUG:Initialised donor_map_fname with value: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:58:56 +0000 DEBUG:Initialised politician_party_fname with value: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:58:56 +0000 DEBUG:Initialised regentity_map_fname with value: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:58:56 +0000 DEBUG:Initialised original_data_fname with value: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:58:56 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:58:56 +0000 DEBUG:Initialised TEXT_FILE with value: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:58:56 +0000 DEBUG:Initialised ELECTION_DATES with value: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:58:56 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:58:56 +0000 DEBUG:Initialised cleaned_data_fname with value: cleaned_data.zip
2026-01-30 17:58:56 +0000 DEBUG:Initialised cleaned_donations_fname with value: cleaned_donations.zip
2026-01-30 17:58:56 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: cleaned_donorlist.zip
2026-01-30 17:58:56 +0000 DEBUG:Initialised cleaned_regentity_fname with value: cleaned_regentity.zip
2026-01-30 17:58:56 +0000 DEBUG:Initialised party_summary_fname with value: party_summary.zip
2026-01-30 17:58:56 +0000 DEBUG:Initialised imported_raw_fname with value: imported_raw.zip
2026-01-30 17:58:56 +0000 DEBUG:Initialised source_data_fname with value: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:58:56 +0000 DEBUG:Initialised Cash_ftr with value: None
2026-01-30 17:58:56 +0000 INFO:Session_state variables initialized
2026-01-30 17:58:56 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 17:58:56 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 17:58:56 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 17:58:56 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 17:58:56 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 17:58:56 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 17:58:56 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 17:58:56 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 17:58:56 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 17:58:56 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 17:58:56 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 17:58:56 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 17:58:56 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 17:58:56 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 17:58:56 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 17:58:56 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 17:58:56 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 17:58:56 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 17:58:56 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 17:58:56 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 17:58:56 +0000 DEBUG:perc_target: 0.5
2026-01-30 17:58:56 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 17:58:56 +0000 DEBUG:Cash_ftr: None
2026-01-30 17:58:56 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 17:58:56 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 17:58:56 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 17:58:56 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 17:58:56 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 17:58:56 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 17:58:56 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 17:58:56 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 17:58:56 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 17:58:56 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 17:58:56 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 17:58:56 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 17:58:56 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:58:56 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 17:58:56 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 17:58:56 +0000 INFO:Session state Setup complete
2026-01-30 17:58:56 +0000 INFO:initialize_session_state executed successfully
2026-01-30 17:58:56 +0000 INFO:Package setup complete
2026-01-30 17:58:57 +0000 INFO:setup_package executed successfully
2026-01-30 17:58:57 +0000 INFO:Setup completed successfully.
2026-01-30 17:58:57 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 17:58:57 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:58:59 +0000 INFO:get_git_version executed successfully
2026-01-30 17:59:00 +0000 INFO:Running first load function.
2026-01-30 17:59:00 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 17:59:00 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2026-01-30 17:59:00 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2026-01-30 17:59:00 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2026-01-30 17:59:00 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2026-01-30 17:59:00 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 17:59:00 +0000 INFO:Original file path: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:59:00 +0000 INFO:Saved file path: imported_raw.zip
2026-01-30 17:59:00 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 17:59:00 +0000 INFO:Checking if H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip has been updated.
2026-01-30 17:59:00 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 17:59:00 +0000 INFO:Getting modification time for H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:59:00 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 17:59:00 +0000 INFO:Current modification time: 1769774510.1556323
2026-01-30 17:59:00 +0000 INFO:Last modification time: 1769774510.1556323
2026-01-30 17:59:00 +0000 INFO:is_file_updated executed successfully
2026-01-30 17:59:00 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 17:59:00 +0000 INFO:Loading raw data...
2026-01-30 17:59:00 +0000 DEBUG:Original data file path post raw data load: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 17:59:00 +0000 DEBUG:Processed data file path post raw data load: imported_raw.zip
2026-01-30 17:59:00 +0000 INFO:Data loaded successfully. Data has 91341 rows and 29 columns
2026-01-30 17:59:01 +0000 INFO:Data saved to imported_raw.zip
2026-01-30 17:59:01 +0000 INFO:Data saved to sessionstate as 'raw_data'
2026-01-30 17:59:01 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2026-01-30 17:59:01 +0000 INFO:Cleaning up raw data
2026-01-30 17:59:01 +0000 ERROR:Session state variables not initialized!
2026-01-30 17:59:01 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 17:59:01 +0000 INFO:Original file path: None
2026-01-30 17:59:01 +0000 INFO:Saved file path: cleaned_donations.zip
2026-01-30 17:59:01 +0000 ERROR:Error: originalfilepath is None!
2026-01-30 17:59:01 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 17:59:01 +0000 INFO:Data loaded, shape: (91341, 29)
2026-01-30 17:59:03 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2026-01-30 17:59:03 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2026-01-30 17:59:03 +0000 INFO:File deduplication complete, shape: ECRef                            592
OriginalRegulatedEntityName      592
RegulatedEntityType              592
Value                            592
AcceptedDate                     574
AccountingUnitName               592
DonorName                        592
AccountingUnitsAsCentralParty    592
IsSponsorship                    592
DonorStatus                      592
RegulatedDoneeType               592
CompanyRegistrationNumber        592
Postcode                         592
DonationType                     592
NatureOfDonation                 592
PurposeOfVisit                   592
DonationAction                   592
ReceivedDate                     486
ReportedDate                     592
IsReportedPrePoll                423
ReportingPeriodName              592
IsBequest                        592
IsAggregation                    592
OriginalRegulatedEntityId        592
AccountingUnitId                 592
DonorId                          592
CampaigningName                  592
RegisterName                     592
IsIrishSource                    592
CleanedRegulatedEntityName       592
CleanedRegulatedEntityId         592
RegulatedEntityId                592
RegulatedEntityName              592
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10109
OriginalRegulatedEntityName      10109
RegulatedEntityType              10109
Value                            10107
AcceptedDate                      9796
AccountingUnitName               10109
DonorName                        10109
AccountingUnitsAsCentralParty    10109
IsSponsorship                    10109
DonorStatus                      10109
RegulatedDoneeType               10109
CompanyRegistrationNumber        10109
Postcode                         10109
DonationType                     10109
NatureOfDonation                 10109
PurposeOfVisit                   10109
DonationAction                   10109
ReceivedDate                      7075
ReportedDate                     10099
IsReportedPrePoll                 4878
ReportingPeriodName              10109
IsBequest                        10109
IsAggregation                    10109
OriginalRegulatedEntityId        10109
AccountingUnitId                 10109
DonorId                          10109
CampaigningName                  10109
RegisterName                     10109
IsIrishSource                    10109
CleanedRegulatedEntityName       10109
CleanedRegulatedEntityId         10109
RegulatedEntityId                10109
RegulatedEntityName              10109
dtype: int64 records updated with new RegulatedEntityName
2026-01-30 17:59:03 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3771
OriginalRegulatedEntityName      3771
RegulatedEntityType              3771
Value                            3771
AcceptedDate                     3667
AccountingUnitName               3771
DonorName                        3771
AccountingUnitsAsCentralParty    3771
IsSponsorship                    3771
DonorStatus                      3771
RegulatedDoneeType               3771
CompanyRegistrationNumber        3771
Postcode                         3771
DonationType                     3771
NatureOfDonation                 3771
PurposeOfVisit                   3771
DonationAction                   3771
ReceivedDate                     3297
ReportedDate                     3771
IsReportedPrePoll                 449
ReportingPeriodName              3771
IsBequest                        3771
IsAggregation                    3771
OriginalRegulatedEntityId        3771
AccountingUnitId                 3771
DonorId                          3771
CampaigningName                  3771
RegisterName                     3771
IsIrishSource                    3771
CleanedRegulatedEntityName        592
CleanedRegulatedEntityId          592
RegulatedEntityId                3771
RegulatedEntityName              3771
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13288
OriginalRegulatedEntityName      13288
RegulatedEntityType              13288
Value                            13286
AcceptedDate                     12889
AccountingUnitName               13288
DonorName                        13288
AccountingUnitsAsCentralParty    13288
IsSponsorship                    13288
DonorStatus                      13288
RegulatedDoneeType               13288
CompanyRegistrationNumber        13288
Postcode                         13288
DonationType                     13288
NatureOfDonation                 13288
PurposeOfVisit                   13288
DonationAction                   13288
ReceivedDate                      9886
ReportedDate                     13278
IsReportedPrePoll                 4904
ReportingPeriodName              13288
IsBequest                        13288
IsAggregation                    13288
OriginalRegulatedEntityId        13288
AccountingUnitId                 13288
DonorId                          13288
CampaigningName                  13288
RegisterName                     13288
IsIrishSource                    13288
CleanedRegulatedEntityName       10109
CleanedRegulatedEntityId         10109
RegulatedEntityId                13288
RegulatedEntityName              13288
dtype: int64 records updated with new RegulatedEntityName
2026-01-30 17:59:03 +0000 INFO:File deduplication complete, shape: (91341, 33)
2026-01-30 17:59:03 +0000 INFO:dedupe_entity_file executed successfully
2026-01-30 17:59:03 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2026-01-30 17:59:03 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2026-01-30 17:59:03 +0000 INFO:File deduplication complete, shape: ECRef                            34082
OriginalRegulatedEntityName      34082
RegulatedEntityType              34082
Value                            34079
AcceptedDate                     33689
AccountingUnitName               34082
OriginalDonorName                34082
AccountingUnitsAsCentralParty    34082
IsSponsorship                    34082
DonorStatus                      34082
RegulatedDoneeType               34082
CompanyRegistrationNumber        34082
Postcode                         34082
DonationType                     34082
NatureOfDonation                 34082
PurposeOfVisit                   34082
DonationAction                   34082
ReceivedDate                     32487
ReportedDate                     34071
IsReportedPrePoll                22707
ReportingPeriodName              34082
IsBequest                        34082
IsAggregation                    34082
OriginalRegulatedEntityId        34082
AccountingUnitId                 34082
OriginalDonorId                  34082
CampaigningName                  34082
RegisterName                     34082
IsIrishSource                    34082
CleanedRegulatedEntityName       34082
CleanedRegulatedEntityId         34082
RegulatedEntityId                34082
RegulatedEntityName              34082
CleanedDonorName                 34082
CleanedDonorId                   34082
DonorId                          34082
DonorName                        34082
dtype: int64 records updated with new DonorId and ECRef                            20155
OriginalRegulatedEntityName      20155
RegulatedEntityType              20155
Value                            20153
AcceptedDate                     19834
AccountingUnitName               20155
OriginalDonorName                20155
AccountingUnitsAsCentralParty    20155
IsSponsorship                    20155
DonorStatus                      20155
RegulatedDoneeType               20155
CompanyRegistrationNumber        20155
Postcode                         20155
DonationType                     20155
NatureOfDonation                 20155
PurposeOfVisit                   20155
DonationAction                   20155
ReceivedDate                     19620
ReportedDate                     20146
IsReportedPrePoll                13414
ReportingPeriodName              20155
IsBequest                        20155
IsAggregation                    20155
OriginalRegulatedEntityId        20155
AccountingUnitId                 20155
OriginalDonorId                  20155
CampaigningName                  20155
RegisterName                     20155
IsIrishSource                    20155
CleanedRegulatedEntityName       20154
CleanedRegulatedEntityId         20154
RegulatedEntityId                20155
RegulatedEntityName              20155
CleanedDonorName                 20155
CleanedDonorId                   20155
DonorId                          20155
DonorName                        20155
dtype: int64 records updated with new DonorName
2026-01-30 17:59:03 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            52934
OriginalRegulatedEntityName      52934
RegulatedEntityType              52934
Value                            52931
AcceptedDate                     52138
AccountingUnitName               52934
OriginalDonorName                52934
AccountingUnitsAsCentralParty    52934
IsSponsorship                    52934
DonorStatus                      52934
RegulatedDoneeType               52934
CompanyRegistrationNumber        52934
Postcode                         52934
DonationType                     52934
NatureOfDonation                 52934
PurposeOfVisit                   52934
DonationAction                   52934
ReceivedDate                     50532
ReportedDate                     52923
IsReportedPrePoll                23658
ReportingPeriodName              52934
IsBequest                        52934
IsAggregation                    52934
OriginalRegulatedEntityId        52934
AccountingUnitId                 52934
OriginalDonorId                  52934
CampaigningName                  52934
RegisterName                     52934
IsIrishSource                    52934
CleanedRegulatedEntityName       49804
CleanedRegulatedEntityId         49804
RegulatedEntityId                52934
RegulatedEntityName              52934
CleanedDonorName                 34082
CleanedDonorId                   34082
DonorId                          52934
DonorName                        52934
dtype: int64 records updated with new DonorId and ECRef                            39007
OriginalRegulatedEntityName      39007
RegulatedEntityType              39007
Value                            39005
AcceptedDate                     38283
AccountingUnitName               39007
OriginalDonorName                39007
AccountingUnitsAsCentralParty    39007
IsSponsorship                    39007
DonorStatus                      39007
RegulatedDoneeType               39007
CompanyRegistrationNumber        39007
Postcode                         39007
DonationType                     39007
NatureOfDonation                 39007
PurposeOfVisit                   39007
DonationAction                   39007
ReceivedDate                     37665
ReportedDate                     38998
IsReportedPrePoll                14365
ReportingPeriodName              39007
IsBequest                        39007
IsAggregation                    39007
OriginalRegulatedEntityId        39007
AccountingUnitId                 39007
OriginalDonorId                  39007
CampaigningName                  39007
RegisterName                     39007
IsIrishSource                    39007
CleanedRegulatedEntityName       35876
CleanedRegulatedEntityId         35876
RegulatedEntityId                39007
RegulatedEntityName              39007
CleanedDonorName                 20155
CleanedDonorId                   20155
DonorId                          39007
DonorName                        39007
dtype: int64 records updated with new DonorName
2026-01-30 17:59:03 +0000 INFO:File deduplication complete, shape: (91341, 37)
2026-01-30 17:59:03 +0000 INFO:dedupe_entity_file executed successfully
2026-01-30 17:59:03 +0000 INFO:Raw Data cleanup completed
2026-01-30 17:59:03 +0000 INFO:Data shape: (91341, 37)
2026-01-30 17:59:05 +0000 INFO:Data saved to cleaned_donations.zip
2026-01-30 17:59:05 +0000 INFO:Data cleanup completed, shape: (91341, 37)
2026-01-30 17:59:05 +0000 INFO:raw_data_cleanup executed successfully
2026-01-30 17:59:05 +0000 INFO:load_raw_data executed successfully
2026-01-30 17:59:05 +0000 INFO:get_raw_data executed successfully
2026-01-30 17:59:05 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:59:05 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2026-01-30 17:59:05 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2026-01-30 17:59:05 +0000 DEBUG:Rows in Raw Data: 91341
2026-01-30 17:59:05 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 17:59:05 +0000 INFO:Original file path: cleaned_donations.zip
2026-01-30 17:59:05 +0000 INFO:Saved file path: cleaned_data.zip
2026-01-30 17:59:05 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 17:59:05 +0000 INFO:Checking if cleaned_donations.zip has been updated.
2026-01-30 17:59:05 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 17:59:05 +0000 INFO:Getting modification time for cleaned_donations.zip
2026-01-30 17:59:05 +0000 WARNING:File cleaned_donations.zip does not exist.
2026-01-30 17:59:05 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 17:59:05 +0000 INFO:Current modification time: None
2026-01-30 17:59:05 +0000 INFO:Last modification time: 1769774510.1556323
2026-01-30 17:59:05 +0000 WARNING:Cannot determine modification time for cleaned_donations.zip
2026-01-30 17:59:05 +0000 INFO:is_file_updated executed successfully
2026-01-30 17:59:05 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 17:59:05 +0000 ERROR:Failed to load data from cleaned_donations.zip
2026-01-30 17:59:05 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2026-01-30 17:59:05 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91341
2026-01-30 17:59:06 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91341
2026-01-30 17:59:08 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2026-01-30 17:59:08 +0000 DEBUG:Clean Data Prep 204: Map Party: 91341
2026-01-30 17:59:43 +0000 INFO:Added parliamentary_sitting column with 8 unique periods
2026-01-30 17:59:43 +0000 DEBUG:Group assignment with exceptions: {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}
2026-01-30 17:59:43 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28638
Labour Party                       22675
Liberal Democrats                  19030
Large Entity                        8611
Medium Entity                       3809
Small Entity                        1985
Uk Independence Party (Ukip)        1830
Green Party                         1673
Single Donation Entity              1353
Scottish National Party (Snp)        815
Plaid Cymru - Party Of Wales         517
Reform UK                            377
Liberal Party                         15
Sinn Féin                             13
Name: count, dtype: int64
2026-01-30 17:59:43 +0000 DEBUG:Group assignment: group
Single Donation Entity             1353
Small Entity                        839
Medium Entity                       614
Large Entity                        227
Conservative And Unionist Party       8
Labour Party                          8
Liberal Democrats                     8
Plaid Cymru - Party Of Wales          8
Scottish National Party (Snp)         8
Uk Independence Party (Ukip)          8
Green Party                           7
Liberal Party                         4
Reform UK                             3
Sinn Féin                             1
Name: count, dtype: int64
2026-01-30 17:59:43 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91341
2026-01-30 17:59:43 +0000 DEBUG:Group assignment with exceptions: {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}
2026-01-30 17:59:43 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32036
Labour Party                       27106
Large Entity                       24804
Uk Independence Party (Ukip)        1853
Green Party                         1694
Medium Entity                       1112
Scottish National Party (Snp)        881
Small Entity                         552
Plaid Cymru - Party Of Wales         525
Reform UK                            377
Single Donation Entity               372
Liberal Party                         15
Sinn Féin                             13
Democratic Unionist Party              1
Name: count, dtype: int64
2026-01-30 17:59:43 +0000 DEBUG:Group assignment: group
Single Donation Entity             372
Small Entity                       233
Medium Entity                      171
Large Entity                       120
Conservative And Unionist Party      8
Labour Party                         8
Plaid Cymru - Party Of Wales         8
Scottish National Party (Snp)        8
Uk Independence Party (Ukip)         8
Green Party                          7
Liberal Party                        4
Reform UK                            3
Democratic Unionist Party            1
Sinn Féin                            1
Name: count, dtype: int64
2026-01-30 17:59:43 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91341
2026-01-30 17:59:43 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2026-01-30 17:59:43 +0000 INFO:Loading election dates from pdpy.
2026-01-30 17:59:43 +0000 INFO:Election Dates loaded from pdpy.
2026-01-30 17:59:43 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2026-01-30 17:59:43 +0000 INFO:Election Dates Loaded Successfully.
2026-01-30 17:59:43 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 17:59:43 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 17:59:43 +0000 INFO:load_election_dates executed successfully
2026-01-30 17:59:44 +0000 DEBUG:Clean Data Prep 353: Election dates: 91341
2026-01-30 17:59:44 +0000 DEBUG:Clean Data Prep 386: End of clean: 91341
2026-01-30 17:59:46 +0000 INFO:Cleaned Data completed, shape: (91341, 57)
2026-01-30 17:59:46 +0000 INFO:load_cleaned_data executed successfully
2026-01-30 17:59:46 +0000 INFO:get_cleaned_data executed successfully
2026-01-30 17:59:46 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 17:59:46 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2026-01-30 17:59:46 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2026-01-30 17:59:46 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 17:59:46 +0000 INFO:Original file path: cleaned_data.zip
2026-01-30 17:59:46 +0000 INFO:Saved file path: cleaned_donorlist.zip
2026-01-30 17:59:46 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 17:59:46 +0000 INFO:Checking if cleaned_data.zip has been updated.
2026-01-30 17:59:46 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 17:59:46 +0000 INFO:Getting modification time for cleaned_data.zip
2026-01-30 17:59:46 +0000 WARNING:File cleaned_data.zip does not exist.
2026-01-30 17:59:46 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 17:59:46 +0000 INFO:Current modification time: None
2026-01-30 17:59:46 +0000 INFO:Last modification time: 1769718453.1764421
2026-01-30 17:59:46 +0000 WARNING:Cannot determine modification time for cleaned_data.zip
2026-01-30 17:59:46 +0000 INFO:is_file_updated executed successfully
2026-01-30 17:59:46 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 17:59:47 +0000 INFO:Donor data saved to cleaned_donorlist.zip
2026-01-30 17:59:47 +0000 INFO:Donor Data summary completed
2026-01-30 17:59:47 +0000 INFO:Data shape: (32070, 5)
2026-01-30 17:59:47 +0000 INFO:load_donorList_data executed successfully
2026-01-30 17:59:47 +0000 INFO:get_donor_data executed successfully
2026-01-30 17:59:47 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:59:47 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:59:47 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2026-01-30 17:59:47 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2026-01-30 17:59:47 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 17:59:47 +0000 INFO:Original file path: cleaned_data.zip
2026-01-30 17:59:47 +0000 INFO:Saved file path: cleaned_regentity.zip
2026-01-30 17:59:47 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 17:59:47 +0000 INFO:Checking if cleaned_data.zip has been updated.
2026-01-30 17:59:47 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 17:59:47 +0000 INFO:Getting modification time for cleaned_data.zip
2026-01-30 17:59:47 +0000 WARNING:File cleaned_data.zip does not exist.
2026-01-30 17:59:47 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 17:59:47 +0000 INFO:Current modification time: None
2026-01-30 17:59:47 +0000 INFO:Last modification time: 1769718453.1764421
2026-01-30 17:59:47 +0000 WARNING:Cannot determine modification time for cleaned_data.zip
2026-01-30 17:59:47 +0000 INFO:is_file_updated executed successfully
2026-01-30 17:59:47 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 17:59:47 +0000 INFO:Regulated entity data saved to cleaned_regentity.zip
2026-01-30 17:59:47 +0000 INFO:Raw Data cleanup completed
2026-01-30 17:59:47 +0000 INFO:Data shape: (2404, 6)
2026-01-30 17:59:47 +0000 INFO:load_regulated_entity_data executed successfully
2026-01-30 17:59:47 +0000 INFO:get_regentity_data executed successfully
2026-01-30 17:59:47 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 17:59:47 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 17:59:47 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 17:59:47 +0000 INFO:firstload executed successfully
2026-01-30 17:59:47 +0000 INFO:Data first load completed successfully.
2026-01-30 17:59:47 +0000 INFO:initialise_data executed successfully
2026-01-30 17:59:47 +0000 INFO:Running Menu setup...
2026-01-30 17:59:47 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 17:59:47 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:59:52 +0000 INFO:get_git_version executed successfully
2026-01-30 17:59:52 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:59:55 +0000 INFO:get_git_version executed successfully
2026-01-30 17:59:55 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 17:59:58 +0000 INFO:get_git_version executed successfully
2026-01-30 17:59:58 +0000 INFO:App Version: v50.239
2026-01-30 17:59:58 +0000 INFO:Switched to page: Introduction
2026-01-30 17:59:58 +0000 INFO:pagesetup executed successfully
2026-01-30 17:59:58 +0000 INFO:Menu setup completed successfully.
2026-01-30 17:59:58 +0000 INFO:App is fully loaded and ready!
2026-01-30 18:02:04 +0000 INFO:Streamlit App Starting...
2026-01-30 18:02:04 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 18:02:04 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 18:02:04 +0000 INFO:Running App setup...
2026-01-30 18:02:04 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 18:02:04 +0000 INFO:Setting up the package
2026-01-30 18:02:04 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 18:02:04 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:02:04 +0000 INFO:get_git_version executed successfully
2026-01-30 18:02:04 +0000 INFO:Version: v50.201
2026-01-30 18:02:04 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 18:02:04 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:02:04 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:filenames already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:thresholds already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:filter_def already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:security already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:perc_target already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:directories already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:data_dir already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:output_dir already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:components_dir already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 18:02:04 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 18:02:04 +0000 INFO:Session_state variables initialized
2026-01-30 18:02:04 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 18:02:04 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 18:02:04 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 18:02:04 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 18:02:04 +0000 DEBUG:menu_selection: {'title': 'Donor Type Analysis', 'function': <function mod_donor_type at 0x000001D560EE67A0>}
2026-01-30 18:02:04 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 18:02:04 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 18:02:04 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 18:02:04 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 18:02:04 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 18:02:04 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 18:02:04 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 18:02:04 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 18:02:04 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 18:02:04 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 18:02:04 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 18:02:04 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 18:02:04 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 18:02:04 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 18:02:04 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 18:02:04 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 18:02:04 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 18:02:04 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 18:02:04 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 18:02:04 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 18:02:04 +0000 DEBUG:perc_target: 0.5
2026-01-30 18:02:04 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 18:02:04 +0000 DEBUG:Cash_ftr: None
2026-01-30 18:02:04 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 18:02:04 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 18:02:04 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 18:02:04 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 18:02:04 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 18:02:04 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 18:02:04 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 18:02:04 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:02:04 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 18:02:04 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 18:02:04 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 18:02:04 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 18:02:04 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 18:02:04 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:02:04 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 18:02:04 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 18:02:04 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 18:02:04 +0000 INFO:Session state Setup complete
2026-01-30 18:02:04 +0000 INFO:initialize_session_state executed successfully
2026-01-30 18:02:04 +0000 INFO:Package setup complete
2026-01-30 18:02:04 +0000 INFO:setup_package executed successfully
2026-01-30 18:02:04 +0000 INFO:Setup completed successfully.
2026-01-30 18:02:04 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 18:02:04 +0000 INFO:Running first load function.
2026-01-30 18:02:04 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 18:02:04 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:02:04 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:02:04 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:02:04 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:02:04 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 18:02:04 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:02:04 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:02:04 +0000 INFO:firstload executed successfully
2026-01-30 18:02:04 +0000 INFO:Data first load completed successfully.
2026-01-30 18:02:04 +0000 INFO:initialise_data executed successfully
2026-01-30 18:02:04 +0000 INFO:Running Menu setup...
2026-01-30 18:02:04 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 18:02:04 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:02:04 +0000 INFO:get_git_version executed successfully
2026-01-30 18:02:04 +0000 INFO:App Version: v50.239
2026-01-30 18:02:04 +0000 INFO:Switched to page: Donor Type Analysis
2026-01-30 18:02:04 +0000 DEBUG:Calling mod_donor_type with args={args}, kwargs={kwargs}
2026-01-30 18:02:04 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 18:02:04 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 18:02:04 +0000 INFO:mod_donor_type executed successfully
2026-01-30 18:02:04 +0000 INFO:pagesetup executed successfully
2026-01-30 18:02:04 +0000 INFO:Menu setup completed successfully.
2026-01-30 18:02:04 +0000 INFO:App is fully loaded and ready!
2026-01-30 18:02:07 +0000 INFO:Streamlit App Starting...
2026-01-30 18:02:07 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 18:02:07 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 18:02:07 +0000 INFO:Running App setup...
2026-01-30 18:02:07 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 18:02:07 +0000 INFO:Setting up the package
2026-01-30 18:02:07 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 18:02:07 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:02:07 +0000 INFO:get_git_version executed successfully
2026-01-30 18:02:07 +0000 INFO:Version: v50.201
2026-01-30 18:02:07 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 18:02:07 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:02:07 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:filenames already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:thresholds already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:filter_def already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:security already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:perc_target already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:directories already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:data_dir already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:output_dir already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:components_dir already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 18:02:07 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 18:02:07 +0000 INFO:Session_state variables initialized
2026-01-30 18:02:07 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 18:02:07 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 18:02:07 +0000 DEBUG:sitting_select_donor_type: ['1997', '2001', '2005', '2010', '2015', '2017', '2019', '2024']
2026-01-30 18:02:07 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 18:02:07 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 18:02:07 +0000 DEBUG:menu_selection: {'title': 'Donor Loyalty Analysis', 'function': <function mod_donor_loyalty at 0x000001D560EE5A20>}
2026-01-30 18:02:07 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 18:02:07 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 18:02:07 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 18:02:07 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 18:02:07 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 18:02:07 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 18:02:07 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 18:02:07 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 18:02:07 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 18:02:07 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 18:02:07 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 18:02:07 +0000 DEBUG:view_type_donor_type: Actual
2026-01-30 18:02:07 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 18:02:07 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 18:02:07 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 18:02:07 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 18:02:07 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 18:02:07 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 18:02:07 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 18:02:07 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 18:02:07 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 18:02:07 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 18:02:07 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 18:02:07 +0000 DEBUG:perc_target: 0.5
2026-01-30 18:02:07 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 18:02:07 +0000 DEBUG:Cash_ftr: None
2026-01-30 18:02:07 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 18:02:07 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 18:02:07 +0000 DEBUG:metric_type_donor_type: Value of Donations
2026-01-30 18:02:07 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 18:02:07 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 18:02:07 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 18:02:07 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 18:02:07 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 18:02:07 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:02:07 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 18:02:07 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 18:02:07 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 18:02:07 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 18:02:07 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 18:02:07 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:02:07 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 18:02:07 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 18:02:07 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 18:02:07 +0000 INFO:Session state Setup complete
2026-01-30 18:02:07 +0000 INFO:initialize_session_state executed successfully
2026-01-30 18:02:07 +0000 INFO:Package setup complete
2026-01-30 18:02:07 +0000 INFO:setup_package executed successfully
2026-01-30 18:02:07 +0000 INFO:Setup completed successfully.
2026-01-30 18:02:07 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 18:02:07 +0000 INFO:Running first load function.
2026-01-30 18:02:07 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 18:02:07 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:02:07 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:02:07 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:02:07 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:02:07 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 18:02:07 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:02:07 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:02:07 +0000 INFO:firstload executed successfully
2026-01-30 18:02:07 +0000 INFO:Data first load completed successfully.
2026-01-30 18:02:07 +0000 INFO:initialise_data executed successfully
2026-01-30 18:02:07 +0000 INFO:Running Menu setup...
2026-01-30 18:02:07 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 18:02:07 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:02:07 +0000 INFO:get_git_version executed successfully
2026-01-30 18:02:07 +0000 INFO:App Version: v50.239
2026-01-30 18:02:07 +0000 INFO:Switched to page: Donor Loyalty Analysis
2026-01-30 18:02:07 +0000 DEBUG:Calling mod_donor_loyalty with args={args}, kwargs={kwargs}
2026-01-30 18:02:07 +0000 DEBUG:Calling display_donor_distribution with args={args}, kwargs={kwargs}
2026-01-30 18:02:07 +0000 DEBUG:Aggregated DataFrame:    Parties_Per_Donor  Count
0                  1  18611
1                 10      4
2                 11      1
3                 12      2
4                 13      2
5                 14      1
6                 17      2
7                 18      1
8                  2   1299
9                  3    185
10                 4     70
11                 5     24
12                 6     17
13                 7     10
14                 8      3
15                 9      3
2026-01-30 18:02:07 +0000 DEBUG:Sorted DataFrame:    Parties_Per_Donor  Count
0                  1  18611
8                  2   1299
9                  3    185
10                 4     70
11                 5     24
12                 6     17
13                 7     10
1                 10      4
14                 8      3
15                 9      3
3                 12      2
4                 13      2
6                 17      2
2                 11      1
5                 14      1
7                 18      1
2026-01-30 18:02:07 +0000 DEBUG:Unique XValues: ['1' '2' '3' '4' '5' '6' '7' '10' '8' '9' '12' '13' '17' '11' '14' '18']
2026-01-30 18:02:07 +0000 DEBUG:Final color_discrete_map: {'1': '#636efa', '2': '#636efa', '3': '#636efa', '4': '#636efa', '5': '#636efa', '6': '#636efa', '7': '#636efa', '10': '#636efa', '8': '#636efa', '9': '#636efa', '12': '#636efa', '13': '#636efa', '17': '#636efa', '11': '#636efa', '14': '#636efa', '18': '#636efa'}
2026-01-30 18:02:07 +0000 DEBUG:Missing color mappings for: ['1', '2', '3', '4', '5', '6', '7', '10', '8', '9', '12', '13', '17', '11', '14', '18']
2026-01-30 18:02:07 +0000 DEBUG:Generated Figure: Figure({
    'data': [{'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '1',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '1',
              'offsetgroup': '1',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['1'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 's0g=', 'dtype': 'i2'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '2',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '2',
              'offsetgroup': '2',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['2'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'EwU=', 'dtype': 'i2'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '3',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '3',
              'offsetgroup': '3',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['3'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'uQA=', 'dtype': 'i2'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '4',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '4',
              'offsetgroup': '4',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['4'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Rg==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '5',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '5',
              'offsetgroup': '5',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['5'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'GA==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '6',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '6',
              'offsetgroup': '6',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['6'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'EQ==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '7',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '7',
              'offsetgroup': '7',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['7'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Cg==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '10',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '10',
              'offsetgroup': '10',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['10'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'BA==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '8',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '8',
              'offsetgroup': '8',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['8'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Aw==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '9',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '9',
              'offsetgroup': '9',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['9'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Aw==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '12',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '12',
              'offsetgroup': '12',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['12'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Ag==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '13',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '13',
              'offsetgroup': '13',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['13'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Ag==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '17',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '17',
              'offsetgroup': '17',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['17'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Ag==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '11',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '11',
              'offsetgroup': '11',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['11'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AQ==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '14',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '14',
              'offsetgroup': '14',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['14'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AQ==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Number of Parties=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '18',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '18',
              'offsetgroup': '18',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['18'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AQ==', 'dtype': 'i1'},
              'yaxis': 'y'}],
    'layout': {'barmode': 'group',
               'legend': {'title': {'text': 'Number of Parties'}, 'tracegroupgap': 0},
               'template': '...',
               'title': {'text': 'Distribution of Parties per Donor'},
               'xaxis': {'anchor': 'y',
                         'categoryarray': [1, 2, 3, 4, 5, 6, 7, 10, 8, 9, 12, 13,
                                           17, 11, 14, 18],
                         'categoryorder': 'array',
                         'domain': [0.0, 1.0],
                         'title': {'text': 'Number of Parties'}},
               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': 'Number of Donors'}}}
})
2026-01-30 18:02:07 +0000 INFO:Bar chart displayed successfully.
2026-01-30 18:02:07 +0000 INFO:display_donor_distribution executed successfully
2026-01-30 18:02:07 +0000 DEBUG:Calling display_government_period_analysis with args={args}, kwargs={kwargs}
2026-01-30 18:02:08 +0000 DEBUG:matplotlib data path: H:\python310\lib\site-packages\matplotlib\mpl-data
2026-01-30 18:02:08 +0000 DEBUG:CONFIGDIR=C:\Users\pgold\.matplotlib
2026-01-30 18:02:08 +0000 DEBUG:interactive is False
2026-01-30 18:02:08 +0000 DEBUG:platform is win32
2026-01-30 18:02:08 +0000 DEBUG:CACHEDIR=C:\Users\pgold\.matplotlib
2026-01-30 18:02:08 +0000 DEBUG:Using fontManager instance from C:\Users\pgold\.matplotlib\fontlist-v330.json
2026-01-30 18:02:08 +0000 INFO:display_government_period_analysis executed successfully
2026-01-30 18:02:08 +0000 DEBUG:Calling display_loyalty_metrics with args={args}, kwargs={kwargs}
2026-01-30 18:02:35 +0000 DEBUG:Aggregated DataFrame:   Score_Range  Count
0     0.0-0.2      7
1     0.2-0.4     80
2     0.4-0.6    659
3     0.6-0.8    548
4     0.8-1.0  18941
2026-01-30 18:02:35 +0000 DEBUG:Sorted DataFrame:   Score_Range  Count
4     0.8-1.0  18941
2     0.4-0.6    659
3     0.6-0.8    548
1     0.2-0.4     80
0     0.0-0.2      7
2026-01-30 18:02:35 +0000 DEBUG:Unique XValues: ['0.8-1.0' '0.4-0.6' '0.6-0.8' '0.2-0.4' '0.0-0.2']
2026-01-30 18:02:35 +0000 DEBUG:Final color_discrete_map: {'0.8-1.0': '#636efa', '0.4-0.6': '#636efa', '0.6-0.8': '#636efa', '0.2-0.4': '#636efa', '0.0-0.2': '#636efa'}
2026-01-30 18:02:35 +0000 DEBUG:Missing color mappings for: ['0.8-1.0', '0.4-0.6', '0.6-0.8', '0.2-0.4', '0.0-0.2']
2026-01-30 18:02:35 +0000 DEBUG:Generated Figure: Figure({
    'data': [{'alignmentgroup': 'True',
              'hovertemplate': 'Loyalty Score Range=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '0.8-1.0',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '0.8-1.0',
              'offsetgroup': '0.8-1.0',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['0.8-1.0'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '/Uk=', 'dtype': 'i2'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Loyalty Score Range=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '0.4-0.6',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '0.4-0.6',
              'offsetgroup': '0.4-0.6',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['0.4-0.6'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'kwI=', 'dtype': 'i2'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Loyalty Score Range=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '0.6-0.8',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '0.6-0.8',
              'offsetgroup': '0.6-0.8',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['0.6-0.8'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'JAI=', 'dtype': 'i2'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Loyalty Score Range=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '0.2-0.4',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '0.2-0.4',
              'offsetgroup': '0.2-0.4',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['0.2-0.4'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'UA==', 'dtype': 'i1'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Loyalty Score Range=%{x}<br>Number of Donors=%{y}<extra></extra>',
              'legendgroup': '0.0-0.2',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': '0.0-0.2',
              'offsetgroup': '0.0-0.2',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['0.0-0.2'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'Bw==', 'dtype': 'i1'},
              'yaxis': 'y'}],
    'layout': {'barmode': 'group',
               'legend': {'title': {'text': 'Loyalty Score Range'}, 'tracegroupgap': 0},
               'template': '...',
               'title': {'text': 'Distribution of Loyalty Scores'},
               'xaxis': {'anchor': 'y',
                         'categoryarray': [0.8-1.0, 0.4-0.6, 0.6-0.8, 0.2-0.4,
                                           0.0-0.2],
                         'categoryorder': 'array',
                         'domain': [0.0, 1.0],
                         'title': {'text': 'Loyalty Score Range'}},
               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': 'Number of Donors'}}}
})
2026-01-30 18:02:35 +0000 INFO:Bar chart displayed successfully.
2026-01-30 18:02:35 +0000 INFO:display_loyalty_metrics executed successfully
2026-01-30 18:02:35 +0000 INFO:mod_donor_loyalty executed successfully
2026-01-30 18:02:35 +0000 INFO:pagesetup executed successfully
2026-01-30 18:02:35 +0000 INFO:Menu setup completed successfully.
2026-01-30 18:02:35 +0000 INFO:App is fully loaded and ready!
2026-01-30 18:02:44 +0000 INFO:Streamlit App Starting...
2026-01-30 18:02:44 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 18:02:44 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 18:02:44 +0000 INFO:Running App setup...
2026-01-30 18:02:44 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 18:02:44 +0000 INFO:Setting up the package
2026-01-30 18:02:44 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 18:02:44 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:02:44 +0000 INFO:get_git_version executed successfully
2026-01-30 18:02:44 +0000 INFO:Version: v50.201
2026-01-30 18:02:44 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 18:02:44 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:02:44 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:filenames already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:thresholds already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:filter_def already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:security already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:perc_target already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:directories already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:data_dir already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:output_dir already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:components_dir already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 18:02:44 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 18:02:44 +0000 INFO:Session_state variables initialized
2026-01-30 18:02:44 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 18:02:44 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 18:02:44 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 18:02:44 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 18:02:44 +0000 DEBUG:menu_selection: {'title': 'Regulated Entity per Donor', 'function': <function mod_regulated_entity_per_donor at 0x000001D560EE6170>}
2026-01-30 18:02:44 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 18:02:44 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 18:02:44 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 18:02:44 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 18:02:44 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 18:02:44 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 18:02:44 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 18:02:44 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 18:02:44 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 18:02:44 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 18:02:44 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 18:02:44 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 18:02:44 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 18:02:44 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 18:02:44 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 18:02:44 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 18:02:44 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 18:02:44 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 18:02:44 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 18:02:44 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 18:02:44 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 18:02:44 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 18:02:44 +0000 DEBUG:perc_target: 0.5
2026-01-30 18:02:44 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 18:02:44 +0000 DEBUG:Cash_ftr: None
2026-01-30 18:02:44 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 18:02:44 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 18:02:44 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 18:02:44 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 18:02:44 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 18:02:44 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 18:02:44 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 18:02:44 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:02:44 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 18:02:44 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 18:02:44 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 18:02:44 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 18:02:44 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 18:02:44 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:02:44 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 18:02:44 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 18:02:44 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 18:02:44 +0000 INFO:Session state Setup complete
2026-01-30 18:02:44 +0000 INFO:initialize_session_state executed successfully
2026-01-30 18:02:44 +0000 INFO:Package setup complete
2026-01-30 18:02:44 +0000 INFO:setup_package executed successfully
2026-01-30 18:02:44 +0000 INFO:Setup completed successfully.
2026-01-30 18:02:44 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 18:02:44 +0000 INFO:Running first load function.
2026-01-30 18:02:44 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 18:02:44 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:02:44 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:02:44 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:02:44 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:02:44 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 18:02:44 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:02:44 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:02:44 +0000 INFO:firstload executed successfully
2026-01-30 18:02:44 +0000 INFO:Data first load completed successfully.
2026-01-30 18:02:44 +0000 INFO:initialise_data executed successfully
2026-01-30 18:02:44 +0000 INFO:Running Menu setup...
2026-01-30 18:02:44 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 18:02:44 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:02:44 +0000 INFO:get_git_version executed successfully
2026-01-30 18:02:44 +0000 INFO:App Version: v50.239
2026-01-30 18:02:44 +0000 INFO:Switched to page: Regulated Entity per Donor
2026-01-30 18:02:44 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:02:44 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:02:44 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:02:44 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:02:44 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:02:44 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:02:44 +0000 DEBUG:Page texts: {}
2026-01-30 18:02:44 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:02:44 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:02:45 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:02:45 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 18:02:45 +0000 INFO:pagesetup executed successfully
2026-01-30 18:02:45 +0000 INFO:Menu setup completed successfully.
2026-01-30 18:02:45 +0000 INFO:App is fully loaded and ready!
2026-01-30 18:02:47 +0000 INFO:Streamlit App Starting...
2026-01-30 18:02:47 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 18:02:47 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 18:02:47 +0000 INFO:Running App setup...
2026-01-30 18:02:47 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 18:02:47 +0000 INFO:Setting up the package
2026-01-30 18:02:47 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 18:02:47 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:02:47 +0000 INFO:get_git_version executed successfully
2026-01-30 18:02:47 +0000 INFO:Version: v50.201
2026-01-30 18:02:47 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 18:02:47 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:02:47 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:filenames already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:thresholds already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:filter_def already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:security already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:perc_target already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:directories already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:data_dir already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:output_dir already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:components_dir already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 18:02:47 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 18:02:47 +0000 INFO:Session_state variables initialized
2026-01-30 18:02:47 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 18:02:47 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 18:02:47 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 18:02:47 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 18:02:47 +0000 DEBUG:menu_selection: {'title': 'Regulated Donor per Entity', 'function': <function mod_regulated_donor_per_entity at 0x000001D560EE60E0>}
2026-01-30 18:02:47 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 18:02:47 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 18:02:47 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 18:02:47 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 18:02:47 +0000 DEBUG:selected_entity_name: All
2026-01-30 18:02:47 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 18:02:47 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 18:02:47 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 18:02:47 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 18:02:47 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 18:02:47 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 18:02:47 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 18:02:47 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 18:02:47 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 18:02:47 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 18:02:47 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 18:02:47 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 18:02:47 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 18:02:47 +0000 DEBUG:mod_regulated_donor_per_entity_None_mod_regulated_donor_per_entityRegulated Entity by DonorNone_group_entity_select: Donor
2026-01-30 18:02:47 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 18:02:47 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 18:02:47 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 18:02:47 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 18:02:47 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 18:02:47 +0000 DEBUG:perc_target: 0.5
2026-01-30 18:02:47 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 18:02:47 +0000 DEBUG:Cash_ftr: None
2026-01-30 18:02:47 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 18:02:47 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 18:02:47 +0000 DEBUG:date_range_mod_regulated_donor_per_entity_mod_regulated_donor_per_entityRegulated Entity by DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 18:02:47 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 18:02:47 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 18:02:47 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 18:02:47 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 18:02:47 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 18:02:47 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:02:47 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 18:02:47 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 18:02:47 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 18:02:47 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 18:02:47 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 18:02:47 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:02:47 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 18:02:47 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 18:02:47 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 18:02:47 +0000 INFO:Session state Setup complete
2026-01-30 18:02:47 +0000 INFO:initialize_session_state executed successfully
2026-01-30 18:02:47 +0000 INFO:Package setup complete
2026-01-30 18:02:47 +0000 INFO:setup_package executed successfully
2026-01-30 18:02:47 +0000 INFO:Setup completed successfully.
2026-01-30 18:02:47 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 18:02:47 +0000 INFO:Running first load function.
2026-01-30 18:02:47 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 18:02:47 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:02:47 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:02:47 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:02:47 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:02:47 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 18:02:47 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:02:47 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:02:47 +0000 INFO:firstload executed successfully
2026-01-30 18:02:47 +0000 INFO:Data first load completed successfully.
2026-01-30 18:02:47 +0000 INFO:initialise_data executed successfully
2026-01-30 18:02:47 +0000 INFO:Running Menu setup...
2026-01-30 18:02:47 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 18:02:47 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:02:47 +0000 INFO:get_git_version executed successfully
2026-01-30 18:02:47 +0000 INFO:App Version: v50.239
2026-01-30 18:02:47 +0000 INFO:Switched to page: Regulated Donor per Entity
2026-01-30 18:02:47 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:02:47 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 18:02:47 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 18:02:47 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:02:47 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:02:47 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:02:47 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:02:47 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:02:47 +0000 DEBUG:Page texts: {}
2026-01-30 18:02:47 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:02:47 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:02:47 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:02:47 +0000 INFO:display_data_page executed successfully
2026-01-30 18:02:47 +0000 INFO:pagesetup executed successfully
2026-01-30 18:02:47 +0000 INFO:Menu setup completed successfully.
2026-01-30 18:02:47 +0000 INFO:App is fully loaded and ready!
2026-01-30 18:02:50 +0000 INFO:Streamlit App Starting...
2026-01-30 18:02:50 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 18:02:50 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 18:02:50 +0000 INFO:Running App setup...
2026-01-30 18:02:50 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 18:02:50 +0000 INFO:Setting up the package
2026-01-30 18:02:50 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 18:02:50 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:02:50 +0000 INFO:get_git_version executed successfully
2026-01-30 18:02:50 +0000 INFO:Version: v50.201
2026-01-30 18:02:50 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 18:02:50 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:02:50 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:filenames already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:thresholds already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:filter_def already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:security already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:perc_target already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:directories already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:data_dir already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:output_dir already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:components_dir already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 18:02:50 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 18:02:50 +0000 INFO:Session_state variables initialized
2026-01-30 18:02:50 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 18:02:50 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 18:02:50 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 18:02:50 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 18:02:50 +0000 DEBUG:menu_selection: {'title': 'Regulated Entity per Donor', 'function': <function mod_regulated_entity_per_donor at 0x000001D560EE6170>}
2026-01-30 18:02:50 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 18:02:50 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 18:02:50 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 18:02:50 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 18:02:50 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 18:02:50 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 18:02:50 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 18:02:50 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 18:02:50 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 18:02:50 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 18:02:50 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 18:02:50 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 18:02:50 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 18:02:50 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 18:02:50 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 18:02:50 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 18:02:50 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 18:02:50 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 18:02:50 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 18:02:50 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 18:02:50 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 18:02:50 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 18:02:50 +0000 DEBUG:perc_target: 0.5
2026-01-30 18:02:50 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 18:02:50 +0000 DEBUG:Cash_ftr: None
2026-01-30 18:02:50 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 18:02:50 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 18:02:50 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 18:02:50 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 18:02:50 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 18:02:50 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 18:02:50 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 18:02:50 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:02:50 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 18:02:50 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 18:02:50 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 18:02:50 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 18:02:50 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 18:02:50 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:02:50 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 18:02:50 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 18:02:50 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 18:02:50 +0000 INFO:Session state Setup complete
2026-01-30 18:02:50 +0000 INFO:initialize_session_state executed successfully
2026-01-30 18:02:50 +0000 INFO:Package setup complete
2026-01-30 18:02:50 +0000 INFO:setup_package executed successfully
2026-01-30 18:02:50 +0000 INFO:Setup completed successfully.
2026-01-30 18:02:50 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 18:02:50 +0000 INFO:Running first load function.
2026-01-30 18:02:50 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 18:02:50 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:02:50 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:02:50 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:02:50 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:02:50 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 18:02:50 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:02:50 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:02:50 +0000 INFO:firstload executed successfully
2026-01-30 18:02:50 +0000 INFO:Data first load completed successfully.
2026-01-30 18:02:50 +0000 INFO:initialise_data executed successfully
2026-01-30 18:02:50 +0000 INFO:Running Menu setup...
2026-01-30 18:02:50 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 18:02:50 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:02:50 +0000 INFO:get_git_version executed successfully
2026-01-30 18:02:50 +0000 INFO:App Version: v50.239
2026-01-30 18:02:50 +0000 INFO:Switched to page: Regulated Entity per Donor
2026-01-30 18:02:50 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:02:51 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:02:51 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:02:51 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:02:51 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:02:51 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:02:51 +0000 DEBUG:Page texts: {}
2026-01-30 18:02:51 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:02:51 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:02:51 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:02:51 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 18:02:51 +0000 INFO:pagesetup executed successfully
2026-01-30 18:02:51 +0000 INFO:Menu setup completed successfully.
2026-01-30 18:02:51 +0000 INFO:App is fully loaded and ready!
2026-01-30 18:02:52 +0000 INFO:Streamlit App Starting...
2026-01-30 18:02:52 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 18:02:52 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 18:02:52 +0000 INFO:Running App setup...
2026-01-30 18:02:52 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 18:02:52 +0000 INFO:Setting up the package
2026-01-30 18:02:52 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 18:02:52 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:02:52 +0000 INFO:get_git_version executed successfully
2026-01-30 18:02:52 +0000 INFO:Version: v50.201
2026-01-30 18:02:52 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 18:02:52 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:02:52 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:filenames already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:thresholds already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:filter_def already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:security already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:perc_target already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:directories already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:data_dir already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:output_dir already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:components_dir already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 18:02:52 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 18:02:52 +0000 INFO:Session_state variables initialized
2026-01-30 18:02:52 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 18:02:52 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 18:02:52 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 18:02:52 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 18:02:52 +0000 DEBUG:menu_selection: {'title': 'Regulated Donor per Entity', 'function': <function mod_regulated_donor_per_entity at 0x000001D560EE60E0>}
2026-01-30 18:02:52 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 18:02:52 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 18:02:52 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 18:02:52 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 18:02:52 +0000 DEBUG:selected_entity_name: All
2026-01-30 18:02:52 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 18:02:52 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 18:02:52 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 18:02:52 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 18:02:52 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 18:02:52 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 18:02:52 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 18:02:52 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 18:02:52 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 18:02:52 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 18:02:52 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 18:02:52 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 18:02:52 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 18:02:52 +0000 DEBUG:mod_regulated_donor_per_entity_None_mod_regulated_donor_per_entityRegulated Entity by DonorNone_group_entity_select: Donor
2026-01-30 18:02:52 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 18:02:52 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 18:02:52 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 18:02:52 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 18:02:52 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 18:02:52 +0000 DEBUG:perc_target: 0.5
2026-01-30 18:02:52 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 18:02:52 +0000 DEBUG:Cash_ftr: None
2026-01-30 18:02:52 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 18:02:53 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 18:02:53 +0000 DEBUG:date_range_mod_regulated_donor_per_entity_mod_regulated_donor_per_entityRegulated Entity by DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 18:02:53 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 18:02:53 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 18:02:53 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 18:02:53 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 18:02:53 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 18:02:53 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:02:53 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 18:02:53 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 18:02:53 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 18:02:53 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 18:02:53 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 18:02:53 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:02:53 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 18:02:53 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 18:02:53 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 18:02:53 +0000 INFO:Session state Setup complete
2026-01-30 18:02:53 +0000 INFO:initialize_session_state executed successfully
2026-01-30 18:02:53 +0000 INFO:Package setup complete
2026-01-30 18:02:53 +0000 INFO:setup_package executed successfully
2026-01-30 18:02:53 +0000 INFO:Setup completed successfully.
2026-01-30 18:02:53 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 18:02:53 +0000 INFO:Running first load function.
2026-01-30 18:02:53 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 18:02:53 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:02:53 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:02:53 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:02:53 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:02:53 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 18:02:53 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:02:53 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:02:53 +0000 INFO:firstload executed successfully
2026-01-30 18:02:53 +0000 INFO:Data first load completed successfully.
2026-01-30 18:02:53 +0000 INFO:initialise_data executed successfully
2026-01-30 18:02:53 +0000 INFO:Running Menu setup...
2026-01-30 18:02:53 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 18:02:53 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:02:53 +0000 INFO:get_git_version executed successfully
2026-01-30 18:02:53 +0000 INFO:App Version: v50.239
2026-01-30 18:02:53 +0000 INFO:Switched to page: Regulated Donor per Entity
2026-01-30 18:02:53 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:02:53 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 18:02:53 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 18:02:53 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:02:53 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:02:53 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:02:53 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:02:53 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:02:53 +0000 DEBUG:Page texts: {}
2026-01-30 18:02:53 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:02:53 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:02:53 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:02:53 +0000 INFO:display_data_page executed successfully
2026-01-30 18:02:53 +0000 INFO:pagesetup executed successfully
2026-01-30 18:02:53 +0000 INFO:Menu setup completed successfully.
2026-01-30 18:02:53 +0000 INFO:App is fully loaded and ready!
2026-01-30 18:02:53 +0000 INFO:Streamlit App Starting...
2026-01-30 18:02:53 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 18:02:53 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 18:02:53 +0000 INFO:Running App setup...
2026-01-30 18:02:53 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 18:02:53 +0000 INFO:Setting up the package
2026-01-30 18:02:53 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 18:02:53 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:02:53 +0000 INFO:get_git_version executed successfully
2026-01-30 18:02:53 +0000 INFO:Version: v50.201
2026-01-30 18:02:53 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 18:02:53 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:02:53 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:filenames already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:thresholds already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:filter_def already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:security already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:perc_target already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:directories already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:data_dir already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:output_dir already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:components_dir already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 18:02:53 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 18:02:53 +0000 INFO:Session_state variables initialized
2026-01-30 18:02:53 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 18:02:53 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 18:02:53 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 18:02:53 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 18:02:53 +0000 DEBUG:menu_selection: {'title': 'Internal Political Party Donations', 'function': <function mod_donations_per_political_party at 0x000001D560EE6050>}
2026-01-30 18:02:53 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 18:02:53 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 18:02:53 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 18:02:53 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 18:02:53 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 18:02:53 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 18:02:53 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 18:02:53 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 18:02:53 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 18:02:53 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 18:02:53 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 18:02:53 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 18:02:53 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 18:02:53 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 18:02:53 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 18:02:53 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 18:02:53 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 18:02:53 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 18:02:53 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 18:02:53 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 18:02:53 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 18:02:53 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 18:02:53 +0000 DEBUG:perc_target: 0.5
2026-01-30 18:02:53 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 18:02:53 +0000 DEBUG:Cash_ftr: None
2026-01-30 18:02:53 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 18:02:53 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 18:02:53 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 18:02:53 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 18:02:54 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 18:02:54 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 18:02:54 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 18:02:54 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:02:54 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 18:02:54 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 18:02:54 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 18:02:54 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 18:02:54 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 18:02:54 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:02:54 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 18:02:54 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 18:02:54 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 18:02:54 +0000 INFO:Session state Setup complete
2026-01-30 18:02:54 +0000 INFO:initialize_session_state executed successfully
2026-01-30 18:02:54 +0000 INFO:Package setup complete
2026-01-30 18:02:54 +0000 INFO:setup_package executed successfully
2026-01-30 18:02:54 +0000 INFO:Setup completed successfully.
2026-01-30 18:02:54 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 18:02:54 +0000 INFO:Running first load function.
2026-01-30 18:02:54 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 18:02:54 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:02:54 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:02:54 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:02:54 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:02:54 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 18:02:54 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:02:54 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:02:54 +0000 INFO:firstload executed successfully
2026-01-30 18:02:54 +0000 INFO:Data first load completed successfully.
2026-01-30 18:02:54 +0000 INFO:initialise_data executed successfully
2026-01-30 18:02:54 +0000 INFO:Running Menu setup...
2026-01-30 18:02:54 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 18:02:54 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:02:54 +0000 INFO:get_git_version executed successfully
2026-01-30 18:02:54 +0000 INFO:App Version: v50.239
2026-01-30 18:02:54 +0000 INFO:Switched to page: Internal Political Party Donations
2026-01-30 18:02:54 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:02:54 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 18:02:54 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 18:02:54 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:02:54 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:02:54 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:02:54 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:02:54 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:02:54 +0000 DEBUG:Page texts: {}
2026-01-30 18:02:54 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:02:54 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:02:54 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:02:54 +0000 INFO:display_data_page executed successfully
2026-01-30 18:02:54 +0000 INFO:pagesetup executed successfully
2026-01-30 18:02:54 +0000 INFO:Menu setup completed successfully.
2026-01-30 18:02:54 +0000 INFO:App is fully loaded and ready!
2026-01-30 18:02:57 +0000 INFO:Streamlit App Starting...
2026-01-30 18:02:57 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 18:02:57 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 18:02:57 +0000 INFO:Running App setup...
2026-01-30 18:02:57 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 18:02:57 +0000 INFO:Setting up the package
2026-01-30 18:02:57 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 18:02:57 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:02:57 +0000 INFO:get_git_version executed successfully
2026-01-30 18:02:57 +0000 INFO:Version: v50.201
2026-01-30 18:02:57 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 18:02:57 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:02:57 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:filenames already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:thresholds already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:filter_def already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:security already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:perc_target already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:directories already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:data_dir already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:output_dir already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:components_dir already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 18:02:57 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 18:02:57 +0000 INFO:Session_state variables initialized
2026-01-30 18:02:57 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 18:02:57 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 18:02:57 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 18:02:57 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 18:02:57 +0000 DEBUG:menu_selection: {'title': 'Regulated Donor per Entity', 'function': <function mod_regulated_donor_per_entity at 0x000001D560EE60E0>}
2026-01-30 18:02:57 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 18:02:57 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 18:02:57 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 18:02:57 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 18:02:57 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 18:02:57 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 18:02:57 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 18:02:57 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 18:02:57 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 18:02:57 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 18:02:57 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 18:02:57 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 18:02:57 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 18:02:57 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 18:02:57 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 18:02:57 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 18:02:57 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 18:02:57 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 18:02:57 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 18:02:57 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 18:02:57 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 18:02:57 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 18:02:57 +0000 DEBUG:perc_target: 0.5
2026-01-30 18:02:57 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 18:02:57 +0000 DEBUG:Cash_ftr: None
2026-01-30 18:02:57 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 18:02:57 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 18:02:57 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 18:02:57 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 18:02:57 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 18:02:57 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 18:02:57 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 18:02:57 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:02:57 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 18:02:57 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 18:02:57 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 18:02:57 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 18:02:57 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 18:02:57 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:02:57 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 18:02:57 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 18:02:57 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 18:02:57 +0000 INFO:Session state Setup complete
2026-01-30 18:02:57 +0000 INFO:initialize_session_state executed successfully
2026-01-30 18:02:57 +0000 INFO:Package setup complete
2026-01-30 18:02:57 +0000 INFO:setup_package executed successfully
2026-01-30 18:02:57 +0000 INFO:Setup completed successfully.
2026-01-30 18:02:57 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 18:02:57 +0000 INFO:Running first load function.
2026-01-30 18:02:57 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 18:02:57 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:02:57 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:02:57 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:02:57 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:02:57 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 18:02:57 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:02:57 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:02:57 +0000 INFO:firstload executed successfully
2026-01-30 18:02:57 +0000 INFO:Data first load completed successfully.
2026-01-30 18:02:57 +0000 INFO:initialise_data executed successfully
2026-01-30 18:02:57 +0000 INFO:Running Menu setup...
2026-01-30 18:02:57 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 18:02:57 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:02:57 +0000 INFO:get_git_version executed successfully
2026-01-30 18:02:57 +0000 INFO:App Version: v50.239
2026-01-30 18:02:57 +0000 INFO:Switched to page: Regulated Donor per Entity
2026-01-30 18:02:57 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:02:57 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 18:02:57 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 18:02:57 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:02:57 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:02:57 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:02:57 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:02:57 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:02:57 +0000 DEBUG:Page texts: {}
2026-01-30 18:02:57 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:02:57 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:02:57 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:02:57 +0000 INFO:display_data_page executed successfully
2026-01-30 18:02:57 +0000 INFO:pagesetup executed successfully
2026-01-30 18:02:57 +0000 INFO:Menu setup completed successfully.
2026-01-30 18:02:57 +0000 INFO:App is fully loaded and ready!
2026-01-30 18:02:58 +0000 INFO:Streamlit App Starting...
2026-01-30 18:02:58 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 18:02:58 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 18:02:58 +0000 INFO:Running App setup...
2026-01-30 18:02:58 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 18:02:58 +0000 INFO:Setting up the package
2026-01-30 18:02:58 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 18:02:58 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:02:58 +0000 INFO:get_git_version executed successfully
2026-01-30 18:02:58 +0000 INFO:Version: v50.201
2026-01-30 18:02:58 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 18:02:58 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:02:58 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:filenames already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:thresholds already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:filter_def already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:security already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:perc_target already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:directories already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:data_dir already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:output_dir already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:components_dir already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 18:02:58 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 18:02:58 +0000 INFO:Session_state variables initialized
2026-01-30 18:02:58 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 18:02:58 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 18:02:58 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 18:02:58 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 18:02:58 +0000 DEBUG:menu_selection: {'title': 'Dubious Donations', 'function': <function mod_dubious_donations at 0x000001D560EE5FC0>}
2026-01-30 18:02:58 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 18:02:58 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 18:02:58 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 18:02:58 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 18:02:58 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 18:02:58 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 18:02:58 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 18:02:58 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 18:02:58 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 18:02:58 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 18:02:58 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 18:02:58 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 18:02:58 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 18:02:58 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 18:02:58 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 18:02:58 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 18:02:58 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 18:02:58 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 18:02:58 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 18:02:58 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 18:02:58 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 18:02:58 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 18:02:58 +0000 DEBUG:perc_target: 0.5
2026-01-30 18:02:58 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 18:02:58 +0000 DEBUG:Cash_ftr: None
2026-01-30 18:02:58 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 18:02:58 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 18:02:58 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 18:02:58 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 18:02:58 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 18:02:58 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 18:02:58 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 18:02:58 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:02:58 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 18:02:58 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 18:02:58 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 18:02:58 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 18:02:58 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 18:02:58 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:02:58 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 18:02:58 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 18:02:58 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 18:02:58 +0000 INFO:Session state Setup complete
2026-01-30 18:02:58 +0000 INFO:initialize_session_state executed successfully
2026-01-30 18:02:58 +0000 INFO:Package setup complete
2026-01-30 18:02:58 +0000 INFO:setup_package executed successfully
2026-01-30 18:02:58 +0000 INFO:Setup completed successfully.
2026-01-30 18:02:58 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 18:02:58 +0000 INFO:Running first load function.
2026-01-30 18:02:58 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 18:02:58 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:02:58 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:02:58 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:02:58 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:02:58 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 18:02:58 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:02:58 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:02:58 +0000 INFO:firstload executed successfully
2026-01-30 18:02:58 +0000 INFO:Data first load completed successfully.
2026-01-30 18:02:58 +0000 INFO:initialise_data executed successfully
2026-01-30 18:02:58 +0000 INFO:Running Menu setup...
2026-01-30 18:02:58 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 18:02:58 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:02:58 +0000 INFO:get_git_version executed successfully
2026-01-30 18:02:58 +0000 INFO:App Version: v50.239
2026-01-30 18:02:58 +0000 INFO:Switched to page: Dubious Donations
2026-01-30 18:02:58 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:02:58 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 18:02:58 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 18:02:58 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:02:58 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:02:58 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:02:58 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:02:58 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:02:58 +0000 DEBUG:Page texts: {}
2026-01-30 18:02:58 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:02:58 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:02:58 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:02:58 +0000 INFO:display_data_page executed successfully
2026-01-30 18:02:58 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:02:58 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:02:59 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:02:59 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:02:59 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:02:59 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:02:59 +0000 DEBUG:Page texts: {}
2026-01-30 18:02:59 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:02:59 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:02:59 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:02:59 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 18:02:59 +0000 INFO:pagesetup executed successfully
2026-01-30 18:02:59 +0000 INFO:Menu setup completed successfully.
2026-01-30 18:02:59 +0000 INFO:App is fully loaded and ready!
2026-01-30 18:02:59 +0000 INFO:Streamlit App Starting...
2026-01-30 18:02:59 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 18:02:59 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 18:02:59 +0000 INFO:Running App setup...
2026-01-30 18:02:59 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 18:02:59 +0000 INFO:Setting up the package
2026-01-30 18:02:59 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 18:02:59 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:02:59 +0000 INFO:get_git_version executed successfully
2026-01-30 18:02:59 +0000 INFO:Version: v50.201
2026-01-30 18:02:59 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 18:02:59 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:02:59 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:filenames already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:thresholds already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:filter_def already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:security already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:perc_target already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:directories already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:data_dir already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:output_dir already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:components_dir already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 18:02:59 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 18:02:59 +0000 INFO:Session_state variables initialized
2026-01-30 18:02:59 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 18:02:59 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 18:02:59 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 18:02:59 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 18:02:59 +0000 DEBUG:mod_dubious_donations_per_donor_None_mod_dubious_donations_per_donorDubious Donations per DonorNone_group_entity_select: Donor
2026-01-30 18:02:59 +0000 DEBUG:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors at 0x000001D560EE6200>}
2026-01-30 18:02:59 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 18:02:59 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 18:02:59 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 18:02:59 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 18:02:59 +0000 DEBUG:selected_entity_name: All
2026-01-30 18:02:59 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 18:02:59 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 18:02:59 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 18:02:59 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 18:02:59 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 18:02:59 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 18:02:59 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 18:02:59 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 18:02:59 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 18:02:59 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 18:02:59 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 18:02:59 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 18:02:59 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 18:02:59 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 18:02:59 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 18:02:59 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 18:02:59 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 18:02:59 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 18:02:59 +0000 DEBUG:perc_target: 0.5
2026-01-30 18:02:59 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 18:02:59 +0000 DEBUG:Cash_ftr: None
2026-01-30 18:02:59 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 18:02:59 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 18:02:59 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 18:02:59 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 18:02:59 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 18:02:59 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 18:02:59 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 18:02:59 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:02:59 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 18:02:59 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 18:02:59 +0000 DEBUG:date_range_mod_dubious_donations_per_donor_mod_dubious_donations_per_donorDubious Donations per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 18:02:59 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 18:02:59 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 18:02:59 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 18:02:59 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:02:59 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 18:02:59 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 18:02:59 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 18:02:59 +0000 INFO:Session state Setup complete
2026-01-30 18:02:59 +0000 INFO:initialize_session_state executed successfully
2026-01-30 18:02:59 +0000 INFO:Package setup complete
2026-01-30 18:02:59 +0000 INFO:setup_package executed successfully
2026-01-30 18:02:59 +0000 INFO:Setup completed successfully.
2026-01-30 18:02:59 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 18:02:59 +0000 INFO:Running first load function.
2026-01-30 18:02:59 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 18:02:59 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:02:59 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:02:59 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:02:59 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:02:59 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 18:02:59 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:02:59 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:02:59 +0000 INFO:firstload executed successfully
2026-01-30 18:02:59 +0000 INFO:Data first load completed successfully.
2026-01-30 18:02:59 +0000 INFO:initialise_data executed successfully
2026-01-30 18:02:59 +0000 INFO:Running Menu setup...
2026-01-30 18:02:59 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 18:02:59 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:02:59 +0000 INFO:get_git_version executed successfully
2026-01-30 18:02:59 +0000 INFO:App Version: v50.239
2026-01-30 18:02:59 +0000 INFO:Switched to page: Dubious Donors
2026-01-30 18:02:59 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:02:59 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 18:02:59 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 18:02:59 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:02:59 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:02:59 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:02:59 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:02:59 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:02:59 +0000 DEBUG:Page texts: {}
2026-01-30 18:02:59 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:02:59 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:03:00 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:03:00 +0000 INFO:display_data_page executed successfully
2026-01-30 18:03:00 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:03:00 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:03:00 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:03:00 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:03:00 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:03:00 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:03:00 +0000 DEBUG:Page texts: {}
2026-01-30 18:03:00 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:03:00 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:03:00 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:03:00 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 18:03:00 +0000 INFO:pagesetup executed successfully
2026-01-30 18:03:00 +0000 INFO:Menu setup completed successfully.
2026-01-30 18:03:00 +0000 INFO:App is fully loaded and ready!
2026-01-30 18:03:05 +0000 INFO:Streamlit App Starting...
2026-01-30 18:03:05 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 18:03:05 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 18:03:05 +0000 INFO:Running App setup...
2026-01-30 18:03:05 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 18:03:05 +0000 INFO:Setting up the package
2026-01-30 18:03:05 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 18:03:05 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:03:05 +0000 INFO:get_git_version executed successfully
2026-01-30 18:03:05 +0000 INFO:Version: v50.201
2026-01-30 18:03:05 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 18:03:05 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:03:05 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:filenames already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:thresholds already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:filter_def already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:security already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:perc_target already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:directories already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:data_dir already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:output_dir already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:components_dir already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 18:03:05 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 18:03:05 +0000 INFO:Session_state variables initialized
2026-01-30 18:03:05 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 18:03:05 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 18:03:05 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 18:03:06 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 18:03:06 +0000 DEBUG:menu_selection: {'title': 'Paid Visits', 'function': <function mod_visits at 0x000001D560EE51B0>}
2026-01-30 18:03:06 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 18:03:06 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 18:03:06 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 18:03:06 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 18:03:06 +0000 DEBUG:selected_entity_name: All
2026-01-30 18:03:06 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 18:03:06 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 18:03:06 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 18:03:06 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 18:03:06 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 18:03:06 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 18:03:06 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 18:03:06 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 18:03:06 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 18:03:06 +0000 DEBUG:mod_dubious_donors_per_entity_None_mod_dubious_donors_per_entityDubious Donors per EntityNone_group_entity_select: Donor
2026-01-30 18:03:06 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 18:03:06 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 18:03:06 +0000 DEBUG:date_range_mod_dubious_donors_per_entity_mod_dubious_donors_per_entityDubious Donors per EntityNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 18:03:06 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 18:03:06 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 18:03:06 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 18:03:06 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 18:03:06 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 18:03:06 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 18:03:06 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 18:03:06 +0000 DEBUG:perc_target: 0.5
2026-01-30 18:03:06 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 18:03:06 +0000 DEBUG:Cash_ftr: None
2026-01-30 18:03:06 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 18:03:06 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 18:03:06 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 18:03:06 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 18:03:06 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 18:03:06 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 18:03:06 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 18:03:06 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:03:06 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 18:03:06 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 18:03:06 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 18:03:06 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 18:03:06 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 18:03:06 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:03:06 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 18:03:06 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 18:03:06 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 18:03:06 +0000 INFO:Session state Setup complete
2026-01-30 18:03:06 +0000 INFO:initialize_session_state executed successfully
2026-01-30 18:03:06 +0000 INFO:Package setup complete
2026-01-30 18:03:06 +0000 INFO:setup_package executed successfully
2026-01-30 18:03:06 +0000 INFO:Setup completed successfully.
2026-01-30 18:03:06 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 18:03:06 +0000 INFO:Running first load function.
2026-01-30 18:03:06 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 18:03:06 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:03:06 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:03:06 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:03:06 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:03:06 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 18:03:06 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:03:06 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:03:06 +0000 INFO:firstload executed successfully
2026-01-30 18:03:06 +0000 INFO:Data first load completed successfully.
2026-01-30 18:03:06 +0000 INFO:initialise_data executed successfully
2026-01-30 18:03:06 +0000 INFO:Running Menu setup...
2026-01-30 18:03:06 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 18:03:06 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:03:06 +0000 INFO:get_git_version executed successfully
2026-01-30 18:03:06 +0000 INFO:App Version: v50.239
2026-01-30 18:03:06 +0000 INFO:Switched to page: Paid Visits
2026-01-30 18:03:06 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:03:06 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 18:03:06 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 18:03:06 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:03:06 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:03:06 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:03:06 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:03:06 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:03:06 +0000 DEBUG:Page texts: {}
2026-01-30 18:03:06 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:03:06 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:03:06 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:03:06 +0000 INFO:display_data_page executed successfully
2026-01-30 18:03:06 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:03:06 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:03:06 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:03:06 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:03:06 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:03:06 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:03:06 +0000 DEBUG:Page texts: {}
2026-01-30 18:03:06 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:03:06 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:03:07 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:03:07 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 18:03:07 +0000 INFO:pagesetup executed successfully
2026-01-30 18:03:07 +0000 INFO:Menu setup completed successfully.
2026-01-30 18:03:07 +0000 INFO:App is fully loaded and ready!
2026-01-30 18:03:10 +0000 INFO:Streamlit App Starting...
2026-01-30 18:03:10 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 18:03:10 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 18:03:10 +0000 INFO:Running App setup...
2026-01-30 18:03:10 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 18:03:10 +0000 INFO:Setting up the package
2026-01-30 18:03:10 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 18:03:10 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:03:10 +0000 INFO:get_git_version executed successfully
2026-01-30 18:03:10 +0000 INFO:Version: v50.201
2026-01-30 18:03:10 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 18:03:10 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:03:10 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:filenames already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:thresholds already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:filter_def already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:security already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:perc_target already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:directories already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:data_dir already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:output_dir already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:components_dir already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 18:03:10 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 18:03:10 +0000 INFO:Session_state variables initialized
2026-01-30 18:03:10 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 18:03:10 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 18:03:10 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 18:03:10 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 18:03:10 +0000 DEBUG:menu_selection: {'title': 'Sponsorships', 'function': <function mod_sponsorships at 0x000001D560EE5E10>}
2026-01-30 18:03:10 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 18:03:10 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 18:03:10 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 18:03:10 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 18:03:10 +0000 DEBUG:selected_entity_name: All
2026-01-30 18:03:10 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 18:03:10 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 18:03:10 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 18:03:10 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 18:03:10 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 18:03:10 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 18:03:10 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 18:03:10 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 18:03:10 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 18:03:10 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 18:03:10 +0000 DEBUG:mod_visits_per_donor_None_mod_visits_per_donorDonated Visits per DonorNone_group_entity_select: Donor
2026-01-30 18:03:10 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 18:03:10 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 18:03:10 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 18:03:10 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 18:03:10 +0000 DEBUG:date_range_mod_visits_per_donor_mod_visits_per_donorDonated Visits per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 18:03:10 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 18:03:10 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 18:03:10 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 18:03:10 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 18:03:10 +0000 DEBUG:perc_target: 0.5
2026-01-30 18:03:10 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 18:03:10 +0000 DEBUG:Cash_ftr: None
2026-01-30 18:03:10 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 18:03:10 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 18:03:10 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 18:03:10 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 18:03:10 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 18:03:10 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 18:03:10 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 18:03:10 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:03:10 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 18:03:10 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 18:03:10 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 18:03:10 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 18:03:10 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 18:03:10 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:03:10 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 18:03:10 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 18:03:10 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 18:03:10 +0000 INFO:Session state Setup complete
2026-01-30 18:03:10 +0000 INFO:initialize_session_state executed successfully
2026-01-30 18:03:10 +0000 INFO:Package setup complete
2026-01-30 18:03:10 +0000 INFO:setup_package executed successfully
2026-01-30 18:03:10 +0000 INFO:Setup completed successfully.
2026-01-30 18:03:10 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 18:03:10 +0000 INFO:Running first load function.
2026-01-30 18:03:10 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 18:03:10 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:03:10 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:03:10 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:03:10 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:03:10 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 18:03:10 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:03:10 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:03:10 +0000 INFO:firstload executed successfully
2026-01-30 18:03:10 +0000 INFO:Data first load completed successfully.
2026-01-30 18:03:10 +0000 INFO:initialise_data executed successfully
2026-01-30 18:03:10 +0000 INFO:Running Menu setup...
2026-01-30 18:03:10 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 18:03:10 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:03:10 +0000 INFO:get_git_version executed successfully
2026-01-30 18:03:10 +0000 INFO:App Version: v50.239
2026-01-30 18:03:10 +0000 INFO:Switched to page: Sponsorships
2026-01-30 18:03:10 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:03:10 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 18:03:11 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 18:03:11 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:03:11 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:03:11 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:03:11 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:03:11 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:03:11 +0000 DEBUG:Page texts: {}
2026-01-30 18:03:11 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:03:11 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:03:11 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:03:11 +0000 INFO:display_data_page executed successfully
2026-01-30 18:03:11 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:03:11 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:03:11 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:03:11 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:03:11 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:03:11 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:03:11 +0000 DEBUG:Page texts: {}
2026-01-30 18:03:11 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:03:11 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:03:11 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:03:11 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 18:03:11 +0000 INFO:pagesetup executed successfully
2026-01-30 18:03:11 +0000 INFO:Menu setup completed successfully.
2026-01-30 18:03:11 +0000 INFO:App is fully loaded and ready!
2026-01-30 18:03:13 +0000 INFO:Streamlit App Starting...
2026-01-30 18:03:13 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 18:03:13 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 18:03:13 +0000 INFO:Running App setup...
2026-01-30 18:03:13 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 18:03:13 +0000 INFO:Setting up the package
2026-01-30 18:03:13 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 18:03:13 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:03:13 +0000 INFO:get_git_version executed successfully
2026-01-30 18:03:13 +0000 INFO:Version: v50.201
2026-01-30 18:03:13 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 18:03:13 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:03:13 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:filenames already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:thresholds already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:filter_def already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:security already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:perc_target already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:directories already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:data_dir already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:output_dir already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:components_dir already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 18:03:13 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 18:03:13 +0000 INFO:Session_state variables initialized
2026-01-30 18:03:13 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 18:03:13 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 18:03:13 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 18:03:13 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 18:03:13 +0000 DEBUG:menu_selection: {'title': 'Corporate Donations', 'function': <function mod_corporate_donations at 0x000001D560EE5F30>}
2026-01-30 18:03:13 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 18:03:13 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 18:03:13 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 18:03:13 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 18:03:13 +0000 DEBUG:selected_entity_name: All
2026-01-30 18:03:13 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 18:03:13 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 18:03:13 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 18:03:13 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 18:03:13 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 18:03:13 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 18:03:13 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 18:03:13 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 18:03:13 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 18:03:13 +0000 DEBUG:date_range_mod_sponsorships_per_donor_mod_sponsorships_per_donorSponsorships per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 18:03:13 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 18:03:13 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 18:03:13 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 18:03:13 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 18:03:13 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 18:03:13 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 18:03:13 +0000 DEBUG:mod_sponsorships_per_donor_None_mod_sponsorships_per_donorSponsorships per DonorNone_group_entity_select: Donor
2026-01-30 18:03:13 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 18:03:13 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 18:03:13 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 18:03:13 +0000 DEBUG:perc_target: 0.5
2026-01-30 18:03:13 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 18:03:13 +0000 DEBUG:Cash_ftr: None
2026-01-30 18:03:13 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 18:03:13 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 18:03:13 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 18:03:13 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 18:03:13 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 18:03:13 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 18:03:13 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 18:03:13 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:03:13 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 18:03:13 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 18:03:13 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 18:03:13 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 18:03:13 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 18:03:13 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:03:13 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 18:03:13 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 18:03:13 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 18:03:13 +0000 INFO:Session state Setup complete
2026-01-30 18:03:13 +0000 INFO:initialize_session_state executed successfully
2026-01-30 18:03:13 +0000 INFO:Package setup complete
2026-01-30 18:03:13 +0000 INFO:setup_package executed successfully
2026-01-30 18:03:13 +0000 INFO:Setup completed successfully.
2026-01-30 18:03:13 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 18:03:13 +0000 INFO:Running first load function.
2026-01-30 18:03:13 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 18:03:13 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:03:13 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:03:13 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:03:13 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:03:13 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 18:03:13 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:03:13 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:03:13 +0000 INFO:firstload executed successfully
2026-01-30 18:03:13 +0000 INFO:Data first load completed successfully.
2026-01-30 18:03:13 +0000 INFO:initialise_data executed successfully
2026-01-30 18:03:13 +0000 INFO:Running Menu setup...
2026-01-30 18:03:13 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 18:03:13 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:03:13 +0000 INFO:get_git_version executed successfully
2026-01-30 18:03:13 +0000 INFO:App Version: v50.239
2026-01-30 18:03:13 +0000 INFO:Switched to page: Corporate Donations
2026-01-30 18:03:13 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:03:13 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 18:03:13 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 18:03:13 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:03:13 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:03:13 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:03:13 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:03:13 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:03:13 +0000 DEBUG:Page texts: {}
2026-01-30 18:03:13 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:03:13 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:03:13 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:03:13 +0000 INFO:display_data_page executed successfully
2026-01-30 18:03:13 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:03:13 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:03:14 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:03:14 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:03:14 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:03:14 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:03:14 +0000 DEBUG:Page texts: {}
2026-01-30 18:03:14 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:03:14 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:03:14 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:03:14 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 18:03:14 +0000 INFO:pagesetup executed successfully
2026-01-30 18:03:14 +0000 INFO:Menu setup completed successfully.
2026-01-30 18:03:14 +0000 INFO:App is fully loaded and ready!
2026-01-30 18:03:21 +0000 INFO:Streamlit App Starting...
2026-01-30 18:03:21 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 18:03:21 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 18:03:21 +0000 INFO:Running App setup...
2026-01-30 18:03:21 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 18:03:21 +0000 INFO:Setting up the package
2026-01-30 18:03:21 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 18:03:21 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:03:21 +0000 INFO:get_git_version executed successfully
2026-01-30 18:03:21 +0000 INFO:Version: v50.201
2026-01-30 18:03:21 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 18:03:21 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:03:21 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:filenames already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:thresholds already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:filter_def already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:security already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:perc_target already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:directories already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:data_dir already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:output_dir already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:components_dir already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 18:03:21 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 18:03:21 +0000 INFO:Session_state variables initialized
2026-01-30 18:03:21 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 18:03:21 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 18:03:21 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 18:03:21 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 18:03:21 +0000 DEBUG:menu_selection: {'title': 'Bequests', 'function': <function mod_bequeths at 0x000001D560EE5EA0>}
2026-01-30 18:03:21 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 18:03:21 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 18:03:21 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 18:03:21 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 18:03:21 +0000 DEBUG:selected_entity_name: All
2026-01-30 18:03:21 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 18:03:21 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 18:03:21 +0000 DEBUG:date_range_mod_corporate_donations_per_donor_mod_corporate_donations_per_donorCorporate Donation per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 18:03:21 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 18:03:21 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 18:03:21 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 18:03:21 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 18:03:21 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 18:03:21 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 18:03:21 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 18:03:21 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 18:03:21 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 18:03:21 +0000 DEBUG:mod_corporate_donations_per_donor_None_mod_corporate_donations_per_donorCorporate Donation per DonorNone_group_entity_select: Donor
2026-01-30 18:03:21 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 18:03:21 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 18:03:21 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 18:03:21 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 18:03:21 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 18:03:21 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 18:03:21 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 18:03:21 +0000 DEBUG:perc_target: 0.5
2026-01-30 18:03:21 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 18:03:21 +0000 DEBUG:Cash_ftr: None
2026-01-30 18:03:21 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 18:03:21 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 18:03:21 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 18:03:21 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 18:03:21 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 18:03:21 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 18:03:21 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 18:03:21 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:03:21 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 18:03:21 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 18:03:21 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 18:03:21 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 18:03:21 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 18:03:21 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:03:21 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 18:03:21 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 18:03:21 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 18:03:21 +0000 INFO:Session state Setup complete
2026-01-30 18:03:21 +0000 INFO:initialize_session_state executed successfully
2026-01-30 18:03:21 +0000 INFO:Package setup complete
2026-01-30 18:03:21 +0000 INFO:setup_package executed successfully
2026-01-30 18:03:21 +0000 INFO:Setup completed successfully.
2026-01-30 18:03:21 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 18:03:21 +0000 INFO:Running first load function.
2026-01-30 18:03:21 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 18:03:21 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:03:21 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:03:21 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:03:21 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:03:21 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 18:03:21 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:03:21 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:03:21 +0000 INFO:firstload executed successfully
2026-01-30 18:03:21 +0000 INFO:Data first load completed successfully.
2026-01-30 18:03:21 +0000 INFO:initialise_data executed successfully
2026-01-30 18:03:21 +0000 INFO:Running Menu setup...
2026-01-30 18:03:21 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 18:03:21 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:03:21 +0000 INFO:get_git_version executed successfully
2026-01-30 18:03:21 +0000 INFO:App Version: v50.239
2026-01-30 18:03:21 +0000 INFO:Switched to page: Bequests
2026-01-30 18:03:21 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:03:21 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 18:03:21 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 18:03:21 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:03:21 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:03:21 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:03:21 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:03:21 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:03:21 +0000 DEBUG:Page texts: {}
2026-01-30 18:03:21 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:03:21 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:03:21 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:03:21 +0000 INFO:display_data_page executed successfully
2026-01-30 18:03:21 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:03:22 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:03:22 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:03:22 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:03:22 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:03:22 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:03:22 +0000 DEBUG:Page texts: {}
2026-01-30 18:03:22 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:03:22 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:03:22 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:03:22 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 18:03:22 +0000 INFO:pagesetup executed successfully
2026-01-30 18:03:22 +0000 INFO:Menu setup completed successfully.
2026-01-30 18:03:22 +0000 INFO:App is fully loaded and ready!
2026-01-30 18:03:22 +0000 INFO:Streamlit App Starting...
2026-01-30 18:03:22 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 18:03:22 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 18:03:22 +0000 INFO:Running App setup...
2026-01-30 18:03:22 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 18:03:22 +0000 INFO:Setting up the package
2026-01-30 18:03:22 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 18:03:22 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:03:22 +0000 INFO:get_git_version executed successfully
2026-01-30 18:03:22 +0000 INFO:Version: v50.201
2026-01-30 18:03:22 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 18:03:22 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:03:22 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:filenames already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:thresholds already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:filter_def already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:security already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:perc_target already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:directories already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:data_dir already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:output_dir already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:components_dir already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 18:03:22 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 18:03:22 +0000 INFO:Session_state variables initialized
2026-01-30 18:03:22 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 18:03:22 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 18:03:22 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 18:03:22 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 18:03:22 +0000 DEBUG:menu_selection: {'title': 'Public Fund Donations', 'function': <function mod_publicfund_donations at 0x000001D560EE63B0>}
2026-01-30 18:03:22 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 18:03:22 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 18:03:22 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 18:03:22 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 18:03:22 +0000 DEBUG:selected_entity_name: All
2026-01-30 18:03:22 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 18:03:22 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 18:03:22 +0000 DEBUG:date_range_mod_corporate_donations_per_donor_mod_corporate_donations_per_donorCorporate Donation per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 18:03:22 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 18:03:22 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 18:03:22 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 18:03:22 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 18:03:22 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 18:03:22 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 18:03:22 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 18:03:22 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 18:03:22 +0000 DEBUG:mod_bequeths_per_donor_None_mod_bequeths_per_donorBequest per DonorNone_group_entity_select: Donor
2026-01-30 18:03:22 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 18:03:22 +0000 DEBUG:date_range_mod_bequeths_per_donor_mod_bequeths_per_donorBequest per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 18:03:22 +0000 DEBUG:mod_corporate_donations_per_donor_None_mod_corporate_donations_per_donorCorporate Donation per DonorNone_group_entity_select: Donor
2026-01-30 18:03:22 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 18:03:22 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 18:03:22 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 18:03:22 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 18:03:22 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 18:03:22 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 18:03:22 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 18:03:22 +0000 DEBUG:perc_target: 0.5
2026-01-30 18:03:22 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 18:03:22 +0000 DEBUG:Cash_ftr: None
2026-01-30 18:03:22 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 18:03:22 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 18:03:22 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 18:03:22 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 18:03:22 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 18:03:22 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 18:03:22 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 18:03:22 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:03:22 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 18:03:22 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 18:03:22 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 18:03:22 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 18:03:22 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 18:03:22 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:03:22 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 18:03:22 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 18:03:22 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 18:03:22 +0000 INFO:Session state Setup complete
2026-01-30 18:03:22 +0000 INFO:initialize_session_state executed successfully
2026-01-30 18:03:22 +0000 INFO:Package setup complete
2026-01-30 18:03:22 +0000 INFO:setup_package executed successfully
2026-01-30 18:03:22 +0000 INFO:Setup completed successfully.
2026-01-30 18:03:22 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 18:03:22 +0000 INFO:Running first load function.
2026-01-30 18:03:22 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 18:03:22 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:03:22 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:03:22 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:03:22 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:03:22 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 18:03:22 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:03:22 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:03:22 +0000 INFO:firstload executed successfully
2026-01-30 18:03:22 +0000 INFO:Data first load completed successfully.
2026-01-30 18:03:22 +0000 INFO:initialise_data executed successfully
2026-01-30 18:03:22 +0000 INFO:Running Menu setup...
2026-01-30 18:03:22 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 18:03:22 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:03:22 +0000 INFO:get_git_version executed successfully
2026-01-30 18:03:22 +0000 INFO:App Version: v50.239
2026-01-30 18:03:22 +0000 INFO:Switched to page: Public Fund Donations
2026-01-30 18:03:22 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:03:22 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 18:03:22 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 18:03:22 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:03:23 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:03:23 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:03:23 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:03:23 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:03:23 +0000 DEBUG:Page texts: {}
2026-01-30 18:03:23 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:03:23 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:03:23 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:03:23 +0000 INFO:display_data_page executed successfully
2026-01-30 18:03:23 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:03:23 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:03:23 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:03:23 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:03:23 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:03:23 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:03:23 +0000 DEBUG:Page texts: {}
2026-01-30 18:03:23 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:03:23 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:03:23 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:03:23 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 18:03:23 +0000 INFO:pagesetup executed successfully
2026-01-30 18:03:23 +0000 INFO:Menu setup completed successfully.
2026-01-30 18:03:23 +0000 INFO:App is fully loaded and ready!
2026-01-30 18:03:24 +0000 INFO:Streamlit App Starting...
2026-01-30 18:03:24 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 18:03:24 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 18:03:24 +0000 INFO:Running App setup...
2026-01-30 18:03:24 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 18:03:24 +0000 INFO:Setting up the package
2026-01-30 18:03:24 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 18:03:24 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:03:24 +0000 INFO:get_git_version executed successfully
2026-01-30 18:03:24 +0000 INFO:Version: v50.201
2026-01-30 18:03:24 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 18:03:24 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:03:24 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:filenames already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:thresholds already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:filter_def already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:security already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:perc_target already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:directories already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:data_dir already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:output_dir already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:components_dir already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 18:03:24 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 18:03:24 +0000 INFO:Session_state variables initialized
2026-01-30 18:03:24 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 18:03:24 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 18:03:24 +0000 DEBUG:mod_publicfund_donations_per_donor_None_mod_publicfund_donations_per_donorPublic Fund Donation per DonorNone_group_entity_select: Donor
2026-01-30 18:03:24 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 18:03:24 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 18:03:24 +0000 DEBUG:menu_selection: {'title': 'Non Cash Donations', 'function': <function mod_non_cash_donations at 0x000001D560EE6320>}
2026-01-30 18:03:24 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 18:03:24 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 18:03:24 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 18:03:24 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 18:03:24 +0000 DEBUG:date_range_mod_publicfund_donations_per_donor_mod_publicfund_donations_per_donorPublic Fund Donation per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 18:03:24 +0000 DEBUG:selected_entity_name: All
2026-01-30 18:03:24 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 18:03:24 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 18:03:24 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 18:03:24 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 18:03:24 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 18:03:24 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 18:03:24 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 18:03:24 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 18:03:24 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 18:03:24 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 18:03:24 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 18:03:24 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 18:03:24 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 18:03:24 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 18:03:24 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 18:03:24 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 18:03:24 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 18:03:24 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 18:03:24 +0000 DEBUG:perc_target: 0.5
2026-01-30 18:03:24 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 18:03:24 +0000 DEBUG:Cash_ftr: None
2026-01-30 18:03:24 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 18:03:24 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 18:03:24 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 18:03:24 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 18:03:24 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 18:03:24 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 18:03:24 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 18:03:24 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:03:24 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 18:03:24 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 18:03:24 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 18:03:24 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 18:03:24 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 18:03:24 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:03:24 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 18:03:24 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 18:03:25 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 18:03:25 +0000 INFO:Session state Setup complete
2026-01-30 18:03:25 +0000 INFO:initialize_session_state executed successfully
2026-01-30 18:03:25 +0000 INFO:Package setup complete
2026-01-30 18:03:25 +0000 INFO:setup_package executed successfully
2026-01-30 18:03:25 +0000 INFO:Setup completed successfully.
2026-01-30 18:03:25 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 18:03:25 +0000 INFO:Running first load function.
2026-01-30 18:03:25 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 18:03:25 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:03:25 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:03:25 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:03:25 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:03:25 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 18:03:25 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:03:25 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:03:25 +0000 INFO:firstload executed successfully
2026-01-30 18:03:25 +0000 INFO:Data first load completed successfully.
2026-01-30 18:03:25 +0000 INFO:initialise_data executed successfully
2026-01-30 18:03:25 +0000 INFO:Running Menu setup...
2026-01-30 18:03:25 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 18:03:25 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:03:25 +0000 INFO:get_git_version executed successfully
2026-01-30 18:03:25 +0000 INFO:App Version: v50.239
2026-01-30 18:03:25 +0000 INFO:Switched to page: Non Cash Donations
2026-01-30 18:03:25 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:03:25 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 18:03:25 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 18:03:25 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:03:25 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:03:25 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:03:25 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:03:25 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:03:25 +0000 DEBUG:Page texts: {}
2026-01-30 18:03:25 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:03:25 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:03:25 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:03:25 +0000 INFO:display_data_page executed successfully
2026-01-30 18:03:25 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:03:25 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:03:25 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:03:25 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:03:25 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:03:25 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:03:25 +0000 DEBUG:Page texts: {}
2026-01-30 18:03:25 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:03:25 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:03:26 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:03:26 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 18:03:26 +0000 INFO:pagesetup executed successfully
2026-01-30 18:03:26 +0000 INFO:Menu setup completed successfully.
2026-01-30 18:03:26 +0000 INFO:App is fully loaded and ready!
2026-01-30 18:03:28 +0000 INFO:Streamlit App Starting...
2026-01-30 18:03:28 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 18:03:28 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 18:03:28 +0000 INFO:Running App setup...
2026-01-30 18:03:28 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 18:03:28 +0000 INFO:Setting up the package
2026-01-30 18:03:28 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 18:03:28 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:03:28 +0000 INFO:get_git_version executed successfully
2026-01-30 18:03:28 +0000 INFO:Version: v50.201
2026-01-30 18:03:28 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 18:03:28 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:03:28 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:filenames already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:thresholds already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:filter_def already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:security already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:perc_target already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:directories already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:data_dir already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:output_dir already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:components_dir already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 18:03:28 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 18:03:28 +0000 INFO:Session_state variables initialized
2026-01-30 18:03:28 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 18:03:28 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 18:03:28 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 18:03:28 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 18:03:28 +0000 DEBUG:menu_selection: {'title': 'Cash Donations', 'function': <function mod_cash_donations at 0x000001D560EE6290>}
2026-01-30 18:03:28 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 18:03:28 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 18:03:28 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 18:03:28 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 18:03:28 +0000 DEBUG:selected_entity_name: All
2026-01-30 18:03:28 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 18:03:28 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 18:03:28 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 18:03:28 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 18:03:28 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 18:03:28 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 18:03:28 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 18:03:28 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 18:03:28 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 18:03:28 +0000 DEBUG:date_range_mod_non_cash_donations_per_donor_mod_non_cash_donations_per_donorNon Cash Donations per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 18:03:28 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 18:03:28 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 18:03:28 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 18:03:28 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 18:03:28 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 18:03:28 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 18:03:28 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 18:03:28 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 18:03:28 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 18:03:28 +0000 DEBUG:perc_target: 0.5
2026-01-30 18:03:28 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 18:03:28 +0000 DEBUG:Cash_ftr: None
2026-01-30 18:03:28 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 18:03:28 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 18:03:28 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 18:03:28 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 18:03:28 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 18:03:28 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 18:03:28 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 18:03:28 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:03:28 +0000 DEBUG:mod_non_cash_donations_per_donor_None_mod_non_cash_donations_per_donorNon Cash Donations per DonorNone_group_entity_select: Donor
2026-01-30 18:03:28 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 18:03:28 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 18:03:28 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 18:03:28 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 18:03:28 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 18:03:28 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:03:28 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 18:03:28 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 18:03:28 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 18:03:28 +0000 INFO:Session state Setup complete
2026-01-30 18:03:28 +0000 INFO:initialize_session_state executed successfully
2026-01-30 18:03:28 +0000 INFO:Package setup complete
2026-01-30 18:03:28 +0000 INFO:setup_package executed successfully
2026-01-30 18:03:28 +0000 INFO:Setup completed successfully.
2026-01-30 18:03:28 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 18:03:28 +0000 INFO:Running first load function.
2026-01-30 18:03:28 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 18:03:28 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:03:28 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:03:28 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:03:28 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:03:28 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 18:03:28 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:03:28 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:03:28 +0000 INFO:firstload executed successfully
2026-01-30 18:03:28 +0000 INFO:Data first load completed successfully.
2026-01-30 18:03:28 +0000 INFO:initialise_data executed successfully
2026-01-30 18:03:28 +0000 INFO:Running Menu setup...
2026-01-30 18:03:28 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 18:03:28 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:03:28 +0000 INFO:get_git_version executed successfully
2026-01-30 18:03:28 +0000 INFO:App Version: v50.239
2026-01-30 18:03:28 +0000 INFO:Switched to page: Cash Donations
2026-01-30 18:03:28 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:03:28 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 18:03:29 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 18:03:29 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:03:29 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:03:29 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:03:29 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:03:29 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:03:29 +0000 DEBUG:Page texts: {'Para1': {'text': 'Except for in 2016', 'is_deleted': False}, 'Para 2': {'text': 'More useful information', 'is_deleted': False}}
2026-01-30 18:03:29 +0000 DEBUG:Calling manage_text_elements with args={args}, kwargs={kwargs}
2026-01-30 18:03:29 +0000 DEBUG:Not logged in as admin.
2026-01-30 18:03:29 +0000 INFO:manage_text_elements executed successfully
2026-01-30 18:03:29 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:03:29 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:03:29 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:03:29 +0000 INFO:display_data_page executed successfully
2026-01-30 18:03:29 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:03:29 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:03:30 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:03:30 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:03:30 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:03:30 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:03:30 +0000 DEBUG:Page texts: {}
2026-01-30 18:03:30 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:03:30 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:03:30 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:03:30 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 18:03:30 +0000 INFO:pagesetup executed successfully
2026-01-30 18:03:30 +0000 INFO:Menu setup completed successfully.
2026-01-30 18:03:30 +0000 INFO:App is fully loaded and ready!
2026-01-30 18:03:30 +0000 INFO:Streamlit App Starting...
2026-01-30 18:03:30 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 18:03:30 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 18:03:30 +0000 INFO:Running App setup...
2026-01-30 18:03:30 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 18:03:30 +0000 INFO:Setting up the package
2026-01-30 18:03:30 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 18:03:30 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:03:30 +0000 INFO:get_git_version executed successfully
2026-01-30 18:03:30 +0000 INFO:Version: v50.201
2026-01-30 18:03:30 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 18:03:30 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:03:30 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:filenames already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:thresholds already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:filter_def already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:security already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:perc_target already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:directories already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:data_dir already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:output_dir already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:components_dir already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 18:03:30 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 18:03:30 +0000 INFO:Session_state variables initialized
2026-01-30 18:03:30 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 18:03:30 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 18:03:30 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 18:03:30 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 18:03:30 +0000 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x000001D560EE4F70>}
2026-01-30 18:03:30 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 18:03:30 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 18:03:30 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 18:03:30 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 18:03:30 +0000 DEBUG:selected_entity_name: All
2026-01-30 18:03:30 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 18:03:30 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 18:03:30 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 18:03:30 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 18:03:30 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 18:03:30 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 18:03:30 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 18:03:30 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 18:03:30 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 18:03:30 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 18:03:30 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 18:03:30 +0000 DEBUG:date_range_mod_cash_donations_per_donor_mod_cash_donations_per_donorCash Donations per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 18:03:30 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 18:03:30 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 18:03:30 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 18:03:30 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 18:03:30 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 18:03:30 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 18:03:30 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 18:03:30 +0000 DEBUG:perc_target: 0.5
2026-01-30 18:03:30 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 18:03:30 +0000 DEBUG:Cash_ftr: None
2026-01-30 18:03:30 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 18:03:30 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 18:03:30 +0000 DEBUG:mod_cash_donations_per_donor_None_mod_cash_donations_per_donorCash Donations per DonorNone_group_entity_select: Donor
2026-01-30 18:03:30 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 18:03:30 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 18:03:30 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 18:03:30 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 18:03:30 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 18:03:30 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:03:30 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 18:03:30 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 18:03:30 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 18:03:30 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 18:03:30 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 18:03:30 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:03:30 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 18:03:30 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 18:03:30 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 18:03:30 +0000 INFO:Session state Setup complete
2026-01-30 18:03:30 +0000 INFO:initialize_session_state executed successfully
2026-01-30 18:03:30 +0000 INFO:Package setup complete
2026-01-30 18:03:30 +0000 INFO:setup_package executed successfully
2026-01-30 18:03:30 +0000 INFO:Setup completed successfully.
2026-01-30 18:03:30 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 18:03:30 +0000 INFO:Running first load function.
2026-01-30 18:03:30 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 18:03:30 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:03:30 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:03:30 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:03:30 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:03:30 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 18:03:30 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:03:30 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:03:30 +0000 INFO:firstload executed successfully
2026-01-30 18:03:30 +0000 INFO:Data first load completed successfully.
2026-01-30 18:03:30 +0000 INFO:initialise_data executed successfully
2026-01-30 18:03:30 +0000 INFO:Running Menu setup...
2026-01-30 18:03:30 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 18:03:30 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:03:30 +0000 INFO:get_git_version executed successfully
2026-01-30 18:03:30 +0000 INFO:App Version: v50.239
2026-01-30 18:03:30 +0000 INFO:Switched to page: Head Line Figures
2026-01-30 18:03:30 +0000 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2026-01-30 18:03:30 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 18:03:31 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 18:03:31 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:03:31 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:03:32 +0000 DEBUG:Aggregated DataFrame:                         Party_Group         Value
0   Conservative And Unionist Party  20170.405233
1         Democratic Unionist Party   3618.940000
2                       Green Party   6204.226405
3                      Labour Party  20519.157176
4                      Large Entity  12031.362470
5                     Liberal Party   2871.754667
6                     Medium Entity  19378.136232
7      Plaid Cymru - Party Of Wales  15859.742724
8                         Reform UK  97641.772732
9     Scottish National Party (Snp)  36021.189364
10           Single Donation Entity  13864.955459
11                        Sinn Féin  44317.630769
12                     Small Entity  24968.983822
13     Uk Independence Party (Ukip)   9943.456859
2026-01-30 18:03:32 +0000 DEBUG:Sorted DataFrame:                         Party_Group         Value
8                         Reform UK  97641.772732
11                        Sinn Féin  44317.630769
9     Scottish National Party (Snp)  36021.189364
12                     Small Entity  24968.983822
3                      Labour Party  20519.157176
0   Conservative And Unionist Party  20170.405233
6                     Medium Entity  19378.136232
7      Plaid Cymru - Party Of Wales  15859.742724
10           Single Donation Entity  13864.955459
4                      Large Entity  12031.362470
13     Uk Independence Party (Ukip)   9943.456859
2                       Green Party   6204.226405
1         Democratic Unionist Party   3618.940000
5                     Liberal Party   2871.754667
2026-01-30 18:03:32 +0000 DEBUG:Unique XValues: ['Reform UK' 'Sinn Féin' 'Scottish National Party (Snp)' 'Small Entity'
 'Labour Party' 'Conservative And Unionist Party' 'Medium Entity'
 'Plaid Cymru - Party Of Wales' 'Single Donation Entity' 'Large Entity'
 'Uk Independence Party (Ukip)' 'Green Party' 'Democratic Unionist Party'
 'Liberal Party']
2026-01-30 18:03:32 +0000 DEBUG:Final color_discrete_map: {'Reform UK': '#12B6CF', 'Sinn Féin': '#326760', 'Scottish National Party (Snp)': '#636efa', 'Small Entity': '#aaaaaa', 'Labour Party': '#DC241F', 'Conservative And Unionist Party': '#0087DC', 'Medium Entity': '#666666', 'Plaid Cymru - Party Of Wales': '#636efa', 'Single Donation Entity': '#e8e8e8', 'Large Entity': '#222222', 'Uk Independence Party (Ukip)': '#70147A', 'Green Party': '#78B943', 'Democratic Unionist Party': '#636efa', 'Liberal Party': '#636efa'}
2026-01-30 18:03:32 +0000 DEBUG:Missing color mappings for: ['Scottish National Party (Snp)', 'Plaid Cymru - Party Of Wales', 'Democratic Unionist Party', 'Liberal Party']
2026-01-30 18:03:32 +0000 DEBUG:Generated Figure: Figure({
    'data': [{'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Reform UK',
              'marker': {'color': '#12B6CF', 'pattern': {'shape': ''}},
              'name': 'Reform UK',
              'offsetgroup': 'Reform UK',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Reform UK'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'a1QcXZzW90A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Sinn Féin',
              'marker': {'color': '#326760', 'pattern': {'shape': ''}},
              'name': 'Sinn Féin',
              'offsetgroup': 'Sinn Féin',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Sinn Féin'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'L/RCL7Sj5UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Scottish National Party (Snp)',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Scottish National Party (Snp)',
              'offsetgroup': 'Scottish National Party (Snp)',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Scottish National Party (Snp)'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '8tdFD6aW4UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Small Entity',
              'marker': {'color': '#aaaaaa', 'pattern': {'shape': ''}},
              'name': 'Small Entity',
              'offsetgroup': 'Small Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Small Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'vX7y9j5i2EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Labour Party',
              'marker': {'color': '#DC241F', 'pattern': {'shape': ''}},
              'name': 'Labour Party',
              'offsetgroup': 'Labour Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Labour Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '9qMqD8oJ1EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Conservative And Unionist Party',
              'marker': {'color': '#0087DC', 'pattern': {'shape': ''}},
              'name': 'Conservative And Unionist Party',
              'offsetgroup': 'Conservative And Unionist Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Conservative And Unionist Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '65FU75my00A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Medium Entity',
              'marker': {'color': '#666666', 'pattern': {'shape': ''}},
              'name': 'Medium Entity',
              'offsetgroup': 'Medium Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Medium Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'nXsGuIjs0kA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Plaid Cymru - Party Of Wales',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Plaid Cymru - Party Of Wales',
              'offsetgroup': 'Plaid Cymru - Party Of Wales',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Plaid Cymru - Party Of Wales'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '7uOSEd/5zkA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Single Donation Entity',
              'marker': {'color': '#e8e8e8', 'pattern': {'shape': ''}},
              'name': 'Single Donation Entity',
              'offsetgroup': 'Single Donation Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Single Donation Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'hd1+THoUy0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Large Entity',
              'marker': {'color': '#222222', 'pattern': {'shape': ''}},
              'name': 'Large Entity',
              'offsetgroup': 'Large Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Large Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'lyJsZa5/x0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Uk Independence Party (Ukip)',
              'marker': {'color': '#70147A', 'pattern': {'shape': ''}},
              'name': 'Uk Independence Party (Ukip)',
              'offsetgroup': 'Uk Independence Party (Ukip)',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Uk Independence Party (Ukip)'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'U0xcerprw0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Green Party',
              'marker': {'color': '#78B943', 'pattern': {'shape': ''}},
              'name': 'Green Party',
              'offsetgroup': 'Green Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Green Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'LOWs9Tk8uEA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Democratic Unionist Party',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Democratic Unionist Party',
              'offsetgroup': 'Democratic Unionist Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Democratic Unionist Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'exSuR+FFrEA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Liberal Party',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Liberal Party',
              'offsetgroup': 'Liberal Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Liberal Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'blmrY4JvpkA=', 'dtype': 'f8'},
              'yaxis': 'y'}],
    'layout': {'barmode': 'group',
               'legend': {'title': {'text': 'Political Party'}, 'tracegroupgap': 0},
               'template': '...',
               'title': {'text': 'Average Donation per Party'},
               'xaxis': {'anchor': 'y',
                         'categoryarray': [Reform UK, Sinn Féin, Scottish National
                                           Party (Snp), Small Entity, Labour Party,
                                           Conservative And Unionist Party, Medium
                                           Entity, Plaid Cymru - Party Of Wales,
                                           Single Donation Entity, Large Entity, Uk
                                           Independence Party (Ukip), Green Party,
                                           Democratic Unionist Party, Liberal
                                           Party],
                         'categoryorder': 'array',
                         'domain': [0.0, 1.0],
                         'title': {'text': 'Political Party'}},
               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': 'Average Donation GBP'}}}
})
2026-01-30 18:03:32 +0000 INFO:Bar chart displayed successfully.
2026-01-30 18:03:32 +0000 INFO:hlf_body executed successfully
2026-01-30 18:03:32 +0000 INFO:pagesetup executed successfully
2026-01-30 18:03:32 +0000 INFO:Menu setup completed successfully.
2026-01-30 18:03:32 +0000 INFO:App is fully loaded and ready!
2026-01-30 18:04:06 +0000 INFO:Streamlit App Starting...
2026-01-30 18:04:06 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 18:04:06 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 18:04:06 +0000 INFO:Running App setup...
2026-01-30 18:04:06 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 18:04:06 +0000 INFO:Setting up the package
2026-01-30 18:04:06 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 18:04:06 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:04:06 +0000 INFO:get_git_version executed successfully
2026-01-30 18:04:06 +0000 INFO:Version: v50.201
2026-01-30 18:04:06 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 18:04:06 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:04:06 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:filenames already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:thresholds already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:filter_def already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:security already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:perc_target already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:directories already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:data_dir already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:output_dir already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:components_dir already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 18:04:06 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 18:04:06 +0000 INFO:Session_state variables initialized
2026-01-30 18:04:06 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 18:04:06 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 18:04:06 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 18:04:06 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 18:04:06 +0000 DEBUG:menu_selection: {'title': 'Regulated Entity per Donor', 'function': <function mod_regulated_entity_per_donor at 0x000001D560EE6170>}
2026-01-30 18:04:06 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 18:04:06 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 18:04:06 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 18:04:06 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 18:04:06 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 18:04:06 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 18:04:06 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 18:04:06 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 18:04:06 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 18:04:06 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 18:04:06 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 18:04:06 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 18:04:06 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 18:04:06 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 18:04:06 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 18:04:06 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 18:04:06 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 18:04:06 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 18:04:06 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 18:04:06 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 18:04:06 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 18:04:06 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 18:04:06 +0000 DEBUG:perc_target: 0.5
2026-01-30 18:04:06 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 18:04:06 +0000 DEBUG:Cash_ftr: None
2026-01-30 18:04:06 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 18:04:06 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 18:04:06 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 18:04:06 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 18:04:06 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 18:04:06 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 18:04:06 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 18:04:06 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:04:06 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 18:04:06 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 18:04:06 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 18:04:06 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 18:04:06 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 18:04:06 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:04:06 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 18:04:06 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 18:04:06 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 18:04:06 +0000 INFO:Session state Setup complete
2026-01-30 18:04:06 +0000 INFO:initialize_session_state executed successfully
2026-01-30 18:04:06 +0000 INFO:Package setup complete
2026-01-30 18:04:06 +0000 INFO:setup_package executed successfully
2026-01-30 18:04:06 +0000 INFO:Setup completed successfully.
2026-01-30 18:04:06 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 18:04:06 +0000 INFO:Running first load function.
2026-01-30 18:04:06 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 18:04:06 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:04:06 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:04:06 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:04:06 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:04:06 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 18:04:06 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:04:06 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:04:06 +0000 INFO:firstload executed successfully
2026-01-30 18:04:06 +0000 INFO:Data first load completed successfully.
2026-01-30 18:04:06 +0000 INFO:initialise_data executed successfully
2026-01-30 18:04:06 +0000 INFO:Running Menu setup...
2026-01-30 18:04:06 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 18:04:06 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:04:06 +0000 INFO:get_git_version executed successfully
2026-01-30 18:04:06 +0000 INFO:App Version: v50.239
2026-01-30 18:04:06 +0000 INFO:Switched to page: Regulated Entity per Donor
2026-01-30 18:04:06 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:04:06 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:04:07 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:04:07 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:04:07 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:04:07 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:04:07 +0000 DEBUG:Page texts: {}
2026-01-30 18:04:07 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:04:07 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:04:07 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:04:07 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 18:04:07 +0000 INFO:pagesetup executed successfully
2026-01-30 18:04:07 +0000 INFO:Menu setup completed successfully.
2026-01-30 18:04:07 +0000 INFO:App is fully loaded and ready!
2026-01-30 18:04:10 +0000 INFO:Streamlit App Starting...
2026-01-30 18:04:10 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 18:04:10 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 18:04:10 +0000 INFO:Running App setup...
2026-01-30 18:04:10 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 18:04:10 +0000 INFO:Setting up the package
2026-01-30 18:04:10 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 18:04:10 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:04:10 +0000 INFO:get_git_version executed successfully
2026-01-30 18:04:10 +0000 INFO:Version: v50.201
2026-01-30 18:04:10 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 18:04:10 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:04:10 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:filenames already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:thresholds already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:filter_def already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:security already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:perc_target already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:directories already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:data_dir already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:output_dir already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:components_dir already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 18:04:10 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 18:04:10 +0000 INFO:Session_state variables initialized
2026-01-30 18:04:10 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 18:04:10 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 18:04:10 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 18:04:10 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 18:04:10 +0000 DEBUG:menu_selection: {'title': 'Regulated Entity per Donor', 'function': <function mod_regulated_entity_per_donor at 0x000001D560EE6170>}
2026-01-30 18:04:10 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 18:04:10 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 18:04:10 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 18:04:10 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 18:04:10 +0000 DEBUG:selected_entity_name: All
2026-01-30 18:04:10 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 18:04:10 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 18:04:10 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 18:04:10 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 18:04:10 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 18:04:10 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 18:04:10 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 18:04:10 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 18:04:10 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 18:04:10 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 18:04:10 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 18:04:10 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 18:04:10 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 18:04:10 +0000 DEBUG:mod_regulated_donor_per_entity_None_mod_regulated_donor_per_entityRegulated Entity by DonorNone_group_entity_select: Regulated Entity
2026-01-30 18:04:10 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 18:04:10 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 18:04:10 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 18:04:10 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 18:04:10 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 18:04:10 +0000 DEBUG:perc_target: 0.5
2026-01-30 18:04:10 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 18:04:10 +0000 DEBUG:Cash_ftr: None
2026-01-30 18:04:10 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 18:04:10 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 18:04:10 +0000 DEBUG:date_range_mod_regulated_donor_per_entity_mod_regulated_donor_per_entityRegulated Entity by DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 18:04:10 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 18:04:10 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 18:04:10 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 18:04:10 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 18:04:10 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 18:04:10 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:04:10 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 18:04:10 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 18:04:10 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 18:04:10 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 18:04:10 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 18:04:10 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:04:10 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 18:04:10 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 18:04:10 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 18:04:10 +0000 INFO:Session state Setup complete
2026-01-30 18:04:10 +0000 INFO:initialize_session_state executed successfully
2026-01-30 18:04:10 +0000 INFO:Package setup complete
2026-01-30 18:04:10 +0000 INFO:setup_package executed successfully
2026-01-30 18:04:10 +0000 INFO:Setup completed successfully.
2026-01-30 18:04:10 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 18:04:10 +0000 INFO:Running first load function.
2026-01-30 18:04:10 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 18:04:10 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:04:10 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:04:10 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:04:10 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:04:10 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 18:04:10 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:04:10 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:04:10 +0000 INFO:firstload executed successfully
2026-01-30 18:04:10 +0000 INFO:Data first load completed successfully.
2026-01-30 18:04:10 +0000 INFO:initialise_data executed successfully
2026-01-30 18:04:10 +0000 INFO:Running Menu setup...
2026-01-30 18:04:10 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 18:04:10 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:04:10 +0000 INFO:get_git_version executed successfully
2026-01-30 18:04:10 +0000 INFO:App Version: v50.239
2026-01-30 18:04:10 +0000 INFO:Switched to page: Regulated Entity per Donor
2026-01-30 18:04:10 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:04:11 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:04:11 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:04:11 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:04:11 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:04:11 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:04:11 +0000 DEBUG:Page texts: {}
2026-01-30 18:04:11 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:04:11 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:04:11 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:04:11 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 18:04:11 +0000 INFO:pagesetup executed successfully
2026-01-30 18:04:11 +0000 INFO:Menu setup completed successfully.
2026-01-30 18:04:11 +0000 INFO:App is fully loaded and ready!
2026-01-30 18:04:35 +0000 INFO:Streamlit App Starting...
2026-01-30 18:04:35 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 18:04:35 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 18:04:35 +0000 INFO:Running App setup...
2026-01-30 18:04:35 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 18:04:35 +0000 INFO:Setting up the package
2026-01-30 18:04:35 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 18:04:35 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:04:35 +0000 INFO:get_git_version executed successfully
2026-01-30 18:04:35 +0000 INFO:Version: v50.201
2026-01-30 18:04:35 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 18:04:35 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:04:35 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:filenames already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:thresholds already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:filter_def already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:security already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:perc_target already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:directories already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:data_dir already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:output_dir already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:components_dir already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 18:04:35 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 18:04:35 +0000 INFO:Session_state variables initialized
2026-01-30 18:04:35 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 18:04:35 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 18:04:35 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 18:04:35 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 18:04:36 +0000 DEBUG:menu_selection: {'title': 'Regulated Entity per Donor', 'function': <function mod_regulated_entity_per_donor at 0x000001D560EE6170>}
2026-01-30 18:04:36 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 18:04:36 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 18:04:36 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 18:04:36 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 18:04:36 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 18:04:36 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 18:04:36 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 18:04:36 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 18:04:36 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 18:04:36 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 18:04:36 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 18:04:36 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 18:04:36 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 18:04:36 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 18:04:36 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 18:04:36 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 18:04:36 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 18:04:36 +0000 DEBUG:mod_regulated_donor_per_entity_None_mod_regulated_donor_per_entityRegulated Entity by DonorNone_group_entity_select: Regulated Entity
2026-01-30 18:04:36 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 18:04:36 +0000 DEBUG:selected_entity_name: Green Party
2026-01-30 18:04:36 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 18:04:36 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 18:04:36 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 18:04:36 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 18:04:36 +0000 DEBUG:perc_target: 0.5
2026-01-30 18:04:36 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 18:04:36 +0000 DEBUG:Cash_ftr: None
2026-01-30 18:04:36 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 18:04:36 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 18:04:36 +0000 DEBUG:date_range_mod_regulated_donor_per_entity_mod_regulated_donor_per_entityRegulated Entity by DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 18:04:36 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 18:04:36 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 18:04:36 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 18:04:36 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 18:04:36 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 18:04:36 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:04:36 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 18:04:36 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 18:04:36 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 18:04:36 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 18:04:36 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 18:04:36 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:04:36 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 18:04:36 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 18:04:36 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 18:04:36 +0000 INFO:Session state Setup complete
2026-01-30 18:04:36 +0000 INFO:initialize_session_state executed successfully
2026-01-30 18:04:36 +0000 INFO:Package setup complete
2026-01-30 18:04:36 +0000 INFO:setup_package executed successfully
2026-01-30 18:04:36 +0000 INFO:Setup completed successfully.
2026-01-30 18:04:36 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 18:04:36 +0000 INFO:Running first load function.
2026-01-30 18:04:36 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 18:04:36 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:04:36 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:04:36 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:04:36 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:04:36 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 18:04:36 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:04:36 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:04:36 +0000 INFO:firstload executed successfully
2026-01-30 18:04:36 +0000 INFO:Data first load completed successfully.
2026-01-30 18:04:36 +0000 INFO:initialise_data executed successfully
2026-01-30 18:04:36 +0000 INFO:Running Menu setup...
2026-01-30 18:04:36 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 18:04:36 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:04:36 +0000 INFO:get_git_version executed successfully
2026-01-30 18:04:36 +0000 INFO:App Version: v50.239
2026-01-30 18:04:36 +0000 INFO:Switched to page: Regulated Entity per Donor
2026-01-30 18:04:36 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:04:36 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:04:36 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:04:36 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:04:36 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:04:36 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:04:36 +0000 DEBUG:Page texts: {}
2026-01-30 18:04:36 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:04:36 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:04:36 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:04:36 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 18:04:36 +0000 INFO:pagesetup executed successfully
2026-01-30 18:04:36 +0000 INFO:Menu setup completed successfully.
2026-01-30 18:04:36 +0000 INFO:App is fully loaded and ready!
2026-01-30 18:56:44 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2026-01-30 18:56:44 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:56:47 +0000 INFO:get_git_version executed successfully
2026-01-30 18:56:48 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:56:51 +0000 INFO:get_git_version executed successfully
2026-01-30 18:56:51 +0000 INFO:Streamlit App Starting...
2026-01-30 18:56:51 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 18:56:51 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 18:56:51 +0000 INFO:Running App setup...
2026-01-30 18:56:51 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 18:56:51 +0000 INFO:Setting up the package
2026-01-30 18:56:51 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 18:56:51 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:56:54 +0000 INFO:get_git_version executed successfully
2026-01-30 18:56:54 +0000 INFO:Version: v50.202
2026-01-30 18:56:54 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 18:56:54 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:56:54 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2026-01-30 18:56:54 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 18:56:54 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2026-01-30 18:56:54 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2026-01-30 18:56:54 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 18:56:54 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 18:56:54 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 18:56:54 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 18:56:54 +0000 DEBUG:Initialised perc_target with value: 0.5
2026-01-30 18:56:54 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2026-01-30 18:56:54 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 18:56:54 +0000 DEBUG:Initialised electoral_cycle_rules with value: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 18:56:54 +0000 DEBUG:Initialised reference_dir with value: H:\GitHub\dashboard_demo\reference_files
2026-01-30 18:56:54 +0000 DEBUG:Initialised data_dir with value: H:\GitHub\dashboard_demo\data
2026-01-30 18:56:54 +0000 DEBUG:Initialised output_dir with value: H:\GitHub\dashboard_demo\output
2026-01-30 18:56:54 +0000 DEBUG:Initialised logs_dir with value: H:\GitHub\dashboard_demo\logs
2026-01-30 18:56:54 +0000 DEBUG:Initialised components_dir with value: H:\GitHub\dashboard_demo\components
2026-01-30 18:56:54 +0000 DEBUG:Initialised app_pages_dir with value: H:\GitHub\dashboard_demo\app_pages
2026-01-30 18:56:54 +0000 DEBUG:Initialised utils_dir with value: H:\GitHub\dashboard_demo\utils
2026-01-30 18:56:54 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 18:56:54 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 18:56:54 +0000 DEBUG:Initialised mppartymemb_fname with value: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 18:56:54 +0000 DEBUG:Initialised donor_map_fname with value: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 18:56:54 +0000 DEBUG:Initialised politician_party_fname with value: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 18:56:54 +0000 DEBUG:Initialised regentity_map_fname with value: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 18:56:54 +0000 DEBUG:Initialised original_data_fname with value: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 18:56:54 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 18:56:54 +0000 DEBUG:Initialised TEXT_FILE with value: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 18:56:54 +0000 DEBUG:Initialised ELECTION_DATES with value: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 18:56:54 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 18:56:54 +0000 DEBUG:Initialised cleaned_data_fname with value: cleaned_data.zip
2026-01-30 18:56:54 +0000 DEBUG:Initialised cleaned_donations_fname with value: cleaned_donations.zip
2026-01-30 18:56:54 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: cleaned_donorlist.zip
2026-01-30 18:56:54 +0000 DEBUG:Initialised cleaned_regentity_fname with value: cleaned_regentity.zip
2026-01-30 18:56:54 +0000 DEBUG:Initialised party_summary_fname with value: party_summary.zip
2026-01-30 18:56:54 +0000 DEBUG:Initialised imported_raw_fname with value: imported_raw.zip
2026-01-30 18:56:54 +0000 DEBUG:Initialised source_data_fname with value: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:56:54 +0000 DEBUG:Initialised Cash_ftr with value: None
2026-01-30 18:56:54 +0000 INFO:Session_state variables initialized
2026-01-30 18:56:54 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 18:56:54 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 18:56:54 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 18:56:54 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:56:54 +0000 DEBUG:perc_target: 0.5
2026-01-30 18:56:54 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 18:56:54 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 18:56:54 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 18:56:54 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 18:56:54 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 18:56:54 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 18:56:54 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 18:56:54 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 18:56:54 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 18:56:54 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 18:56:54 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 18:56:54 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 18:56:54 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 18:56:54 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 18:56:54 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 18:56:54 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 18:56:54 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 18:56:54 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 18:56:54 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:56:54 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 18:56:54 +0000 DEBUG:Cash_ftr: None
2026-01-30 18:56:54 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 18:56:54 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 18:56:54 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 18:56:54 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 18:56:54 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 18:56:54 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 18:56:54 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 18:56:54 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 18:56:54 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 18:56:54 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 18:56:54 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 18:56:54 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 18:56:54 +0000 INFO:Session state Setup complete
2026-01-30 18:56:54 +0000 INFO:initialize_session_state executed successfully
2026-01-30 18:56:54 +0000 INFO:Package setup complete
2026-01-30 18:56:54 +0000 INFO:setup_package executed successfully
2026-01-30 18:56:54 +0000 INFO:Setup completed successfully.
2026-01-30 18:56:54 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 18:56:54 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:56:57 +0000 INFO:get_git_version executed successfully
2026-01-30 18:56:57 +0000 INFO:Running first load function.
2026-01-30 18:56:57 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 18:56:57 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2026-01-30 18:56:57 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2026-01-30 18:56:57 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2026-01-30 18:56:57 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2026-01-30 18:56:57 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 18:56:57 +0000 INFO:Original file path: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:56:57 +0000 INFO:Saved file path: imported_raw.zip
2026-01-30 18:56:57 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 18:56:57 +0000 INFO:Checking if H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip has been updated.
2026-01-30 18:56:57 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 18:56:57 +0000 INFO:Getting modification time for H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:56:57 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 18:56:57 +0000 INFO:Current modification time: 1769774510.1556323
2026-01-30 18:56:57 +0000 INFO:Last modification time: 1769774510.1556323
2026-01-30 18:56:57 +0000 INFO:is_file_updated executed successfully
2026-01-30 18:56:57 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 18:56:57 +0000 INFO:Loading raw data...
2026-01-30 18:56:57 +0000 DEBUG:Original data file path post raw data load: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:56:57 +0000 DEBUG:Processed data file path post raw data load: imported_raw.zip
2026-01-30 18:56:57 +0000 INFO:Data loaded successfully. Data has 91341 rows and 29 columns
2026-01-30 18:56:59 +0000 INFO:Data saved to imported_raw.zip
2026-01-30 18:56:59 +0000 INFO:Data saved to sessionstate as 'raw_data'
2026-01-30 18:56:59 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2026-01-30 18:56:59 +0000 INFO:Cleaning up raw data
2026-01-30 18:56:59 +0000 ERROR:Session state variables not initialized!
2026-01-30 18:56:59 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 18:56:59 +0000 INFO:Original file path: None
2026-01-30 18:56:59 +0000 INFO:Saved file path: cleaned_donations.zip
2026-01-30 18:56:59 +0000 ERROR:Error: originalfilepath is None!
2026-01-30 18:56:59 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 18:56:59 +0000 INFO:Data loaded, shape: (91341, 29)
2026-01-30 18:57:00 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2026-01-30 18:57:00 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2026-01-30 18:57:01 +0000 INFO:File deduplication complete, shape: ECRef                            592
OriginalRegulatedEntityName      592
RegulatedEntityType              592
Value                            592
AcceptedDate                     574
AccountingUnitName               592
DonorName                        592
AccountingUnitsAsCentralParty    592
IsSponsorship                    592
DonorStatus                      592
RegulatedDoneeType               592
CompanyRegistrationNumber        592
Postcode                         592
DonationType                     592
NatureOfDonation                 592
PurposeOfVisit                   592
DonationAction                   592
ReceivedDate                     486
ReportedDate                     592
IsReportedPrePoll                423
ReportingPeriodName              592
IsBequest                        592
IsAggregation                    592
OriginalRegulatedEntityId        592
AccountingUnitId                 592
DonorId                          592
CampaigningName                  592
RegisterName                     592
IsIrishSource                    592
CleanedRegulatedEntityName       592
CleanedRegulatedEntityId         592
RegulatedEntityId                592
RegulatedEntityName              592
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10109
OriginalRegulatedEntityName      10109
RegulatedEntityType              10109
Value                            10107
AcceptedDate                      9796
AccountingUnitName               10109
DonorName                        10109
AccountingUnitsAsCentralParty    10109
IsSponsorship                    10109
DonorStatus                      10109
RegulatedDoneeType               10109
CompanyRegistrationNumber        10109
Postcode                         10109
DonationType                     10109
NatureOfDonation                 10109
PurposeOfVisit                   10109
DonationAction                   10109
ReceivedDate                      7075
ReportedDate                     10099
IsReportedPrePoll                 4878
ReportingPeriodName              10109
IsBequest                        10109
IsAggregation                    10109
OriginalRegulatedEntityId        10109
AccountingUnitId                 10109
DonorId                          10109
CampaigningName                  10109
RegisterName                     10109
IsIrishSource                    10109
CleanedRegulatedEntityName       10109
CleanedRegulatedEntityId         10109
RegulatedEntityId                10109
RegulatedEntityName              10109
dtype: int64 records updated with new RegulatedEntityName
2026-01-30 18:57:01 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3771
OriginalRegulatedEntityName      3771
RegulatedEntityType              3771
Value                            3771
AcceptedDate                     3667
AccountingUnitName               3771
DonorName                        3771
AccountingUnitsAsCentralParty    3771
IsSponsorship                    3771
DonorStatus                      3771
RegulatedDoneeType               3771
CompanyRegistrationNumber        3771
Postcode                         3771
DonationType                     3771
NatureOfDonation                 3771
PurposeOfVisit                   3771
DonationAction                   3771
ReceivedDate                     3297
ReportedDate                     3771
IsReportedPrePoll                 449
ReportingPeriodName              3771
IsBequest                        3771
IsAggregation                    3771
OriginalRegulatedEntityId        3771
AccountingUnitId                 3771
DonorId                          3771
CampaigningName                  3771
RegisterName                     3771
IsIrishSource                    3771
CleanedRegulatedEntityName        592
CleanedRegulatedEntityId          592
RegulatedEntityId                3771
RegulatedEntityName              3771
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13288
OriginalRegulatedEntityName      13288
RegulatedEntityType              13288
Value                            13286
AcceptedDate                     12889
AccountingUnitName               13288
DonorName                        13288
AccountingUnitsAsCentralParty    13288
IsSponsorship                    13288
DonorStatus                      13288
RegulatedDoneeType               13288
CompanyRegistrationNumber        13288
Postcode                         13288
DonationType                     13288
NatureOfDonation                 13288
PurposeOfVisit                   13288
DonationAction                   13288
ReceivedDate                      9886
ReportedDate                     13278
IsReportedPrePoll                 4904
ReportingPeriodName              13288
IsBequest                        13288
IsAggregation                    13288
OriginalRegulatedEntityId        13288
AccountingUnitId                 13288
DonorId                          13288
CampaigningName                  13288
RegisterName                     13288
IsIrishSource                    13288
CleanedRegulatedEntityName       10109
CleanedRegulatedEntityId         10109
RegulatedEntityId                13288
RegulatedEntityName              13288
dtype: int64 records updated with new RegulatedEntityName
2026-01-30 18:57:01 +0000 INFO:File deduplication complete, shape: (91341, 33)
2026-01-30 18:57:01 +0000 INFO:dedupe_entity_file executed successfully
2026-01-30 18:57:01 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2026-01-30 18:57:01 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2026-01-30 18:57:01 +0000 INFO:File deduplication complete, shape: ECRef                            34082
OriginalRegulatedEntityName      34082
RegulatedEntityType              34082
Value                            34079
AcceptedDate                     33689
AccountingUnitName               34082
OriginalDonorName                34082
AccountingUnitsAsCentralParty    34082
IsSponsorship                    34082
DonorStatus                      34082
RegulatedDoneeType               34082
CompanyRegistrationNumber        34082
Postcode                         34082
DonationType                     34082
NatureOfDonation                 34082
PurposeOfVisit                   34082
DonationAction                   34082
ReceivedDate                     32487
ReportedDate                     34071
IsReportedPrePoll                22707
ReportingPeriodName              34082
IsBequest                        34082
IsAggregation                    34082
OriginalRegulatedEntityId        34082
AccountingUnitId                 34082
OriginalDonorId                  34082
CampaigningName                  34082
RegisterName                     34082
IsIrishSource                    34082
CleanedRegulatedEntityName       34082
CleanedRegulatedEntityId         34082
RegulatedEntityId                34082
RegulatedEntityName              34082
CleanedDonorName                 34082
CleanedDonorId                   34082
DonorId                          34082
DonorName                        34082
dtype: int64 records updated with new DonorId and ECRef                            20155
OriginalRegulatedEntityName      20155
RegulatedEntityType              20155
Value                            20153
AcceptedDate                     19834
AccountingUnitName               20155
OriginalDonorName                20155
AccountingUnitsAsCentralParty    20155
IsSponsorship                    20155
DonorStatus                      20155
RegulatedDoneeType               20155
CompanyRegistrationNumber        20155
Postcode                         20155
DonationType                     20155
NatureOfDonation                 20155
PurposeOfVisit                   20155
DonationAction                   20155
ReceivedDate                     19620
ReportedDate                     20146
IsReportedPrePoll                13414
ReportingPeriodName              20155
IsBequest                        20155
IsAggregation                    20155
OriginalRegulatedEntityId        20155
AccountingUnitId                 20155
OriginalDonorId                  20155
CampaigningName                  20155
RegisterName                     20155
IsIrishSource                    20155
CleanedRegulatedEntityName       20154
CleanedRegulatedEntityId         20154
RegulatedEntityId                20155
RegulatedEntityName              20155
CleanedDonorName                 20155
CleanedDonorId                   20155
DonorId                          20155
DonorName                        20155
dtype: int64 records updated with new DonorName
2026-01-30 18:57:01 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            52934
OriginalRegulatedEntityName      52934
RegulatedEntityType              52934
Value                            52931
AcceptedDate                     52138
AccountingUnitName               52934
OriginalDonorName                52934
AccountingUnitsAsCentralParty    52934
IsSponsorship                    52934
DonorStatus                      52934
RegulatedDoneeType               52934
CompanyRegistrationNumber        52934
Postcode                         52934
DonationType                     52934
NatureOfDonation                 52934
PurposeOfVisit                   52934
DonationAction                   52934
ReceivedDate                     50532
ReportedDate                     52923
IsReportedPrePoll                23658
ReportingPeriodName              52934
IsBequest                        52934
IsAggregation                    52934
OriginalRegulatedEntityId        52934
AccountingUnitId                 52934
OriginalDonorId                  52934
CampaigningName                  52934
RegisterName                     52934
IsIrishSource                    52934
CleanedRegulatedEntityName       49804
CleanedRegulatedEntityId         49804
RegulatedEntityId                52934
RegulatedEntityName              52934
CleanedDonorName                 34082
CleanedDonorId                   34082
DonorId                          52934
DonorName                        52934
dtype: int64 records updated with new DonorId and ECRef                            39007
OriginalRegulatedEntityName      39007
RegulatedEntityType              39007
Value                            39005
AcceptedDate                     38283
AccountingUnitName               39007
OriginalDonorName                39007
AccountingUnitsAsCentralParty    39007
IsSponsorship                    39007
DonorStatus                      39007
RegulatedDoneeType               39007
CompanyRegistrationNumber        39007
Postcode                         39007
DonationType                     39007
NatureOfDonation                 39007
PurposeOfVisit                   39007
DonationAction                   39007
ReceivedDate                     37665
ReportedDate                     38998
IsReportedPrePoll                14365
ReportingPeriodName              39007
IsBequest                        39007
IsAggregation                    39007
OriginalRegulatedEntityId        39007
AccountingUnitId                 39007
OriginalDonorId                  39007
CampaigningName                  39007
RegisterName                     39007
IsIrishSource                    39007
CleanedRegulatedEntityName       35876
CleanedRegulatedEntityId         35876
RegulatedEntityId                39007
RegulatedEntityName              39007
CleanedDonorName                 20155
CleanedDonorId                   20155
DonorId                          39007
DonorName                        39007
dtype: int64 records updated with new DonorName
2026-01-30 18:57:01 +0000 INFO:File deduplication complete, shape: (91341, 37)
2026-01-30 18:57:01 +0000 INFO:dedupe_entity_file executed successfully
2026-01-30 18:57:01 +0000 INFO:Raw Data cleanup completed
2026-01-30 18:57:01 +0000 INFO:Data shape: (91341, 37)
2026-01-30 18:57:03 +0000 INFO:Data saved to cleaned_donations.zip
2026-01-30 18:57:03 +0000 INFO:Data cleanup completed, shape: (91341, 37)
2026-01-30 18:57:03 +0000 INFO:raw_data_cleanup executed successfully
2026-01-30 18:57:03 +0000 INFO:load_raw_data executed successfully
2026-01-30 18:57:03 +0000 INFO:get_raw_data executed successfully
2026-01-30 18:57:03 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:57:03 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2026-01-30 18:57:03 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2026-01-30 18:57:03 +0000 DEBUG:Rows in Raw Data: 91341
2026-01-30 18:57:03 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 18:57:03 +0000 INFO:Original file path: cleaned_donations.zip
2026-01-30 18:57:03 +0000 INFO:Saved file path: cleaned_data.zip
2026-01-30 18:57:03 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 18:57:03 +0000 INFO:Checking if cleaned_donations.zip has been updated.
2026-01-30 18:57:03 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 18:57:03 +0000 INFO:Getting modification time for cleaned_donations.zip
2026-01-30 18:57:03 +0000 WARNING:File cleaned_donations.zip does not exist.
2026-01-30 18:57:03 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 18:57:03 +0000 INFO:Current modification time: None
2026-01-30 18:57:03 +0000 INFO:Last modification time: 1769774510.1556323
2026-01-30 18:57:03 +0000 WARNING:Cannot determine modification time for cleaned_donations.zip
2026-01-30 18:57:03 +0000 INFO:is_file_updated executed successfully
2026-01-30 18:57:03 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 18:57:03 +0000 ERROR:Failed to load data from cleaned_donations.zip
2026-01-30 18:57:03 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2026-01-30 18:57:03 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91341
2026-01-30 18:57:03 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91341
2026-01-30 18:57:05 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2026-01-30 18:57:05 +0000 DEBUG:Clean Data Prep 204: Map Party: 91341
2026-01-30 18:57:41 +0000 INFO:Added parliamentary_sitting column with 8 unique periods
2026-01-30 18:57:41 +0000 DEBUG:Group assignment with exceptions: {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}
2026-01-30 18:57:41 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28638
Labour Party                       22675
Liberal Democrats                  19030
Large Entity                        8611
Medium Entity                       3809
Small Entity                        1985
Uk Independence Party (Ukip)        1830
Green Party                         1673
Single Donation Entity              1353
Scottish National Party (Snp)        815
Plaid Cymru - Party Of Wales         517
Reform UK                            377
Liberal Party                         15
Sinn Féin                             13
Name: count, dtype: int64
2026-01-30 18:57:41 +0000 DEBUG:Group assignment: group
Single Donation Entity             1353
Small Entity                        839
Medium Entity                       614
Large Entity                        227
Conservative And Unionist Party       8
Labour Party                          8
Liberal Democrats                     8
Plaid Cymru - Party Of Wales          8
Scottish National Party (Snp)         8
Uk Independence Party (Ukip)          8
Green Party                           7
Liberal Party                         4
Reform UK                             3
Sinn Féin                             1
Name: count, dtype: int64
2026-01-30 18:57:41 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91341
2026-01-30 18:57:41 +0000 DEBUG:Group assignment with exceptions: {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}
2026-01-30 18:57:41 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32036
Labour Party                       27106
Large Entity                       24804
Uk Independence Party (Ukip)        1853
Green Party                         1694
Medium Entity                       1112
Scottish National Party (Snp)        881
Small Entity                         552
Plaid Cymru - Party Of Wales         525
Reform UK                            377
Single Donation Entity               372
Liberal Party                         15
Sinn Féin                             13
Democratic Unionist Party              1
Name: count, dtype: int64
2026-01-30 18:57:41 +0000 DEBUG:Group assignment: group
Single Donation Entity             372
Small Entity                       233
Medium Entity                      171
Large Entity                       120
Conservative And Unionist Party      8
Labour Party                         8
Plaid Cymru - Party Of Wales         8
Scottish National Party (Snp)        8
Uk Independence Party (Ukip)         8
Green Party                          7
Liberal Party                        4
Reform UK                            3
Democratic Unionist Party            1
Sinn Féin                            1
Name: count, dtype: int64
2026-01-30 18:57:41 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91341
2026-01-30 18:57:41 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2026-01-30 18:57:41 +0000 INFO:Loading election dates from pdpy.
2026-01-30 18:57:41 +0000 INFO:Election Dates loaded from pdpy.
2026-01-30 18:57:41 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2026-01-30 18:57:41 +0000 INFO:Election Dates Loaded Successfully.
2026-01-30 18:57:41 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 18:57:41 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 18:57:41 +0000 INFO:load_election_dates executed successfully
2026-01-30 18:57:42 +0000 DEBUG:Clean Data Prep 353: Election dates: 91341
2026-01-30 18:57:42 +0000 DEBUG:Clean Data Prep 386: End of clean: 91341
2026-01-30 18:57:45 +0000 INFO:Cleaned Data completed, shape: (91341, 57)
2026-01-30 18:57:45 +0000 INFO:load_cleaned_data executed successfully
2026-01-30 18:57:45 +0000 INFO:get_cleaned_data executed successfully
2026-01-30 18:57:45 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:57:45 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2026-01-30 18:57:45 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2026-01-30 18:57:45 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 18:57:45 +0000 INFO:Original file path: cleaned_data.zip
2026-01-30 18:57:45 +0000 INFO:Saved file path: cleaned_donorlist.zip
2026-01-30 18:57:45 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 18:57:45 +0000 INFO:Checking if cleaned_data.zip has been updated.
2026-01-30 18:57:45 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 18:57:45 +0000 INFO:Getting modification time for cleaned_data.zip
2026-01-30 18:57:45 +0000 WARNING:File cleaned_data.zip does not exist.
2026-01-30 18:57:45 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 18:57:45 +0000 INFO:Current modification time: None
2026-01-30 18:57:45 +0000 INFO:Last modification time: 1769718453.1764421
2026-01-30 18:57:45 +0000 WARNING:Cannot determine modification time for cleaned_data.zip
2026-01-30 18:57:45 +0000 INFO:is_file_updated executed successfully
2026-01-30 18:57:45 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 18:57:45 +0000 INFO:Donor data saved to cleaned_donorlist.zip
2026-01-30 18:57:45 +0000 INFO:Donor Data summary completed
2026-01-30 18:57:45 +0000 INFO:Data shape: (32070, 5)
2026-01-30 18:57:45 +0000 INFO:load_donorList_data executed successfully
2026-01-30 18:57:45 +0000 INFO:get_donor_data executed successfully
2026-01-30 18:57:45 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:57:45 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:57:45 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2026-01-30 18:57:45 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2026-01-30 18:57:45 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 18:57:45 +0000 INFO:Original file path: cleaned_data.zip
2026-01-30 18:57:45 +0000 INFO:Saved file path: cleaned_regentity.zip
2026-01-30 18:57:45 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 18:57:45 +0000 INFO:Checking if cleaned_data.zip has been updated.
2026-01-30 18:57:45 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 18:57:45 +0000 INFO:Getting modification time for cleaned_data.zip
2026-01-30 18:57:45 +0000 WARNING:File cleaned_data.zip does not exist.
2026-01-30 18:57:45 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 18:57:45 +0000 INFO:Current modification time: None
2026-01-30 18:57:45 +0000 INFO:Last modification time: 1769718453.1764421
2026-01-30 18:57:45 +0000 WARNING:Cannot determine modification time for cleaned_data.zip
2026-01-30 18:57:45 +0000 INFO:is_file_updated executed successfully
2026-01-30 18:57:45 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 18:57:45 +0000 INFO:Regulated entity data saved to cleaned_regentity.zip
2026-01-30 18:57:45 +0000 INFO:Raw Data cleanup completed
2026-01-30 18:57:45 +0000 INFO:Data shape: (2404, 6)
2026-01-30 18:57:45 +0000 INFO:load_regulated_entity_data executed successfully
2026-01-30 18:57:45 +0000 INFO:get_regentity_data executed successfully
2026-01-30 18:57:45 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 18:57:45 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:57:45 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:57:45 +0000 INFO:firstload executed successfully
2026-01-30 18:57:45 +0000 INFO:Data first load completed successfully.
2026-01-30 18:57:45 +0000 INFO:initialise_data executed successfully
2026-01-30 18:57:45 +0000 INFO:Running Menu setup...
2026-01-30 18:57:45 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 18:57:45 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:57:48 +0000 INFO:get_git_version executed successfully
2026-01-30 18:57:48 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:57:51 +0000 INFO:get_git_version executed successfully
2026-01-30 18:57:51 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:57:54 +0000 INFO:get_git_version executed successfully
2026-01-30 18:57:54 +0000 INFO:App Version: v50.240
2026-01-30 18:57:54 +0000 INFO:Switched to page: Introduction
2026-01-30 18:57:54 +0000 INFO:pagesetup executed successfully
2026-01-30 18:57:54 +0000 INFO:Menu setup completed successfully.
2026-01-30 18:57:54 +0000 INFO:App is fully loaded and ready!
2026-01-30 18:59:03 +0000 INFO:Streamlit App Starting...
2026-01-30 18:59:03 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 18:59:03 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 18:59:03 +0000 INFO:Running App setup...
2026-01-30 18:59:03 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 18:59:03 +0000 INFO:Setting up the package
2026-01-30 18:59:03 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 18:59:03 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:59:03 +0000 INFO:get_git_version executed successfully
2026-01-30 18:59:03 +0000 INFO:Version: v50.202
2026-01-30 18:59:03 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 18:59:03 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:59:03 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:filenames already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:thresholds already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:filter_def already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:security already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:perc_target already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:directories already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:data_dir already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:output_dir already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:components_dir already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 18:59:03 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 18:59:03 +0000 INFO:Session_state variables initialized
2026-01-30 18:59:03 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 18:59:03 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 18:59:03 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 18:59:03 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:59:03 +0000 DEBUG:perc_target: 0.5
2026-01-30 18:59:03 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 18:59:03 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 18:59:03 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 18:59:03 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 18:59:03 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 18:59:03 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 18:59:03 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 18:59:03 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 18:59:03 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 18:59:03 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 18:59:03 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 18:59:03 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 18:59:03 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 18:59:03 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 18:59:03 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 18:59:03 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 18:59:03 +0000 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x000001BAF341DFC0>}
2026-01-30 18:59:03 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 18:59:03 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 18:59:03 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 18:59:03 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 18:59:03 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 18:59:03 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 18:59:03 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 18:59:03 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:59:03 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 18:59:03 +0000 DEBUG:Cash_ftr: None
2026-01-30 18:59:03 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 18:59:03 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 18:59:03 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 18:59:03 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 18:59:03 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 18:59:03 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 18:59:03 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 18:59:03 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 18:59:03 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 18:59:03 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 18:59:03 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 18:59:03 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 18:59:03 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 18:59:03 +0000 INFO:Session state Setup complete
2026-01-30 18:59:03 +0000 INFO:initialize_session_state executed successfully
2026-01-30 18:59:03 +0000 INFO:Package setup complete
2026-01-30 18:59:03 +0000 INFO:setup_package executed successfully
2026-01-30 18:59:03 +0000 INFO:Setup completed successfully.
2026-01-30 18:59:03 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 18:59:03 +0000 INFO:Running first load function.
2026-01-30 18:59:03 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 18:59:03 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:59:03 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:59:03 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:59:03 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:59:03 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 18:59:03 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:59:03 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:59:03 +0000 INFO:firstload executed successfully
2026-01-30 18:59:03 +0000 INFO:Data first load completed successfully.
2026-01-30 18:59:03 +0000 INFO:initialise_data executed successfully
2026-01-30 18:59:03 +0000 INFO:Running Menu setup...
2026-01-30 18:59:03 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 18:59:03 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:59:03 +0000 INFO:get_git_version executed successfully
2026-01-30 18:59:03 +0000 INFO:App Version: v50.240
2026-01-30 18:59:03 +0000 INFO:Switched to page: Head Line Figures
2026-01-30 18:59:03 +0000 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2026-01-30 18:59:03 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 18:59:03 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 18:59:03 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:59:04 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:59:05 +0000 DEBUG:Aggregated DataFrame:                         Party_Group         Value
0   Conservative And Unionist Party  20170.405233
1         Democratic Unionist Party   3618.940000
2                       Green Party   6204.226405
3                      Labour Party  20519.157176
4                      Large Entity  12031.362470
5                     Liberal Party   2871.754667
6                     Medium Entity  19378.136232
7      Plaid Cymru - Party Of Wales  15859.742724
8                         Reform UK  97641.772732
9     Scottish National Party (Snp)  36021.189364
10           Single Donation Entity  13864.955459
11                        Sinn Féin  44317.630769
12                     Small Entity  24968.983822
13     Uk Independence Party (Ukip)   9943.456859
2026-01-30 18:59:05 +0000 DEBUG:Sorted DataFrame:                         Party_Group         Value
8                         Reform UK  97641.772732
11                        Sinn Féin  44317.630769
9     Scottish National Party (Snp)  36021.189364
12                     Small Entity  24968.983822
3                      Labour Party  20519.157176
0   Conservative And Unionist Party  20170.405233
6                     Medium Entity  19378.136232
7      Plaid Cymru - Party Of Wales  15859.742724
10           Single Donation Entity  13864.955459
4                      Large Entity  12031.362470
13     Uk Independence Party (Ukip)   9943.456859
2                       Green Party   6204.226405
1         Democratic Unionist Party   3618.940000
5                     Liberal Party   2871.754667
2026-01-30 18:59:05 +0000 DEBUG:Unique XValues: ['Reform UK' 'Sinn Féin' 'Scottish National Party (Snp)' 'Small Entity'
 'Labour Party' 'Conservative And Unionist Party' 'Medium Entity'
 'Plaid Cymru - Party Of Wales' 'Single Donation Entity' 'Large Entity'
 'Uk Independence Party (Ukip)' 'Green Party' 'Democratic Unionist Party'
 'Liberal Party']
2026-01-30 18:59:05 +0000 DEBUG:Final color_discrete_map: {'Reform UK': '#12B6CF', 'Sinn Féin': '#326760', 'Scottish National Party (Snp)': '#636efa', 'Small Entity': '#aaaaaa', 'Labour Party': '#DC241F', 'Conservative And Unionist Party': '#0087DC', 'Medium Entity': '#666666', 'Plaid Cymru - Party Of Wales': '#636efa', 'Single Donation Entity': '#e8e8e8', 'Large Entity': '#222222', 'Uk Independence Party (Ukip)': '#70147A', 'Green Party': '#78B943', 'Democratic Unionist Party': '#636efa', 'Liberal Party': '#636efa'}
2026-01-30 18:59:05 +0000 DEBUG:Missing color mappings for: ['Scottish National Party (Snp)', 'Plaid Cymru - Party Of Wales', 'Democratic Unionist Party', 'Liberal Party']
2026-01-30 18:59:05 +0000 DEBUG:Generated Figure: Figure({
    'data': [{'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Reform UK',
              'marker': {'color': '#12B6CF', 'pattern': {'shape': ''}},
              'name': 'Reform UK',
              'offsetgroup': 'Reform UK',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Reform UK'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'a1QcXZzW90A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Sinn Féin',
              'marker': {'color': '#326760', 'pattern': {'shape': ''}},
              'name': 'Sinn Féin',
              'offsetgroup': 'Sinn Féin',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Sinn Féin'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'L/RCL7Sj5UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Scottish National Party (Snp)',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Scottish National Party (Snp)',
              'offsetgroup': 'Scottish National Party (Snp)',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Scottish National Party (Snp)'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '8tdFD6aW4UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Small Entity',
              'marker': {'color': '#aaaaaa', 'pattern': {'shape': ''}},
              'name': 'Small Entity',
              'offsetgroup': 'Small Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Small Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'vX7y9j5i2EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Labour Party',
              'marker': {'color': '#DC241F', 'pattern': {'shape': ''}},
              'name': 'Labour Party',
              'offsetgroup': 'Labour Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Labour Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '9qMqD8oJ1EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Conservative And Unionist Party',
              'marker': {'color': '#0087DC', 'pattern': {'shape': ''}},
              'name': 'Conservative And Unionist Party',
              'offsetgroup': 'Conservative And Unionist Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Conservative And Unionist Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '65FU75my00A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Medium Entity',
              'marker': {'color': '#666666', 'pattern': {'shape': ''}},
              'name': 'Medium Entity',
              'offsetgroup': 'Medium Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Medium Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'nXsGuIjs0kA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Plaid Cymru - Party Of Wales',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Plaid Cymru - Party Of Wales',
              'offsetgroup': 'Plaid Cymru - Party Of Wales',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Plaid Cymru - Party Of Wales'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '7uOSEd/5zkA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Single Donation Entity',
              'marker': {'color': '#e8e8e8', 'pattern': {'shape': ''}},
              'name': 'Single Donation Entity',
              'offsetgroup': 'Single Donation Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Single Donation Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'hd1+THoUy0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Large Entity',
              'marker': {'color': '#222222', 'pattern': {'shape': ''}},
              'name': 'Large Entity',
              'offsetgroup': 'Large Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Large Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'lyJsZa5/x0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Uk Independence Party (Ukip)',
              'marker': {'color': '#70147A', 'pattern': {'shape': ''}},
              'name': 'Uk Independence Party (Ukip)',
              'offsetgroup': 'Uk Independence Party (Ukip)',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Uk Independence Party (Ukip)'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'U0xcerprw0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Green Party',
              'marker': {'color': '#78B943', 'pattern': {'shape': ''}},
              'name': 'Green Party',
              'offsetgroup': 'Green Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Green Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'LOWs9Tk8uEA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Democratic Unionist Party',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Democratic Unionist Party',
              'offsetgroup': 'Democratic Unionist Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Democratic Unionist Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'exSuR+FFrEA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Liberal Party',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Liberal Party',
              'offsetgroup': 'Liberal Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Liberal Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'blmrY4JvpkA=', 'dtype': 'f8'},
              'yaxis': 'y'}],
    'layout': {'barmode': 'group',
               'legend': {'title': {'text': 'Political Party'}, 'tracegroupgap': 0},
               'template': '...',
               'title': {'text': 'Average Donation per Party'},
               'xaxis': {'anchor': 'y',
                         'categoryarray': [Reform UK, Sinn Féin, Scottish National
                                           Party (Snp), Small Entity, Labour Party,
                                           Conservative And Unionist Party, Medium
                                           Entity, Plaid Cymru - Party Of Wales,
                                           Single Donation Entity, Large Entity, Uk
                                           Independence Party (Ukip), Green Party,
                                           Democratic Unionist Party, Liberal
                                           Party],
                         'categoryorder': 'array',
                         'domain': [0.0, 1.0],
                         'title': {'text': 'Political Party'}},
               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': 'Average Donation GBP'}}}
})
2026-01-30 18:59:05 +0000 INFO:Bar chart displayed successfully.
2026-01-30 18:59:05 +0000 INFO:hlf_body executed successfully
2026-01-30 18:59:05 +0000 INFO:pagesetup executed successfully
2026-01-30 18:59:05 +0000 INFO:Menu setup completed successfully.
2026-01-30 18:59:05 +0000 INFO:App is fully loaded and ready!
2026-01-30 18:59:09 +0000 INFO:Streamlit App Starting...
2026-01-30 18:59:09 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 18:59:09 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 18:59:09 +0000 INFO:Running App setup...
2026-01-30 18:59:09 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 18:59:09 +0000 INFO:Setting up the package
2026-01-30 18:59:09 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 18:59:09 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:59:09 +0000 INFO:get_git_version executed successfully
2026-01-30 18:59:09 +0000 INFO:Version: v50.202
2026-01-30 18:59:09 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 18:59:09 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:59:09 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:filenames already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:thresholds already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:filter_def already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:security already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:perc_target already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:directories already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:data_dir already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:output_dir already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:components_dir already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 18:59:09 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 18:59:09 +0000 INFO:Session_state variables initialized
2026-01-30 18:59:09 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 18:59:09 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 18:59:09 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 18:59:09 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:59:09 +0000 DEBUG:perc_target: 0.5
2026-01-30 18:59:09 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 18:59:09 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 18:59:09 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 18:59:09 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 18:59:09 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 18:59:09 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 18:59:09 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 18:59:09 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 18:59:09 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 18:59:09 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 18:59:09 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 18:59:09 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 18:59:09 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 18:59:09 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 18:59:09 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 18:59:09 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 18:59:09 +0000 DEBUG:menu_selection: {'title': 'Cash Donations', 'function': <function mod_cash_donations at 0x000001BAF341F2E0>}
2026-01-30 18:59:09 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 18:59:09 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 18:59:09 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 18:59:09 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 18:59:09 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 18:59:09 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 18:59:09 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 18:59:09 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:59:09 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 18:59:09 +0000 DEBUG:Cash_ftr: None
2026-01-30 18:59:09 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 18:59:09 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 18:59:09 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 18:59:09 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 18:59:09 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 18:59:09 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 18:59:09 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 18:59:09 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 18:59:09 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 18:59:09 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 18:59:09 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 18:59:09 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 18:59:09 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 18:59:09 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 18:59:09 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 18:59:09 +0000 INFO:Session state Setup complete
2026-01-30 18:59:09 +0000 INFO:initialize_session_state executed successfully
2026-01-30 18:59:09 +0000 INFO:Package setup complete
2026-01-30 18:59:09 +0000 INFO:setup_package executed successfully
2026-01-30 18:59:09 +0000 INFO:Setup completed successfully.
2026-01-30 18:59:09 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 18:59:09 +0000 INFO:Running first load function.
2026-01-30 18:59:09 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 18:59:09 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:59:09 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:59:09 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:59:09 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:59:09 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 18:59:09 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:59:09 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:59:09 +0000 INFO:firstload executed successfully
2026-01-30 18:59:09 +0000 INFO:Data first load completed successfully.
2026-01-30 18:59:09 +0000 INFO:initialise_data executed successfully
2026-01-30 18:59:09 +0000 INFO:Running Menu setup...
2026-01-30 18:59:09 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 18:59:10 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:59:10 +0000 INFO:get_git_version executed successfully
2026-01-30 18:59:10 +0000 INFO:App Version: v50.240
2026-01-30 18:59:10 +0000 INFO:Switched to page: Cash Donations
2026-01-30 18:59:10 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:59:10 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 18:59:10 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 18:59:10 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:59:10 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:59:10 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:59:10 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:59:10 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:59:10 +0000 DEBUG:Page texts: {'Para1': {'text': 'Except for in 2016', 'is_deleted': False}, 'Para 2': {'text': 'More useful information', 'is_deleted': False}}
2026-01-30 18:59:10 +0000 DEBUG:Calling manage_text_elements with args={args}, kwargs={kwargs}
2026-01-30 18:59:10 +0000 DEBUG:Not logged in as admin.
2026-01-30 18:59:10 +0000 INFO:manage_text_elements executed successfully
2026-01-30 18:59:10 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:59:10 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:59:10 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:59:10 +0000 INFO:display_data_page executed successfully
2026-01-30 18:59:10 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:59:11 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:59:11 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:59:11 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:59:11 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:59:11 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:59:11 +0000 DEBUG:Page texts: {}
2026-01-30 18:59:11 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:59:11 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:59:11 +0000 INFO:Streamlit App Starting...
2026-01-30 18:59:11 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 18:59:11 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 18:59:11 +0000 INFO:Running App setup...
2026-01-30 18:59:11 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 18:59:11 +0000 INFO:Setting up the package
2026-01-30 18:59:11 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 18:59:11 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:59:11 +0000 INFO:get_git_version executed successfully
2026-01-30 18:59:11 +0000 INFO:Version: v50.202
2026-01-30 18:59:11 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 18:59:11 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:59:11 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:filenames already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:thresholds already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:filter_def already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:security already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:perc_target already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:directories already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:data_dir already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:output_dir already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:components_dir already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 18:59:11 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 18:59:11 +0000 INFO:Session_state variables initialized
2026-01-30 18:59:11 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 18:59:11 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 18:59:11 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 18:59:11 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 18:59:11 +0000 DEBUG:perc_target: 0.5
2026-01-30 18:59:11 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 18:59:11 +0000 DEBUG:mod_cash_donations_per_donor_None_mod_cash_donations_per_donorCash Donations per DonorNone_group_entity_select: Donor
2026-01-30 18:59:11 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 18:59:11 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 18:59:11 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 18:59:11 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 18:59:11 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 18:59:11 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 18:59:11 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 18:59:11 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 18:59:11 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 18:59:11 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 18:59:11 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 18:59:11 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 18:59:11 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 18:59:11 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 18:59:11 +0000 DEBUG:selected_entity_name: All
2026-01-30 18:59:11 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 18:59:11 +0000 DEBUG:menu_selection: {'title': 'Non Cash Donations', 'function': <function mod_non_cash_donations at 0x000001BAF341F370>}
2026-01-30 18:59:11 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 18:59:11 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 18:59:11 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 18:59:11 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 18:59:11 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 18:59:11 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 18:59:11 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 18:59:11 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 18:59:11 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 18:59:11 +0000 DEBUG:Cash_ftr: None
2026-01-30 18:59:11 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 18:59:11 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 18:59:11 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 18:59:11 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 18:59:11 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 18:59:11 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 18:59:11 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 18:59:11 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 18:59:11 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 18:59:11 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 18:59:11 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 18:59:11 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 18:59:11 +0000 DEBUG:date_range_mod_cash_donations_per_donor_mod_cash_donations_per_donorCash Donations per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 18:59:11 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 18:59:11 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 18:59:11 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 18:59:11 +0000 INFO:Session state Setup complete
2026-01-30 18:59:11 +0000 INFO:initialize_session_state executed successfully
2026-01-30 18:59:11 +0000 INFO:Package setup complete
2026-01-30 18:59:11 +0000 INFO:setup_package executed successfully
2026-01-30 18:59:11 +0000 INFO:Setup completed successfully.
2026-01-30 18:59:11 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 18:59:11 +0000 INFO:Running first load function.
2026-01-30 18:59:11 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 18:59:11 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:59:11 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 18:59:11 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:59:11 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:59:11 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 18:59:11 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 18:59:11 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 18:59:11 +0000 INFO:firstload executed successfully
2026-01-30 18:59:11 +0000 INFO:Data first load completed successfully.
2026-01-30 18:59:11 +0000 INFO:initialise_data executed successfully
2026-01-30 18:59:11 +0000 INFO:Running Menu setup...
2026-01-30 18:59:11 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 18:59:11 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 18:59:11 +0000 INFO:get_git_version executed successfully
2026-01-30 18:59:11 +0000 INFO:App Version: v50.240
2026-01-30 18:59:11 +0000 INFO:Switched to page: Non Cash Donations
2026-01-30 18:59:11 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:59:11 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 18:59:11 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 18:59:11 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:59:12 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:59:12 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:59:12 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:59:12 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:59:12 +0000 DEBUG:Page texts: {}
2026-01-30 18:59:12 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:59:12 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:59:12 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:59:12 +0000 INFO:display_data_page executed successfully
2026-01-30 18:59:12 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 18:59:12 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 18:59:12 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 18:59:12 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 18:59:12 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 18:59:12 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 18:59:12 +0000 DEBUG:Page texts: {}
2026-01-30 18:59:12 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 18:59:12 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 18:59:12 +0000 INFO:display_visualizations executed successfully
2026-01-30 18:59:12 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 18:59:12 +0000 INFO:pagesetup executed successfully
2026-01-30 18:59:12 +0000 INFO:Menu setup completed successfully.
2026-01-30 18:59:12 +0000 INFO:App is fully loaded and ready!
2026-01-30 19:03:53 +0000 INFO:Streamlit App Starting...
2026-01-30 19:03:53 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 19:03:53 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 19:03:53 +0000 INFO:Running App setup...
2026-01-30 19:03:53 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 19:03:53 +0000 INFO:Setting up the package
2026-01-30 19:03:53 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 19:03:53 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 19:03:53 +0000 INFO:get_git_version executed successfully
2026-01-30 19:03:53 +0000 INFO:Version: v50.202
2026-01-30 19:03:53 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 19:03:53 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 19:03:53 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:filenames already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:thresholds already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:filter_def already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:security already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:perc_target already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:directories already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:data_dir already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:output_dir already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:components_dir already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 19:03:53 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 19:03:53 +0000 INFO:Session_state variables initialized
2026-01-30 19:03:53 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 19:03:53 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 19:03:53 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 19:03:53 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 19:03:53 +0000 DEBUG:perc_target: 0.5
2026-01-30 19:03:53 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 19:03:53 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 19:03:53 +0000 DEBUG:mod_non_cash_donations_per_donor_None_mod_non_cash_donations_per_donorNon Cash Donations per DonorNone_group_entity_select: Donor
2026-01-30 19:03:53 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 19:03:53 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 19:03:53 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 19:03:53 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 19:03:53 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 19:03:53 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 19:03:53 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 19:03:53 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 19:03:53 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 19:03:53 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 19:03:53 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 19:03:53 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 19:03:53 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 19:03:53 +0000 DEBUG:selected_entity_name: All
2026-01-30 19:03:53 +0000 DEBUG:date_range_mod_non_cash_donations_per_donor_mod_non_cash_donations_per_donorNon Cash Donations per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 19:03:53 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 19:03:53 +0000 DEBUG:menu_selection: {'title': 'Public Fund Donations', 'function': <function mod_publicfund_donations at 0x000001BAF341F400>}
2026-01-30 19:03:53 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 19:03:53 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 19:03:53 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 19:03:53 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 19:03:53 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 19:03:53 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 19:03:53 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 19:03:53 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 19:03:53 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 19:03:53 +0000 DEBUG:Cash_ftr: None
2026-01-30 19:03:53 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 19:03:53 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 19:03:53 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 19:03:53 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 19:03:53 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 19:03:53 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 19:03:53 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 19:03:53 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 19:03:53 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 19:03:53 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 19:03:53 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 19:03:53 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 19:03:53 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 19:03:53 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 19:03:53 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 19:03:53 +0000 INFO:Session state Setup complete
2026-01-30 19:03:53 +0000 INFO:initialize_session_state executed successfully
2026-01-30 19:03:53 +0000 INFO:Package setup complete
2026-01-30 19:03:53 +0000 INFO:setup_package executed successfully
2026-01-30 19:03:53 +0000 INFO:Setup completed successfully.
2026-01-30 19:03:53 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 19:03:53 +0000 INFO:Running first load function.
2026-01-30 19:03:53 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 19:03:53 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 19:03:53 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 19:03:53 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 19:03:53 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 19:03:53 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 19:03:53 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 19:03:53 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 19:03:53 +0000 INFO:firstload executed successfully
2026-01-30 19:03:53 +0000 INFO:Data first load completed successfully.
2026-01-30 19:03:53 +0000 INFO:initialise_data executed successfully
2026-01-30 19:03:53 +0000 INFO:Running Menu setup...
2026-01-30 19:03:53 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 19:03:53 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 19:03:53 +0000 INFO:get_git_version executed successfully
2026-01-30 19:03:53 +0000 INFO:App Version: v50.240
2026-01-30 19:03:53 +0000 INFO:Switched to page: Public Fund Donations
2026-01-30 19:03:53 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 19:03:53 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 19:03:53 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 19:03:53 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 19:03:53 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 19:03:53 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 19:03:53 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 19:03:53 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 19:03:53 +0000 DEBUG:Page texts: {}
2026-01-30 19:03:53 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 19:03:53 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 19:03:53 +0000 INFO:display_visualizations executed successfully
2026-01-30 19:03:53 +0000 INFO:display_data_page executed successfully
2026-01-30 19:03:53 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 19:03:54 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 19:03:54 +0000 INFO:Streamlit App Starting...
2026-01-30 19:03:54 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 19:03:54 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 19:03:54 +0000 INFO:Running App setup...
2026-01-30 19:03:54 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 19:03:54 +0000 INFO:Setting up the package
2026-01-30 19:03:54 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 19:03:54 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 19:03:54 +0000 INFO:get_git_version executed successfully
2026-01-30 19:03:54 +0000 INFO:Version: v50.202
2026-01-30 19:03:54 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 19:03:54 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 19:03:54 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:filenames already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:thresholds already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:filter_def already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:security already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:perc_target already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:directories already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:data_dir already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:output_dir already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:components_dir already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 19:03:54 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 19:03:54 +0000 INFO:Session_state variables initialized
2026-01-30 19:03:54 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 19:03:54 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 19:03:54 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 19:03:54 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 19:03:54 +0000 DEBUG:perc_target: 0.5
2026-01-30 19:03:54 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 19:03:54 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 19:03:54 +0000 DEBUG:mod_non_cash_donations_per_donor_None_mod_non_cash_donations_per_donorNon Cash Donations per DonorNone_group_entity_select: Donor
2026-01-30 19:03:54 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 19:03:54 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 19:03:54 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 19:03:54 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 19:03:54 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 19:03:54 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 19:03:54 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 19:03:54 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 19:03:54 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 19:03:54 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 19:03:54 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 19:03:54 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 19:03:54 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 19:03:54 +0000 DEBUG:selected_entity_name: All
2026-01-30 19:03:54 +0000 DEBUG:date_range_mod_non_cash_donations_per_donor_mod_non_cash_donations_per_donorNon Cash Donations per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 19:03:54 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 19:03:54 +0000 DEBUG:menu_selection: {'title': 'Sponsorships', 'function': <function mod_sponsorships at 0x000001BAF341EE60>}
2026-01-30 19:03:54 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 19:03:54 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 19:03:54 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 19:03:54 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 19:03:54 +0000 DEBUG:mod_publicfund_donations_per_donor_None_mod_publicfund_donations_per_donorPublic Fund Donation per DonorNone_group_entity_select: Donor
2026-01-30 19:03:54 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 19:03:54 +0000 DEBUG:date_range_mod_publicfund_donations_per_donor_mod_publicfund_donations_per_donorPublic Fund Donation per DonorNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2026, 1, 3, 0, 0))
2026-01-30 19:03:54 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 19:03:54 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 19:03:54 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 19:03:54 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 19:03:54 +0000 DEBUG:Cash_ftr: None
2026-01-30 19:03:54 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 19:03:54 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 19:03:54 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 19:03:54 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 19:03:54 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 19:03:54 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 19:03:54 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 19:03:54 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 19:03:54 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 19:03:54 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 19:03:54 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 19:03:54 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 19:03:54 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 19:03:54 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 19:03:54 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 19:03:54 +0000 INFO:Session state Setup complete
2026-01-30 19:03:54 +0000 INFO:initialize_session_state executed successfully
2026-01-30 19:03:54 +0000 INFO:Package setup complete
2026-01-30 19:03:54 +0000 INFO:setup_package executed successfully
2026-01-30 19:03:54 +0000 INFO:Setup completed successfully.
2026-01-30 19:03:54 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 19:03:54 +0000 INFO:Running first load function.
2026-01-30 19:03:54 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 19:03:54 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 19:03:54 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 19:03:54 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 19:03:54 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 19:03:54 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 19:03:54 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 19:03:54 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 19:03:54 +0000 INFO:firstload executed successfully
2026-01-30 19:03:54 +0000 INFO:Data first load completed successfully.
2026-01-30 19:03:54 +0000 INFO:initialise_data executed successfully
2026-01-30 19:03:54 +0000 INFO:Running Menu setup...
2026-01-30 19:03:54 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 19:03:54 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 19:03:54 +0000 INFO:get_git_version executed successfully
2026-01-30 19:03:54 +0000 INFO:App Version: v50.240
2026-01-30 19:03:54 +0000 INFO:Switched to page: Sponsorships
2026-01-30 19:03:54 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 19:03:54 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 19:03:54 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 19:03:54 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 19:03:54 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 19:03:54 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 19:03:54 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 19:03:54 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 19:03:54 +0000 DEBUG:Page texts: {}
2026-01-30 19:03:54 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 19:03:54 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 19:03:54 +0000 INFO:display_visualizations executed successfully
2026-01-30 19:03:54 +0000 INFO:display_data_page executed successfully
2026-01-30 19:03:54 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 19:03:55 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 19:03:55 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 19:03:55 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 19:03:55 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 19:03:55 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 19:03:55 +0000 DEBUG:Page texts: {}
2026-01-30 19:03:55 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 19:03:55 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 19:03:55 +0000 INFO:display_visualizations executed successfully
2026-01-30 19:03:55 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 19:03:55 +0000 INFO:pagesetup executed successfully
2026-01-30 19:03:55 +0000 INFO:Menu setup completed successfully.
2026-01-30 19:03:55 +0000 INFO:App is fully loaded and ready!
2026-01-30 19:04:03 +0000 INFO:Streamlit App Starting...
2026-01-30 19:04:03 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 19:04:03 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 19:04:03 +0000 INFO:Running App setup...
2026-01-30 19:04:03 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 19:04:03 +0000 INFO:Setting up the package
2026-01-30 19:04:03 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 19:04:03 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 19:04:06 +0000 INFO:get_git_version executed successfully
2026-01-30 19:04:06 +0000 INFO:Version: v50.202
2026-01-30 19:04:06 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 19:04:06 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 19:04:06 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2026-01-30 19:04:06 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 19:04:06 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2026-01-30 19:04:06 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2026-01-30 19:04:06 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 19:04:06 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 19:04:06 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 19:04:06 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 19:04:06 +0000 DEBUG:Initialised perc_target with value: 0.5
2026-01-30 19:04:06 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2026-01-30 19:04:06 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 19:04:06 +0000 DEBUG:Initialised electoral_cycle_rules with value: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 19:04:06 +0000 DEBUG:Initialised reference_dir with value: H:\GitHub\dashboard_demo\reference_files
2026-01-30 19:04:06 +0000 DEBUG:Initialised data_dir with value: H:\GitHub\dashboard_demo\data
2026-01-30 19:04:06 +0000 DEBUG:Initialised output_dir with value: H:\GitHub\dashboard_demo\output
2026-01-30 19:04:06 +0000 DEBUG:Initialised logs_dir with value: H:\GitHub\dashboard_demo\logs
2026-01-30 19:04:06 +0000 DEBUG:Initialised components_dir with value: H:\GitHub\dashboard_demo\components
2026-01-30 19:04:06 +0000 DEBUG:Initialised app_pages_dir with value: H:\GitHub\dashboard_demo\app_pages
2026-01-30 19:04:06 +0000 DEBUG:Initialised utils_dir with value: H:\GitHub\dashboard_demo\utils
2026-01-30 19:04:06 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 19:04:06 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 19:04:06 +0000 DEBUG:Initialised mppartymemb_fname with value: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 19:04:06 +0000 DEBUG:Initialised donor_map_fname with value: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 19:04:06 +0000 DEBUG:Initialised politician_party_fname with value: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 19:04:06 +0000 DEBUG:Initialised regentity_map_fname with value: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 19:04:06 +0000 DEBUG:Initialised original_data_fname with value: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 19:04:06 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 19:04:06 +0000 DEBUG:Initialised TEXT_FILE with value: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 19:04:06 +0000 DEBUG:Initialised ELECTION_DATES with value: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 19:04:06 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 19:04:06 +0000 DEBUG:Initialised cleaned_data_fname with value: cleaned_data.zip
2026-01-30 19:04:06 +0000 DEBUG:Initialised cleaned_donations_fname with value: cleaned_donations.zip
2026-01-30 19:04:06 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: cleaned_donorlist.zip
2026-01-30 19:04:06 +0000 DEBUG:Initialised cleaned_regentity_fname with value: cleaned_regentity.zip
2026-01-30 19:04:06 +0000 DEBUG:Initialised party_summary_fname with value: party_summary.zip
2026-01-30 19:04:06 +0000 DEBUG:Initialised imported_raw_fname with value: imported_raw.zip
2026-01-30 19:04:06 +0000 DEBUG:Initialised source_data_fname with value: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 19:04:06 +0000 DEBUG:Initialised Cash_ftr with value: None
2026-01-30 19:04:06 +0000 INFO:Session_state variables initialized
2026-01-30 19:04:06 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 19:04:06 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 19:04:06 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 19:04:06 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 19:04:06 +0000 DEBUG:perc_target: 0.5
2026-01-30 19:04:06 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 19:04:06 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 19:04:06 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 19:04:06 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 19:04:06 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 19:04:06 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 19:04:06 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 19:04:06 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 19:04:06 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 19:04:06 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 19:04:06 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 19:04:06 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 19:04:06 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 19:04:06 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 19:04:06 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 19:04:06 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 19:04:06 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 19:04:06 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 19:04:06 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 19:04:06 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 19:04:06 +0000 DEBUG:Cash_ftr: None
2026-01-30 19:04:06 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 19:04:06 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 19:04:06 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 19:04:06 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 19:04:06 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 19:04:06 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 19:04:06 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 19:04:06 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 19:04:06 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 19:04:06 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 19:04:06 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 19:04:06 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 19:04:06 +0000 INFO:Session state Setup complete
2026-01-30 19:04:06 +0000 INFO:initialize_session_state executed successfully
2026-01-30 19:04:06 +0000 INFO:Package setup complete
2026-01-30 19:04:06 +0000 INFO:setup_package executed successfully
2026-01-30 19:04:06 +0000 INFO:Setup completed successfully.
2026-01-30 19:04:06 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 19:04:06 +0000 INFO:Running first load function.
2026-01-30 19:04:06 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 19:04:06 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2026-01-30 19:04:06 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2026-01-30 19:04:06 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2026-01-30 19:04:06 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2026-01-30 19:04:06 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 19:04:06 +0000 INFO:Original file path: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 19:04:06 +0000 INFO:Saved file path: imported_raw.zip
2026-01-30 19:04:06 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 19:04:06 +0000 INFO:Checking if H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip has been updated.
2026-01-30 19:04:06 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 19:04:06 +0000 INFO:Getting modification time for H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 19:04:06 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 19:04:06 +0000 INFO:Current modification time: 1769774510.1556323
2026-01-30 19:04:06 +0000 INFO:Last modification time: 1769774510.1556323
2026-01-30 19:04:06 +0000 INFO:is_file_updated executed successfully
2026-01-30 19:04:06 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 19:04:06 +0000 INFO:Loading raw data...
2026-01-30 19:04:06 +0000 DEBUG:Original data file path post raw data load: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 19:04:06 +0000 DEBUG:Processed data file path post raw data load: imported_raw.zip
2026-01-30 19:04:06 +0000 INFO:Data loaded successfully. Data has 91341 rows and 29 columns
2026-01-30 19:04:08 +0000 INFO:Data saved to imported_raw.zip
2026-01-30 19:04:08 +0000 INFO:Data saved to sessionstate as 'raw_data'
2026-01-30 19:04:08 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2026-01-30 19:04:08 +0000 INFO:Cleaning up raw data
2026-01-30 19:04:08 +0000 ERROR:Session state variables not initialized!
2026-01-30 19:04:08 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 19:04:08 +0000 INFO:Original file path: None
2026-01-30 19:04:08 +0000 INFO:Saved file path: cleaned_donations.zip
2026-01-30 19:04:08 +0000 ERROR:Error: originalfilepath is None!
2026-01-30 19:04:08 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 19:04:08 +0000 INFO:Data loaded, shape: (91341, 29)
2026-01-30 19:04:09 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2026-01-30 19:04:09 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2026-01-30 19:04:10 +0000 INFO:File deduplication complete, shape: ECRef                            592
OriginalRegulatedEntityName      592
RegulatedEntityType              592
Value                            592
AcceptedDate                     574
AccountingUnitName               592
DonorName                        592
AccountingUnitsAsCentralParty    592
IsSponsorship                    592
DonorStatus                      592
RegulatedDoneeType               592
CompanyRegistrationNumber        592
Postcode                         592
DonationType                     592
NatureOfDonation                 592
PurposeOfVisit                   592
DonationAction                   592
ReceivedDate                     486
ReportedDate                     592
IsReportedPrePoll                423
ReportingPeriodName              592
IsBequest                        592
IsAggregation                    592
OriginalRegulatedEntityId        592
AccountingUnitId                 592
DonorId                          592
CampaigningName                  592
RegisterName                     592
IsIrishSource                    592
CleanedRegulatedEntityName       592
CleanedRegulatedEntityId         592
RegulatedEntityId                592
RegulatedEntityName              592
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10109
OriginalRegulatedEntityName      10109
RegulatedEntityType              10109
Value                            10107
AcceptedDate                      9796
AccountingUnitName               10109
DonorName                        10109
AccountingUnitsAsCentralParty    10109
IsSponsorship                    10109
DonorStatus                      10109
RegulatedDoneeType               10109
CompanyRegistrationNumber        10109
Postcode                         10109
DonationType                     10109
NatureOfDonation                 10109
PurposeOfVisit                   10109
DonationAction                   10109
ReceivedDate                      7075
ReportedDate                     10099
IsReportedPrePoll                 4878
ReportingPeriodName              10109
IsBequest                        10109
IsAggregation                    10109
OriginalRegulatedEntityId        10109
AccountingUnitId                 10109
DonorId                          10109
CampaigningName                  10109
RegisterName                     10109
IsIrishSource                    10109
CleanedRegulatedEntityName       10109
CleanedRegulatedEntityId         10109
RegulatedEntityId                10109
RegulatedEntityName              10109
dtype: int64 records updated with new RegulatedEntityName
2026-01-30 19:04:10 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3771
OriginalRegulatedEntityName      3771
RegulatedEntityType              3771
Value                            3771
AcceptedDate                     3667
AccountingUnitName               3771
DonorName                        3771
AccountingUnitsAsCentralParty    3771
IsSponsorship                    3771
DonorStatus                      3771
RegulatedDoneeType               3771
CompanyRegistrationNumber        3771
Postcode                         3771
DonationType                     3771
NatureOfDonation                 3771
PurposeOfVisit                   3771
DonationAction                   3771
ReceivedDate                     3297
ReportedDate                     3771
IsReportedPrePoll                 449
ReportingPeriodName              3771
IsBequest                        3771
IsAggregation                    3771
OriginalRegulatedEntityId        3771
AccountingUnitId                 3771
DonorId                          3771
CampaigningName                  3771
RegisterName                     3771
IsIrishSource                    3771
CleanedRegulatedEntityName        592
CleanedRegulatedEntityId          592
RegulatedEntityId                3771
RegulatedEntityName              3771
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13288
OriginalRegulatedEntityName      13288
RegulatedEntityType              13288
Value                            13286
AcceptedDate                     12889
AccountingUnitName               13288
DonorName                        13288
AccountingUnitsAsCentralParty    13288
IsSponsorship                    13288
DonorStatus                      13288
RegulatedDoneeType               13288
CompanyRegistrationNumber        13288
Postcode                         13288
DonationType                     13288
NatureOfDonation                 13288
PurposeOfVisit                   13288
DonationAction                   13288
ReceivedDate                      9886
ReportedDate                     13278
IsReportedPrePoll                 4904
ReportingPeriodName              13288
IsBequest                        13288
IsAggregation                    13288
OriginalRegulatedEntityId        13288
AccountingUnitId                 13288
DonorId                          13288
CampaigningName                  13288
RegisterName                     13288
IsIrishSource                    13288
CleanedRegulatedEntityName       10109
CleanedRegulatedEntityId         10109
RegulatedEntityId                13288
RegulatedEntityName              13288
dtype: int64 records updated with new RegulatedEntityName
2026-01-30 19:04:10 +0000 INFO:File deduplication complete, shape: (91341, 33)
2026-01-30 19:04:10 +0000 INFO:dedupe_entity_file executed successfully
2026-01-30 19:04:10 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2026-01-30 19:04:10 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2026-01-30 19:04:10 +0000 INFO:File deduplication complete, shape: ECRef                            34082
OriginalRegulatedEntityName      34082
RegulatedEntityType              34082
Value                            34079
AcceptedDate                     33689
AccountingUnitName               34082
OriginalDonorName                34082
AccountingUnitsAsCentralParty    34082
IsSponsorship                    34082
DonorStatus                      34082
RegulatedDoneeType               34082
CompanyRegistrationNumber        34082
Postcode                         34082
DonationType                     34082
NatureOfDonation                 34082
PurposeOfVisit                   34082
DonationAction                   34082
ReceivedDate                     32487
ReportedDate                     34071
IsReportedPrePoll                22707
ReportingPeriodName              34082
IsBequest                        34082
IsAggregation                    34082
OriginalRegulatedEntityId        34082
AccountingUnitId                 34082
OriginalDonorId                  34082
CampaigningName                  34082
RegisterName                     34082
IsIrishSource                    34082
CleanedRegulatedEntityName       34082
CleanedRegulatedEntityId         34082
RegulatedEntityId                34082
RegulatedEntityName              34082
CleanedDonorName                 34082
CleanedDonorId                   34082
DonorId                          34082
DonorName                        34082
dtype: int64 records updated with new DonorId and ECRef                            20155
OriginalRegulatedEntityName      20155
RegulatedEntityType              20155
Value                            20153
AcceptedDate                     19834
AccountingUnitName               20155
OriginalDonorName                20155
AccountingUnitsAsCentralParty    20155
IsSponsorship                    20155
DonorStatus                      20155
RegulatedDoneeType               20155
CompanyRegistrationNumber        20155
Postcode                         20155
DonationType                     20155
NatureOfDonation                 20155
PurposeOfVisit                   20155
DonationAction                   20155
ReceivedDate                     19620
ReportedDate                     20146
IsReportedPrePoll                13414
ReportingPeriodName              20155
IsBequest                        20155
IsAggregation                    20155
OriginalRegulatedEntityId        20155
AccountingUnitId                 20155
OriginalDonorId                  20155
CampaigningName                  20155
RegisterName                     20155
IsIrishSource                    20155
CleanedRegulatedEntityName       20154
CleanedRegulatedEntityId         20154
RegulatedEntityId                20155
RegulatedEntityName              20155
CleanedDonorName                 20155
CleanedDonorId                   20155
DonorId                          20155
DonorName                        20155
dtype: int64 records updated with new DonorName
2026-01-30 19:04:10 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            52934
OriginalRegulatedEntityName      52934
RegulatedEntityType              52934
Value                            52931
AcceptedDate                     52138
AccountingUnitName               52934
OriginalDonorName                52934
AccountingUnitsAsCentralParty    52934
IsSponsorship                    52934
DonorStatus                      52934
RegulatedDoneeType               52934
CompanyRegistrationNumber        52934
Postcode                         52934
DonationType                     52934
NatureOfDonation                 52934
PurposeOfVisit                   52934
DonationAction                   52934
ReceivedDate                     50532
ReportedDate                     52923
IsReportedPrePoll                23658
ReportingPeriodName              52934
IsBequest                        52934
IsAggregation                    52934
OriginalRegulatedEntityId        52934
AccountingUnitId                 52934
OriginalDonorId                  52934
CampaigningName                  52934
RegisterName                     52934
IsIrishSource                    52934
CleanedRegulatedEntityName       49804
CleanedRegulatedEntityId         49804
RegulatedEntityId                52934
RegulatedEntityName              52934
CleanedDonorName                 34082
CleanedDonorId                   34082
DonorId                          52934
DonorName                        52934
dtype: int64 records updated with new DonorId and ECRef                            39007
OriginalRegulatedEntityName      39007
RegulatedEntityType              39007
Value                            39005
AcceptedDate                     38283
AccountingUnitName               39007
OriginalDonorName                39007
AccountingUnitsAsCentralParty    39007
IsSponsorship                    39007
DonorStatus                      39007
RegulatedDoneeType               39007
CompanyRegistrationNumber        39007
Postcode                         39007
DonationType                     39007
NatureOfDonation                 39007
PurposeOfVisit                   39007
DonationAction                   39007
ReceivedDate                     37665
ReportedDate                     38998
IsReportedPrePoll                14365
ReportingPeriodName              39007
IsBequest                        39007
IsAggregation                    39007
OriginalRegulatedEntityId        39007
AccountingUnitId                 39007
OriginalDonorId                  39007
CampaigningName                  39007
RegisterName                     39007
IsIrishSource                    39007
CleanedRegulatedEntityName       35876
CleanedRegulatedEntityId         35876
RegulatedEntityId                39007
RegulatedEntityName              39007
CleanedDonorName                 20155
CleanedDonorId                   20155
DonorId                          39007
DonorName                        39007
dtype: int64 records updated with new DonorName
2026-01-30 19:04:10 +0000 INFO:File deduplication complete, shape: (91341, 37)
2026-01-30 19:04:10 +0000 INFO:dedupe_entity_file executed successfully
2026-01-30 19:04:10 +0000 INFO:Raw Data cleanup completed
2026-01-30 19:04:10 +0000 INFO:Data shape: (91341, 37)
2026-01-30 19:04:12 +0000 INFO:Data saved to cleaned_donations.zip
2026-01-30 19:04:12 +0000 INFO:Data cleanup completed, shape: (91341, 37)
2026-01-30 19:04:12 +0000 INFO:raw_data_cleanup executed successfully
2026-01-30 19:04:12 +0000 INFO:load_raw_data executed successfully
2026-01-30 19:04:12 +0000 INFO:get_raw_data executed successfully
2026-01-30 19:04:12 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 19:04:12 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2026-01-30 19:04:12 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2026-01-30 19:04:12 +0000 DEBUG:Rows in Raw Data: 91341
2026-01-30 19:04:12 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 19:04:12 +0000 INFO:Original file path: cleaned_donations.zip
2026-01-30 19:04:12 +0000 INFO:Saved file path: cleaned_data.zip
2026-01-30 19:04:12 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 19:04:12 +0000 INFO:Checking if cleaned_donations.zip has been updated.
2026-01-30 19:04:12 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 19:04:12 +0000 INFO:Getting modification time for cleaned_donations.zip
2026-01-30 19:04:12 +0000 WARNING:File cleaned_donations.zip does not exist.
2026-01-30 19:04:12 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 19:04:12 +0000 INFO:Current modification time: None
2026-01-30 19:04:12 +0000 INFO:Last modification time: 1769774510.1556323
2026-01-30 19:04:12 +0000 WARNING:Cannot determine modification time for cleaned_donations.zip
2026-01-30 19:04:12 +0000 INFO:is_file_updated executed successfully
2026-01-30 19:04:12 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 19:04:12 +0000 ERROR:Failed to load data from cleaned_donations.zip
2026-01-30 19:04:12 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2026-01-30 19:04:12 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91341
2026-01-30 19:04:12 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91341
2026-01-30 19:04:14 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2026-01-30 19:04:14 +0000 DEBUG:Clean Data Prep 204: Map Party: 91341
2026-01-30 19:04:52 +0000 INFO:Added parliamentary_sitting column with 8 unique periods
2026-01-30 19:04:52 +0000 DEBUG:Group assignment with exceptions: {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}
2026-01-30 19:04:52 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28638
Labour Party                       22675
Liberal Democrats                  19030
Large Entity                        8611
Medium Entity                       3809
Small Entity                        1985
Uk Independence Party (Ukip)        1830
Green Party                         1673
Single Donation Entity              1353
Scottish National Party (Snp)        815
Plaid Cymru - Party Of Wales         517
Reform UK                            377
Liberal Party                         15
Sinn Féin                             13
Name: count, dtype: int64
2026-01-30 19:04:52 +0000 DEBUG:Group assignment: group
Single Donation Entity             1353
Small Entity                        839
Medium Entity                       614
Large Entity                        227
Conservative And Unionist Party       8
Labour Party                          8
Liberal Democrats                     8
Plaid Cymru - Party Of Wales          8
Scottish National Party (Snp)         8
Uk Independence Party (Ukip)          8
Green Party                           7
Liberal Party                         4
Reform UK                             3
Sinn Féin                             1
Name: count, dtype: int64
2026-01-30 19:04:52 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91341
2026-01-30 19:04:52 +0000 DEBUG:Group assignment with exceptions: {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}
2026-01-30 19:04:52 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32036
Labour Party                       27106
Large Entity                       24804
Uk Independence Party (Ukip)        1853
Green Party                         1694
Medium Entity                       1112
Scottish National Party (Snp)        881
Small Entity                         552
Plaid Cymru - Party Of Wales         525
Reform UK                            377
Single Donation Entity               372
Liberal Party                         15
Sinn Féin                             13
Democratic Unionist Party              1
Name: count, dtype: int64
2026-01-30 19:04:52 +0000 DEBUG:Group assignment: group
Single Donation Entity             372
Small Entity                       233
Medium Entity                      171
Large Entity                       120
Conservative And Unionist Party      8
Labour Party                         8
Plaid Cymru - Party Of Wales         8
Scottish National Party (Snp)        8
Uk Independence Party (Ukip)         8
Green Party                          7
Liberal Party                        4
Reform UK                            3
Democratic Unionist Party            1
Sinn Féin                            1
Name: count, dtype: int64
2026-01-30 19:04:52 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91341
2026-01-30 19:04:52 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2026-01-30 19:04:52 +0000 INFO:Loading election dates from pdpy.
2026-01-30 19:04:52 +0000 INFO:Election Dates loaded from pdpy.
2026-01-30 19:04:52 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2026-01-30 19:04:52 +0000 INFO:Election Dates Loaded Successfully.
2026-01-30 19:04:52 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 19:04:52 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 19:04:52 +0000 INFO:load_election_dates executed successfully
2026-01-30 19:04:53 +0000 DEBUG:Clean Data Prep 353: Election dates: 91341
2026-01-30 19:04:53 +0000 DEBUG:Clean Data Prep 386: End of clean: 91341
2026-01-30 19:04:56 +0000 INFO:Cleaned Data completed, shape: (91341, 57)
2026-01-30 19:04:56 +0000 INFO:load_cleaned_data executed successfully
2026-01-30 19:04:56 +0000 INFO:get_cleaned_data executed successfully
2026-01-30 19:04:56 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 19:04:56 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2026-01-30 19:04:56 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2026-01-30 19:04:56 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 19:04:56 +0000 INFO:Original file path: cleaned_data.zip
2026-01-30 19:04:56 +0000 INFO:Saved file path: cleaned_donorlist.zip
2026-01-30 19:04:56 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 19:04:56 +0000 INFO:Checking if cleaned_data.zip has been updated.
2026-01-30 19:04:56 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 19:04:56 +0000 INFO:Getting modification time for cleaned_data.zip
2026-01-30 19:04:56 +0000 WARNING:File cleaned_data.zip does not exist.
2026-01-30 19:04:56 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 19:04:56 +0000 INFO:Current modification time: None
2026-01-30 19:04:56 +0000 INFO:Last modification time: 1769718453.1764421
2026-01-30 19:04:56 +0000 WARNING:Cannot determine modification time for cleaned_data.zip
2026-01-30 19:04:56 +0000 INFO:is_file_updated executed successfully
2026-01-30 19:04:56 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 19:04:56 +0000 INFO:Donor data saved to cleaned_donorlist.zip
2026-01-30 19:04:56 +0000 INFO:Donor Data summary completed
2026-01-30 19:04:56 +0000 INFO:Data shape: (32070, 5)
2026-01-30 19:04:56 +0000 INFO:load_donorList_data executed successfully
2026-01-30 19:04:56 +0000 INFO:get_donor_data executed successfully
2026-01-30 19:04:56 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 19:04:56 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 19:04:56 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2026-01-30 19:04:56 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2026-01-30 19:04:56 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 19:04:56 +0000 INFO:Original file path: cleaned_data.zip
2026-01-30 19:04:56 +0000 INFO:Saved file path: cleaned_regentity.zip
2026-01-30 19:04:56 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 19:04:56 +0000 INFO:Checking if cleaned_data.zip has been updated.
2026-01-30 19:04:56 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 19:04:56 +0000 INFO:Getting modification time for cleaned_data.zip
2026-01-30 19:04:56 +0000 WARNING:File cleaned_data.zip does not exist.
2026-01-30 19:04:56 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 19:04:56 +0000 INFO:Current modification time: None
2026-01-30 19:04:56 +0000 INFO:Last modification time: 1769718453.1764421
2026-01-30 19:04:56 +0000 WARNING:Cannot determine modification time for cleaned_data.zip
2026-01-30 19:04:56 +0000 INFO:is_file_updated executed successfully
2026-01-30 19:04:56 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 19:04:56 +0000 INFO:Regulated entity data saved to cleaned_regentity.zip
2026-01-30 19:04:56 +0000 INFO:Raw Data cleanup completed
2026-01-30 19:04:56 +0000 INFO:Data shape: (2404, 6)
2026-01-30 19:04:56 +0000 INFO:load_regulated_entity_data executed successfully
2026-01-30 19:04:56 +0000 INFO:get_regentity_data executed successfully
2026-01-30 19:04:56 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 19:04:56 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 19:04:56 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 19:04:56 +0000 INFO:firstload executed successfully
2026-01-30 19:04:56 +0000 INFO:Data first load completed successfully.
2026-01-30 19:04:56 +0000 INFO:initialise_data executed successfully
2026-01-30 19:04:56 +0000 INFO:Running Menu setup...
2026-01-30 19:04:56 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 19:04:56 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 19:05:01 +0000 INFO:get_git_version executed successfully
2026-01-30 19:05:01 +0000 INFO:App Version: v50.240
2026-01-30 19:05:01 +0000 INFO:Switched to page: Introduction
2026-01-30 19:05:01 +0000 INFO:pagesetup executed successfully
2026-01-30 19:05:01 +0000 INFO:Menu setup completed successfully.
2026-01-30 19:05:01 +0000 INFO:App is fully loaded and ready!
2026-01-30 19:05:22 +0000 INFO:Streamlit App Starting...
2026-01-30 19:05:22 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 19:05:22 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 19:05:22 +0000 INFO:Running App setup...
2026-01-30 19:05:22 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 19:05:22 +0000 INFO:Setting up the package
2026-01-30 19:05:22 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 19:05:22 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 19:05:22 +0000 INFO:get_git_version executed successfully
2026-01-30 19:05:22 +0000 INFO:Version: v50.202
2026-01-30 19:05:22 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 19:05:22 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 19:05:22 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:filenames already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:thresholds already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:filter_def already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:security already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:perc_target already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:directories already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:data_dir already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:output_dir already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:components_dir already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 19:05:22 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 19:05:22 +0000 INFO:Session_state variables initialized
2026-01-30 19:05:22 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 19:05:22 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 19:05:22 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 19:05:22 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 19:05:22 +0000 DEBUG:perc_target: 0.5
2026-01-30 19:05:22 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 19:05:22 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 19:05:22 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 19:05:22 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 19:05:22 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 19:05:22 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 19:05:22 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 19:05:22 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 19:05:22 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 19:05:22 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 19:05:22 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 19:05:22 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 19:05:22 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 19:05:22 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 19:05:22 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 19:05:22 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 19:05:22 +0000 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x000001BAF341DFC0>}
2026-01-30 19:05:22 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 19:05:22 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 19:05:22 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 19:05:22 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 19:05:22 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 19:05:22 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 19:05:22 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 19:05:22 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 19:05:22 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 19:05:22 +0000 DEBUG:Cash_ftr: None
2026-01-30 19:05:22 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 19:05:22 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 19:05:22 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 19:05:22 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 19:05:22 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 19:05:22 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 19:05:22 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 19:05:22 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 19:05:22 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 19:05:22 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 19:05:22 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 19:05:22 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 19:05:22 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 19:05:22 +0000 INFO:Session state Setup complete
2026-01-30 19:05:22 +0000 INFO:initialize_session_state executed successfully
2026-01-30 19:05:22 +0000 INFO:Package setup complete
2026-01-30 19:05:22 +0000 INFO:setup_package executed successfully
2026-01-30 19:05:22 +0000 INFO:Setup completed successfully.
2026-01-30 19:05:22 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 19:05:22 +0000 INFO:Running first load function.
2026-01-30 19:05:22 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 19:05:22 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 19:05:22 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 19:05:22 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 19:05:22 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 19:05:22 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 19:05:22 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 19:05:22 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 19:05:22 +0000 INFO:firstload executed successfully
2026-01-30 19:05:22 +0000 INFO:Data first load completed successfully.
2026-01-30 19:05:22 +0000 INFO:initialise_data executed successfully
2026-01-30 19:05:22 +0000 INFO:Running Menu setup...
2026-01-30 19:05:22 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 19:05:22 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 19:05:22 +0000 INFO:get_git_version executed successfully
2026-01-30 19:05:22 +0000 INFO:App Version: v50.240
2026-01-30 19:05:22 +0000 INFO:Switched to page: Head Line Figures
2026-01-30 19:05:22 +0000 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2026-01-30 19:05:22 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 19:05:22 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 19:05:22 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 19:05:22 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 19:05:23 +0000 DEBUG:Aggregated DataFrame:                         Party_Group         Value
0   Conservative And Unionist Party  20170.405233
1         Democratic Unionist Party   3618.940000
2                       Green Party   6204.226405
3                      Labour Party  20519.157176
4                      Large Entity  12031.362470
5                     Liberal Party   2871.754667
6                     Medium Entity  19378.136232
7      Plaid Cymru - Party Of Wales  15859.742724
8                         Reform UK  97641.772732
9     Scottish National Party (Snp)  36021.189364
10           Single Donation Entity  13864.955459
11                        Sinn Féin  44317.630769
12                     Small Entity  24968.983822
13     Uk Independence Party (Ukip)   9943.456859
2026-01-30 19:05:23 +0000 DEBUG:Sorted DataFrame:                         Party_Group         Value
8                         Reform UK  97641.772732
11                        Sinn Féin  44317.630769
9     Scottish National Party (Snp)  36021.189364
12                     Small Entity  24968.983822
3                      Labour Party  20519.157176
0   Conservative And Unionist Party  20170.405233
6                     Medium Entity  19378.136232
7      Plaid Cymru - Party Of Wales  15859.742724
10           Single Donation Entity  13864.955459
4                      Large Entity  12031.362470
13     Uk Independence Party (Ukip)   9943.456859
2                       Green Party   6204.226405
1         Democratic Unionist Party   3618.940000
5                     Liberal Party   2871.754667
2026-01-30 19:05:23 +0000 DEBUG:Unique XValues: ['Reform UK' 'Sinn Féin' 'Scottish National Party (Snp)' 'Small Entity'
 'Labour Party' 'Conservative And Unionist Party' 'Medium Entity'
 'Plaid Cymru - Party Of Wales' 'Single Donation Entity' 'Large Entity'
 'Uk Independence Party (Ukip)' 'Green Party' 'Democratic Unionist Party'
 'Liberal Party']
2026-01-30 19:05:23 +0000 DEBUG:Final color_discrete_map: {'Reform UK': '#12B6CF', 'Sinn Féin': '#326760', 'Scottish National Party (Snp)': '#636efa', 'Small Entity': '#aaaaaa', 'Labour Party': '#DC241F', 'Conservative And Unionist Party': '#0087DC', 'Medium Entity': '#666666', 'Plaid Cymru - Party Of Wales': '#636efa', 'Single Donation Entity': '#e8e8e8', 'Large Entity': '#222222', 'Uk Independence Party (Ukip)': '#70147A', 'Green Party': '#78B943', 'Democratic Unionist Party': '#636efa', 'Liberal Party': '#636efa'}
2026-01-30 19:05:23 +0000 DEBUG:Missing color mappings for: ['Scottish National Party (Snp)', 'Plaid Cymru - Party Of Wales', 'Democratic Unionist Party', 'Liberal Party']
2026-01-30 19:05:23 +0000 DEBUG:Generated Figure: Figure({
    'data': [{'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Reform UK',
              'marker': {'color': '#12B6CF', 'pattern': {'shape': ''}},
              'name': 'Reform UK',
              'offsetgroup': 'Reform UK',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Reform UK'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'a1QcXZzW90A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Sinn Féin',
              'marker': {'color': '#326760', 'pattern': {'shape': ''}},
              'name': 'Sinn Féin',
              'offsetgroup': 'Sinn Féin',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Sinn Féin'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'L/RCL7Sj5UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Scottish National Party (Snp)',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Scottish National Party (Snp)',
              'offsetgroup': 'Scottish National Party (Snp)',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Scottish National Party (Snp)'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '8tdFD6aW4UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Small Entity',
              'marker': {'color': '#aaaaaa', 'pattern': {'shape': ''}},
              'name': 'Small Entity',
              'offsetgroup': 'Small Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Small Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'vX7y9j5i2EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Labour Party',
              'marker': {'color': '#DC241F', 'pattern': {'shape': ''}},
              'name': 'Labour Party',
              'offsetgroup': 'Labour Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Labour Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '9qMqD8oJ1EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Conservative And Unionist Party',
              'marker': {'color': '#0087DC', 'pattern': {'shape': ''}},
              'name': 'Conservative And Unionist Party',
              'offsetgroup': 'Conservative And Unionist Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Conservative And Unionist Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '65FU75my00A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Medium Entity',
              'marker': {'color': '#666666', 'pattern': {'shape': ''}},
              'name': 'Medium Entity',
              'offsetgroup': 'Medium Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Medium Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'nXsGuIjs0kA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Plaid Cymru - Party Of Wales',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Plaid Cymru - Party Of Wales',
              'offsetgroup': 'Plaid Cymru - Party Of Wales',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Plaid Cymru - Party Of Wales'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '7uOSEd/5zkA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Single Donation Entity',
              'marker': {'color': '#e8e8e8', 'pattern': {'shape': ''}},
              'name': 'Single Donation Entity',
              'offsetgroup': 'Single Donation Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Single Donation Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'hd1+THoUy0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Large Entity',
              'marker': {'color': '#222222', 'pattern': {'shape': ''}},
              'name': 'Large Entity',
              'offsetgroup': 'Large Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Large Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'lyJsZa5/x0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Uk Independence Party (Ukip)',
              'marker': {'color': '#70147A', 'pattern': {'shape': ''}},
              'name': 'Uk Independence Party (Ukip)',
              'offsetgroup': 'Uk Independence Party (Ukip)',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Uk Independence Party (Ukip)'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'U0xcerprw0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Green Party',
              'marker': {'color': '#78B943', 'pattern': {'shape': ''}},
              'name': 'Green Party',
              'offsetgroup': 'Green Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Green Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'LOWs9Tk8uEA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Democratic Unionist Party',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Democratic Unionist Party',
              'offsetgroup': 'Democratic Unionist Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Democratic Unionist Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'exSuR+FFrEA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Liberal Party',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Liberal Party',
              'offsetgroup': 'Liberal Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Liberal Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'blmrY4JvpkA=', 'dtype': 'f8'},
              'yaxis': 'y'}],
    'layout': {'barmode': 'group',
               'legend': {'title': {'text': 'Political Party'}, 'tracegroupgap': 0},
               'template': '...',
               'title': {'text': 'Average Donation per Party'},
               'xaxis': {'anchor': 'y',
                         'categoryarray': [Reform UK, Sinn Féin, Scottish National
                                           Party (Snp), Small Entity, Labour Party,
                                           Conservative And Unionist Party, Medium
                                           Entity, Plaid Cymru - Party Of Wales,
                                           Single Donation Entity, Large Entity, Uk
                                           Independence Party (Ukip), Green Party,
                                           Democratic Unionist Party, Liberal
                                           Party],
                         'categoryorder': 'array',
                         'domain': [0.0, 1.0],
                         'title': {'text': 'Political Party'}},
               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': 'Average Donation GBP'}}}
})
2026-01-30 19:05:23 +0000 INFO:Bar chart displayed successfully.
2026-01-30 19:05:23 +0000 INFO:hlf_body executed successfully
2026-01-30 19:05:23 +0000 INFO:pagesetup executed successfully
2026-01-30 19:05:23 +0000 INFO:Menu setup completed successfully.
2026-01-30 19:05:23 +0000 INFO:App is fully loaded and ready!
2026-01-30 19:05:35 +0000 INFO:Streamlit App Starting...
2026-01-30 19:05:35 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 19:05:35 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 19:05:35 +0000 INFO:Running App setup...
2026-01-30 19:05:35 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 19:05:35 +0000 INFO:Setting up the package
2026-01-30 19:05:35 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 19:05:35 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 19:05:35 +0000 INFO:get_git_version executed successfully
2026-01-30 19:05:35 +0000 INFO:Version: v50.202
2026-01-30 19:05:35 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 19:05:35 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 19:05:35 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:filenames already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:thresholds already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:filter_def already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:security already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:perc_target already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:directories already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:data_dir already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:output_dir already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:components_dir already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 19:05:35 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 19:05:35 +0000 INFO:Session_state variables initialized
2026-01-30 19:05:35 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 19:05:35 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 19:05:35 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 19:05:35 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 19:05:35 +0000 DEBUG:perc_target: 0.5
2026-01-30 19:05:35 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 19:05:35 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 19:05:35 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 19:05:35 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 19:05:35 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 19:05:35 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 19:05:35 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 19:05:35 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 19:05:35 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 19:05:35 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 19:05:35 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 19:05:35 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 19:05:35 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 19:05:35 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 19:05:35 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 19:05:35 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 19:05:35 +0000 DEBUG:menu_selection: {'title': 'Cash Donations', 'function': <function mod_cash_donations at 0x000001BAF341F2E0>}
2026-01-30 19:05:35 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 19:05:35 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 19:05:35 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 19:05:35 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 19:05:35 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 19:05:35 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 19:05:35 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 19:05:35 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 19:05:35 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 19:05:35 +0000 DEBUG:Cash_ftr: None
2026-01-30 19:05:35 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 19:05:35 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 19:05:35 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 19:05:35 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 19:05:35 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 19:05:35 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 19:05:35 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 19:05:35 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 19:05:35 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 19:05:35 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 19:05:35 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 19:05:35 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 19:05:35 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 19:05:35 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 19:05:35 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 19:05:35 +0000 INFO:Session state Setup complete
2026-01-30 19:05:35 +0000 INFO:initialize_session_state executed successfully
2026-01-30 19:05:35 +0000 INFO:Package setup complete
2026-01-30 19:05:35 +0000 INFO:setup_package executed successfully
2026-01-30 19:05:35 +0000 INFO:Setup completed successfully.
2026-01-30 19:05:35 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 19:05:35 +0000 INFO:Running first load function.
2026-01-30 19:05:35 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 19:05:35 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 19:05:35 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 19:05:35 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 19:05:35 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 19:05:35 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 19:05:35 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 19:05:35 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 19:05:35 +0000 INFO:firstload executed successfully
2026-01-30 19:05:35 +0000 INFO:Data first load completed successfully.
2026-01-30 19:05:35 +0000 INFO:initialise_data executed successfully
2026-01-30 19:05:35 +0000 INFO:Running Menu setup...
2026-01-30 19:05:35 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 19:05:35 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 19:05:35 +0000 INFO:get_git_version executed successfully
2026-01-30 19:05:35 +0000 INFO:App Version: v50.240
2026-01-30 19:05:35 +0000 INFO:Switched to page: Cash Donations
2026-01-30 19:05:35 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 19:05:35 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 19:05:35 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 19:05:35 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 19:05:35 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 19:05:35 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 19:05:35 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 19:05:35 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 19:05:35 +0000 DEBUG:Page texts: {'Para1': {'text': 'Except for in 2016', 'is_deleted': False}, 'Para 2': {'text': 'More useful information', 'is_deleted': False}}
2026-01-30 19:05:35 +0000 DEBUG:Calling manage_text_elements with args={args}, kwargs={kwargs}
2026-01-30 19:05:35 +0000 DEBUG:Not logged in as admin.
2026-01-30 19:05:35 +0000 INFO:manage_text_elements executed successfully
2026-01-30 19:05:35 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 19:05:35 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 19:05:36 +0000 INFO:display_visualizations executed successfully
2026-01-30 19:05:36 +0000 INFO:display_data_page executed successfully
2026-01-30 19:05:36 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 19:05:36 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 19:05:36 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 19:05:36 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 19:05:36 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 19:05:36 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 19:05:36 +0000 DEBUG:Page texts: {}
2026-01-30 19:05:36 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 19:05:36 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 19:05:37 +0000 INFO:display_visualizations executed successfully
2026-01-30 19:05:37 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 19:05:37 +0000 INFO:pagesetup executed successfully
2026-01-30 19:05:37 +0000 INFO:Menu setup completed successfully.
2026-01-30 19:05:37 +0000 INFO:App is fully loaded and ready!
2026-01-30 19:06:22 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2026-01-30 19:06:22 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 19:06:25 +0000 INFO:get_git_version executed successfully
2026-01-30 19:06:26 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 19:06:29 +0000 INFO:get_git_version executed successfully
2026-01-30 19:06:29 +0000 INFO:Streamlit App Starting...
2026-01-30 19:06:29 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 19:06:29 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 19:06:29 +0000 INFO:Running App setup...
2026-01-30 19:06:29 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 19:06:29 +0000 INFO:Setting up the package
2026-01-30 19:06:29 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 19:06:29 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 19:06:32 +0000 INFO:get_git_version executed successfully
2026-01-30 19:06:32 +0000 INFO:Version: v50.202
2026-01-30 19:06:32 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 19:06:32 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 19:06:32 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2026-01-30 19:06:32 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 19:06:32 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2026-01-30 19:06:32 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2026-01-30 19:06:32 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 19:06:32 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 19:06:32 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 19:06:32 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 19:06:32 +0000 DEBUG:Initialised perc_target with value: 0.5
2026-01-30 19:06:32 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2026-01-30 19:06:32 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 19:06:32 +0000 DEBUG:Initialised electoral_cycle_rules with value: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 19:06:32 +0000 DEBUG:Initialised reference_dir with value: H:\GitHub\dashboard_demo\reference_files
2026-01-30 19:06:32 +0000 DEBUG:Initialised data_dir with value: H:\GitHub\dashboard_demo\data
2026-01-30 19:06:32 +0000 DEBUG:Initialised output_dir with value: H:\GitHub\dashboard_demo\output
2026-01-30 19:06:32 +0000 DEBUG:Initialised logs_dir with value: H:\GitHub\dashboard_demo\logs
2026-01-30 19:06:32 +0000 DEBUG:Initialised components_dir with value: H:\GitHub\dashboard_demo\components
2026-01-30 19:06:32 +0000 DEBUG:Initialised app_pages_dir with value: H:\GitHub\dashboard_demo\app_pages
2026-01-30 19:06:32 +0000 DEBUG:Initialised utils_dir with value: H:\GitHub\dashboard_demo\utils
2026-01-30 19:06:32 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 19:06:32 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 19:06:32 +0000 DEBUG:Initialised mppartymemb_fname with value: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 19:06:32 +0000 DEBUG:Initialised donor_map_fname with value: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 19:06:32 +0000 DEBUG:Initialised politician_party_fname with value: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 19:06:32 +0000 DEBUG:Initialised regentity_map_fname with value: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 19:06:32 +0000 DEBUG:Initialised original_data_fname with value: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 19:06:32 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 19:06:32 +0000 DEBUG:Initialised TEXT_FILE with value: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 19:06:32 +0000 DEBUG:Initialised ELECTION_DATES with value: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 19:06:32 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 19:06:32 +0000 DEBUG:Initialised cleaned_data_fname with value: cleaned_data.zip
2026-01-30 19:06:32 +0000 DEBUG:Initialised cleaned_donations_fname with value: cleaned_donations.zip
2026-01-30 19:06:32 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: cleaned_donorlist.zip
2026-01-30 19:06:32 +0000 DEBUG:Initialised cleaned_regentity_fname with value: cleaned_regentity.zip
2026-01-30 19:06:32 +0000 DEBUG:Initialised party_summary_fname with value: party_summary.zip
2026-01-30 19:06:32 +0000 DEBUG:Initialised imported_raw_fname with value: imported_raw.zip
2026-01-30 19:06:32 +0000 DEBUG:Initialised source_data_fname with value: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 19:06:32 +0000 DEBUG:Initialised Cash_ftr with value: None
2026-01-30 19:06:32 +0000 INFO:Session_state variables initialized
2026-01-30 19:06:32 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 19:06:32 +0000 DEBUG:perc_target: 0.5
2026-01-30 19:06:32 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 19:06:32 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 19:06:32 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 19:06:32 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 19:06:32 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 19:06:32 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 19:06:32 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 19:06:32 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 19:06:32 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 19:06:32 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 19:06:32 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 19:06:32 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 19:06:32 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 19:06:32 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 19:06:32 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 19:06:32 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 19:06:32 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 19:06:32 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 19:06:32 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 19:06:32 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 19:06:32 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 19:06:32 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 19:06:32 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 19:06:32 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 19:06:32 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 19:06:32 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 19:06:32 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 19:06:32 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 19:06:32 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 19:06:32 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 19:06:32 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 19:06:32 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 19:06:32 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 19:06:32 +0000 DEBUG:Cash_ftr: None
2026-01-30 19:06:32 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 19:06:32 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 19:06:32 +0000 INFO:Session state Setup complete
2026-01-30 19:06:32 +0000 INFO:initialize_session_state executed successfully
2026-01-30 19:06:32 +0000 INFO:Package setup complete
2026-01-30 19:06:32 +0000 INFO:setup_package executed successfully
2026-01-30 19:06:32 +0000 INFO:Setup completed successfully.
2026-01-30 19:06:32 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 19:06:32 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 19:06:34 +0000 INFO:get_git_version executed successfully
2026-01-30 19:06:35 +0000 INFO:Running first load function.
2026-01-30 19:06:35 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 19:06:35 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2026-01-30 19:06:35 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2026-01-30 19:06:35 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2026-01-30 19:06:35 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2026-01-30 19:06:35 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 19:06:35 +0000 INFO:Original file path: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 19:06:35 +0000 INFO:Saved file path: imported_raw.zip
2026-01-30 19:06:35 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 19:06:35 +0000 INFO:Checking if H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip has been updated.
2026-01-30 19:06:35 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 19:06:35 +0000 INFO:Getting modification time for H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 19:06:35 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 19:06:35 +0000 INFO:Current modification time: 1769774510.1556323
2026-01-30 19:06:35 +0000 INFO:Last modification time: 1769774510.1556323
2026-01-30 19:06:35 +0000 INFO:is_file_updated executed successfully
2026-01-30 19:06:35 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 19:06:35 +0000 INFO:Loading raw data...
2026-01-30 19:06:35 +0000 DEBUG:Original data file path post raw data load: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 19:06:35 +0000 DEBUG:Processed data file path post raw data load: imported_raw.zip
2026-01-30 19:06:35 +0000 INFO:Data loaded successfully. Data has 91341 rows and 29 columns
2026-01-30 19:06:36 +0000 INFO:Data saved to imported_raw.zip
2026-01-30 19:06:36 +0000 INFO:Data saved to sessionstate as 'raw_data'
2026-01-30 19:06:36 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2026-01-30 19:06:36 +0000 INFO:Cleaning up raw data
2026-01-30 19:06:36 +0000 ERROR:Session state variables not initialized!
2026-01-30 19:06:36 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 19:06:36 +0000 INFO:Original file path: None
2026-01-30 19:06:36 +0000 INFO:Saved file path: cleaned_donations.zip
2026-01-30 19:06:36 +0000 ERROR:Error: originalfilepath is None!
2026-01-30 19:06:36 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 19:06:36 +0000 INFO:Data loaded, shape: (91341, 29)
2026-01-30 19:06:38 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2026-01-30 19:06:38 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2026-01-30 19:06:38 +0000 INFO:File deduplication complete, shape: ECRef                            592
OriginalRegulatedEntityName      592
RegulatedEntityType              592
Value                            592
AcceptedDate                     574
AccountingUnitName               592
DonorName                        592
AccountingUnitsAsCentralParty    592
IsSponsorship                    592
DonorStatus                      592
RegulatedDoneeType               592
CompanyRegistrationNumber        592
Postcode                         592
DonationType                     592
NatureOfDonation                 592
PurposeOfVisit                   592
DonationAction                   592
ReceivedDate                     486
ReportedDate                     592
IsReportedPrePoll                423
ReportingPeriodName              592
IsBequest                        592
IsAggregation                    592
OriginalRegulatedEntityId        592
AccountingUnitId                 592
DonorId                          592
CampaigningName                  592
RegisterName                     592
IsIrishSource                    592
CleanedRegulatedEntityName       592
CleanedRegulatedEntityId         592
RegulatedEntityId                592
RegulatedEntityName              592
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10109
OriginalRegulatedEntityName      10109
RegulatedEntityType              10109
Value                            10107
AcceptedDate                      9796
AccountingUnitName               10109
DonorName                        10109
AccountingUnitsAsCentralParty    10109
IsSponsorship                    10109
DonorStatus                      10109
RegulatedDoneeType               10109
CompanyRegistrationNumber        10109
Postcode                         10109
DonationType                     10109
NatureOfDonation                 10109
PurposeOfVisit                   10109
DonationAction                   10109
ReceivedDate                      7075
ReportedDate                     10099
IsReportedPrePoll                 4878
ReportingPeriodName              10109
IsBequest                        10109
IsAggregation                    10109
OriginalRegulatedEntityId        10109
AccountingUnitId                 10109
DonorId                          10109
CampaigningName                  10109
RegisterName                     10109
IsIrishSource                    10109
CleanedRegulatedEntityName       10109
CleanedRegulatedEntityId         10109
RegulatedEntityId                10109
RegulatedEntityName              10109
dtype: int64 records updated with new RegulatedEntityName
2026-01-30 19:06:38 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3771
OriginalRegulatedEntityName      3771
RegulatedEntityType              3771
Value                            3771
AcceptedDate                     3667
AccountingUnitName               3771
DonorName                        3771
AccountingUnitsAsCentralParty    3771
IsSponsorship                    3771
DonorStatus                      3771
RegulatedDoneeType               3771
CompanyRegistrationNumber        3771
Postcode                         3771
DonationType                     3771
NatureOfDonation                 3771
PurposeOfVisit                   3771
DonationAction                   3771
ReceivedDate                     3297
ReportedDate                     3771
IsReportedPrePoll                 449
ReportingPeriodName              3771
IsBequest                        3771
IsAggregation                    3771
OriginalRegulatedEntityId        3771
AccountingUnitId                 3771
DonorId                          3771
CampaigningName                  3771
RegisterName                     3771
IsIrishSource                    3771
CleanedRegulatedEntityName        592
CleanedRegulatedEntityId          592
RegulatedEntityId                3771
RegulatedEntityName              3771
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13288
OriginalRegulatedEntityName      13288
RegulatedEntityType              13288
Value                            13286
AcceptedDate                     12889
AccountingUnitName               13288
DonorName                        13288
AccountingUnitsAsCentralParty    13288
IsSponsorship                    13288
DonorStatus                      13288
RegulatedDoneeType               13288
CompanyRegistrationNumber        13288
Postcode                         13288
DonationType                     13288
NatureOfDonation                 13288
PurposeOfVisit                   13288
DonationAction                   13288
ReceivedDate                      9886
ReportedDate                     13278
IsReportedPrePoll                 4904
ReportingPeriodName              13288
IsBequest                        13288
IsAggregation                    13288
OriginalRegulatedEntityId        13288
AccountingUnitId                 13288
DonorId                          13288
CampaigningName                  13288
RegisterName                     13288
IsIrishSource                    13288
CleanedRegulatedEntityName       10109
CleanedRegulatedEntityId         10109
RegulatedEntityId                13288
RegulatedEntityName              13288
dtype: int64 records updated with new RegulatedEntityName
2026-01-30 19:06:38 +0000 INFO:File deduplication complete, shape: (91341, 33)
2026-01-30 19:06:38 +0000 INFO:dedupe_entity_file executed successfully
2026-01-30 19:06:38 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2026-01-30 19:06:38 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2026-01-30 19:06:39 +0000 INFO:File deduplication complete, shape: ECRef                            34082
OriginalRegulatedEntityName      34082
RegulatedEntityType              34082
Value                            34079
AcceptedDate                     33689
AccountingUnitName               34082
OriginalDonorName                34082
AccountingUnitsAsCentralParty    34082
IsSponsorship                    34082
DonorStatus                      34082
RegulatedDoneeType               34082
CompanyRegistrationNumber        34082
Postcode                         34082
DonationType                     34082
NatureOfDonation                 34082
PurposeOfVisit                   34082
DonationAction                   34082
ReceivedDate                     32487
ReportedDate                     34071
IsReportedPrePoll                22707
ReportingPeriodName              34082
IsBequest                        34082
IsAggregation                    34082
OriginalRegulatedEntityId        34082
AccountingUnitId                 34082
OriginalDonorId                  34082
CampaigningName                  34082
RegisterName                     34082
IsIrishSource                    34082
CleanedRegulatedEntityName       34082
CleanedRegulatedEntityId         34082
RegulatedEntityId                34082
RegulatedEntityName              34082
CleanedDonorName                 34082
CleanedDonorId                   34082
DonorId                          34082
DonorName                        34082
dtype: int64 records updated with new DonorId and ECRef                            20155
OriginalRegulatedEntityName      20155
RegulatedEntityType              20155
Value                            20153
AcceptedDate                     19834
AccountingUnitName               20155
OriginalDonorName                20155
AccountingUnitsAsCentralParty    20155
IsSponsorship                    20155
DonorStatus                      20155
RegulatedDoneeType               20155
CompanyRegistrationNumber        20155
Postcode                         20155
DonationType                     20155
NatureOfDonation                 20155
PurposeOfVisit                   20155
DonationAction                   20155
ReceivedDate                     19620
ReportedDate                     20146
IsReportedPrePoll                13414
ReportingPeriodName              20155
IsBequest                        20155
IsAggregation                    20155
OriginalRegulatedEntityId        20155
AccountingUnitId                 20155
OriginalDonorId                  20155
CampaigningName                  20155
RegisterName                     20155
IsIrishSource                    20155
CleanedRegulatedEntityName       20154
CleanedRegulatedEntityId         20154
RegulatedEntityId                20155
RegulatedEntityName              20155
CleanedDonorName                 20155
CleanedDonorId                   20155
DonorId                          20155
DonorName                        20155
dtype: int64 records updated with new DonorName
2026-01-30 19:06:39 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            52934
OriginalRegulatedEntityName      52934
RegulatedEntityType              52934
Value                            52931
AcceptedDate                     52138
AccountingUnitName               52934
OriginalDonorName                52934
AccountingUnitsAsCentralParty    52934
IsSponsorship                    52934
DonorStatus                      52934
RegulatedDoneeType               52934
CompanyRegistrationNumber        52934
Postcode                         52934
DonationType                     52934
NatureOfDonation                 52934
PurposeOfVisit                   52934
DonationAction                   52934
ReceivedDate                     50532
ReportedDate                     52923
IsReportedPrePoll                23658
ReportingPeriodName              52934
IsBequest                        52934
IsAggregation                    52934
OriginalRegulatedEntityId        52934
AccountingUnitId                 52934
OriginalDonorId                  52934
CampaigningName                  52934
RegisterName                     52934
IsIrishSource                    52934
CleanedRegulatedEntityName       49804
CleanedRegulatedEntityId         49804
RegulatedEntityId                52934
RegulatedEntityName              52934
CleanedDonorName                 34082
CleanedDonorId                   34082
DonorId                          52934
DonorName                        52934
dtype: int64 records updated with new DonorId and ECRef                            39007
OriginalRegulatedEntityName      39007
RegulatedEntityType              39007
Value                            39005
AcceptedDate                     38283
AccountingUnitName               39007
OriginalDonorName                39007
AccountingUnitsAsCentralParty    39007
IsSponsorship                    39007
DonorStatus                      39007
RegulatedDoneeType               39007
CompanyRegistrationNumber        39007
Postcode                         39007
DonationType                     39007
NatureOfDonation                 39007
PurposeOfVisit                   39007
DonationAction                   39007
ReceivedDate                     37665
ReportedDate                     38998
IsReportedPrePoll                14365
ReportingPeriodName              39007
IsBequest                        39007
IsAggregation                    39007
OriginalRegulatedEntityId        39007
AccountingUnitId                 39007
OriginalDonorId                  39007
CampaigningName                  39007
RegisterName                     39007
IsIrishSource                    39007
CleanedRegulatedEntityName       35876
CleanedRegulatedEntityId         35876
RegulatedEntityId                39007
RegulatedEntityName              39007
CleanedDonorName                 20155
CleanedDonorId                   20155
DonorId                          39007
DonorName                        39007
dtype: int64 records updated with new DonorName
2026-01-30 19:06:39 +0000 INFO:File deduplication complete, shape: (91341, 37)
2026-01-30 19:06:39 +0000 INFO:dedupe_entity_file executed successfully
2026-01-30 19:06:39 +0000 INFO:Raw Data cleanup completed
2026-01-30 19:06:39 +0000 INFO:Data shape: (91341, 37)
2026-01-30 19:06:40 +0000 INFO:Data saved to cleaned_donations.zip
2026-01-30 19:06:40 +0000 INFO:Data cleanup completed, shape: (91341, 37)
2026-01-30 19:06:40 +0000 INFO:raw_data_cleanup executed successfully
2026-01-30 19:06:40 +0000 INFO:load_raw_data executed successfully
2026-01-30 19:06:41 +0000 INFO:get_raw_data executed successfully
2026-01-30 19:06:41 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 19:06:41 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2026-01-30 19:06:41 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2026-01-30 19:06:41 +0000 DEBUG:Rows in Raw Data: 91341
2026-01-30 19:06:41 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 19:06:41 +0000 INFO:Original file path: cleaned_donations.zip
2026-01-30 19:06:41 +0000 INFO:Saved file path: cleaned_data.zip
2026-01-30 19:06:41 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 19:06:41 +0000 INFO:Checking if cleaned_donations.zip has been updated.
2026-01-30 19:06:41 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 19:06:41 +0000 INFO:Getting modification time for cleaned_donations.zip
2026-01-30 19:06:41 +0000 WARNING:File cleaned_donations.zip does not exist.
2026-01-30 19:06:41 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 19:06:41 +0000 INFO:Current modification time: None
2026-01-30 19:06:41 +0000 INFO:Last modification time: 1769774510.1556323
2026-01-30 19:06:41 +0000 WARNING:Cannot determine modification time for cleaned_donations.zip
2026-01-30 19:06:41 +0000 INFO:is_file_updated executed successfully
2026-01-30 19:06:41 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 19:06:41 +0000 ERROR:Failed to load data from cleaned_donations.zip
2026-01-30 19:06:41 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2026-01-30 19:06:41 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91341
2026-01-30 19:06:41 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91341
2026-01-30 19:06:43 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2026-01-30 19:06:43 +0000 DEBUG:Clean Data Prep 204: Map Party: 91341
2026-01-30 19:07:18 +0000 INFO:Added parliamentary_sitting column with 8 unique periods
2026-01-30 19:07:18 +0000 DEBUG:Group assignment with exceptions: {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}
2026-01-30 19:07:18 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28638
Labour Party                       22675
Liberal Democrats                  19030
Large Entity                        8611
Medium Entity                       3809
Small Entity                        1985
Uk Independence Party (Ukip)        1830
Green Party                         1673
Single Donation Entity              1353
Scottish National Party (Snp)        815
Plaid Cymru - Party Of Wales         517
Reform UK                            377
Liberal Party                         15
Sinn Féin                             13
Name: count, dtype: int64
2026-01-30 19:07:18 +0000 DEBUG:Group assignment: group
Single Donation Entity             1353
Small Entity                        839
Medium Entity                       614
Large Entity                        227
Conservative And Unionist Party       8
Labour Party                          8
Liberal Democrats                     8
Plaid Cymru - Party Of Wales          8
Scottish National Party (Snp)         8
Uk Independence Party (Ukip)          8
Green Party                           7
Liberal Party                         4
Reform UK                             3
Sinn Féin                             1
Name: count, dtype: int64
2026-01-30 19:07:18 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91341
2026-01-30 19:07:18 +0000 DEBUG:Group assignment with exceptions: {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}
2026-01-30 19:07:18 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32036
Labour Party                       27106
Large Entity                       24804
Uk Independence Party (Ukip)        1853
Green Party                         1694
Medium Entity                       1112
Scottish National Party (Snp)        881
Small Entity                         552
Plaid Cymru - Party Of Wales         525
Reform UK                            377
Single Donation Entity               372
Liberal Party                         15
Sinn Féin                             13
Democratic Unionist Party              1
Name: count, dtype: int64
2026-01-30 19:07:18 +0000 DEBUG:Group assignment: group
Single Donation Entity             372
Small Entity                       233
Medium Entity                      171
Large Entity                       120
Conservative And Unionist Party      8
Labour Party                         8
Plaid Cymru - Party Of Wales         8
Scottish National Party (Snp)        8
Uk Independence Party (Ukip)         8
Green Party                          7
Liberal Party                        4
Reform UK                            3
Democratic Unionist Party            1
Sinn Féin                            1
Name: count, dtype: int64
2026-01-30 19:07:18 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91341
2026-01-30 19:07:18 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2026-01-30 19:07:18 +0000 INFO:Loading election dates from pdpy.
2026-01-30 19:07:18 +0000 INFO:Election Dates loaded from pdpy.
2026-01-30 19:07:18 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2026-01-30 19:07:18 +0000 INFO:Election Dates Loaded Successfully.
2026-01-30 19:07:18 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 19:07:18 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 19:07:18 +0000 INFO:load_election_dates executed successfully
2026-01-30 19:07:19 +0000 DEBUG:Clean Data Prep 353: Election dates: 91341
2026-01-30 19:07:19 +0000 DEBUG:Clean Data Prep 386: End of clean: 91341
2026-01-30 19:07:21 +0000 INFO:Cleaned Data completed, shape: (91341, 57)
2026-01-30 19:07:21 +0000 INFO:load_cleaned_data executed successfully
2026-01-30 19:07:21 +0000 INFO:get_cleaned_data executed successfully
2026-01-30 19:07:21 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 19:07:21 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2026-01-30 19:07:21 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2026-01-30 19:07:21 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 19:07:21 +0000 INFO:Original file path: cleaned_data.zip
2026-01-30 19:07:21 +0000 INFO:Saved file path: cleaned_donorlist.zip
2026-01-30 19:07:21 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 19:07:21 +0000 INFO:Checking if cleaned_data.zip has been updated.
2026-01-30 19:07:21 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 19:07:21 +0000 INFO:Getting modification time for cleaned_data.zip
2026-01-30 19:07:21 +0000 WARNING:File cleaned_data.zip does not exist.
2026-01-30 19:07:21 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 19:07:21 +0000 INFO:Current modification time: None
2026-01-30 19:07:21 +0000 INFO:Last modification time: 1769718453.1764421
2026-01-30 19:07:21 +0000 WARNING:Cannot determine modification time for cleaned_data.zip
2026-01-30 19:07:21 +0000 INFO:is_file_updated executed successfully
2026-01-30 19:07:21 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 19:07:22 +0000 INFO:Donor data saved to cleaned_donorlist.zip
2026-01-30 19:07:22 +0000 INFO:Donor Data summary completed
2026-01-30 19:07:22 +0000 INFO:Data shape: (32070, 5)
2026-01-30 19:07:22 +0000 INFO:load_donorList_data executed successfully
2026-01-30 19:07:22 +0000 INFO:get_donor_data executed successfully
2026-01-30 19:07:22 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 19:07:22 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 19:07:22 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2026-01-30 19:07:22 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2026-01-30 19:07:22 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2026-01-30 19:07:22 +0000 INFO:Original file path: cleaned_data.zip
2026-01-30 19:07:22 +0000 INFO:Saved file path: cleaned_regentity.zip
2026-01-30 19:07:22 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2026-01-30 19:07:22 +0000 INFO:Checking if cleaned_data.zip has been updated.
2026-01-30 19:07:22 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2026-01-30 19:07:22 +0000 INFO:Getting modification time for cleaned_data.zip
2026-01-30 19:07:22 +0000 WARNING:File cleaned_data.zip does not exist.
2026-01-30 19:07:22 +0000 INFO:get_file_modification_time executed successfully
2026-01-30 19:07:22 +0000 INFO:Current modification time: None
2026-01-30 19:07:22 +0000 INFO:Last modification time: 1769718453.1764421
2026-01-30 19:07:22 +0000 WARNING:Cannot determine modification time for cleaned_data.zip
2026-01-30 19:07:22 +0000 INFO:is_file_updated executed successfully
2026-01-30 19:07:22 +0000 INFO:try_to_use_preprocessed_data executed successfully
2026-01-30 19:07:22 +0000 INFO:Regulated entity data saved to cleaned_regentity.zip
2026-01-30 19:07:22 +0000 INFO:Raw Data cleanup completed
2026-01-30 19:07:22 +0000 INFO:Data shape: (2404, 6)
2026-01-30 19:07:22 +0000 INFO:load_regulated_entity_data executed successfully
2026-01-30 19:07:22 +0000 INFO:get_regentity_data executed successfully
2026-01-30 19:07:22 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 19:07:22 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 19:07:22 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 19:07:22 +0000 INFO:firstload executed successfully
2026-01-30 19:07:22 +0000 INFO:Data first load completed successfully.
2026-01-30 19:07:22 +0000 INFO:initialise_data executed successfully
2026-01-30 19:07:22 +0000 INFO:Running Menu setup...
2026-01-30 19:07:22 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 19:07:22 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 19:07:27 +0000 INFO:get_git_version executed successfully
2026-01-30 19:07:27 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 19:07:30 +0000 INFO:get_git_version executed successfully
2026-01-30 19:07:30 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 19:07:33 +0000 INFO:get_git_version executed successfully
2026-01-30 19:07:33 +0000 INFO:App Version: v50.240
2026-01-30 19:07:33 +0000 INFO:Switched to page: Introduction
2026-01-30 19:07:33 +0000 INFO:pagesetup executed successfully
2026-01-30 19:07:33 +0000 INFO:Menu setup completed successfully.
2026-01-30 19:07:33 +0000 INFO:App is fully loaded and ready!
2026-01-30 19:07:37 +0000 INFO:Streamlit App Starting...
2026-01-30 19:07:37 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 19:07:37 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 19:07:37 +0000 INFO:Running App setup...
2026-01-30 19:07:37 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 19:07:37 +0000 INFO:Setting up the package
2026-01-30 19:07:37 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 19:07:37 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 19:07:37 +0000 INFO:get_git_version executed successfully
2026-01-30 19:07:37 +0000 INFO:Version: v50.202
2026-01-30 19:07:37 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 19:07:37 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 19:07:37 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:filenames already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:thresholds already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:filter_def already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:security already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:perc_target already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:directories already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:data_dir already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:output_dir already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:components_dir already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 19:07:37 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 19:07:37 +0000 INFO:Session_state variables initialized
2026-01-30 19:07:37 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 19:07:37 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 19:07:37 +0000 DEBUG:perc_target: 0.5
2026-01-30 19:07:37 +0000 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x000001E714ADA3B0>}
2026-01-30 19:07:37 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 19:07:37 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 19:07:37 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 19:07:37 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 19:07:37 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 19:07:37 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 19:07:37 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 19:07:37 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 19:07:37 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 19:07:37 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 19:07:37 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 19:07:37 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 19:07:37 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 19:07:37 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 19:07:37 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 19:07:37 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 19:07:37 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 19:07:37 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 19:07:37 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 19:07:37 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 19:07:37 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 19:07:37 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 19:07:37 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 19:07:37 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 19:07:37 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 19:07:37 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 19:07:37 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 19:07:37 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 19:07:37 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 19:07:37 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 19:07:37 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 19:07:37 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 19:07:37 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 19:07:37 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 19:07:37 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 19:07:37 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 19:07:37 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 19:07:37 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 19:07:37 +0000 DEBUG:Cash_ftr: None
2026-01-30 19:07:37 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 19:07:37 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 19:07:37 +0000 INFO:Session state Setup complete
2026-01-30 19:07:37 +0000 INFO:initialize_session_state executed successfully
2026-01-30 19:07:37 +0000 INFO:Package setup complete
2026-01-30 19:07:37 +0000 INFO:setup_package executed successfully
2026-01-30 19:07:37 +0000 INFO:Setup completed successfully.
2026-01-30 19:07:37 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 19:07:37 +0000 INFO:Running first load function.
2026-01-30 19:07:37 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 19:07:37 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 19:07:37 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 19:07:37 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 19:07:37 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 19:07:37 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 19:07:37 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 19:07:37 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 19:07:37 +0000 INFO:firstload executed successfully
2026-01-30 19:07:37 +0000 INFO:Data first load completed successfully.
2026-01-30 19:07:37 +0000 INFO:initialise_data executed successfully
2026-01-30 19:07:37 +0000 INFO:Running Menu setup...
2026-01-30 19:07:37 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 19:07:37 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 19:07:37 +0000 INFO:get_git_version executed successfully
2026-01-30 19:07:37 +0000 INFO:App Version: v50.240
2026-01-30 19:07:37 +0000 INFO:Switched to page: Head Line Figures
2026-01-30 19:07:37 +0000 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2026-01-30 19:07:37 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 19:07:37 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 19:07:37 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 19:07:38 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 19:07:39 +0000 DEBUG:Aggregated DataFrame:                         Party_Group         Value
0   Conservative And Unionist Party  20170.405233
1         Democratic Unionist Party   3618.940000
2                       Green Party   6204.226405
3                      Labour Party  20519.157176
4                      Large Entity  12031.362470
5                     Liberal Party   2871.754667
6                     Medium Entity  19378.136232
7      Plaid Cymru - Party Of Wales  15859.742724
8                         Reform UK  97641.772732
9     Scottish National Party (Snp)  36021.189364
10           Single Donation Entity  13864.955459
11                        Sinn Féin  44317.630769
12                     Small Entity  24968.983822
13     Uk Independence Party (Ukip)   9943.456859
2026-01-30 19:07:39 +0000 DEBUG:Sorted DataFrame:                         Party_Group         Value
8                         Reform UK  97641.772732
11                        Sinn Féin  44317.630769
9     Scottish National Party (Snp)  36021.189364
12                     Small Entity  24968.983822
3                      Labour Party  20519.157176
0   Conservative And Unionist Party  20170.405233
6                     Medium Entity  19378.136232
7      Plaid Cymru - Party Of Wales  15859.742724
10           Single Donation Entity  13864.955459
4                      Large Entity  12031.362470
13     Uk Independence Party (Ukip)   9943.456859
2                       Green Party   6204.226405
1         Democratic Unionist Party   3618.940000
5                     Liberal Party   2871.754667
2026-01-30 19:07:39 +0000 DEBUG:Unique XValues: ['Reform UK' 'Sinn Féin' 'Scottish National Party (Snp)' 'Small Entity'
 'Labour Party' 'Conservative And Unionist Party' 'Medium Entity'
 'Plaid Cymru - Party Of Wales' 'Single Donation Entity' 'Large Entity'
 'Uk Independence Party (Ukip)' 'Green Party' 'Democratic Unionist Party'
 'Liberal Party']
2026-01-30 19:07:39 +0000 DEBUG:Final color_discrete_map: {'Reform UK': '#12B6CF', 'Sinn Féin': '#326760', 'Scottish National Party (Snp)': '#636efa', 'Small Entity': '#aaaaaa', 'Labour Party': '#DC241F', 'Conservative And Unionist Party': '#0087DC', 'Medium Entity': '#666666', 'Plaid Cymru - Party Of Wales': '#636efa', 'Single Donation Entity': '#e8e8e8', 'Large Entity': '#222222', 'Uk Independence Party (Ukip)': '#70147A', 'Green Party': '#78B943', 'Democratic Unionist Party': '#636efa', 'Liberal Party': '#636efa'}
2026-01-30 19:07:39 +0000 DEBUG:Missing color mappings for: ['Scottish National Party (Snp)', 'Plaid Cymru - Party Of Wales', 'Democratic Unionist Party', 'Liberal Party']
2026-01-30 19:07:39 +0000 DEBUG:Generated Figure: Figure({
    'data': [{'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Reform UK',
              'marker': {'color': '#12B6CF', 'pattern': {'shape': ''}},
              'name': 'Reform UK',
              'offsetgroup': 'Reform UK',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Reform UK'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'a1QcXZzW90A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Sinn Féin',
              'marker': {'color': '#326760', 'pattern': {'shape': ''}},
              'name': 'Sinn Féin',
              'offsetgroup': 'Sinn Féin',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Sinn Féin'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'L/RCL7Sj5UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Scottish National Party (Snp)',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Scottish National Party (Snp)',
              'offsetgroup': 'Scottish National Party (Snp)',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Scottish National Party (Snp)'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '8tdFD6aW4UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Small Entity',
              'marker': {'color': '#aaaaaa', 'pattern': {'shape': ''}},
              'name': 'Small Entity',
              'offsetgroup': 'Small Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Small Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'vX7y9j5i2EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Labour Party',
              'marker': {'color': '#DC241F', 'pattern': {'shape': ''}},
              'name': 'Labour Party',
              'offsetgroup': 'Labour Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Labour Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '9qMqD8oJ1EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Conservative And Unionist Party',
              'marker': {'color': '#0087DC', 'pattern': {'shape': ''}},
              'name': 'Conservative And Unionist Party',
              'offsetgroup': 'Conservative And Unionist Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Conservative And Unionist Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '65FU75my00A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Medium Entity',
              'marker': {'color': '#666666', 'pattern': {'shape': ''}},
              'name': 'Medium Entity',
              'offsetgroup': 'Medium Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Medium Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'nXsGuIjs0kA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Plaid Cymru - Party Of Wales',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Plaid Cymru - Party Of Wales',
              'offsetgroup': 'Plaid Cymru - Party Of Wales',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Plaid Cymru - Party Of Wales'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '7uOSEd/5zkA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Single Donation Entity',
              'marker': {'color': '#e8e8e8', 'pattern': {'shape': ''}},
              'name': 'Single Donation Entity',
              'offsetgroup': 'Single Donation Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Single Donation Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'hd1+THoUy0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Large Entity',
              'marker': {'color': '#222222', 'pattern': {'shape': ''}},
              'name': 'Large Entity',
              'offsetgroup': 'Large Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Large Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'lyJsZa5/x0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Uk Independence Party (Ukip)',
              'marker': {'color': '#70147A', 'pattern': {'shape': ''}},
              'name': 'Uk Independence Party (Ukip)',
              'offsetgroup': 'Uk Independence Party (Ukip)',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Uk Independence Party (Ukip)'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'U0xcerprw0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Green Party',
              'marker': {'color': '#78B943', 'pattern': {'shape': ''}},
              'name': 'Green Party',
              'offsetgroup': 'Green Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Green Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'LOWs9Tk8uEA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Democratic Unionist Party',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Democratic Unionist Party',
              'offsetgroup': 'Democratic Unionist Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Democratic Unionist Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'exSuR+FFrEA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Liberal Party',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Liberal Party',
              'offsetgroup': 'Liberal Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Liberal Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'blmrY4JvpkA=', 'dtype': 'f8'},
              'yaxis': 'y'}],
    'layout': {'barmode': 'group',
               'legend': {'title': {'text': 'Political Party'}, 'tracegroupgap': 0},
               'template': '...',
               'title': {'text': 'Average Donation per Party'},
               'xaxis': {'anchor': 'y',
                         'categoryarray': [Reform UK, Sinn Féin, Scottish National
                                           Party (Snp), Small Entity, Labour Party,
                                           Conservative And Unionist Party, Medium
                                           Entity, Plaid Cymru - Party Of Wales,
                                           Single Donation Entity, Large Entity, Uk
                                           Independence Party (Ukip), Green Party,
                                           Democratic Unionist Party, Liberal
                                           Party],
                         'categoryorder': 'array',
                         'domain': [0.0, 1.0],
                         'title': {'text': 'Political Party'}},
               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': 'Average Donation GBP'}}}
})
2026-01-30 19:07:39 +0000 INFO:Bar chart displayed successfully.
2026-01-30 19:07:39 +0000 INFO:hlf_body executed successfully
2026-01-30 19:07:39 +0000 INFO:pagesetup executed successfully
2026-01-30 19:07:39 +0000 INFO:Menu setup completed successfully.
2026-01-30 19:07:39 +0000 INFO:App is fully loaded and ready!
2026-01-30 19:07:44 +0000 INFO:Streamlit App Starting...
2026-01-30 19:07:44 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2026-01-30 19:07:44 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2026-01-30 19:07:44 +0000 INFO:Running App setup...
2026-01-30 19:07:44 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2026-01-30 19:07:44 +0000 INFO:Setting up the package
2026-01-30 19:07:44 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2026-01-30 19:07:44 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 19:07:44 +0000 INFO:get_git_version executed successfully
2026-01-30 19:07:44 +0000 INFO:Version: v50.202
2026-01-30 19:07:44 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2026-01-30 19:07:44 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 19:07:44 +0000 DEBUG:BASE_DIR already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:filenames already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:thresholds already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:data_remappings already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:filter_def already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:security already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:perc_target already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:directories already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:electoral_cycle_rules already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:reference_dir already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:data_dir already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:output_dir already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:logs_dir already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:components_dir already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:app_pages_dir already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:utils_dir already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:mppartymemb_fname already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:donor_map_fname already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:politician_party_fname already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:regentity_map_fname already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:original_data_fname already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:TEXT_FILE already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:ELECTION_DATES already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:cleaned_data_fname already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:cleaned_donations_fname already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:party_summary_fname already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:imported_raw_fname already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:source_data_fname already exists in session state
2026-01-30 19:07:44 +0000 DEBUG:Cash_ftr already exists in session state
2026-01-30 19:07:44 +0000 INFO:Session_state variables initialized
2026-01-30 19:07:44 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2026-01-30 19:07:44 +0000 DEBUG:max_date: 2026-01-03
2026-01-30 19:07:44 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2026-01-30 19:07:44 +0000 DEBUG:perc_target: 0.5
2026-01-30 19:07:44 +0000 DEBUG:menu_selection: {'title': 'Cash Donations', 'function': <function mod_cash_donations at 0x000001E714ADB640>}
2026-01-30 19:07:44 +0000 DEBUG:data_regentity:       RegulatedEntityId       Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0           English Democrats           Medium Entity          45000.0                7    6428.571429
1                  17.0           English Democrats  Single Donation Entity          59532.0                2   29766.000000
2                  17.0           English Democrats            Small Entity          14000.0                3    4666.666667
3                  19.0  Legalise Cannabis Alliance           Medium Entity          27300.0               10    2730.000000
4                  19.0  Legalise Cannabis Alliance            Small Entity           8200.0                3    2733.333333
...                 ...                         ...                     ...              ...              ...            ...
2399            18336.0                Shockat Adam  Single Donation Entity           5843.0                1    5843.000000
2400            18337.0              Alex Ballinger  Single Donation Entity           5985.0                1    5985.000000
2401            18338.0                Anna Gelderd  Single Donation Entity           4125.2                1    4125.200000
2402            18339.0                  John Grady  Single Donation Entity           7000.0                1    7000.000000
2403            18340.0                Gordon Mckee  Single Donation Entity           3000.0                1    3000.000000

[2404 rows x 6 columns]
2026-01-30 19:07:44 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2026-01-30 19:07:44 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2026-01-30 19:07:44 +0000 DEBUG:utils_dir: H:\GitHub\dashboard_demo\utils
2026-01-30 19:07:44 +0000 DEBUG:ELECTION_DATES: H:\GitHub\dashboard_demo\reference_files\elections.csv
2026-01-30 19:07:44 +0000 DEBUG:data_clean:            ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0       C0000001         Third Party   50000.00  ...                  16.0                 1.0                  4.0
1       C0000002         Third Party  112531.96  ...                  17.0                 1.0                  5.0
2       C0000003     Regulated Donee   15000.00  ...                  16.0                 1.0                  4.0
3       C0000004     Regulated Donee   25000.00  ...                  16.0                 1.0                  4.0
4       C0000005     Regulated Donee    4200.00  ...                  16.0                 1.0                  4.0
...          ...                 ...        ...  ...                   ...                 ...                  ...
91336  NC0834238     Regulated Donee   10158.72  ...                  24.0                -5.0                  6.0
91337   C0834291     Political Party    2301.44  ...                  24.0                -5.0                  6.0
91338   V0834246     Regulated Donee    5700.00  ...                  25.0                -6.0                  7.0
91339  NC0834261     Regulated Donee    9750.00  ...                  22.0                -5.0                  6.0
91340   V0834245     Regulated Donee    3925.00  ...                  25.0                -6.0                  7.0

[91341 rows x 57 columns]
2026-01-30 19:07:44 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservative And Unionist Party': 52, 'Labour Party': 53, 'Liberal Democrats': 90, 'Liberal Party': 54, 'Scottish National Party (Snp)': 102, 'Green Party': 63, 'Plaid Cymru - Party Of Wales': 77, 'Reform UK': 7931, 'Uk Independence Party (Ukip)': 85, 'Your Party': 1506, 'Democratic Unionist Party': 60, 'Sinn Féin': 62, 'Ulster Unionist Party (Uup)': 59, 'Social Democratic And Labour Party': 61, 'Alliance Party Of Northern Ireland': 58, 'Unknown': 0}}
2026-01-30 19:07:44 +0000 DEBUG:imported_raw_fname: imported_raw.zip
2026-01-30 19:07:44 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, '\n    "output_dir": {\n        "cleaned_data_fname": "cleaned_data.csv",\n        "cleaned_donations_fname": "cleaned_donations.csv",\n        "cleaned_donorlist_fname": "cleaned_donorlist.csv",\n        "cleaned_regentity_fname": "cleaned_regentity.csv",\n        "party_summary_fname": "party_summary.csv",\n        "imported_raw_fname": "imported_raw.csv",\n    },\n    output_dir': {'cleaned_data_fname': 'cleaned_data.zip', 'cleaned_donations_fname': 'cleaned_donations.zip', 'cleaned_donorlist_fname': 'cleaned_donorlist.zip', 'cleaned_regentity_fname': 'cleaned_regentity.zip', 'party_summary_fname': 'party_summary.zip', 'imported_raw_fname': 'imported_raw.zip'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.zip'}}
2026-01-30 19:07:44 +0000 DEBUG:components_dir: H:\GitHub\dashboard_demo\components
2026-01-30 19:07:44 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2026-01-30 19:07:44 +0000 DEBUG:source_data_fname: H:\GitHub\dashboard_demo\source\Donations_accepted_by_political_parties.zip
2026-01-30 19:07:44 +0000 DEBUG:data_dir: H:\GitHub\dashboard_demo\data
2026-01-30 19:07:44 +0000 DEBUG:reference_dir: H:\GitHub\dashboard_demo\reference_files
2026-01-30 19:07:44 +0000 DEBUG:cleaned_data_fname: cleaned_data.zip
2026-01-30 19:07:44 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2026-01-30 19:07:44 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2026-01-30 19:07:44 +0000 DEBUG:regentity_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalEntityDeDuped.csv
2026-01-30 19:07:44 +0000 DEBUG:politician_party_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople_Final.csv
2026-01-30 19:07:44 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'H:\\GitHub\\dashboard_demo\\data', 'output_dir': 'H:\\GitHub\\dashboard_demo\\output', 'logs_dir': 'H:\\GitHub\\dashboard_demo\\logs', 'reference_dir': 'H:\\GitHub\\dashboard_demo\\reference_files', 'components_dir': 'H:\\GitHub\\dashboard_demo\\components', 'app_pages_dir': 'H:\\GitHub\\dashboard_demo\\app_pages', 'utils_dir': 'H:\\GitHub\\dashboard_demo\\utils', 'source_dir': 'H:\\GitHub\\dashboard_demo\\source', 'tests_dir': 'H:\\GitHub\\dashboard_demo\\tests'}
2026-01-30 19:07:44 +0000 DEBUG:output_dir: H:\GitHub\dashboard_demo\output
2026-01-30 19:07:44 +0000 DEBUG:CREDENTIALS_FILE: H:\GitHub\dashboard_demo\reference_files\admin_credentials.json
2026-01-30 19:07:44 +0000 DEBUG:min_date: 2001-01-01
2026-01-30 19:07:44 +0000 DEBUG:original_data_fname: H:\GitHub\dashboard_demo\reference_files\original_data.csv
2026-01-30 19:07:44 +0000 DEBUG:logs_dir: H:\GitHub\dashboard_demo\logs
2026-01-30 19:07:44 +0000 DEBUG:raw_data:            ECRef       OriginalRegulatedEntityName  ...   DonorId                                          DonorName
0       C0000001                        Charter 88  ...       1.0                   Joseph Rowntree Refrom Trust Ltd
1       C0000002                        Charter 88  ...       2.0                   Birkenhead North End Labour Club
2       C0000003     The Rt Hon Charles Kennedy Mp  ...       3.0                               Bord Institute Trust
3       C0000004     The Rt Hon Charles Kennedy Mp  ...       4.0                       Branksome Liberal Club Trust
4       C0000005     The Rt Hon Charles Kennedy Mp  ...       5.0                                   Bridgwater Trust
...          ...                               ...  ...       ...                                                ...
91336  NC0834238                   Dr Beccy Cooper  ...  104032.0  The British Society For Antimicrobial Chemothe...
91337   C0834291  Plaid Cymru - The Party Of Wales  ...  104056.0                           Llundain / London Branch
91338   V0834246                   Mark Garnier Mp  ...  104039.0  Ministry Of Foreign Affairs Of The State Of Qatar
91339  NC0834261                    David Simmonds  ...   93060.0  The Refugee Asylum And Migration Policy Projec...
91340   V0834245                   Mark Garnier Mp  ...  104038.0                         Great Britain China Centre

[91341 rows x 37 columns]
2026-01-30 19:07:44 +0000 DEBUG:app_pages_dir: H:\GitHub\dashboard_demo\app_pages
2026-01-30 19:07:44 +0000 DEBUG:Donor_dedupe_cleaned_fname: H:\GitHub\dashboard_demo\reference_files\Donor_dedupe_cleaned_data.csv
2026-01-30 19:07:44 +0000 DEBUG:electoral_cycle_rules: {(0, 30): 'Final Campaign Period', (31, 90): 'Campaign Build-Up', (91, 180): 'Pre-Campaign Phase', (181, 730): 'Early Cycle', (731, 3650): 'Mid-Cycle'}
2026-01-30 19:07:44 +0000 DEBUG:ListofPoliticalPeople_fname: H:\GitHub\dashboard_demo\reference_files\ListOfPoliticalPeople.csv
2026-01-30 19:07:44 +0000 DEBUG:party_summary_fname: party_summary.zip
2026-01-30 19:07:44 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
32065   104050.0                        Doha Forum          5985.00                1    5985.000000
32066   104051.0                    Martin Littler          5000.00                1    5000.000000
32067   104052.0                        Doha Forum          6155.00                1    6155.000000
32068   104056.0          Llundain / London Branch          2301.44                1    2301.440000
32069  1000001.0                Unidentified Donor       2357936.90              139   16963.574820

[32070 rows x 5 columns]
2026-01-30 19:07:44 +0000 DEBUG:LAST_MODIFIED_DATES: H:\GitHub\dashboard_demo\reference_files\last_modified_dates.json
2026-01-30 19:07:44 +0000 DEBUG:mppartymemb_fname: H:\GitHub\dashboard_demo\reference_files\mppartymemb_pypd.csv
2026-01-30 19:07:44 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 3): 'Small Entity', (4, 12): 'Medium Entity', (13, 10000): 'Large Entity'}
2026-01-30 19:07:44 +0000 DEBUG:cleaned_regentity_fname: cleaned_regentity.zip
2026-01-30 19:07:44 +0000 DEBUG:donor_map_fname: H:\GitHub\dashboard_demo\reference_files\PoliticalDonorsDeduped.csv
2026-01-30 19:07:44 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2026-01-30 19:07:44 +0000 DEBUG:cleaned_donations_fname: cleaned_donations.zip
2026-01-30 19:07:44 +0000 DEBUG:Cash_ftr: None
2026-01-30 19:07:44 +0000 DEBUG:cleaned_donorlist_fname: cleaned_donorlist.zip
2026-01-30 19:07:44 +0000 DEBUG:TEXT_FILE: H:\GitHub\dashboard_demo\reference_files\admin_text.json
2026-01-30 19:07:44 +0000 INFO:Session state Setup complete
2026-01-30 19:07:44 +0000 INFO:initialize_session_state executed successfully
2026-01-30 19:07:44 +0000 INFO:Package setup complete
2026-01-30 19:07:44 +0000 INFO:setup_package executed successfully
2026-01-30 19:07:44 +0000 INFO:Setup completed successfully.
2026-01-30 19:07:44 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2026-01-30 19:07:44 +0000 INFO:Running first load function.
2026-01-30 19:07:44 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2026-01-30 19:07:44 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 19:07:44 +0000 DEBUG:st.session_state.raw_data: 91341
2026-01-30 19:07:44 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 19:07:44 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 19:07:44 +0000 DEBUG:st.session_state.data_regentity: 2404
2026-01-30 19:07:44 +0000 DEBUG:st.session_state.data_donor: 32070
2026-01-30 19:07:44 +0000 DEBUG:st.session_state.data_clean: 91341
2026-01-30 19:07:44 +0000 INFO:firstload executed successfully
2026-01-30 19:07:44 +0000 INFO:Data first load completed successfully.
2026-01-30 19:07:44 +0000 INFO:initialise_data executed successfully
2026-01-30 19:07:44 +0000 INFO:Running Menu setup...
2026-01-30 19:07:44 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2026-01-30 19:07:44 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2026-01-30 19:07:44 +0000 INFO:get_git_version executed successfully
2026-01-30 19:07:44 +0000 INFO:App Version: v50.240
2026-01-30 19:07:44 +0000 INFO:Switched to page: Cash Donations
2026-01-30 19:07:44 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2026-01-30 19:07:44 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2026-01-30 19:07:45 +0000 INFO:load_and_filter_data executed successfully
2026-01-30 19:07:45 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 19:07:45 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 19:07:45 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 19:07:45 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 19:07:45 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 19:07:45 +0000 DEBUG:Page texts: {'Para1': {'text': 'Except for in 2016', 'is_deleted': False}, 'Para 2': {'text': 'More useful information', 'is_deleted': False}}
2026-01-30 19:07:45 +0000 DEBUG:Calling manage_text_elements with args={args}, kwargs={kwargs}
2026-01-30 19:07:45 +0000 DEBUG:Not logged in as admin.
2026-01-30 19:07:45 +0000 INFO:manage_text_elements executed successfully
2026-01-30 19:07:45 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 19:07:45 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 19:07:45 +0000 INFO:display_visualizations executed successfully
2026-01-30 19:07:45 +0000 INFO:display_data_page executed successfully
2026-01-30 19:07:45 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2026-01-30 19:07:46 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2026-01-30 19:07:46 +0000 INFO:display_summary_statistics executed successfully
2026-01-30 19:07:46 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2026-01-30 19:07:46 +0000 INFO:display_textual_insights_predefined executed successfully
2026-01-30 19:07:46 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2026-01-30 19:07:46 +0000 DEBUG:Page texts: {}
2026-01-30 19:07:46 +0000 INFO:display_textual_insights_custom executed successfully
2026-01-30 19:07:46 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2026-01-30 19:07:46 +0000 INFO:display_visualizations executed successfully
2026-01-30 19:07:46 +0000 INFO:display_per_group_data_page executed successfully
2026-01-30 19:07:46 +0000 INFO:pagesetup executed successfully
2026-01-30 19:07:46 +0000 INFO:Menu setup completed successfully.
2026-01-30 19:07:46 +0000 INFO:App is fully loaded and ready!
