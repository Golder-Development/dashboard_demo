2025/03/04 08:32:22 AM INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/04 08:32:22 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\utils',), kwargs={}
2025/03/04 08:32:23 AM INFO:get_git_version executed successfully
2025/03/04 08:32:23 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\data',), kwargs={}
2025/03/04 08:32:23 AM INFO:get_git_version executed successfully
2025/03/04 08:32:23 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:32:23 AM INFO:Running App setup...
2025/03/04 08:32:23 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:32:23 AM INFO:Setting up the package
2025/03/04 08:32:23 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:32:23 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:32:23 AM INFO:get_git_version executed successfully
2025/03/04 08:32:23 AM INFO:Version: v20.140
2025/03/04 08:32:23 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:32:23 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:32:23 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:32:23 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:32:23 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:32:23 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:32:23 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:32:23 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:32:23 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:32:23 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:32:23 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:32:23 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:32:23 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:32:23 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:32:23 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:32:24 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:32:24 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:32:24 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:32:24 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:32:24 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:32:24 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:32:24 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:32:24 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:32:24 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:32:24 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:32:24 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:32:24 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:32:24 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:32:24 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:32:24 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:32:24 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:32:24 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:32:24 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:32:24 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:32:24 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:32:24 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:32:24 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:32:24 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:32:24 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:32:24 AM INFO:Session_state variables initialized
2025/03/04 08:32:24 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:32:24 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:32:24 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:32:24 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:32:24 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:32:24 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:32:24 AM DEBUG:components_dir: components
2025/03/04 08:32:24 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:32:24 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:32:24 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:32:24 AM DEBUG:logs_dir: logs
2025/03/04 08:32:24 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:32:24 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:32:24 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:32:24 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:32:24 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:32:24 AM DEBUG:data_dir: data
2025/03/04 08:32:24 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:32:24 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:32:24 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:32:24 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:32:24 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:32:24 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:32:24 AM DEBUG:reference_dir: reference_files
2025/03/04 08:32:24 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:32:24 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:32:24 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:32:24 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:32:24 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:32:24 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:32:24 AM DEBUG:perc_target: 0.5
2025/03/04 08:32:24 AM DEBUG:output_dir: output
2025/03/04 08:32:24 AM DEBUG:utils_dir: utils
2025/03/04 08:32:24 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:32:24 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:32:24 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:32:24 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:32:24 AM INFO:Session state Setup complete
2025/03/04 08:32:24 AM INFO:initialize_session_state executed successfully
2025/03/04 08:32:24 AM INFO:Package setup complete
2025/03/04 08:32:24 AM INFO:setup_package executed successfully
2025/03/04 08:32:24 AM INFO:Running Menu setup...
2025/03/04 08:32:24 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:32:24 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\app_pages',), kwargs={}
2025/03/04 08:32:24 AM INFO:get_git_version executed successfully
2025/03/04 08:32:24 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\components',), kwargs={}
2025/03/04 08:32:24 AM INFO:get_git_version executed successfully
2025/03/04 08:32:24 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:32:24 AM INFO:get_git_version executed successfully
2025/03/04 08:32:24 AM INFO:App Version: v20.161
2025/03/04 08:32:24 AM INFO:Switched to page: Introduction
2025/03/04 08:32:24 AM INFO:pagesetup executed successfully
2025/03/04 08:32:24 AM INFO:No data found in session state, running firstload()
2025/03/04 08:32:24 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 08:32:24 AM INFO:Running first load function.
2025/03/04 08:32:24 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 08:32:24 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x0000021FACFCC670>), kwargs={}
2025/03/04 08:32:24 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 08:32:24 AM DEBUG:Calling load_raw_data with args=(), kwargs={'main_file': 'raw_data', 'cleaned_file': 'raw_data_clean', 'output_csv': True, 'dedupe_donors': True, 'dedupe_regentity': True, 'originaldatafilepath': 'source_data_fname', 'processeddatafilepath': 'imported_raw_fname'}
2025/03/04 08:32:24 AM DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/04 08:32:24 AM DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/04 08:32:24 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'source\\Donations_accepted_by_political_parties.csv', 'savedfilepath': 'output\\imported_raw.csv', 'timestamp_key': 'load_raw_data_last_modified'}
2025/03/04 08:32:24 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:32:24 AM INFO:Saved file path: output\imported_raw.csv
2025/03/04 08:32:24 AM DEBUG:Calling is_file_updated with args=('source\\Donations_accepted_by_political_parties.csv', 'load_raw_data_last_modified'), kwargs={}
2025/03/04 08:32:24 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 08:32:24 AM DEBUG:Calling get_file_modification_time with args=('source\\Donations_accepted_by_political_parties.csv',), kwargs={}
2025/03/04 08:32:24 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 08:32:24 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:32:24 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 08:32:24 AM INFO:Last modification time: None
2025/03/04 08:32:24 AM INFO:is_file_updated executed successfully
2025/03/04 08:32:24 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:32:24 AM INFO:Loading raw data...
2025/03/04 08:32:24 AM DEBUG:Original data file path post raw data load: {originaldatafilepath}
2025/03/04 08:32:24 AM DEBUG:Processed data file path post raw data load: {processeddatafilepath}
2025/03/04 08:32:25 AM INFO:Data loaded successfully. Data has 65278 rows and 29 columns
2025/03/04 08:32:25 AM INFO:Data saved to output\imported_raw.csv
2025/03/04 08:32:25 AM DEBUG:Calling raw_data_cleanup with args=(), kwargs={'loaddata_df':            ECRef              RegulatedEntityName    RegulatedEntityType        Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                               ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    £1,876.56   02/09/2019  ...              NaN  86310.0             NaN  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    £2,700.00   02/09/2019  ...              NaN  86310.0             NaN  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    £4,852.58   30/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    £2,500.00   30/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    £4,524.05   29/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
...          ...                              ...                    ...          ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   £10,000.00          NaN  ...              NaN  74198.0             NaN            NaN         False
65274   C0242461               Vote Leave Limited  Permitted Participant  £100,000.00          NaN  ...              NaN  74184.0             NaN            NaN         False
65275   C0243560               Vote Leave Limited  Permitted Participant   £40,000.00          NaN  ...              NaN  74576.0             NaN            NaN         False
65276   C0319710  Conservative and Unionist Party        Political Party   £50,000.00          NaN  ...              NaN  34241.0             NaN  Great Britain         False
65277   C0319727  Conservative and Unionist Party        Political Party   £15,000.00          NaN  ...              NaN  74743.0             NaN  Great Britain         False

[65278 rows x 29 columns], 'dedupe_donors': True, 'dedupe_regentity': True, 'output_csv': True, 'originaldatafilepath': 'output\\imported_raw.csv', 'processeddatafilepath': 'cleaned_donations_fname'}
2025/03/04 08:32:25 AM INFO:Cleaning up raw data
2025/03/04 08:32:25 AM ERROR:Session state variables not initialized!
2025/03/04 08:32:25 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': None, 'savedfilepath': 'output\\cleaned_donations.csv', 'timestamp_key': 'cleaned_raw_data_last_modified'}
2025/03/04 08:32:25 AM INFO:Original file path: None
2025/03/04 08:32:25 AM INFO:Saved file path: output\cleaned_donations.csv
2025/03/04 08:32:25 AM ERROR:Error: originalfilepath is None!
2025/03/04 08:32:25 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:32:25 AM INFO:Data loaded, shape: (65278, 29)
2025/03/04 08:32:27 AM DEBUG:Calling dedupe_entity_file with args=(), kwargs={'loaddata_dd_df':            ECRef              RegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                             ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...                   86310.0                  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...                   86310.0                  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...                   86310.0                  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...                   86310.0                  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...                   86310.0                  Great Britain         False
...          ...                              ...                    ...        ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...                   74198.0                          Other         False
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                   74184.0                          Other         False
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   74576.0                          Other         False
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                   34241.0                  Great Britain         False
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                   74743.0                  Great Britain         False

[65278 rows x 29 columns], 'entity': 'RegulatedEntity', 'map_filename': 'regentity_map_fname', 'output_csv': True}
2025/03/04 08:32:27 AM DEBUG:Calling is_file_updated with args=('reference_files\\PoliticalEntityDeDuped.csv', 'regentity_map_fname_last_modified'), kwargs={}
2025/03/04 08:32:27 AM INFO:Checking if reference_files\PoliticalEntityDeDuped.csv has been updated.
2025/03/04 08:32:27 AM DEBUG:Calling get_file_modification_time with args=('reference_files\\PoliticalEntityDeDuped.csv',), kwargs={}
2025/03/04 08:32:27 AM INFO:Getting modification time for reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:32:27 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:32:27 AM INFO:Current modification time: 1740841102.2638545
2025/03/04 08:32:27 AM INFO:Last modification time: None
2025/03/04 08:32:27 AM INFO:is_file_updated executed successfully
2025/03/04 08:32:27 AM INFO:Map file regentity_map_fname has been updated. Proceeding with deduplication.
2025/03/04 08:32:27 AM INFO:File deduplication complete, shape: (65278, 34)
2025/03/04 08:32:27 AM INFO:dedupe_entity_file executed successfully
2025/03/04 08:32:27 AM DEBUG:Calling dedupe_entity_file with args=(), kwargs={'loaddata_dd_df':            ECRef      OriginalRegulatedEntityName    RegulatedEntityType  ...      OriginalRegulatedEntityName RegulatedEntityId              RegulatedEntityName
0      NC0408174                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
1      NC0408173                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
2      NC0408177                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
3      NC0408176                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
4      NC0408170                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
...          ...                              ...                    ...  ...                              ...               ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65274   C0242461               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65275   C0243560               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65276   C0319710  Conservative And Unionist Party        Political Party  ...  Conservative And Unionist Party              52.0  Conservative And Unionist Party
65277   C0319727  Conservative And Unionist Party        Political Party  ...  Conservative And Unionist Party              52.0  Conservative And Unionist Party

[65278 rows x 34 columns], 'entity': 'Donor', 'map_filename': 'donor_map_fname', 'output_csv': True}
2025/03/04 08:32:27 AM DEBUG:Calling is_file_updated with args=('reference_files\\PoliticalDonorsDeduped.csv', 'donor_map_fname_last_modified'), kwargs={}
2025/03/04 08:32:27 AM INFO:Checking if reference_files\PoliticalDonorsDeduped.csv has been updated.
2025/03/04 08:32:27 AM DEBUG:Calling get_file_modification_time with args=('reference_files\\PoliticalDonorsDeduped.csv',), kwargs={}
2025/03/04 08:32:27 AM INFO:Getting modification time for reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:32:27 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:32:27 AM INFO:Current modification time: 1740757863.2545311
2025/03/04 08:32:27 AM INFO:Last modification time: None
2025/03/04 08:32:27 AM INFO:is_file_updated executed successfully
2025/03/04 08:32:27 AM INFO:Map file donor_map_fname has been updated. Proceeding with deduplication.
2025/03/04 08:32:27 AM INFO:File deduplication complete, shape: (65278, 40)
2025/03/04 08:32:27 AM INFO:dedupe_entity_file executed successfully
2025/03/04 08:32:27 AM INFO:Raw Data cleanup completed
2025/03/04 08:32:27 AM INFO:Data shape: (65278, 40)
2025/03/04 08:32:28 AM INFO:Data saved to output\cleaned_donations.csv
2025/03/04 08:32:28 AM INFO:Data cleanup completed, shape: (65278, 40)
2025/03/04 08:32:28 AM INFO:raw_data_cleanup executed successfully
2025/03/04 08:32:29 AM INFO:load_raw_data executed successfully
2025/03/04 08:32:29 AM INFO:get_raw_data executed successfully
2025/03/04 08:32:29 AM INFO:load_data_to_session executed successfully
2025/03/04 08:32:29 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x0000021FACFCC700>), kwargs={}
2025/03/04 08:32:29 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 08:32:29 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 08:32:29 AM DEBUG:Rows in Raw Data: 65278
2025/03/04 08:32:29 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'output\\cleaned_donations.csv', 'savedfilepath': 'output\\cleaned_data.csv', 'timestamp_key': 'load_raw_data_last_modified'}
2025/03/04 08:32:29 AM INFO:Original file path: output\cleaned_donations.csv
2025/03/04 08:32:29 AM INFO:Saved file path: output\cleaned_data.csv
2025/03/04 08:32:29 AM DEBUG:Calling is_file_updated with args=('output\\cleaned_donations.csv', 'load_raw_data_last_modified'), kwargs={}
2025/03/04 08:32:29 AM INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/04 08:32:29 AM DEBUG:Calling get_file_modification_time with args=('output\\cleaned_donations.csv',), kwargs={}
2025/03/04 08:32:29 AM INFO:Getting modification time for output\cleaned_donations.csv
2025/03/04 08:32:29 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:32:29 AM INFO:Current modification time: 1741077148.9387336
2025/03/04 08:32:29 AM INFO:Last modification time: 1740757862.6744745
2025/03/04 08:32:29 AM INFO:is_file_updated executed successfully
2025/03/04 08:32:29 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:32:29 AM ERROR:Error in load_cleaned_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 42, in load_cleaned_data
    logger.debug(f"Clean Data Prep: loaddata_df records: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:32:29 AM ERROR:Error in get_cleaned_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 42, in load_cleaned_data
    logger.debug(f"Clean Data Prep: loaddata_df records: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:32:29 AM ERROR:Error in load_data_to_session: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 42, in load_cleaned_data
    logger.debug(f"Clean Data Prep: loaddata_df records: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:32:29 AM ERROR:Error in firstload: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 42, in load_cleaned_data
    logger.debug(f"Clean Data Prep: loaddata_df records: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:32:29 AM ERROR:Error in initialise_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 42, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 42, in load_cleaned_data
    logger.debug(f"Clean Data Prep: loaddata_df records: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:33:32 AM INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/04 08:33:32 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\utils',), kwargs={}
2025/03/04 08:33:33 AM INFO:get_git_version executed successfully
2025/03/04 08:33:33 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\data',), kwargs={}
2025/03/04 08:33:33 AM INFO:get_git_version executed successfully
2025/03/04 08:33:33 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:33:33 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:33:33 AM INFO:Running App setup...
2025/03/04 08:33:33 AM INFO:Running App setup...
2025/03/04 08:33:33 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:33:33 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:33:33 AM INFO:Setting up the package
2025/03/04 08:33:33 AM INFO:Setting up the package
2025/03/04 08:33:33 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:33:33 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:33:33 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:33:33 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:33:33 AM INFO:get_git_version executed successfully
2025/03/04 08:33:33 AM INFO:get_git_version executed successfully
2025/03/04 08:33:33 AM INFO:Version: v20.140
2025/03/04 08:33:33 AM INFO:Version: v20.140
2025/03/04 08:33:33 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:33:33 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:33:33 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:33:33 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:33:33 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:33:33 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:33:33 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:33:33 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:33:33 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:33:33 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:33:33 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:33:33 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:33:33 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:33:33 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:33:33 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:33:33 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:33:33 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:33:33 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:33:33 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:33:33 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:33:33 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:33:33 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:33:33 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:33:33 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:33:33 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:33:33 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:33:33 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:33:33 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:33:33 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:33:33 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:33:33 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:33:33 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:33:33 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:33:33 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:33:33 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:33:33 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:33:33 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:33:33 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:33:33 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:33:33 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:33:33 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:33:33 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:33:33 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:33:33 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:33:33 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:33:33 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:33:33 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:33:33 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:33:33 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:33:34 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:33:34 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:33:34 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:33:34 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:33:34 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:33:34 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:33:34 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:33:34 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:33:34 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:33:34 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:33:34 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:33:34 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:33:34 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:33:34 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:33:34 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:33:34 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:33:34 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:33:34 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:33:34 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:33:34 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:33:34 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:33:34 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:33:34 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:33:34 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:33:34 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:33:34 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:33:34 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:33:34 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:33:34 AM INFO:Session_state variables initialized
2025/03/04 08:33:34 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:33:34 AM DEBUG:output_dir: output
2025/03/04 08:33:34 AM INFO:Session_state variables initialized
2025/03/04 08:33:34 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:33:34 AM DEBUG:output_dir: output
2025/03/04 08:33:34 AM DEBUG:utils_dir: utils
2025/03/04 08:33:34 AM DEBUG:data_dir: data
2025/03/04 08:33:34 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:33:34 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:33:34 AM DEBUG:utils_dir: utils
2025/03/04 08:33:34 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:33:34 AM DEBUG:data_dir: data
2025/03/04 08:33:34 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:33:34 AM DEBUG:components_dir: components
2025/03/04 08:33:34 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:33:34 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:33:34 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:33:34 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:33:34 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:33:34 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:33:34 AM DEBUG:components_dir: components
2025/03/04 08:33:34 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:33:34 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:33:34 AM DEBUG:reference_dir: reference_files
2025/03/04 08:33:34 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:33:34 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:33:34 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:33:34 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:33:34 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:33:34 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:33:34 AM DEBUG:reference_dir: reference_files
2025/03/04 08:33:34 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:33:34 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:33:34 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:33:34 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:33:34 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:33:34 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:33:34 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:33:34 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:33:34 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:33:34 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:33:34 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:33:34 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:33:34 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:33:34 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:33:34 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:33:34 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:33:34 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:33:34 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:33:34 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:33:34 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:33:34 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:33:34 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:33:34 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:33:34 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:33:34 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:33:34 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:33:34 AM DEBUG:perc_target: 0.5
2025/03/04 08:33:34 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:33:34 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:33:34 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:33:34 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:33:34 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:33:34 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:33:34 AM DEBUG:perc_target: 0.5
2025/03/04 08:33:34 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:33:34 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:33:34 AM DEBUG:logs_dir: logs
2025/03/04 08:33:34 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:33:34 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:33:34 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:33:34 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:33:34 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:33:34 AM INFO:Session state Setup complete
2025/03/04 08:33:34 AM DEBUG:logs_dir: logs
2025/03/04 08:33:34 AM INFO:initialize_session_state executed successfully
2025/03/04 08:33:34 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:33:34 AM INFO:Package setup complete
2025/03/04 08:33:34 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:33:34 AM INFO:setup_package executed successfully
2025/03/04 08:33:34 AM INFO:Session state Setup complete
2025/03/04 08:33:34 AM INFO:initialize_session_state executed successfully
2025/03/04 08:33:34 AM INFO:Running Menu setup...
2025/03/04 08:33:34 AM INFO:Package setup complete
2025/03/04 08:33:34 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:33:34 AM INFO:setup_package executed successfully
2025/03/04 08:33:34 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\app_pages',), kwargs={}
2025/03/04 08:33:34 AM INFO:Running Menu setup...
2025/03/04 08:33:34 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:33:34 AM INFO:get_git_version executed successfully
2025/03/04 08:33:34 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\components',), kwargs={}
2025/03/04 08:33:34 AM INFO:get_git_version executed successfully
2025/03/04 08:33:34 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:33:34 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:33:34 AM INFO:get_git_version executed successfully
2025/03/04 08:33:34 AM INFO:get_git_version executed successfully
2025/03/04 08:33:34 AM INFO:App Version: v20.161
2025/03/04 08:33:34 AM INFO:App Version: v20.161
2025/03/04 08:33:34 AM INFO:Switched to page: Introduction
2025/03/04 08:33:34 AM INFO:Switched to page: Introduction
2025/03/04 08:33:34 AM INFO:pagesetup executed successfully
2025/03/04 08:33:34 AM INFO:pagesetup executed successfully
2025/03/04 08:33:34 AM INFO:No data found in session state, running firstload()
2025/03/04 08:33:34 AM INFO:No data found in session state, running firstload()
2025/03/04 08:33:34 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 08:33:34 AM INFO:Running first load function.
2025/03/04 08:33:34 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 08:33:34 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x000001D946EB1510>), kwargs={}
2025/03/04 08:33:34 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 08:33:34 AM DEBUG:Calling load_raw_data with args=(), kwargs={'main_file': 'raw_data', 'cleaned_file': 'raw_data_clean', 'output_csv': True, 'dedupe_donors': True, 'dedupe_regentity': True, 'originaldatafilepath': 'source_data_fname', 'processeddatafilepath': 'imported_raw_fname'}
2025/03/04 08:33:34 AM DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/04 08:33:34 AM DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/04 08:33:34 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'source\\Donations_accepted_by_political_parties.csv', 'savedfilepath': 'output\\imported_raw.csv', 'timestamp_key': 'load_raw_data_last_modified'}
2025/03/04 08:33:34 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:33:34 AM INFO:Saved file path: output\imported_raw.csv
2025/03/04 08:33:34 AM DEBUG:Calling is_file_updated with args=('source\\Donations_accepted_by_political_parties.csv', 'load_raw_data_last_modified'), kwargs={}
2025/03/04 08:33:34 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 08:33:34 AM DEBUG:Calling get_file_modification_time with args=('source\\Donations_accepted_by_political_parties.csv',), kwargs={}
2025/03/04 08:33:34 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 08:33:34 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:33:34 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 08:33:34 AM INFO:Last modification time: None
2025/03/04 08:33:34 AM INFO:is_file_updated executed successfully
2025/03/04 08:33:34 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:33:34 AM INFO:Loading raw data...
2025/03/04 08:33:34 AM DEBUG:Original data file path post raw data load: {originaldatafilepath}
2025/03/04 08:33:34 AM DEBUG:Processed data file path post raw data load: {processeddatafilepath}
2025/03/04 08:33:35 AM INFO:Data loaded successfully. Data has 65278 rows and 29 columns
2025/03/04 08:33:35 AM INFO:Data saved to output\imported_raw.csv
2025/03/04 08:33:35 AM DEBUG:Calling raw_data_cleanup with args=(), kwargs={'loaddata_df':            ECRef              RegulatedEntityName    RegulatedEntityType        Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                               ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    £1,876.56   02/09/2019  ...              NaN  86310.0             NaN  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    £2,700.00   02/09/2019  ...              NaN  86310.0             NaN  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    £4,852.58   30/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    £2,500.00   30/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    £4,524.05   29/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
...          ...                              ...                    ...          ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   £10,000.00          NaN  ...              NaN  74198.0             NaN            NaN         False
65274   C0242461               Vote Leave Limited  Permitted Participant  £100,000.00          NaN  ...              NaN  74184.0             NaN            NaN         False
65275   C0243560               Vote Leave Limited  Permitted Participant   £40,000.00          NaN  ...              NaN  74576.0             NaN            NaN         False
65276   C0319710  Conservative and Unionist Party        Political Party   £50,000.00          NaN  ...              NaN  34241.0             NaN  Great Britain         False
65277   C0319727  Conservative and Unionist Party        Political Party   £15,000.00          NaN  ...              NaN  74743.0             NaN  Great Britain         False

[65278 rows x 29 columns], 'dedupe_donors': True, 'dedupe_regentity': True, 'output_csv': True, 'originaldatafilepath': 'output\\imported_raw.csv', 'processeddatafilepath': 'cleaned_donations_fname'}
2025/03/04 08:33:35 AM INFO:Cleaning up raw data
2025/03/04 08:33:35 AM ERROR:Session state variables not initialized!
2025/03/04 08:33:35 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': None, 'savedfilepath': 'output\\cleaned_donations.csv', 'timestamp_key': 'cleaned_raw_data_last_modified'}
2025/03/04 08:33:35 AM INFO:Original file path: None
2025/03/04 08:33:35 AM INFO:Saved file path: output\cleaned_donations.csv
2025/03/04 08:33:35 AM ERROR:Error: originalfilepath is None!
2025/03/04 08:33:35 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:33:35 AM INFO:Data loaded, shape: (65278, 29)
2025/03/04 08:33:37 AM DEBUG:Calling dedupe_entity_file with args=(), kwargs={'loaddata_dd_df':            ECRef              RegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                             ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...                   86310.0                  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...                   86310.0                  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...                   86310.0                  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...                   86310.0                  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...                   86310.0                  Great Britain         False
...          ...                              ...                    ...        ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...                   74198.0                          Other         False
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                   74184.0                          Other         False
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   74576.0                          Other         False
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                   34241.0                  Great Britain         False
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                   74743.0                  Great Britain         False

[65278 rows x 29 columns], 'entity': 'RegulatedEntity', 'map_filename': 'regentity_map_fname', 'output_csv': True}
2025/03/04 08:33:37 AM DEBUG:Calling is_file_updated with args=('reference_files\\PoliticalEntityDeDuped.csv', 'regentity_map_fname_last_modified'), kwargs={}
2025/03/04 08:33:37 AM INFO:Checking if reference_files\PoliticalEntityDeDuped.csv has been updated.
2025/03/04 08:33:37 AM DEBUG:Calling get_file_modification_time with args=('reference_files\\PoliticalEntityDeDuped.csv',), kwargs={}
2025/03/04 08:33:37 AM INFO:Getting modification time for reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:33:37 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:33:37 AM INFO:Current modification time: 1740841102.2638545
2025/03/04 08:33:37 AM INFO:Last modification time: None
2025/03/04 08:33:37 AM INFO:is_file_updated executed successfully
2025/03/04 08:33:37 AM INFO:Map file regentity_map_fname has been updated. Proceeding with deduplication.
2025/03/04 08:33:37 AM INFO:File deduplication complete, shape: (65278, 34)
2025/03/04 08:33:37 AM INFO:dedupe_entity_file executed successfully
2025/03/04 08:33:37 AM DEBUG:Calling dedupe_entity_file with args=(), kwargs={'loaddata_dd_df':            ECRef      OriginalRegulatedEntityName    RegulatedEntityType  ...      OriginalRegulatedEntityName RegulatedEntityId              RegulatedEntityName
0      NC0408174                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
1      NC0408173                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
2      NC0408177                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
3      NC0408176                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
4      NC0408170                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
...          ...                              ...                    ...  ...                              ...               ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65274   C0242461               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65275   C0243560               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65276   C0319710  Conservative And Unionist Party        Political Party  ...  Conservative And Unionist Party              52.0  Conservative And Unionist Party
65277   C0319727  Conservative And Unionist Party        Political Party  ...  Conservative And Unionist Party              52.0  Conservative And Unionist Party

[65278 rows x 34 columns], 'entity': 'Donor', 'map_filename': 'donor_map_fname', 'output_csv': True}
2025/03/04 08:33:37 AM DEBUG:Calling is_file_updated with args=('reference_files\\PoliticalDonorsDeduped.csv', 'donor_map_fname_last_modified'), kwargs={}
2025/03/04 08:33:37 AM INFO:Checking if reference_files\PoliticalDonorsDeduped.csv has been updated.
2025/03/04 08:33:37 AM DEBUG:Calling get_file_modification_time with args=('reference_files\\PoliticalDonorsDeduped.csv',), kwargs={}
2025/03/04 08:33:37 AM INFO:Getting modification time for reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:33:37 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:33:37 AM INFO:Current modification time: 1740757863.2545311
2025/03/04 08:33:37 AM INFO:Last modification time: None
2025/03/04 08:33:37 AM INFO:is_file_updated executed successfully
2025/03/04 08:33:37 AM INFO:Map file donor_map_fname has been updated. Proceeding with deduplication.
2025/03/04 08:33:37 AM INFO:File deduplication complete, shape: (65278, 40)
2025/03/04 08:33:37 AM INFO:dedupe_entity_file executed successfully
2025/03/04 08:33:37 AM INFO:Raw Data cleanup completed
2025/03/04 08:33:37 AM INFO:Data shape: (65278, 40)
2025/03/04 08:33:38 AM INFO:Data saved to output\cleaned_donations.csv
2025/03/04 08:33:38 AM INFO:Data cleanup completed, shape: (65278, 40)
2025/03/04 08:33:38 AM INFO:raw_data_cleanup executed successfully
2025/03/04 08:33:39 AM INFO:load_raw_data executed successfully
2025/03/04 08:33:39 AM INFO:get_raw_data executed successfully
2025/03/04 08:33:39 AM INFO:load_data_to_session executed successfully
2025/03/04 08:33:39 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x000001D946EB15A0>), kwargs={}
2025/03/04 08:33:39 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 08:33:39 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 08:33:39 AM DEBUG:Rows in Raw Data: 65278
2025/03/04 08:33:39 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'output\\cleaned_donations.csv', 'savedfilepath': 'output\\cleaned_data.csv', 'timestamp_key': 'load_raw_data_last_modified'}
2025/03/04 08:33:39 AM INFO:Original file path: output\cleaned_donations.csv
2025/03/04 08:33:39 AM INFO:Saved file path: output\cleaned_data.csv
2025/03/04 08:33:39 AM DEBUG:Calling is_file_updated with args=('output\\cleaned_donations.csv', 'load_raw_data_last_modified'), kwargs={}
2025/03/04 08:33:39 AM INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/04 08:33:39 AM DEBUG:Calling get_file_modification_time with args=('output\\cleaned_donations.csv',), kwargs={}
2025/03/04 08:33:39 AM INFO:Getting modification time for output\cleaned_donations.csv
2025/03/04 08:33:39 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:33:39 AM INFO:Current modification time: 1741077218.9491327
2025/03/04 08:33:39 AM INFO:Last modification time: 1740757862.6744745
2025/03/04 08:33:39 AM INFO:is_file_updated executed successfully
2025/03/04 08:33:39 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:33:39 AM ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/04 08:33:39 AM ERROR:Error in load_cleaned_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 44, in load_cleaned_data
    logger.debug(f"Clean Data Prep: loaddata_df records: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:33:39 AM ERROR:Error in get_cleaned_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 44, in load_cleaned_data
    logger.debug(f"Clean Data Prep: loaddata_df records: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:33:39 AM ERROR:Error in load_data_to_session: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 44, in load_cleaned_data
    logger.debug(f"Clean Data Prep: loaddata_df records: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:33:39 AM ERROR:Error in firstload: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 44, in load_cleaned_data
    logger.debug(f"Clean Data Prep: loaddata_df records: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:33:39 AM ERROR:Error in initialise_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 42, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 44, in load_cleaned_data
    logger.debug(f"Clean Data Prep: loaddata_df records: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:33:39 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 08:33:39 AM INFO:Running first load function.
2025/03/04 08:33:39 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 08:33:39 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x000001D946EB1510>), kwargs={}
2025/03/04 08:33:39 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 08:33:39 AM INFO:get_raw_data executed successfully
2025/03/04 08:33:39 AM INFO:load_data_to_session executed successfully
2025/03/04 08:33:39 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x000001D946EB15A0>), kwargs={}
2025/03/04 08:33:39 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 08:33:39 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 08:33:39 AM DEBUG:Rows in Raw Data: 65278
2025/03/04 08:33:39 AM ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/04 08:33:39 AM ERROR:Error in load_cleaned_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 44, in load_cleaned_data
    logger.debug(f"Clean Data Prep: loaddata_df records: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:33:39 AM ERROR:Error in get_cleaned_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 44, in load_cleaned_data
    logger.debug(f"Clean Data Prep: loaddata_df records: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:33:39 AM ERROR:Error in load_data_to_session: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 44, in load_cleaned_data
    logger.debug(f"Clean Data Prep: loaddata_df records: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:33:39 AM ERROR:Error in firstload: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 44, in load_cleaned_data
    logger.debug(f"Clean Data Prep: loaddata_df records: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:33:39 AM ERROR:Error in initialise_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 42, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 44, in load_cleaned_data
    logger.debug(f"Clean Data Prep: loaddata_df records: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:34:41 AM INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/04 08:34:41 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\utils',), kwargs={}
2025/03/04 08:34:42 AM INFO:get_git_version executed successfully
2025/03/04 08:34:43 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\data',), kwargs={}
2025/03/04 08:34:43 AM INFO:get_git_version executed successfully
2025/03/04 08:34:43 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:34:43 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:34:43 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:34:43 AM INFO:Running App setup...
2025/03/04 08:34:43 AM INFO:Running App setup...
2025/03/04 08:34:43 AM INFO:Running App setup...
2025/03/04 08:34:43 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:34:43 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:34:43 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:34:43 AM INFO:Setting up the package
2025/03/04 08:34:43 AM INFO:Setting up the package
2025/03/04 08:34:43 AM INFO:Setting up the package
2025/03/04 08:34:43 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:34:43 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:34:43 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:34:43 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:34:43 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:34:43 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:34:43 AM INFO:get_git_version executed successfully
2025/03/04 08:34:43 AM INFO:get_git_version executed successfully
2025/03/04 08:34:43 AM INFO:get_git_version executed successfully
2025/03/04 08:34:43 AM INFO:Version: v20.140
2025/03/04 08:34:43 AM INFO:Version: v20.140
2025/03/04 08:34:43 AM INFO:Version: v20.140
2025/03/04 08:34:43 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:34:43 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:34:43 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:34:43 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:34:43 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:34:43 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:34:43 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:34:43 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:34:43 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:34:43 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:34:43 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:34:43 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:34:43 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:34:43 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:34:43 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:34:43 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:34:43 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:34:43 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:34:43 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:34:43 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:34:43 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:34:43 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:34:43 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:34:43 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:34:43 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:34:43 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:34:43 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:34:43 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:34:43 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:34:43 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:34:43 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:34:43 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:34:43 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:34:43 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:34:43 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:34:43 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:34:43 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:34:43 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:34:43 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:34:43 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:34:43 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:34:43 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:34:43 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:34:43 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:34:43 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:34:43 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:34:43 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:34:43 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:34:43 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:34:43 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:34:43 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:34:43 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:34:43 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:34:43 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:34:43 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:34:43 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:34:43 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:34:43 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:34:43 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:34:43 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:34:43 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:34:43 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:34:43 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:34:43 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:34:43 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:34:43 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:34:43 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:34:43 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:34:43 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:34:43 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:34:43 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:34:43 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:34:43 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:34:43 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:34:43 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:34:43 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:34:43 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:34:43 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:34:43 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:34:43 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:34:43 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:34:43 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:34:43 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:34:43 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:34:43 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:34:43 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:34:43 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:34:43 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:34:43 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:34:43 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:34:43 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:34:43 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:34:43 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:34:43 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:34:43 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:34:43 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:34:43 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:34:43 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:34:43 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:34:43 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:34:43 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:34:43 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:34:43 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:34:43 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:34:43 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:34:43 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:34:43 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:34:43 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:34:43 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:34:43 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:34:43 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:34:43 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:34:43 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:34:43 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:34:43 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:34:43 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:34:43 AM INFO:Session_state variables initialized
2025/03/04 08:34:43 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:34:43 AM INFO:Session_state variables initialized
2025/03/04 08:34:43 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:34:43 AM INFO:Session_state variables initialized
2025/03/04 08:34:43 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:34:43 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:34:43 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:34:43 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:34:43 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:34:43 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:34:43 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:34:43 AM DEBUG:output_dir: output
2025/03/04 08:34:43 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:34:43 AM DEBUG:output_dir: output
2025/03/04 08:34:43 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:34:43 AM DEBUG:output_dir: output
2025/03/04 08:34:43 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:34:43 AM DEBUG:logs_dir: logs
2025/03/04 08:34:43 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:34:43 AM DEBUG:logs_dir: logs
2025/03/04 08:34:43 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:34:43 AM DEBUG:logs_dir: logs
2025/03/04 08:34:43 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:34:43 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:34:43 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:34:43 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:34:43 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:34:43 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:34:43 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:34:43 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:34:43 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:34:43 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:34:43 AM DEBUG:data_dir: data
2025/03/04 08:34:43 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:34:43 AM DEBUG:data_dir: data
2025/03/04 08:34:43 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:34:43 AM DEBUG:data_dir: data
2025/03/04 08:34:43 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:34:43 AM DEBUG:utils_dir: utils
2025/03/04 08:34:43 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:34:43 AM DEBUG:utils_dir: utils
2025/03/04 08:34:43 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:34:43 AM DEBUG:utils_dir: utils
2025/03/04 08:34:43 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:34:43 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:34:43 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:34:43 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:34:43 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:34:43 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:34:43 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:34:43 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:34:43 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:34:43 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:34:43 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:34:43 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:34:43 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:34:43 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:34:43 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:34:43 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:34:43 AM DEBUG:perc_target: 0.5
2025/03/04 08:34:43 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:34:43 AM DEBUG:perc_target: 0.5
2025/03/04 08:34:43 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:34:43 AM DEBUG:perc_target: 0.5
2025/03/04 08:34:43 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:34:43 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:34:43 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:34:43 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:34:43 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:34:43 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:34:43 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:34:43 AM DEBUG:reference_dir: reference_files
2025/03/04 08:34:43 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:34:43 AM DEBUG:reference_dir: reference_files
2025/03/04 08:34:43 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:34:43 AM DEBUG:reference_dir: reference_files
2025/03/04 08:34:43 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:34:43 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:34:43 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:34:43 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:34:43 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:34:43 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:34:43 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:34:43 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:34:43 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:34:43 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:34:43 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:34:43 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:34:43 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:34:43 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:34:43 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:34:43 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:34:43 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:34:43 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:34:43 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:34:43 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:34:43 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:34:43 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:34:43 AM DEBUG:components_dir: components
2025/03/04 08:34:43 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:34:43 AM DEBUG:components_dir: components
2025/03/04 08:34:43 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:34:43 AM DEBUG:components_dir: components
2025/03/04 08:34:43 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:34:43 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:34:43 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:34:43 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:34:43 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:34:43 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:34:43 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:34:43 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:34:43 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:34:43 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:34:43 AM INFO:Session state Setup complete
2025/03/04 08:34:43 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:34:43 AM INFO:Session state Setup complete
2025/03/04 08:34:43 AM INFO:initialize_session_state executed successfully
2025/03/04 08:34:43 AM INFO:Session state Setup complete
2025/03/04 08:34:43 AM INFO:initialize_session_state executed successfully
2025/03/04 08:34:43 AM INFO:Package setup complete
2025/03/04 08:34:43 AM INFO:initialize_session_state executed successfully
2025/03/04 08:34:43 AM INFO:Package setup complete
2025/03/04 08:34:43 AM INFO:setup_package executed successfully
2025/03/04 08:34:43 AM INFO:Package setup complete
2025/03/04 08:34:43 AM INFO:setup_package executed successfully
2025/03/04 08:34:43 AM INFO:setup_package executed successfully
2025/03/04 08:34:43 AM INFO:Running Menu setup...
2025/03/04 08:34:43 AM INFO:Running Menu setup...
2025/03/04 08:34:43 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:34:43 AM INFO:Running Menu setup...
2025/03/04 08:34:43 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:34:43 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:34:43 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\app_pages',), kwargs={}
2025/03/04 08:34:43 AM INFO:get_git_version executed successfully
2025/03/04 08:34:43 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\components',), kwargs={}
2025/03/04 08:34:43 AM INFO:get_git_version executed successfully
2025/03/04 08:34:43 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:34:43 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:34:43 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:34:43 AM INFO:get_git_version executed successfully
2025/03/04 08:34:43 AM INFO:get_git_version executed successfully
2025/03/04 08:34:43 AM INFO:get_git_version executed successfully
2025/03/04 08:34:43 AM INFO:App Version: v20.161
2025/03/04 08:34:43 AM INFO:App Version: v20.161
2025/03/04 08:34:43 AM INFO:App Version: v20.161
2025/03/04 08:34:43 AM INFO:Switched to page: Introduction
2025/03/04 08:34:43 AM INFO:Switched to page: Introduction
2025/03/04 08:34:43 AM INFO:Switched to page: Introduction
2025/03/04 08:34:43 AM INFO:pagesetup executed successfully
2025/03/04 08:34:43 AM INFO:pagesetup executed successfully
2025/03/04 08:34:43 AM INFO:pagesetup executed successfully
2025/03/04 08:34:43 AM INFO:No data found in session state, running firstload()
2025/03/04 08:34:43 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 08:34:43 AM INFO:No data found in session state, running firstload()
2025/03/04 08:34:43 AM INFO:No data found in session state, running firstload()
2025/03/04 08:34:44 AM INFO:Running first load function.
2025/03/04 08:34:44 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 08:34:44 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x0000021EEE6CDFC0>), kwargs={}
2025/03/04 08:34:44 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 08:34:44 AM DEBUG:Calling load_raw_data with args=(), kwargs={'main_file': 'raw_data', 'cleaned_file': 'raw_data_clean', 'output_csv': True, 'dedupe_donors': True, 'dedupe_regentity': True, 'originaldatafilepath': 'source_data_fname', 'processeddatafilepath': 'imported_raw_fname'}
2025/03/04 08:34:44 AM DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/04 08:34:44 AM DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/04 08:34:44 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'source\\Donations_accepted_by_political_parties.csv', 'savedfilepath': 'output\\imported_raw.csv', 'timestamp_key': 'load_raw_data_last_modified'}
2025/03/04 08:34:44 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:34:44 AM INFO:Saved file path: output\imported_raw.csv
2025/03/04 08:34:44 AM DEBUG:Calling is_file_updated with args=('source\\Donations_accepted_by_political_parties.csv', 'load_raw_data_last_modified'), kwargs={}
2025/03/04 08:34:44 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 08:34:44 AM DEBUG:Calling get_file_modification_time with args=('source\\Donations_accepted_by_political_parties.csv',), kwargs={}
2025/03/04 08:34:44 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 08:34:44 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:34:44 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 08:34:44 AM INFO:Last modification time: None
2025/03/04 08:34:44 AM INFO:is_file_updated executed successfully
2025/03/04 08:34:44 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:34:44 AM INFO:Loading raw data...
2025/03/04 08:34:44 AM DEBUG:Original data file path post raw data load: {originaldatafilepath}
2025/03/04 08:34:44 AM DEBUG:Processed data file path post raw data load: {processeddatafilepath}
2025/03/04 08:34:44 AM INFO:Data loaded successfully. Data has 65278 rows and 29 columns
2025/03/04 08:34:45 AM INFO:Data saved to output\imported_raw.csv
2025/03/04 08:34:45 AM DEBUG:Calling raw_data_cleanup with args=(), kwargs={'loaddata_df':            ECRef              RegulatedEntityName    RegulatedEntityType        Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                               ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    £1,876.56   02/09/2019  ...              NaN  86310.0             NaN  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    £2,700.00   02/09/2019  ...              NaN  86310.0             NaN  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    £4,852.58   30/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    £2,500.00   30/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    £4,524.05   29/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
...          ...                              ...                    ...          ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   £10,000.00          NaN  ...              NaN  74198.0             NaN            NaN         False
65274   C0242461               Vote Leave Limited  Permitted Participant  £100,000.00          NaN  ...              NaN  74184.0             NaN            NaN         False
65275   C0243560               Vote Leave Limited  Permitted Participant   £40,000.00          NaN  ...              NaN  74576.0             NaN            NaN         False
65276   C0319710  Conservative and Unionist Party        Political Party   £50,000.00          NaN  ...              NaN  34241.0             NaN  Great Britain         False
65277   C0319727  Conservative and Unionist Party        Political Party   £15,000.00          NaN  ...              NaN  74743.0             NaN  Great Britain         False

[65278 rows x 29 columns], 'dedupe_donors': True, 'dedupe_regentity': True, 'output_csv': True, 'originaldatafilepath': 'output\\imported_raw.csv', 'processeddatafilepath': 'cleaned_donations_fname'}
2025/03/04 08:34:45 AM INFO:Cleaning up raw data
2025/03/04 08:34:45 AM ERROR:Session state variables not initialized!
2025/03/04 08:34:45 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': None, 'savedfilepath': 'output\\cleaned_donations.csv', 'timestamp_key': 'cleaned_raw_data_last_modified'}
2025/03/04 08:34:45 AM INFO:Original file path: None
2025/03/04 08:34:45 AM INFO:Saved file path: output\cleaned_donations.csv
2025/03/04 08:34:45 AM ERROR:Error: originalfilepath is None!
2025/03/04 08:34:45 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:34:45 AM INFO:Data loaded, shape: (65278, 29)
2025/03/04 08:34:46 AM DEBUG:Calling dedupe_entity_file with args=(), kwargs={'loaddata_dd_df':            ECRef              RegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                             ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...                   86310.0                  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...                   86310.0                  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...                   86310.0                  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...                   86310.0                  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...                   86310.0                  Great Britain         False
...          ...                              ...                    ...        ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...                   74198.0                          Other         False
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                   74184.0                          Other         False
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   74576.0                          Other         False
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                   34241.0                  Great Britain         False
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                   74743.0                  Great Britain         False

[65278 rows x 29 columns], 'entity': 'RegulatedEntity', 'map_filename': 'regentity_map_fname', 'output_csv': True}
2025/03/04 08:34:46 AM DEBUG:Calling is_file_updated with args=('reference_files\\PoliticalEntityDeDuped.csv', 'regentity_map_fname_last_modified'), kwargs={}
2025/03/04 08:34:46 AM INFO:Checking if reference_files\PoliticalEntityDeDuped.csv has been updated.
2025/03/04 08:34:46 AM DEBUG:Calling get_file_modification_time with args=('reference_files\\PoliticalEntityDeDuped.csv',), kwargs={}
2025/03/04 08:34:46 AM INFO:Getting modification time for reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:34:46 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:34:46 AM INFO:Current modification time: 1740841102.2638545
2025/03/04 08:34:46 AM INFO:Last modification time: None
2025/03/04 08:34:46 AM INFO:is_file_updated executed successfully
2025/03/04 08:34:46 AM INFO:Map file regentity_map_fname has been updated. Proceeding with deduplication.
2025/03/04 08:34:46 AM INFO:File deduplication complete, shape: (65278, 34)
2025/03/04 08:34:46 AM INFO:dedupe_entity_file executed successfully
2025/03/04 08:34:46 AM DEBUG:Calling dedupe_entity_file with args=(), kwargs={'loaddata_dd_df':            ECRef      OriginalRegulatedEntityName    RegulatedEntityType  ...      OriginalRegulatedEntityName RegulatedEntityId              RegulatedEntityName
0      NC0408174                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
1      NC0408173                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
2      NC0408177                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
3      NC0408176                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
4      NC0408170                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
...          ...                              ...                    ...  ...                              ...               ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65274   C0242461               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65275   C0243560               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65276   C0319710  Conservative And Unionist Party        Political Party  ...  Conservative And Unionist Party              52.0  Conservative And Unionist Party
65277   C0319727  Conservative And Unionist Party        Political Party  ...  Conservative And Unionist Party              52.0  Conservative And Unionist Party

[65278 rows x 34 columns], 'entity': 'Donor', 'map_filename': 'donor_map_fname', 'output_csv': True}
2025/03/04 08:34:46 AM DEBUG:Calling is_file_updated with args=('reference_files\\PoliticalDonorsDeduped.csv', 'donor_map_fname_last_modified'), kwargs={}
2025/03/04 08:34:46 AM INFO:Checking if reference_files\PoliticalDonorsDeduped.csv has been updated.
2025/03/04 08:34:46 AM DEBUG:Calling get_file_modification_time with args=('reference_files\\PoliticalDonorsDeduped.csv',), kwargs={}
2025/03/04 08:34:46 AM INFO:Getting modification time for reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:34:46 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:34:46 AM INFO:Current modification time: 1740757863.2545311
2025/03/04 08:34:46 AM INFO:Last modification time: None
2025/03/04 08:34:46 AM INFO:is_file_updated executed successfully
2025/03/04 08:34:46 AM INFO:Map file donor_map_fname has been updated. Proceeding with deduplication.
2025/03/04 08:34:46 AM INFO:File deduplication complete, shape: (65278, 40)
2025/03/04 08:34:46 AM INFO:dedupe_entity_file executed successfully
2025/03/04 08:34:46 AM INFO:Raw Data cleanup completed
2025/03/04 08:34:46 AM INFO:Data shape: (65278, 40)
2025/03/04 08:34:48 AM INFO:Data saved to output\cleaned_donations.csv
2025/03/04 08:34:48 AM INFO:Data cleanup completed, shape: (65278, 40)
2025/03/04 08:34:48 AM INFO:raw_data_cleanup executed successfully
2025/03/04 08:34:48 AM INFO:load_raw_data executed successfully
2025/03/04 08:34:48 AM INFO:get_raw_data executed successfully
2025/03/04 08:34:48 AM INFO:load_data_to_session executed successfully
2025/03/04 08:34:48 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x0000021EEE6CE050>), kwargs={}
2025/03/04 08:34:48 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 08:34:48 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 08:34:48 AM DEBUG:Rows in Raw Data: 65278
2025/03/04 08:34:48 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'output\\cleaned_donations.csv', 'savedfilepath': 'output\\cleaned_data.csv', 'timestamp_key': 'load_raw_data_last_modified'}
2025/03/04 08:34:48 AM INFO:Original file path: output\cleaned_donations.csv
2025/03/04 08:34:48 AM INFO:Saved file path: output\cleaned_data.csv
2025/03/04 08:34:48 AM DEBUG:Calling is_file_updated with args=('output\\cleaned_donations.csv', 'load_raw_data_last_modified'), kwargs={}
2025/03/04 08:34:48 AM INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/04 08:34:48 AM DEBUG:Calling get_file_modification_time with args=('output\\cleaned_donations.csv',), kwargs={}
2025/03/04 08:34:48 AM INFO:Getting modification time for output\cleaned_donations.csv
2025/03/04 08:34:48 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:34:48 AM INFO:Current modification time: 1741077288.2520096
2025/03/04 08:34:48 AM INFO:Last modification time: 1740757862.6744745
2025/03/04 08:34:48 AM INFO:is_file_updated executed successfully
2025/03/04 08:34:48 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:34:48 AM ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/04 08:34:48 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 08:34:48 AM ERROR:Error in load_cleaned_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 77, in load_cleaned_data
    logger.debug(f"Clean Data Prep: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:34:48 AM ERROR:Error in get_cleaned_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 77, in load_cleaned_data
    logger.debug(f"Clean Data Prep: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:34:48 AM ERROR:Error in load_data_to_session: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 77, in load_cleaned_data
    logger.debug(f"Clean Data Prep: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:34:48 AM ERROR:Error in firstload: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 77, in load_cleaned_data
    logger.debug(f"Clean Data Prep: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:34:48 AM ERROR:Error in initialise_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 42, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 77, in load_cleaned_data
    logger.debug(f"Clean Data Prep: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:34:48 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 08:34:48 AM INFO:Running first load function.
2025/03/04 08:34:48 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 08:34:48 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x0000021EEE6CDFC0>), kwargs={}
2025/03/04 08:34:48 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 08:34:48 AM INFO:get_raw_data executed successfully
2025/03/04 08:34:48 AM INFO:load_data_to_session executed successfully
2025/03/04 08:34:48 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x0000021EEE6CE050>), kwargs={}
2025/03/04 08:34:48 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 08:34:48 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 08:34:48 AM DEBUG:Rows in Raw Data: 65278
2025/03/04 08:34:48 AM ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/04 08:34:48 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 08:34:48 AM ERROR:Error in load_cleaned_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 77, in load_cleaned_data
    logger.debug(f"Clean Data Prep: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:34:48 AM ERROR:Error in get_cleaned_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 77, in load_cleaned_data
    logger.debug(f"Clean Data Prep: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:34:48 AM ERROR:Error in load_data_to_session: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 77, in load_cleaned_data
    logger.debug(f"Clean Data Prep: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:34:48 AM ERROR:Error in firstload: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 77, in load_cleaned_data
    logger.debug(f"Clean Data Prep: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:34:48 AM ERROR:Error in initialise_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 42, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 77, in load_cleaned_data
    logger.debug(f"Clean Data Prep: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:34:48 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 08:34:48 AM INFO:Running first load function.
2025/03/04 08:34:48 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 08:34:48 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x0000021EEE6CDFC0>), kwargs={}
2025/03/04 08:34:48 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 08:34:48 AM INFO:get_raw_data executed successfully
2025/03/04 08:34:48 AM INFO:load_data_to_session executed successfully
2025/03/04 08:34:48 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x0000021EEE6CE050>), kwargs={}
2025/03/04 08:34:48 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 08:34:48 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 08:34:48 AM DEBUG:Rows in Raw Data: 65278
2025/03/04 08:34:48 AM ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/04 08:34:48 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 08:34:48 AM ERROR:Error in load_cleaned_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 77, in load_cleaned_data
    logger.debug(f"Clean Data Prep: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:34:48 AM ERROR:Error in get_cleaned_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 77, in load_cleaned_data
    logger.debug(f"Clean Data Prep: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:34:48 AM ERROR:Error in load_data_to_session: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 77, in load_cleaned_data
    logger.debug(f"Clean Data Prep: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:34:48 AM ERROR:Error in firstload: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 77, in load_cleaned_data
    logger.debug(f"Clean Data Prep: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:34:48 AM ERROR:Error in initialise_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 42, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 77, in load_cleaned_data
    logger.debug(f"Clean Data Prep: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:37:55 AM INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/04 08:37:55 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\utils',), kwargs={}
2025/03/04 08:37:56 AM INFO:get_git_version executed successfully
2025/03/04 08:37:56 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\data',), kwargs={}
2025/03/04 08:37:57 AM INFO:get_git_version executed successfully
2025/03/04 08:37:57 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:37:57 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:37:57 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:37:57 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:37:57 AM INFO:Running App setup...
2025/03/04 08:37:57 AM INFO:Running App setup...
2025/03/04 08:37:57 AM INFO:Running App setup...
2025/03/04 08:37:57 AM INFO:Running App setup...
2025/03/04 08:37:57 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:37:57 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:37:57 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:37:57 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:37:57 AM INFO:Setting up the package
2025/03/04 08:37:57 AM INFO:Setting up the package
2025/03/04 08:37:57 AM INFO:Setting up the package
2025/03/04 08:37:57 AM INFO:Setting up the package
2025/03/04 08:37:57 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:37:57 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:37:57 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:37:57 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:37:57 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:37:57 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:37:57 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:37:57 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:37:57 AM INFO:get_git_version executed successfully
2025/03/04 08:37:57 AM INFO:get_git_version executed successfully
2025/03/04 08:37:57 AM INFO:get_git_version executed successfully
2025/03/04 08:37:57 AM INFO:get_git_version executed successfully
2025/03/04 08:37:57 AM INFO:Version: v20.140
2025/03/04 08:37:57 AM INFO:Version: v20.140
2025/03/04 08:37:57 AM INFO:Version: v20.140
2025/03/04 08:37:57 AM INFO:Version: v20.140
2025/03/04 08:37:57 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:37:57 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:37:57 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:37:57 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:37:57 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:37:57 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:37:57 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:37:57 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:37:57 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:37:57 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:37:57 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:37:57 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:37:57 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:37:57 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:37:57 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:37:57 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:37:57 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:37:57 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:37:57 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:37:57 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:37:57 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:37:57 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:37:57 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:37:57 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:37:57 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:37:57 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:37:57 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:37:57 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:37:57 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:37:57 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:37:57 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:37:57 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:37:57 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:37:57 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:37:57 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:37:57 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:37:57 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:37:57 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:37:57 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:37:57 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:37:57 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:37:57 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:37:57 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:37:57 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:37:57 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:37:57 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:37:57 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:37:57 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:37:57 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:37:57 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:37:57 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:37:57 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:37:57 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:37:57 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:37:57 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:37:57 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:37:57 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:37:57 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:37:57 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:37:57 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:37:57 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:37:57 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:37:57 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:37:57 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:37:57 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:37:57 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:37:57 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:37:57 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:37:57 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:37:57 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:37:57 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:37:57 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:37:57 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:37:57 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:37:57 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:37:57 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:37:57 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:37:57 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:37:57 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:37:57 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:37:57 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:37:57 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:37:57 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:37:57 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:37:57 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:37:57 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:37:57 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:37:57 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:37:57 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:37:57 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:37:57 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:37:57 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:37:57 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:37:57 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:37:57 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:37:57 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:37:57 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:37:57 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:37:57 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:37:57 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:37:57 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:37:57 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:37:57 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:37:57 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:37:57 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:37:57 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:37:57 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:37:57 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:37:57 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:37:57 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:37:57 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:37:57 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:37:57 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:37:57 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:37:57 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:37:57 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:37:57 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:37:57 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:37:57 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:37:57 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:37:57 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:37:57 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:37:57 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:37:57 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:37:57 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:37:57 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:37:57 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:37:57 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:37:57 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:37:57 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:37:57 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:37:57 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:37:57 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:37:57 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:37:57 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:37:57 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:37:57 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:37:57 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:37:57 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:37:57 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:37:57 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:37:57 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:37:57 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:37:57 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:37:57 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:37:57 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:37:57 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:37:57 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:37:57 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:37:57 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:37:57 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:37:57 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:37:57 AM INFO:Session_state variables initialized
2025/03/04 08:37:57 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:37:57 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:37:57 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:37:57 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:37:57 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:37:57 AM INFO:Session_state variables initialized
2025/03/04 08:37:57 AM INFO:Session_state variables initialized
2025/03/04 08:37:57 AM DEBUG:components_dir: components
2025/03/04 08:37:57 AM INFO:Session_state variables initialized
2025/03/04 08:37:57 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:37:57 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:37:57 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:37:57 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:37:57 AM DEBUG:components_dir: components
2025/03/04 08:37:57 AM DEBUG:components_dir: components
2025/03/04 08:37:57 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:37:57 AM DEBUG:components_dir: components
2025/03/04 08:37:57 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:37:57 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:37:57 AM DEBUG:utils_dir: utils
2025/03/04 08:37:57 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:37:57 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:37:57 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:37:57 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:37:57 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:37:57 AM DEBUG:utils_dir: utils
2025/03/04 08:37:57 AM DEBUG:utils_dir: utils
2025/03/04 08:37:57 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:37:57 AM DEBUG:utils_dir: utils
2025/03/04 08:37:57 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:37:57 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:37:57 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:37:57 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:37:57 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:37:57 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:37:57 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:37:57 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:37:57 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:37:57 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:37:57 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:37:57 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:37:57 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:37:57 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:37:57 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:37:57 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:37:57 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:37:57 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:37:57 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:37:57 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:37:57 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:37:57 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:37:57 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:37:57 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:37:57 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:37:57 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:37:57 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:37:57 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:37:57 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:37:57 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:37:57 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:37:57 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:37:57 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:37:57 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:37:57 AM DEBUG:data_dir: data
2025/03/04 08:37:57 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:37:57 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:37:57 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:37:57 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:37:57 AM DEBUG:output_dir: output
2025/03/04 08:37:57 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:37:57 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:37:57 AM DEBUG:data_dir: data
2025/03/04 08:37:57 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:37:57 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:37:57 AM DEBUG:data_dir: data
2025/03/04 08:37:57 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:37:57 AM DEBUG:data_dir: data
2025/03/04 08:37:57 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:37:57 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:37:57 AM DEBUG:output_dir: output
2025/03/04 08:37:57 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:37:57 AM DEBUG:logs_dir: logs
2025/03/04 08:37:57 AM DEBUG:output_dir: output
2025/03/04 08:37:57 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:37:57 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:37:57 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:37:57 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:37:57 AM DEBUG:output_dir: output
2025/03/04 08:37:57 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:37:57 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:37:57 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:37:57 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:37:57 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:37:57 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:37:57 AM DEBUG:logs_dir: logs
2025/03/04 08:37:57 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:37:57 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:37:57 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:37:57 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:37:57 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:37:57 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:37:57 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:37:57 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:37:57 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:37:57 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:37:57 AM DEBUG:logs_dir: logs
2025/03/04 08:37:57 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:37:57 AM DEBUG:logs_dir: logs
2025/03/04 08:37:57 AM DEBUG:perc_target: 0.5
2025/03/04 08:37:57 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:37:57 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:37:57 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:37:57 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:37:57 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:37:57 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:37:57 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:37:57 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:37:57 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:37:57 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:37:57 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:37:57 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:37:57 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:37:57 AM DEBUG:perc_target: 0.5
2025/03/04 08:37:57 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:37:57 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:37:57 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:37:57 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:37:57 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:37:57 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:37:57 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:37:57 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:37:57 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:37:57 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:37:57 AM DEBUG:perc_target: 0.5
2025/03/04 08:37:57 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:37:57 AM DEBUG:perc_target: 0.5
2025/03/04 08:37:57 AM DEBUG:reference_dir: reference_files
2025/03/04 08:37:57 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:37:57 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:37:57 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:37:57 AM INFO:Session state Setup complete
2025/03/04 08:37:57 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:37:57 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:37:57 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:37:57 AM INFO:initialize_session_state executed successfully
2025/03/04 08:37:57 AM INFO:Package setup complete
2025/03/04 08:37:57 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:37:57 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:37:57 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:37:57 AM INFO:setup_package executed successfully
2025/03/04 08:37:57 AM DEBUG:reference_dir: reference_files
2025/03/04 08:37:57 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:37:57 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:37:57 AM INFO:Session state Setup complete
2025/03/04 08:37:57 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:37:57 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:37:57 AM INFO:Running Menu setup...
2025/03/04 08:37:57 AM INFO:initialize_session_state executed successfully
2025/03/04 08:37:57 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:37:57 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:37:57 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:37:57 AM INFO:Package setup complete
2025/03/04 08:37:57 AM DEBUG:reference_dir: reference_files
2025/03/04 08:37:57 AM DEBUG:reference_dir: reference_files
2025/03/04 08:37:57 AM INFO:setup_package executed successfully
2025/03/04 08:37:57 AM INFO:Session state Setup complete
2025/03/04 08:37:57 AM INFO:Session state Setup complete
2025/03/04 08:37:57 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\app_pages',), kwargs={}
2025/03/04 08:37:57 AM INFO:initialize_session_state executed successfully
2025/03/04 08:37:57 AM INFO:initialize_session_state executed successfully
2025/03/04 08:37:57 AM INFO:Running Menu setup...
2025/03/04 08:37:57 AM INFO:Package setup complete
2025/03/04 08:37:57 AM INFO:Package setup complete
2025/03/04 08:37:57 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:37:57 AM INFO:setup_package executed successfully
2025/03/04 08:37:57 AM INFO:setup_package executed successfully
2025/03/04 08:37:57 AM INFO:Running Menu setup...
2025/03/04 08:37:57 AM INFO:Running Menu setup...
2025/03/04 08:37:57 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:37:57 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:37:57 AM INFO:get_git_version executed successfully
2025/03/04 08:37:57 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\components',), kwargs={}
2025/03/04 08:37:57 AM INFO:get_git_version executed successfully
2025/03/04 08:37:57 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:37:57 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:37:57 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:37:57 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:37:57 AM INFO:get_git_version executed successfully
2025/03/04 08:37:57 AM INFO:get_git_version executed successfully
2025/03/04 08:37:57 AM INFO:get_git_version executed successfully
2025/03/04 08:37:57 AM INFO:App Version: v20.161
2025/03/04 08:37:57 AM INFO:get_git_version executed successfully
2025/03/04 08:37:57 AM INFO:App Version: v20.161
2025/03/04 08:37:57 AM INFO:App Version: v20.161
2025/03/04 08:37:57 AM INFO:App Version: v20.161
2025/03/04 08:37:57 AM INFO:Switched to page: Introduction
2025/03/04 08:37:57 AM INFO:Switched to page: Introduction
2025/03/04 08:37:57 AM INFO:Switched to page: Introduction
2025/03/04 08:37:57 AM INFO:Switched to page: Introduction
2025/03/04 08:37:57 AM INFO:pagesetup executed successfully
2025/03/04 08:37:57 AM INFO:pagesetup executed successfully
2025/03/04 08:37:57 AM INFO:pagesetup executed successfully
2025/03/04 08:37:57 AM INFO:pagesetup executed successfully
2025/03/04 08:37:57 AM INFO:No data found in session state, running firstload()
2025/03/04 08:37:57 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 08:37:57 AM INFO:No data found in session state, running firstload()
2025/03/04 08:37:57 AM INFO:No data found in session state, running firstload()
2025/03/04 08:37:57 AM INFO:No data found in session state, running firstload()
2025/03/04 08:37:58 AM INFO:Running first load function.
2025/03/04 08:37:58 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 08:37:58 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x000001AFC7352C20>), kwargs={}
2025/03/04 08:37:58 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 08:37:58 AM DEBUG:Calling load_raw_data with args=(), kwargs={'main_file': 'raw_data', 'cleaned_file': 'raw_data_clean', 'output_csv': True, 'dedupe_donors': True, 'dedupe_regentity': True, 'originaldatafilepath': 'source_data_fname', 'processeddatafilepath': 'imported_raw_fname'}
2025/03/04 08:37:58 AM DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/04 08:37:58 AM DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/04 08:37:58 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'source\\Donations_accepted_by_political_parties.csv', 'savedfilepath': 'output\\imported_raw.csv', 'timestamp_key': 'load_raw_data_last_modified'}
2025/03/04 08:37:58 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:37:58 AM INFO:Saved file path: output\imported_raw.csv
2025/03/04 08:37:58 AM DEBUG:Calling is_file_updated with args=('source\\Donations_accepted_by_political_parties.csv', 'load_raw_data_last_modified'), kwargs={}
2025/03/04 08:37:58 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 08:37:58 AM DEBUG:Calling get_file_modification_time with args=('source\\Donations_accepted_by_political_parties.csv',), kwargs={}
2025/03/04 08:37:58 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 08:37:58 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:37:58 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 08:37:58 AM INFO:Last modification time: None
2025/03/04 08:37:58 AM INFO:is_file_updated executed successfully
2025/03/04 08:37:58 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:37:58 AM INFO:Loading raw data...
2025/03/04 08:37:58 AM DEBUG:Original data file path post raw data load: {originaldatafilepath}
2025/03/04 08:37:58 AM DEBUG:Processed data file path post raw data load: {processeddatafilepath}
2025/03/04 08:37:58 AM INFO:Data loaded successfully. Data has 65278 rows and 29 columns
2025/03/04 08:37:59 AM INFO:Data saved to output\imported_raw.csv
2025/03/04 08:37:59 AM DEBUG:Calling raw_data_cleanup with args=(), kwargs={'loaddata_df':            ECRef              RegulatedEntityName    RegulatedEntityType        Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                               ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    £1,876.56   02/09/2019  ...              NaN  86310.0             NaN  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    £2,700.00   02/09/2019  ...              NaN  86310.0             NaN  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    £4,852.58   30/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    £2,500.00   30/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    £4,524.05   29/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
...          ...                              ...                    ...          ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   £10,000.00          NaN  ...              NaN  74198.0             NaN            NaN         False
65274   C0242461               Vote Leave Limited  Permitted Participant  £100,000.00          NaN  ...              NaN  74184.0             NaN            NaN         False
65275   C0243560               Vote Leave Limited  Permitted Participant   £40,000.00          NaN  ...              NaN  74576.0             NaN            NaN         False
65276   C0319710  Conservative and Unionist Party        Political Party   £50,000.00          NaN  ...              NaN  34241.0             NaN  Great Britain         False
65277   C0319727  Conservative and Unionist Party        Political Party   £15,000.00          NaN  ...              NaN  74743.0             NaN  Great Britain         False

[65278 rows x 29 columns], 'dedupe_donors': True, 'dedupe_regentity': True, 'output_csv': True, 'originaldatafilepath': 'output\\imported_raw.csv', 'processeddatafilepath': 'cleaned_donations_fname'}
2025/03/04 08:37:59 AM INFO:Cleaning up raw data
2025/03/04 08:37:59 AM ERROR:Session state variables not initialized!
2025/03/04 08:37:59 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': None, 'savedfilepath': 'output\\cleaned_donations.csv', 'timestamp_key': 'cleaned_raw_data_last_modified'}
2025/03/04 08:37:59 AM INFO:Original file path: None
2025/03/04 08:37:59 AM INFO:Saved file path: output\cleaned_donations.csv
2025/03/04 08:37:59 AM ERROR:Error: originalfilepath is None!
2025/03/04 08:37:59 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:37:59 AM INFO:Data loaded, shape: (65278, 29)
2025/03/04 08:38:00 AM DEBUG:Calling dedupe_entity_file with args=(), kwargs={'loaddata_dd_df':            ECRef              RegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                             ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...                   86310.0                  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...                   86310.0                  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...                   86310.0                  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...                   86310.0                  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...                   86310.0                  Great Britain         False
...          ...                              ...                    ...        ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...                   74198.0                          Other         False
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                   74184.0                          Other         False
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   74576.0                          Other         False
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                   34241.0                  Great Britain         False
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                   74743.0                  Great Britain         False

[65278 rows x 29 columns], 'entity': 'RegulatedEntity', 'map_filename': 'regentity_map_fname', 'output_csv': True}
2025/03/04 08:38:00 AM DEBUG:Calling is_file_updated with args=('reference_files\\PoliticalEntityDeDuped.csv', 'regentity_map_fname_last_modified'), kwargs={}
2025/03/04 08:38:00 AM INFO:Checking if reference_files\PoliticalEntityDeDuped.csv has been updated.
2025/03/04 08:38:00 AM DEBUG:Calling get_file_modification_time with args=('reference_files\\PoliticalEntityDeDuped.csv',), kwargs={}
2025/03/04 08:38:00 AM INFO:Getting modification time for reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:38:00 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:38:00 AM INFO:Current modification time: 1740841102.2638545
2025/03/04 08:38:00 AM INFO:Last modification time: None
2025/03/04 08:38:00 AM INFO:is_file_updated executed successfully
2025/03/04 08:38:00 AM INFO:Map file regentity_map_fname has been updated. Proceeding with deduplication.
2025/03/04 08:38:00 AM INFO:File deduplication complete, shape: (65278, 34)
2025/03/04 08:38:00 AM INFO:dedupe_entity_file executed successfully
2025/03/04 08:38:00 AM DEBUG:Calling dedupe_entity_file with args=(), kwargs={'loaddata_dd_df':            ECRef      OriginalRegulatedEntityName    RegulatedEntityType  ...      OriginalRegulatedEntityName RegulatedEntityId              RegulatedEntityName
0      NC0408174                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
1      NC0408173                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
2      NC0408177                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
3      NC0408176                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
4      NC0408170                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
...          ...                              ...                    ...  ...                              ...               ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65274   C0242461               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65275   C0243560               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65276   C0319710  Conservative And Unionist Party        Political Party  ...  Conservative And Unionist Party              52.0  Conservative And Unionist Party
65277   C0319727  Conservative And Unionist Party        Political Party  ...  Conservative And Unionist Party              52.0  Conservative And Unionist Party

[65278 rows x 34 columns], 'entity': 'Donor', 'map_filename': 'donor_map_fname', 'output_csv': True}
2025/03/04 08:38:00 AM DEBUG:Calling is_file_updated with args=('reference_files\\PoliticalDonorsDeduped.csv', 'donor_map_fname_last_modified'), kwargs={}
2025/03/04 08:38:00 AM INFO:Checking if reference_files\PoliticalDonorsDeduped.csv has been updated.
2025/03/04 08:38:00 AM DEBUG:Calling get_file_modification_time with args=('reference_files\\PoliticalDonorsDeduped.csv',), kwargs={}
2025/03/04 08:38:00 AM INFO:Getting modification time for reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:38:00 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:38:00 AM INFO:Current modification time: 1740757863.2545311
2025/03/04 08:38:00 AM INFO:Last modification time: None
2025/03/04 08:38:00 AM INFO:is_file_updated executed successfully
2025/03/04 08:38:00 AM INFO:Map file donor_map_fname has been updated. Proceeding with deduplication.
2025/03/04 08:38:00 AM INFO:File deduplication complete, shape: (65278, 40)
2025/03/04 08:38:00 AM INFO:dedupe_entity_file executed successfully
2025/03/04 08:38:00 AM INFO:Raw Data cleanup completed
2025/03/04 08:38:00 AM INFO:Data shape: (65278, 40)
2025/03/04 08:38:02 AM INFO:Data saved to output\cleaned_donations.csv
2025/03/04 08:38:02 AM INFO:Data cleanup completed, shape: (65278, 40)
2025/03/04 08:38:02 AM INFO:raw_data_cleanup executed successfully
2025/03/04 08:38:03 AM INFO:load_raw_data executed successfully
2025/03/04 08:38:03 AM INFO:get_raw_data executed successfully
2025/03/04 08:38:03 AM INFO:load_data_to_session executed successfully
2025/03/04 08:38:03 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x000001AFC7352CB0>), kwargs={}
2025/03/04 08:38:03 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 08:38:03 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 08:38:03 AM DEBUG:Rows in Raw Data: 65278
2025/03/04 08:38:03 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'output\\cleaned_donations.csv', 'savedfilepath': 'output\\cleaned_data.csv', 'timestamp_key': 'load_raw_data_last_modified'}
2025/03/04 08:38:03 AM INFO:Original file path: output\cleaned_donations.csv
2025/03/04 08:38:03 AM INFO:Saved file path: output\cleaned_data.csv
2025/03/04 08:38:03 AM DEBUG:Calling is_file_updated with args=('output\\cleaned_donations.csv', 'load_raw_data_last_modified'), kwargs={}
2025/03/04 08:38:03 AM INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/04 08:38:03 AM DEBUG:Calling get_file_modification_time with args=('output\\cleaned_donations.csv',), kwargs={}
2025/03/04 08:38:03 AM INFO:Getting modification time for output\cleaned_donations.csv
2025/03/04 08:38:03 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:38:03 AM INFO:Current modification time: 1741077482.880819
2025/03/04 08:38:03 AM INFO:Last modification time: 1740757862.6744745
2025/03/04 08:38:03 AM INFO:is_file_updated executed successfully
2025/03/04 08:38:03 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:38:03 AM ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/04 08:38:03 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 08:38:03 AM DEBUG:Clean Data Prep: streamlitdata load: 65278
2025/03/04 08:38:03 AM ERROR:Error in load_cleaned_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 124, in load_cleaned_data
    logger.debug(f"Clean Data Prep 123: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:38:03 AM ERROR:Error in get_cleaned_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 124, in load_cleaned_data
    logger.debug(f"Clean Data Prep 123: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:38:03 AM ERROR:Error in load_data_to_session: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 124, in load_cleaned_data
    logger.debug(f"Clean Data Prep 123: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:38:03 AM ERROR:Error in firstload: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 124, in load_cleaned_data
    logger.debug(f"Clean Data Prep 123: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:38:03 AM ERROR:Error in initialise_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 42, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 124, in load_cleaned_data
    logger.debug(f"Clean Data Prep 123: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:38:03 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 08:38:03 AM INFO:Running first load function.
2025/03/04 08:38:03 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 08:38:03 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x000001AFC7352C20>), kwargs={}
2025/03/04 08:38:03 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 08:38:03 AM INFO:get_raw_data executed successfully
2025/03/04 08:38:03 AM INFO:load_data_to_session executed successfully
2025/03/04 08:38:03 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x000001AFC7352CB0>), kwargs={}
2025/03/04 08:38:03 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 08:38:03 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 08:38:03 AM DEBUG:Rows in Raw Data: 65278
2025/03/04 08:38:03 AM ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/04 08:38:03 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 08:38:03 AM DEBUG:Clean Data Prep: streamlitdata load: 65278
2025/03/04 08:38:03 AM ERROR:Error in load_cleaned_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 124, in load_cleaned_data
    logger.debug(f"Clean Data Prep 123: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:38:03 AM ERROR:Error in get_cleaned_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 124, in load_cleaned_data
    logger.debug(f"Clean Data Prep 123: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:38:03 AM ERROR:Error in load_data_to_session: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 124, in load_cleaned_data
    logger.debug(f"Clean Data Prep 123: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:38:03 AM ERROR:Error in firstload: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 124, in load_cleaned_data
    logger.debug(f"Clean Data Prep 123: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:38:03 AM ERROR:Error in initialise_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 42, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 124, in load_cleaned_data
    logger.debug(f"Clean Data Prep 123: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:38:03 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 08:38:03 AM INFO:Running first load function.
2025/03/04 08:38:03 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 08:38:03 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x000001AFC7352C20>), kwargs={}
2025/03/04 08:38:03 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 08:38:04 AM INFO:get_raw_data executed successfully
2025/03/04 08:38:04 AM INFO:load_data_to_session executed successfully
2025/03/04 08:38:04 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x000001AFC7352CB0>), kwargs={}
2025/03/04 08:38:04 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 08:38:04 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 08:38:04 AM DEBUG:Rows in Raw Data: 65278
2025/03/04 08:38:04 AM ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/04 08:38:04 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 08:38:04 AM DEBUG:Clean Data Prep: streamlitdata load: 65278
2025/03/04 08:38:04 AM ERROR:Error in load_cleaned_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 124, in load_cleaned_data
    logger.debug(f"Clean Data Prep 123: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:38:04 AM ERROR:Error in get_cleaned_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 124, in load_cleaned_data
    logger.debug(f"Clean Data Prep 123: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:38:04 AM ERROR:Error in load_data_to_session: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 124, in load_cleaned_data
    logger.debug(f"Clean Data Prep 123: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:38:04 AM ERROR:Error in firstload: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 124, in load_cleaned_data
    logger.debug(f"Clean Data Prep 123: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:38:04 AM ERROR:Error in initialise_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 42, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 124, in load_cleaned_data
    logger.debug(f"Clean Data Prep 123: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:38:04 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 08:38:04 AM INFO:Running first load function.
2025/03/04 08:38:04 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 08:38:04 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x000001AFC7352C20>), kwargs={}
2025/03/04 08:38:04 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 08:38:04 AM INFO:get_raw_data executed successfully
2025/03/04 08:38:04 AM INFO:load_data_to_session executed successfully
2025/03/04 08:38:04 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x000001AFC7352CB0>), kwargs={}
2025/03/04 08:38:04 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 08:38:04 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 08:38:04 AM DEBUG:Rows in Raw Data: 65278
2025/03/04 08:38:04 AM ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/04 08:38:04 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 08:38:04 AM DEBUG:Clean Data Prep: streamlitdata load: 65278
2025/03/04 08:38:04 AM ERROR:Error in load_cleaned_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 124, in load_cleaned_data
    logger.debug(f"Clean Data Prep 123: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:38:04 AM ERROR:Error in get_cleaned_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 124, in load_cleaned_data
    logger.debug(f"Clean Data Prep 123: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:38:04 AM ERROR:Error in load_data_to_session: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 124, in load_cleaned_data
    logger.debug(f"Clean Data Prep 123: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:38:04 AM ERROR:Error in firstload: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 124, in load_cleaned_data
    logger.debug(f"Clean Data Prep 123: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:38:04 AM ERROR:Error in initialise_data: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 42, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 124, in load_cleaned_data
    logger.debug(f"Clean Data Prep 123: streamlitdata load: {len(loaddata_df)}")
TypeError: object of type 'NoneType' has no len()
2025/03/04 08:39:19 AM INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/04 08:39:19 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\utils',), kwargs={}
2025/03/04 08:39:19 AM INFO:get_git_version executed successfully
2025/03/04 08:39:20 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\data',), kwargs={}
2025/03/04 08:39:20 AM INFO:get_git_version executed successfully
2025/03/04 08:39:20 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:39:20 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:39:20 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:39:20 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:39:20 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:39:20 AM INFO:Running App setup...
2025/03/04 08:39:20 AM INFO:Running App setup...
2025/03/04 08:39:20 AM INFO:Running App setup...
2025/03/04 08:39:20 AM INFO:Running App setup...
2025/03/04 08:39:20 AM INFO:Running App setup...
2025/03/04 08:39:20 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:39:20 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:39:20 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:39:20 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:39:20 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:39:20 AM INFO:Setting up the package
2025/03/04 08:39:20 AM INFO:Setting up the package
2025/03/04 08:39:20 AM INFO:Setting up the package
2025/03/04 08:39:20 AM INFO:Setting up the package
2025/03/04 08:39:20 AM INFO:Setting up the package
2025/03/04 08:39:20 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:39:20 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:39:20 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:39:20 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:39:20 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:39:20 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:39:20 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:39:20 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:39:20 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:39:20 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:39:20 AM INFO:get_git_version executed successfully
2025/03/04 08:39:20 AM INFO:get_git_version executed successfully
2025/03/04 08:39:20 AM INFO:get_git_version executed successfully
2025/03/04 08:39:20 AM INFO:Version: v20.140
2025/03/04 08:39:20 AM INFO:get_git_version executed successfully
2025/03/04 08:39:20 AM INFO:get_git_version executed successfully
2025/03/04 08:39:20 AM INFO:Version: v20.140
2025/03/04 08:39:20 AM INFO:Version: v20.140
2025/03/04 08:39:20 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:39:20 AM INFO:Version: v20.140
2025/03/04 08:39:20 AM INFO:Version: v20.140
2025/03/04 08:39:20 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:39:20 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:39:20 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:39:20 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:39:20 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:39:20 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:39:20 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:39:20 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:39:20 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:39:20 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:39:20 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:39:20 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:39:20 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:39:20 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:39:20 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:39:20 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:39:20 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:39:20 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:39:20 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:39:20 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:39:20 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:39:20 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:39:20 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:39:20 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:39:20 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:39:20 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:39:20 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:39:20 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:39:20 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:39:20 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:39:20 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:39:20 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:39:20 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:39:20 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:39:20 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:39:20 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:39:20 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:39:20 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:39:20 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:39:20 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:39:20 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:39:20 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:39:20 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:39:20 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:39:20 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:39:20 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:39:20 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:39:20 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:39:20 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:39:20 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:39:20 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:39:20 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:39:20 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:39:20 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:39:20 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:39:20 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:39:20 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:39:20 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:39:20 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:39:20 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:39:20 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:39:20 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:39:20 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:39:20 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:39:20 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:39:20 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:39:20 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:39:20 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:39:20 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:39:20 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:39:20 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:39:20 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:39:20 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:39:20 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:39:20 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:39:20 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:39:20 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:39:20 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:39:20 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:39:20 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:39:20 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:39:20 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:39:20 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:39:20 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:39:20 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:39:20 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:39:20 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:39:20 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:39:20 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:39:20 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:39:20 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:39:20 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:39:20 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:39:20 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:39:20 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:39:20 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:39:20 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:39:20 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:39:20 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:39:20 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:39:20 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:39:20 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:39:20 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:39:20 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:39:20 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:39:20 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:39:20 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:39:20 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:39:20 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:39:20 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:39:20 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:39:20 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:39:20 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:39:20 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:39:20 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:39:20 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:39:20 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:39:20 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:39:20 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:39:20 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:39:20 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:39:20 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:39:20 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:39:20 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:39:20 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:39:20 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:39:20 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:39:20 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:39:20 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:39:20 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:39:20 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:39:20 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:39:20 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:39:20 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:39:20 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:39:20 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:39:20 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:39:20 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:39:20 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:39:20 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:39:20 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:39:20 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:39:20 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:39:20 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:39:20 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:39:20 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:39:20 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:39:20 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:39:20 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:39:20 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:39:20 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:39:20 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:39:20 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:39:20 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:39:20 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:39:20 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:39:20 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:39:20 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:39:20 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:39:20 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:39:20 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:39:20 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:39:20 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:39:20 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:39:20 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:39:20 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:39:20 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:39:20 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:39:20 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:39:20 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:39:20 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:39:20 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:39:20 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:39:20 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:39:20 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:39:20 AM INFO:Session_state variables initialized
2025/03/04 08:39:20 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:39:20 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:39:20 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:39:20 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:39:20 AM DEBUG:reference_dir: reference_files
2025/03/04 08:39:20 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:39:20 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:39:20 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:39:20 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:39:20 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:39:20 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:39:20 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:39:20 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:39:20 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:39:20 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:39:20 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:39:20 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:39:20 AM INFO:Session_state variables initialized
2025/03/04 08:39:20 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:39:20 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:39:20 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:39:20 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:39:20 AM DEBUG:reference_dir: reference_files
2025/03/04 08:39:20 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:39:20 AM DEBUG:data_dir: data
2025/03/04 08:39:20 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:39:20 AM INFO:Session_state variables initialized
2025/03/04 08:39:20 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:39:20 AM INFO:Session_state variables initialized
2025/03/04 08:39:20 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:39:20 AM INFO:Session_state variables initialized
2025/03/04 08:39:20 AM DEBUG:reference_dir: reference_files
2025/03/04 08:39:20 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:39:20 AM DEBUG:reference_dir: reference_files
2025/03/04 08:39:20 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:39:20 AM DEBUG:reference_dir: reference_files
2025/03/04 08:39:20 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:39:20 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:39:20 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:39:20 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:39:20 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:39:20 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:39:20 AM DEBUG:data_dir: data
2025/03/04 08:39:20 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:39:20 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:39:20 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:39:20 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:39:20 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:39:20 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:39:20 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:39:20 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:39:20 AM DEBUG:data_dir: data
2025/03/04 08:39:20 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:39:20 AM DEBUG:data_dir: data
2025/03/04 08:39:20 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:39:20 AM DEBUG:data_dir: data
2025/03/04 08:39:20 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:39:20 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:39:20 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:39:20 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:39:20 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:39:20 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:39:20 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:39:20 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:39:20 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:39:20 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:39:20 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:39:20 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:39:20 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:39:20 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:39:20 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:39:20 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:39:20 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:39:20 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:39:20 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:39:20 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:39:20 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:39:20 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:39:20 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:39:20 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:39:20 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:39:20 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:39:20 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:39:20 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:39:20 AM DEBUG:components_dir: components
2025/03/04 08:39:20 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:39:20 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:39:20 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:39:20 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:39:20 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:39:20 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:39:20 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:39:20 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:39:20 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:39:20 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:39:20 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:39:20 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:39:20 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:39:20 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:39:20 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:39:20 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:39:20 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:39:20 AM DEBUG:components_dir: components
2025/03/04 08:39:20 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:39:20 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:39:20 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:39:20 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:39:20 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:39:20 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:39:20 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:39:20 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:39:20 AM DEBUG:components_dir: components
2025/03/04 08:39:20 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:39:20 AM DEBUG:components_dir: components
2025/03/04 08:39:20 AM DEBUG:output_dir: output
2025/03/04 08:39:20 AM DEBUG:components_dir: components
2025/03/04 08:39:20 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:39:20 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:39:20 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:39:20 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:39:20 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:39:20 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:39:20 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:39:20 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:39:20 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:39:20 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:39:20 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:39:20 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:39:20 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:39:20 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:39:20 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:39:20 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:39:20 AM DEBUG:output_dir: output
2025/03/04 08:39:20 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:39:20 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:39:20 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:39:20 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:39:20 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:39:20 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:39:20 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:39:20 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:39:20 AM DEBUG:output_dir: output
2025/03/04 08:39:20 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:39:20 AM DEBUG:output_dir: output
2025/03/04 08:39:20 AM DEBUG:perc_target: 0.5
2025/03/04 08:39:20 AM DEBUG:output_dir: output
2025/03/04 08:39:20 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:39:20 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:39:20 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:39:20 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:39:20 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:39:20 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:39:20 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:39:20 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:39:20 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:39:20 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:39:20 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:39:20 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:39:20 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:39:20 AM DEBUG:logs_dir: logs
2025/03/04 08:39:20 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:39:20 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:39:20 AM DEBUG:perc_target: 0.5
2025/03/04 08:39:20 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:39:20 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:39:20 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:39:20 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:39:20 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:39:20 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:39:20 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:39:20 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:39:20 AM DEBUG:perc_target: 0.5
2025/03/04 08:39:20 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:39:20 AM DEBUG:perc_target: 0.5
2025/03/04 08:39:20 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:39:20 AM DEBUG:perc_target: 0.5
2025/03/04 08:39:20 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:39:20 AM DEBUG:logs_dir: logs
2025/03/04 08:39:20 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:39:20 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:39:20 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:39:20 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:39:20 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:39:20 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:39:20 AM DEBUG:utils_dir: utils
2025/03/04 08:39:20 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:39:20 AM DEBUG:logs_dir: logs
2025/03/04 08:39:20 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:39:20 AM DEBUG:logs_dir: logs
2025/03/04 08:39:20 AM INFO:Session state Setup complete
2025/03/04 08:39:20 AM DEBUG:logs_dir: logs
2025/03/04 08:39:20 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:39:20 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:39:20 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:39:20 AM INFO:initialize_session_state executed successfully
2025/03/04 08:39:20 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:39:20 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:39:20 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:39:20 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:39:20 AM INFO:Package setup complete
2025/03/04 08:39:20 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:39:20 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:39:20 AM DEBUG:utils_dir: utils
2025/03/04 08:39:20 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:39:20 AM INFO:setup_package executed successfully
2025/03/04 08:39:20 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:39:20 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:39:20 AM INFO:Session state Setup complete
2025/03/04 08:39:20 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:39:20 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:39:20 AM DEBUG:utils_dir: utils
2025/03/04 08:39:20 AM INFO:initialize_session_state executed successfully
2025/03/04 08:39:20 AM DEBUG:utils_dir: utils
2025/03/04 08:39:20 AM INFO:Running Menu setup...
2025/03/04 08:39:20 AM DEBUG:utils_dir: utils
2025/03/04 08:39:20 AM INFO:Session state Setup complete
2025/03/04 08:39:20 AM INFO:Package setup complete
2025/03/04 08:39:20 AM INFO:Session state Setup complete
2025/03/04 08:39:20 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:39:20 AM INFO:Session state Setup complete
2025/03/04 08:39:20 AM INFO:initialize_session_state executed successfully
2025/03/04 08:39:20 AM INFO:setup_package executed successfully
2025/03/04 08:39:20 AM INFO:initialize_session_state executed successfully
2025/03/04 08:39:20 AM INFO:initialize_session_state executed successfully
2025/03/04 08:39:20 AM INFO:Package setup complete
2025/03/04 08:39:20 AM INFO:Package setup complete
2025/03/04 08:39:20 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\app_pages',), kwargs={}
2025/03/04 08:39:20 AM INFO:Package setup complete
2025/03/04 08:39:20 AM INFO:setup_package executed successfully
2025/03/04 08:39:20 AM INFO:Running Menu setup...
2025/03/04 08:39:20 AM INFO:setup_package executed successfully
2025/03/04 08:39:20 AM INFO:setup_package executed successfully
2025/03/04 08:39:20 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:39:20 AM INFO:Running Menu setup...
2025/03/04 08:39:20 AM INFO:Running Menu setup...
2025/03/04 08:39:20 AM INFO:Running Menu setup...
2025/03/04 08:39:20 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:39:20 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:39:20 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:39:21 AM INFO:get_git_version executed successfully
2025/03/04 08:39:21 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\components',), kwargs={}
2025/03/04 08:39:21 AM INFO:get_git_version executed successfully
2025/03/04 08:39:21 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:39:21 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:39:21 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:39:21 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:39:21 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:39:21 AM INFO:get_git_version executed successfully
2025/03/04 08:39:21 AM INFO:get_git_version executed successfully
2025/03/04 08:39:21 AM INFO:get_git_version executed successfully
2025/03/04 08:39:21 AM INFO:get_git_version executed successfully
2025/03/04 08:39:21 AM INFO:App Version: v20.161
2025/03/04 08:39:21 AM INFO:get_git_version executed successfully
2025/03/04 08:39:21 AM INFO:App Version: v20.161
2025/03/04 08:39:21 AM INFO:App Version: v20.161
2025/03/04 08:39:21 AM INFO:App Version: v20.161
2025/03/04 08:39:21 AM INFO:App Version: v20.161
2025/03/04 08:39:21 AM INFO:Switched to page: Introduction
2025/03/04 08:39:21 AM INFO:Switched to page: Introduction
2025/03/04 08:39:21 AM INFO:Switched to page: Introduction
2025/03/04 08:39:21 AM INFO:Switched to page: Introduction
2025/03/04 08:39:21 AM INFO:Switched to page: Introduction
2025/03/04 08:39:21 AM INFO:pagesetup executed successfully
2025/03/04 08:39:21 AM INFO:pagesetup executed successfully
2025/03/04 08:39:21 AM INFO:pagesetup executed successfully
2025/03/04 08:39:21 AM INFO:pagesetup executed successfully
2025/03/04 08:39:21 AM INFO:pagesetup executed successfully
2025/03/04 08:39:21 AM INFO:No data found in session state, running firstload()
2025/03/04 08:39:21 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 08:39:21 AM INFO:No data found in session state, running firstload()
2025/03/04 08:39:21 AM INFO:No data found in session state, running firstload()
2025/03/04 08:39:21 AM INFO:No data found in session state, running firstload()
2025/03/04 08:39:21 AM INFO:No data found in session state, running firstload()
2025/03/04 08:39:21 AM INFO:Running first load function.
2025/03/04 08:39:21 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 08:39:21 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x00000219E53675B0>), kwargs={}
2025/03/04 08:39:21 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 08:39:21 AM DEBUG:Calling load_raw_data with args=(), kwargs={'main_file': 'raw_data', 'cleaned_file': 'raw_data_clean', 'output_csv': True, 'dedupe_donors': True, 'dedupe_regentity': True, 'originaldatafilepath': 'source_data_fname', 'processeddatafilepath': 'imported_raw_fname'}
2025/03/04 08:39:21 AM DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/04 08:39:21 AM DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/04 08:39:21 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'source\\Donations_accepted_by_political_parties.csv', 'savedfilepath': 'output\\imported_raw.csv', 'timestamp_key': 'load_raw_data_last_modified'}
2025/03/04 08:39:21 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:39:21 AM INFO:Saved file path: output\imported_raw.csv
2025/03/04 08:39:21 AM DEBUG:Calling is_file_updated with args=('source\\Donations_accepted_by_political_parties.csv', 'load_raw_data_last_modified'), kwargs={}
2025/03/04 08:39:21 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 08:39:21 AM DEBUG:Calling get_file_modification_time with args=('source\\Donations_accepted_by_political_parties.csv',), kwargs={}
2025/03/04 08:39:21 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 08:39:21 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:39:21 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 08:39:21 AM INFO:Last modification time: None
2025/03/04 08:39:21 AM INFO:is_file_updated executed successfully
2025/03/04 08:39:21 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:39:21 AM INFO:Loading raw data...
2025/03/04 08:39:21 AM DEBUG:Original data file path post raw data load: {originaldatafilepath}
2025/03/04 08:39:21 AM DEBUG:Processed data file path post raw data load: {processeddatafilepath}
2025/03/04 08:39:22 AM INFO:Data loaded successfully. Data has 65278 rows and 29 columns
2025/03/04 08:39:22 AM INFO:Data saved to output\imported_raw.csv
2025/03/04 08:39:22 AM DEBUG:Calling raw_data_cleanup with args=(), kwargs={'loaddata_df':            ECRef              RegulatedEntityName    RegulatedEntityType        Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                               ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    £1,876.56   02/09/2019  ...              NaN  86310.0             NaN  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    £2,700.00   02/09/2019  ...              NaN  86310.0             NaN  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    £4,852.58   30/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    £2,500.00   30/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    £4,524.05   29/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
...          ...                              ...                    ...          ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   £10,000.00          NaN  ...              NaN  74198.0             NaN            NaN         False
65274   C0242461               Vote Leave Limited  Permitted Participant  £100,000.00          NaN  ...              NaN  74184.0             NaN            NaN         False
65275   C0243560               Vote Leave Limited  Permitted Participant   £40,000.00          NaN  ...              NaN  74576.0             NaN            NaN         False
65276   C0319710  Conservative and Unionist Party        Political Party   £50,000.00          NaN  ...              NaN  34241.0             NaN  Great Britain         False
65277   C0319727  Conservative and Unionist Party        Political Party   £15,000.00          NaN  ...              NaN  74743.0             NaN  Great Britain         False

[65278 rows x 29 columns], 'dedupe_donors': True, 'dedupe_regentity': True, 'output_csv': True, 'originaldatafilepath': 'output\\imported_raw.csv', 'processeddatafilepath': 'cleaned_donations_fname'}
2025/03/04 08:39:22 AM INFO:Cleaning up raw data
2025/03/04 08:39:22 AM ERROR:Session state variables not initialized!
2025/03/04 08:39:22 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': None, 'savedfilepath': 'output\\cleaned_donations.csv', 'timestamp_key': 'cleaned_raw_data_last_modified'}
2025/03/04 08:39:22 AM INFO:Original file path: None
2025/03/04 08:39:22 AM INFO:Saved file path: output\cleaned_donations.csv
2025/03/04 08:39:22 AM ERROR:Error: originalfilepath is None!
2025/03/04 08:39:22 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:39:22 AM INFO:Data loaded, shape: (65278, 29)
2025/03/04 08:39:24 AM DEBUG:Calling dedupe_entity_file with args=(), kwargs={'loaddata_dd_df':            ECRef              RegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                             ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...                   86310.0                  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...                   86310.0                  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...                   86310.0                  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...                   86310.0                  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...                   86310.0                  Great Britain         False
...          ...                              ...                    ...        ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...                   74198.0                          Other         False
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                   74184.0                          Other         False
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   74576.0                          Other         False
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                   34241.0                  Great Britain         False
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                   74743.0                  Great Britain         False

[65278 rows x 29 columns], 'entity': 'RegulatedEntity', 'map_filename': 'regentity_map_fname', 'output_csv': True}
2025/03/04 08:39:24 AM DEBUG:Calling is_file_updated with args=('reference_files\\PoliticalEntityDeDuped.csv', 'regentity_map_fname_last_modified'), kwargs={}
2025/03/04 08:39:24 AM INFO:Checking if reference_files\PoliticalEntityDeDuped.csv has been updated.
2025/03/04 08:39:24 AM DEBUG:Calling get_file_modification_time with args=('reference_files\\PoliticalEntityDeDuped.csv',), kwargs={}
2025/03/04 08:39:24 AM INFO:Getting modification time for reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:39:24 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:39:24 AM INFO:Current modification time: 1740841102.2638545
2025/03/04 08:39:24 AM INFO:Last modification time: None
2025/03/04 08:39:24 AM INFO:is_file_updated executed successfully
2025/03/04 08:39:24 AM INFO:Map file regentity_map_fname has been updated. Proceeding with deduplication.
2025/03/04 08:39:24 AM INFO:File deduplication complete, shape: (65278, 34)
2025/03/04 08:39:24 AM INFO:dedupe_entity_file executed successfully
2025/03/04 08:39:24 AM DEBUG:Calling dedupe_entity_file with args=(), kwargs={'loaddata_dd_df':            ECRef      OriginalRegulatedEntityName    RegulatedEntityType  ...      OriginalRegulatedEntityName RegulatedEntityId              RegulatedEntityName
0      NC0408174                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
1      NC0408173                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
2      NC0408177                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
3      NC0408176                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
4      NC0408170                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
...          ...                              ...                    ...  ...                              ...               ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65274   C0242461               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65275   C0243560               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65276   C0319710  Conservative And Unionist Party        Political Party  ...  Conservative And Unionist Party              52.0  Conservative And Unionist Party
65277   C0319727  Conservative And Unionist Party        Political Party  ...  Conservative And Unionist Party              52.0  Conservative And Unionist Party

[65278 rows x 34 columns], 'entity': 'Donor', 'map_filename': 'donor_map_fname', 'output_csv': True}
2025/03/04 08:39:24 AM DEBUG:Calling is_file_updated with args=('reference_files\\PoliticalDonorsDeduped.csv', 'donor_map_fname_last_modified'), kwargs={}
2025/03/04 08:39:24 AM INFO:Checking if reference_files\PoliticalDonorsDeduped.csv has been updated.
2025/03/04 08:39:24 AM DEBUG:Calling get_file_modification_time with args=('reference_files\\PoliticalDonorsDeduped.csv',), kwargs={}
2025/03/04 08:39:24 AM INFO:Getting modification time for reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:39:24 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:39:24 AM INFO:Current modification time: 1740757863.2545311
2025/03/04 08:39:24 AM INFO:Last modification time: None
2025/03/04 08:39:24 AM INFO:is_file_updated executed successfully
2025/03/04 08:39:24 AM INFO:Map file donor_map_fname has been updated. Proceeding with deduplication.
2025/03/04 08:39:24 AM INFO:File deduplication complete, shape: (65278, 40)
2025/03/04 08:39:24 AM INFO:dedupe_entity_file executed successfully
2025/03/04 08:39:24 AM INFO:Raw Data cleanup completed
2025/03/04 08:39:24 AM INFO:Data shape: (65278, 40)
2025/03/04 08:39:26 AM INFO:Data saved to output\cleaned_donations.csv
2025/03/04 08:39:26 AM INFO:Data cleanup completed, shape: (65278, 40)
2025/03/04 08:39:26 AM INFO:raw_data_cleanup executed successfully
2025/03/04 08:39:26 AM INFO:load_raw_data executed successfully
2025/03/04 08:39:26 AM INFO:get_raw_data executed successfully
2025/03/04 08:39:26 AM INFO:load_data_to_session executed successfully
2025/03/04 08:39:26 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x00000219E5367640>), kwargs={}
2025/03/04 08:39:26 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 08:39:26 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 08:39:26 AM DEBUG:Rows in Raw Data: 65278
2025/03/04 08:39:26 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'output\\cleaned_donations.csv', 'savedfilepath': 'output\\cleaned_data.csv', 'timestamp_key': 'load_raw_data_last_modified'}
2025/03/04 08:39:26 AM INFO:Original file path: output\cleaned_donations.csv
2025/03/04 08:39:26 AM INFO:Saved file path: output\cleaned_data.csv
2025/03/04 08:39:26 AM DEBUG:Calling is_file_updated with args=('output\\cleaned_donations.csv', 'load_raw_data_last_modified'), kwargs={}
2025/03/04 08:39:26 AM INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/04 08:39:26 AM DEBUG:Calling get_file_modification_time with args=('output\\cleaned_donations.csv',), kwargs={}
2025/03/04 08:39:26 AM INFO:Getting modification time for output\cleaned_donations.csv
2025/03/04 08:39:26 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:39:26 AM INFO:Current modification time: 1741077566.12045
2025/03/04 08:39:26 AM INFO:Last modification time: 1740757862.6744745
2025/03/04 08:39:26 AM INFO:is_file_updated executed successfully
2025/03/04 08:39:26 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:39:26 AM ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/04 08:39:26 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 08:39:26 AM DEBUG:Clean Data Prep: streamlitdata load: 65278
2025/03/04 08:39:26 AM DEBUG:Clean Data Prep 123: streamlitdata load: 65278
2025/03/04 08:39:29 AM DEBUG:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ...                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...  ...                              ...        ...          ...           ...               ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...          Shaftesbury Investments          1         2016             4            201604
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                Mr Jeremy Hosking          1         2016             2            201602
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   Anthony Clarke          1         2016             6            201606
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                Mr Peter A Dubens          1         2017             5            201705
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                 Mr Ravi S Kailas          1         2017             5            201705

[65278 rows x 44 columns],), kwargs={}
2025/03/04 08:39:29 AM DEBUG:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/04 08:39:29 AM DEBUG:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/04 08:39:29 AM DEBUG:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 08:39:29 AM DEBUG:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/04 08:39:29 AM DEBUG:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 08:39:29 AM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/04 08:39:29 AM ERROR:Attempting to remove duplicates
2025/03/04 08:39:30 AM DEBUG:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 46 columns]
2025/03/04 08:39:30 AM DEBUG:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/04 08:39:30 AM INFO:Data Updated with PartyName and PartyId successfully
2025/03/04 08:39:30 AM INFO:map_mp_to_party executed successfully
2025/03/04 08:39:30 AM DEBUG:Clean Data Prep 150: Map Mps: 65278
2025/03/04 08:39:30 AM DEBUG:Clean Data Prep 235: RegEntity_Map: 65278
2025/03/04 08:39:30 AM DEBUG:Calling load_election_dates with args=(), kwargs={}
2025/03/04 08:39:30 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'source\\Donations_accepted_by_political_parties.csv', 'savedfilepath': 'reference_files\\elections.csv', 'timestamp_key': 'election_dates_last_modified'}
2025/03/04 08:39:30 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:39:30 AM INFO:Saved file path: reference_files\elections.csv
2025/03/04 08:39:30 AM DEBUG:Calling is_file_updated with args=('source\\Donations_accepted_by_political_parties.csv', 'election_dates_last_modified'), kwargs={}
2025/03/04 08:39:30 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 08:39:30 AM DEBUG:Calling get_file_modification_time with args=('source\\Donations_accepted_by_political_parties.csv',), kwargs={}
2025/03/04 08:39:30 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 08:39:30 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:39:30 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 08:39:30 AM INFO:Last modification time: None
2025/03/04 08:39:30 AM INFO:is_file_updated executed successfully
2025/03/04 08:39:30 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:39:30 AM INFO:Election dates loaded from file.
2025/03/04 08:39:30 AM INFO:Election_dates_df empty - loading from pdpy.
2025/03/04 08:39:30 AM INFO:Election Dates loaded vis pdpy.
2025/03/04 08:39:30 AM DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025/03/04 08:39:30 AM INFO:Election Dates Loaded Successfully.
2025/03/04 08:39:30 AM DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/04 08:39:30 AM DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/04 08:39:30 AM INFO:load_election_dates executed successfully
2025/03/04 08:39:50 AM DEBUG:Clean Data Prep 353: Election dates: 65278
2025/03/04 08:39:50 AM DEBUG:Clean Data Prep 386: End of clean: 65278
2025/03/04 08:40:15 AM INFO:Cleaned Data completed, shape: (65278, 58)
2025/03/04 08:40:15 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 08:40:15 AM INFO:Running first load function.
2025/03/04 08:40:15 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 08:40:15 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x00000219E53675B0>), kwargs={}
2025/03/04 08:40:15 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 08:40:15 AM INFO:Running first load function.
2025/03/04 08:40:15 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 08:40:15 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x00000219E53675B0>), kwargs={}
2025/03/04 08:40:15 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 08:40:16 AM INFO:get_raw_data executed successfully
2025/03/04 08:40:16 AM INFO:load_data_to_session executed successfully
2025/03/04 08:40:16 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x00000219E5367640>), kwargs={}
2025/03/04 08:40:16 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 08:40:16 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 08:40:16 AM DEBUG:Rows in Raw Data: 65278
2025/03/04 08:40:16 AM ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/04 08:40:16 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 08:40:16 AM DEBUG:Clean Data Prep: streamlitdata load: 65278
2025/03/04 08:40:16 AM DEBUG:Clean Data Prep 123: streamlitdata load: 65278
2025/03/04 08:40:18 AM DEBUG:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ...                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...  ...                              ...        ...          ...           ...               ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...          Shaftesbury Investments          1         2016             4            201604
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                Mr Jeremy Hosking          1         2016             2            201602
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   Anthony Clarke          1         2016             6            201606
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                Mr Peter A Dubens          1         2017             5            201705
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                 Mr Ravi S Kailas          1         2017             5            201705

[65278 rows x 44 columns],), kwargs={}
2025/03/04 08:40:18 AM DEBUG:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/04 08:40:18 AM DEBUG:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/04 08:40:19 AM DEBUG:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 08:40:19 AM DEBUG:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/04 08:40:19 AM DEBUG:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 08:40:19 AM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/04 08:40:19 AM ERROR:Attempting to remove duplicates
2025/03/04 08:40:19 AM DEBUG:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 46 columns]
2025/03/04 08:40:19 AM DEBUG:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/04 08:40:19 AM INFO:Data Updated with PartyName and PartyId successfully
2025/03/04 08:40:19 AM INFO:map_mp_to_party executed successfully
2025/03/04 08:40:19 AM DEBUG:Clean Data Prep 150: Map Mps: 65278
2025/03/04 08:40:19 AM DEBUG:Clean Data Prep 235: RegEntity_Map: 65278
2025/03/04 08:40:19 AM DEBUG:Calling load_election_dates with args=(), kwargs={}
2025/03/04 08:40:19 AM INFO:load_election_dates executed successfully
2025/03/04 08:40:19 AM ERROR:Error in load_cleaned_data: st.session_state has no attribute "ElectionDatesAscend". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "ElectionDatesAscend". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 309, in load_cleaned_data
    if not st.session_state.ElectionDatesAscend:
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "ElectionDatesAscend". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/04 08:40:19 AM ERROR:Error in get_cleaned_data: st.session_state has no attribute "ElectionDatesAscend". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "ElectionDatesAscend". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 309, in load_cleaned_data
    if not st.session_state.ElectionDatesAscend:
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "ElectionDatesAscend". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/04 08:40:19 AM ERROR:Error in load_data_to_session: st.session_state has no attribute "ElectionDatesAscend". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "ElectionDatesAscend". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 309, in load_cleaned_data
    if not st.session_state.ElectionDatesAscend:
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "ElectionDatesAscend". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/04 08:40:19 AM ERROR:Error in firstload: st.session_state has no attribute "ElectionDatesAscend". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "ElectionDatesAscend". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 309, in load_cleaned_data
    if not st.session_state.ElectionDatesAscend:
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "ElectionDatesAscend". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/04 08:40:19 AM ERROR:Error in initialise_data: st.session_state has no attribute "ElectionDatesAscend". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "ElectionDatesAscend". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 42, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 309, in load_cleaned_data
    if not st.session_state.ElectionDatesAscend:
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "ElectionDatesAscend". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/04 08:40:19 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 08:40:19 AM INFO:Running first load function.
2025/03/04 08:40:19 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 08:40:19 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x00000219E53675B0>), kwargs={}
2025/03/04 08:40:19 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 08:40:19 AM INFO:Running first load function.
2025/03/04 08:40:19 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 08:40:19 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x00000219E53675B0>), kwargs={}
2025/03/04 08:45:14 AM INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/04 08:45:14 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\utils',), kwargs={}
2025/03/04 08:45:14 AM INFO:get_git_version executed successfully
2025/03/04 08:45:15 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\data',), kwargs={}
2025/03/04 08:45:15 AM INFO:get_git_version executed successfully
2025/03/04 08:45:15 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:45:15 AM INFO:Running App setup...
2025/03/04 08:45:15 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:45:15 AM INFO:Setting up the package
2025/03/04 08:45:15 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:45:15 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:45:15 AM INFO:get_git_version executed successfully
2025/03/04 08:45:15 AM INFO:Version: v20.140
2025/03/04 08:45:15 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:45:15 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:45:15 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:45:15 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:45:15 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:45:15 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:45:15 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:45:15 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:45:15 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:45:15 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:45:15 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:45:15 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:45:15 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:45:15 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:45:15 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:45:15 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:45:15 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:45:15 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:45:15 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:45:15 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:45:15 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:45:15 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:45:15 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:45:15 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:45:15 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:45:15 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:45:15 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:45:15 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:45:15 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:45:15 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:45:15 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:45:15 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:45:15 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:45:15 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:45:15 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:45:15 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:45:15 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:45:15 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:45:15 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:45:15 AM INFO:Session_state variables initialized
2025/03/04 08:45:15 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:45:15 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:45:15 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:45:15 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:45:15 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:45:15 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:45:15 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:45:15 AM DEBUG:components_dir: components
2025/03/04 08:45:15 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:45:15 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:45:15 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:45:15 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:45:15 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:45:15 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:45:15 AM DEBUG:output_dir: output
2025/03/04 08:45:15 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:45:15 AM DEBUG:perc_target: 0.5
2025/03/04 08:45:15 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:45:15 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:45:15 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:45:15 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:45:15 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:45:15 AM DEBUG:data_dir: data
2025/03/04 08:45:15 AM DEBUG:reference_dir: reference_files
2025/03/04 08:45:15 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:45:15 AM DEBUG:logs_dir: logs
2025/03/04 08:45:15 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:45:15 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:45:15 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:45:15 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:45:15 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:45:15 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:45:15 AM DEBUG:utils_dir: utils
2025/03/04 08:45:15 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:45:15 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:45:15 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:45:15 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:45:15 AM INFO:Session state Setup complete
2025/03/04 08:45:15 AM INFO:initialize_session_state executed successfully
2025/03/04 08:45:15 AM INFO:Package setup complete
2025/03/04 08:45:15 AM INFO:setup_package executed successfully
2025/03/04 08:45:15 AM INFO:Running Menu setup...
2025/03/04 08:45:15 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:45:15 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\app_pages',), kwargs={}
2025/03/04 08:45:15 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:45:15 AM INFO:Running App setup...
2025/03/04 08:45:15 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:45:15 AM INFO:Setting up the package
2025/03/04 08:45:15 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:45:15 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:45:15 AM INFO:get_git_version executed successfully
2025/03/04 08:45:15 AM INFO:Version: v20.140
2025/03/04 08:45:15 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:45:15 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:45:15 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:45:15 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:45:15 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:45:15 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:45:15 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:45:15 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:45:15 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:45:15 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:45:15 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:45:15 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:45:15 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:45:15 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:45:15 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:45:15 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:45:15 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:45:15 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:45:15 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:45:15 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:45:15 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:45:15 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:45:15 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:45:15 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:45:15 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:45:15 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:45:15 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:45:15 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:45:15 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:45:15 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:45:15 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:45:15 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:45:15 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:45:15 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:45:15 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:45:15 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:45:15 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:45:15 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:45:15 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:45:15 AM INFO:Session_state variables initialized
2025/03/04 08:45:15 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:45:15 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:45:15 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:45:15 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:45:15 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:45:15 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:45:15 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:45:15 AM DEBUG:components_dir: components
2025/03/04 08:45:15 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:45:15 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:45:15 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:45:15 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:45:15 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:45:15 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:45:15 AM DEBUG:output_dir: output
2025/03/04 08:45:15 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:45:15 AM DEBUG:perc_target: 0.5
2025/03/04 08:45:15 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:45:15 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:45:15 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:45:15 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:45:15 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:45:15 AM DEBUG:data_dir: data
2025/03/04 08:45:15 AM DEBUG:reference_dir: reference_files
2025/03/04 08:45:15 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:45:15 AM DEBUG:logs_dir: logs
2025/03/04 08:45:15 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:45:15 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:45:15 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:45:15 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:45:15 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:45:15 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:45:15 AM DEBUG:utils_dir: utils
2025/03/04 08:45:15 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:45:15 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:45:15 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:45:15 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:45:15 AM INFO:Session state Setup complete
2025/03/04 08:45:15 AM INFO:initialize_session_state executed successfully
2025/03/04 08:45:15 AM INFO:Package setup complete
2025/03/04 08:45:15 AM INFO:setup_package executed successfully
2025/03/04 08:45:15 AM INFO:Running Menu setup...
2025/03/04 08:45:15 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:45:15 AM INFO:get_git_version executed successfully
2025/03/04 08:45:15 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\components',), kwargs={}
2025/03/04 08:45:15 AM INFO:get_git_version executed successfully
2025/03/04 08:45:15 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:45:15 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:45:16 AM INFO:get_git_version executed successfully
2025/03/04 08:45:16 AM INFO:get_git_version executed successfully
2025/03/04 08:45:16 AM INFO:App Version: v20.161
2025/03/04 08:45:16 AM INFO:App Version: v20.161
2025/03/04 08:45:16 AM INFO:Switched to page: Introduction
2025/03/04 08:45:16 AM INFO:Switched to page: Introduction
2025/03/04 08:45:16 AM INFO:pagesetup executed successfully
2025/03/04 08:45:16 AM INFO:pagesetup executed successfully
2025/03/04 08:45:16 AM INFO:No data found in session state, running firstload()
2025/03/04 08:45:16 AM INFO:No data found in session state, running firstload()
2025/03/04 08:45:16 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 08:45:16 AM ERROR:Error in initialise_data: cannot assign to attribute here. Maybe you meant '==' instead of '='? (clean_and_enhance.py, line 309)
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 39, in initialise_data
    from data.data_loader import firstload
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 3, in <module>
    from data.clean_and_enhance import load_cleaned_data
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 309
    if st.session_state.ElectionDatesAscend = None:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: cannot assign to attribute here. Maybe you meant '==' instead of '='?
2025/03/04 08:45:16 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 08:45:16 AM ERROR:Error in initialise_data: cannot assign to attribute here. Maybe you meant '==' instead of '='? (clean_and_enhance.py, line 309)
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 39, in initialise_data
    from data.data_loader import firstload
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 3, in <module>
    from data.clean_and_enhance import load_cleaned_data
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 309
    if st.session_state.ElectionDatesAscend = None:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: cannot assign to attribute here. Maybe you meant '==' instead of '='?
2025/03/04 08:45:40 AM INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/04 08:45:40 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\utils',), kwargs={}
2025/03/04 08:45:41 AM INFO:get_git_version executed successfully
2025/03/04 08:45:42 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\data',), kwargs={}
2025/03/04 08:45:42 AM INFO:get_git_version executed successfully
2025/03/04 08:45:42 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:45:42 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:45:42 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:45:42 AM INFO:Running App setup...
2025/03/04 08:45:42 AM INFO:Running App setup...
2025/03/04 08:45:42 AM INFO:Running App setup...
2025/03/04 08:45:42 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:45:42 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:45:42 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:45:42 AM INFO:Setting up the package
2025/03/04 08:45:42 AM INFO:Setting up the package
2025/03/04 08:45:42 AM INFO:Setting up the package
2025/03/04 08:45:42 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:45:42 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:45:42 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:45:42 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:45:42 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:45:42 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:45:42 AM INFO:get_git_version executed successfully
2025/03/04 08:45:42 AM INFO:get_git_version executed successfully
2025/03/04 08:45:42 AM INFO:get_git_version executed successfully
2025/03/04 08:45:42 AM INFO:Version: v20.140
2025/03/04 08:45:42 AM INFO:Version: v20.140
2025/03/04 08:45:42 AM INFO:Version: v20.140
2025/03/04 08:45:42 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:45:42 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:45:42 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:45:42 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:45:42 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:45:42 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:45:42 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:45:42 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:45:42 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:45:42 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:45:42 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:45:42 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:45:42 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:45:42 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:45:42 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:45:42 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:45:42 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:45:42 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:45:42 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:45:42 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:45:42 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:45:42 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:45:42 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:45:42 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:45:42 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:45:42 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:45:42 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:45:42 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:45:42 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:45:42 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:45:42 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:45:42 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:45:42 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:45:42 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:45:42 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:45:42 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:45:42 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:45:42 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:45:42 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:45:42 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:45:42 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:45:42 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:45:42 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:45:42 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:45:42 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:45:42 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:45:42 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:45:42 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:45:42 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:45:42 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:45:42 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:45:42 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:45:42 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:45:42 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:45:42 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:45:42 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:45:42 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:45:42 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:45:42 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:45:42 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:45:42 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:45:42 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:45:42 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:45:42 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:45:42 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:45:42 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:45:42 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:45:42 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:45:42 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:45:42 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:45:42 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:45:42 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:45:42 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:45:42 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:45:42 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:45:42 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:45:42 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:45:42 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:45:42 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:45:42 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:45:42 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:45:42 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:45:42 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:45:42 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:45:42 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:45:42 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:45:42 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:45:42 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:45:42 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:45:42 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:45:42 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:45:42 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:45:42 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:45:42 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:45:42 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:45:42 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:45:42 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:45:42 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:45:42 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:45:42 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:45:42 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:45:42 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:45:42 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:45:42 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:45:42 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:45:42 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:45:42 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:45:42 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:45:42 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:45:42 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:45:42 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:45:42 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:45:42 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:45:42 AM INFO:Session_state variables initialized
2025/03/04 08:45:42 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:45:42 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:45:42 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:45:42 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:45:42 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:45:42 AM DEBUG:output_dir: output
2025/03/04 08:45:42 AM INFO:Session_state variables initialized
2025/03/04 08:45:42 AM INFO:Session_state variables initialized
2025/03/04 08:45:42 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:45:42 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:45:42 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:45:42 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:45:42 AM DEBUG:output_dir: output
2025/03/04 08:45:42 AM DEBUG:output_dir: output
2025/03/04 08:45:42 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:45:42 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:45:42 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:45:42 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:45:42 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:45:42 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:45:42 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:45:42 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:45:42 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:45:42 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:45:42 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:45:42 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:45:42 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:45:42 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:45:42 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:45:42 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:45:42 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:45:42 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:45:42 AM DEBUG:components_dir: components
2025/03/04 08:45:42 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:45:42 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:45:42 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:45:42 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:45:42 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:45:42 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:45:42 AM DEBUG:components_dir: components
2025/03/04 08:45:42 AM DEBUG:components_dir: components
2025/03/04 08:45:42 AM DEBUG:utils_dir: utils
2025/03/04 08:45:42 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:45:42 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:45:42 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:45:42 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:45:42 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:45:42 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:45:42 AM DEBUG:utils_dir: utils
2025/03/04 08:45:42 AM DEBUG:utils_dir: utils
2025/03/04 08:45:42 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:45:42 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:45:42 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:45:42 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:45:42 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:45:42 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:45:42 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:45:42 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:45:42 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:45:42 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:45:42 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:45:42 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:45:42 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:45:42 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:45:42 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:45:42 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:45:42 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:45:42 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:45:42 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:45:42 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:45:42 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:45:42 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:45:42 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:45:42 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:45:42 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:45:42 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:45:42 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:45:42 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:45:42 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:45:42 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:45:42 AM DEBUG:perc_target: 0.5
2025/03/04 08:45:42 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:45:42 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:45:42 AM DEBUG:data_dir: data
2025/03/04 08:45:42 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:45:42 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:45:42 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:45:42 AM DEBUG:perc_target: 0.5
2025/03/04 08:45:42 AM DEBUG:perc_target: 0.5
2025/03/04 08:45:42 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:45:42 AM DEBUG:data_dir: data
2025/03/04 08:45:42 AM DEBUG:data_dir: data
2025/03/04 08:45:42 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:45:42 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:45:42 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:45:42 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:45:42 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:45:42 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:45:42 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:45:42 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:45:42 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:45:42 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:45:42 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:45:42 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:45:42 AM DEBUG:logs_dir: logs
2025/03/04 08:45:42 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:45:42 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:45:42 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:45:42 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:45:42 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:45:42 AM DEBUG:reference_dir: reference_files
2025/03/04 08:45:42 AM DEBUG:logs_dir: logs
2025/03/04 08:45:42 AM DEBUG:logs_dir: logs
2025/03/04 08:45:42 AM INFO:Session state Setup complete
2025/03/04 08:45:42 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:45:42 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:45:42 AM INFO:initialize_session_state executed successfully
2025/03/04 08:45:42 AM DEBUG:reference_dir: reference_files
2025/03/04 08:45:42 AM DEBUG:reference_dir: reference_files
2025/03/04 08:45:42 AM INFO:Package setup complete
2025/03/04 08:45:42 AM INFO:Session state Setup complete
2025/03/04 08:45:42 AM INFO:Session state Setup complete
2025/03/04 08:45:42 AM INFO:setup_package executed successfully
2025/03/04 08:45:42 AM INFO:initialize_session_state executed successfully
2025/03/04 08:45:42 AM INFO:initialize_session_state executed successfully
2025/03/04 08:45:42 AM INFO:Running Menu setup...
2025/03/04 08:45:42 AM INFO:Package setup complete
2025/03/04 08:45:42 AM INFO:Package setup complete
2025/03/04 08:45:42 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:45:42 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\app_pages',), kwargs={}
2025/03/04 08:45:42 AM INFO:setup_package executed successfully
2025/03/04 08:45:42 AM INFO:setup_package executed successfully
2025/03/04 08:45:42 AM INFO:Running Menu setup...
2025/03/04 08:45:42 AM INFO:Running Menu setup...
2025/03/04 08:45:42 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:45:42 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:45:42 AM INFO:get_git_version executed successfully
2025/03/04 08:45:42 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\components',), kwargs={}
2025/03/04 08:45:42 AM INFO:get_git_version executed successfully
2025/03/04 08:45:42 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:45:42 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:45:42 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:45:42 AM INFO:get_git_version executed successfully
2025/03/04 08:45:42 AM INFO:get_git_version executed successfully
2025/03/04 08:45:42 AM INFO:get_git_version executed successfully
2025/03/04 08:45:42 AM INFO:App Version: v20.161
2025/03/04 08:45:42 AM INFO:App Version: v20.161
2025/03/04 08:45:42 AM INFO:App Version: v20.161
2025/03/04 08:45:42 AM INFO:Switched to page: Introduction
2025/03/04 08:45:42 AM INFO:Switched to page: Introduction
2025/03/04 08:45:42 AM INFO:Switched to page: Introduction
2025/03/04 08:45:42 AM INFO:pagesetup executed successfully
2025/03/04 08:45:42 AM INFO:pagesetup executed successfully
2025/03/04 08:45:42 AM INFO:pagesetup executed successfully
2025/03/04 08:45:42 AM INFO:No data found in session state, running firstload()
2025/03/04 08:45:42 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 08:45:42 AM INFO:No data found in session state, running firstload()
2025/03/04 08:45:42 AM INFO:No data found in session state, running firstload()
2025/03/04 08:45:43 AM INFO:Running first load function.
2025/03/04 08:45:43 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 08:45:43 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x0000025DAA3B9D80>), kwargs={}
2025/03/04 08:45:43 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 08:45:43 AM DEBUG:Calling load_raw_data with args=(), kwargs={'main_file': 'raw_data', 'cleaned_file': 'raw_data_clean', 'output_csv': True, 'dedupe_donors': True, 'dedupe_regentity': True, 'originaldatafilepath': 'source_data_fname', 'processeddatafilepath': 'imported_raw_fname'}
2025/03/04 08:45:43 AM DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/04 08:45:43 AM DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/04 08:45:43 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'source\\Donations_accepted_by_political_parties.csv', 'savedfilepath': 'output\\imported_raw.csv', 'timestamp_key': 'load_raw_data_last_modified'}
2025/03/04 08:45:43 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:45:43 AM INFO:Saved file path: output\imported_raw.csv
2025/03/04 08:45:43 AM DEBUG:Calling is_file_updated with args=('source\\Donations_accepted_by_political_parties.csv', 'load_raw_data_last_modified'), kwargs={}
2025/03/04 08:45:43 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 08:45:43 AM DEBUG:Calling get_file_modification_time with args=('source\\Donations_accepted_by_political_parties.csv',), kwargs={}
2025/03/04 08:45:43 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 08:45:43 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:45:43 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 08:45:43 AM INFO:Last modification time: None
2025/03/04 08:45:43 AM INFO:is_file_updated executed successfully
2025/03/04 08:45:43 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:45:43 AM INFO:Loading raw data...
2025/03/04 08:45:43 AM DEBUG:Original data file path post raw data load: {originaldatafilepath}
2025/03/04 08:45:43 AM DEBUG:Processed data file path post raw data load: {processeddatafilepath}
2025/03/04 08:45:43 AM INFO:Data loaded successfully. Data has 65278 rows and 29 columns
2025/03/04 08:45:44 AM INFO:Data saved to output\imported_raw.csv
2025/03/04 08:45:44 AM DEBUG:Calling raw_data_cleanup with args=(), kwargs={'loaddata_df':            ECRef              RegulatedEntityName    RegulatedEntityType        Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                               ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    £1,876.56   02/09/2019  ...              NaN  86310.0             NaN  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    £2,700.00   02/09/2019  ...              NaN  86310.0             NaN  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    £4,852.58   30/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    £2,500.00   30/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    £4,524.05   29/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
...          ...                              ...                    ...          ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   £10,000.00          NaN  ...              NaN  74198.0             NaN            NaN         False
65274   C0242461               Vote Leave Limited  Permitted Participant  £100,000.00          NaN  ...              NaN  74184.0             NaN            NaN         False
65275   C0243560               Vote Leave Limited  Permitted Participant   £40,000.00          NaN  ...              NaN  74576.0             NaN            NaN         False
65276   C0319710  Conservative and Unionist Party        Political Party   £50,000.00          NaN  ...              NaN  34241.0             NaN  Great Britain         False
65277   C0319727  Conservative and Unionist Party        Political Party   £15,000.00          NaN  ...              NaN  74743.0             NaN  Great Britain         False

[65278 rows x 29 columns], 'dedupe_donors': True, 'dedupe_regentity': True, 'output_csv': True, 'originaldatafilepath': 'output\\imported_raw.csv', 'processeddatafilepath': 'cleaned_donations_fname'}
2025/03/04 08:45:44 AM INFO:Cleaning up raw data
2025/03/04 08:45:44 AM ERROR:Session state variables not initialized!
2025/03/04 08:45:44 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': None, 'savedfilepath': 'output\\cleaned_donations.csv', 'timestamp_key': 'cleaned_raw_data_last_modified'}
2025/03/04 08:45:44 AM INFO:Original file path: None
2025/03/04 08:45:44 AM INFO:Saved file path: output\cleaned_donations.csv
2025/03/04 08:45:44 AM ERROR:Error: originalfilepath is None!
2025/03/04 08:45:44 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:45:44 AM INFO:Data loaded, shape: (65278, 29)
2025/03/04 08:45:45 AM DEBUG:Calling dedupe_entity_file with args=(), kwargs={'loaddata_dd_df':            ECRef              RegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                             ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...                   86310.0                  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...                   86310.0                  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...                   86310.0                  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...                   86310.0                  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...                   86310.0                  Great Britain         False
...          ...                              ...                    ...        ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...                   74198.0                          Other         False
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                   74184.0                          Other         False
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   74576.0                          Other         False
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                   34241.0                  Great Britain         False
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                   74743.0                  Great Britain         False

[65278 rows x 29 columns], 'entity': 'RegulatedEntity', 'map_filename': 'regentity_map_fname', 'output_csv': True}
2025/03/04 08:45:45 AM DEBUG:Calling is_file_updated with args=('reference_files\\PoliticalEntityDeDuped.csv', 'regentity_map_fname_last_modified'), kwargs={}
2025/03/04 08:45:45 AM INFO:Checking if reference_files\PoliticalEntityDeDuped.csv has been updated.
2025/03/04 08:45:45 AM DEBUG:Calling get_file_modification_time with args=('reference_files\\PoliticalEntityDeDuped.csv',), kwargs={}
2025/03/04 08:45:45 AM INFO:Getting modification time for reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:45:45 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:45:45 AM INFO:Current modification time: 1740841102.2638545
2025/03/04 08:45:45 AM INFO:Last modification time: None
2025/03/04 08:45:45 AM INFO:is_file_updated executed successfully
2025/03/04 08:45:45 AM INFO:Map file regentity_map_fname has been updated. Proceeding with deduplication.
2025/03/04 08:45:45 AM INFO:File deduplication complete, shape: (65278, 34)
2025/03/04 08:45:45 AM INFO:dedupe_entity_file executed successfully
2025/03/04 08:45:45 AM DEBUG:Calling dedupe_entity_file with args=(), kwargs={'loaddata_dd_df':            ECRef      OriginalRegulatedEntityName    RegulatedEntityType  ...      OriginalRegulatedEntityName RegulatedEntityId              RegulatedEntityName
0      NC0408174                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
1      NC0408173                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
2      NC0408177                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
3      NC0408176                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
4      NC0408170                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
...          ...                              ...                    ...  ...                              ...               ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65274   C0242461               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65275   C0243560               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65276   C0319710  Conservative And Unionist Party        Political Party  ...  Conservative And Unionist Party              52.0  Conservative And Unionist Party
65277   C0319727  Conservative And Unionist Party        Political Party  ...  Conservative And Unionist Party              52.0  Conservative And Unionist Party

[65278 rows x 34 columns], 'entity': 'Donor', 'map_filename': 'donor_map_fname', 'output_csv': True}
2025/03/04 08:45:45 AM DEBUG:Calling is_file_updated with args=('reference_files\\PoliticalDonorsDeduped.csv', 'donor_map_fname_last_modified'), kwargs={}
2025/03/04 08:45:45 AM INFO:Checking if reference_files\PoliticalDonorsDeduped.csv has been updated.
2025/03/04 08:45:45 AM DEBUG:Calling get_file_modification_time with args=('reference_files\\PoliticalDonorsDeduped.csv',), kwargs={}
2025/03/04 08:45:45 AM INFO:Getting modification time for reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:45:45 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:45:45 AM INFO:Current modification time: 1740757863.2545311
2025/03/04 08:45:45 AM INFO:Last modification time: None
2025/03/04 08:45:45 AM INFO:is_file_updated executed successfully
2025/03/04 08:45:45 AM INFO:Map file donor_map_fname has been updated. Proceeding with deduplication.
2025/03/04 08:45:45 AM INFO:File deduplication complete, shape: (65278, 40)
2025/03/04 08:45:45 AM INFO:dedupe_entity_file executed successfully
2025/03/04 08:45:45 AM INFO:Raw Data cleanup completed
2025/03/04 08:45:45 AM INFO:Data shape: (65278, 40)
2025/03/04 08:45:47 AM INFO:Data saved to output\cleaned_donations.csv
2025/03/04 08:45:47 AM INFO:Data cleanup completed, shape: (65278, 40)
2025/03/04 08:45:47 AM INFO:raw_data_cleanup executed successfully
2025/03/04 08:45:47 AM INFO:load_raw_data executed successfully
2025/03/04 08:45:47 AM INFO:get_raw_data executed successfully
2025/03/04 08:45:47 AM INFO:load_data_to_session executed successfully
2025/03/04 08:45:47 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x0000025DAA3B9E10>), kwargs={}
2025/03/04 08:45:47 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 08:45:47 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 08:45:47 AM DEBUG:Rows in Raw Data: 65278
2025/03/04 08:45:47 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'output\\cleaned_donations.csv', 'savedfilepath': 'output\\cleaned_data.csv', 'timestamp_key': 'load_raw_data_last_modified'}
2025/03/04 08:45:47 AM INFO:Original file path: output\cleaned_donations.csv
2025/03/04 08:45:47 AM INFO:Saved file path: output\cleaned_data.csv
2025/03/04 08:45:47 AM DEBUG:Calling is_file_updated with args=('output\\cleaned_donations.csv', 'load_raw_data_last_modified'), kwargs={}
2025/03/04 08:45:47 AM INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/04 08:45:47 AM DEBUG:Calling get_file_modification_time with args=('output\\cleaned_donations.csv',), kwargs={}
2025/03/04 08:45:47 AM INFO:Getting modification time for output\cleaned_donations.csv
2025/03/04 08:45:47 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:45:47 AM INFO:Current modification time: 1741077947.4282584
2025/03/04 08:45:47 AM INFO:Last modification time: 1740757862.6744745
2025/03/04 08:45:47 AM INFO:is_file_updated executed successfully
2025/03/04 08:45:47 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:45:47 AM ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/04 08:45:47 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 08:45:47 AM DEBUG:Clean Data Prep: streamlitdata load: 65278
2025/03/04 08:45:47 AM DEBUG:Clean Data Prep 123: streamlitdata load: 65278
2025/03/04 08:45:50 AM DEBUG:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ...                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...  ...                              ...        ...          ...           ...               ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...          Shaftesbury Investments          1         2016             4            201604
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                Mr Jeremy Hosking          1         2016             2            201602
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   Anthony Clarke          1         2016             6            201606
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                Mr Peter A Dubens          1         2017             5            201705
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                 Mr Ravi S Kailas          1         2017             5            201705

[65278 rows x 44 columns],), kwargs={}
2025/03/04 08:45:50 AM DEBUG:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/04 08:45:50 AM DEBUG:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/04 08:45:50 AM DEBUG:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 08:45:51 AM DEBUG:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/04 08:45:51 AM DEBUG:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 08:45:51 AM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/04 08:45:51 AM ERROR:Attempting to remove duplicates
2025/03/04 08:45:51 AM DEBUG:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 46 columns]
2025/03/04 08:45:51 AM DEBUG:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/04 08:45:51 AM INFO:Data Updated with PartyName and PartyId successfully
2025/03/04 08:45:51 AM INFO:map_mp_to_party executed successfully
2025/03/04 08:45:51 AM DEBUG:Clean Data Prep 150: Map Mps: 65278
2025/03/04 08:45:51 AM DEBUG:Clean Data Prep 235: RegEntity_Map: 65278
2025/03/04 08:45:51 AM DEBUG:Calling load_election_dates with args=(), kwargs={}
2025/03/04 08:45:51 AM DEBUG:st.session_state.ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:45:51 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'source\\Donations_accepted_by_political_parties.csv', 'savedfilepath': 'reference_files\\elections.csv', 'timestamp_key': 'election_dates_last_modified'}
2025/03/04 08:45:51 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:45:51 AM INFO:Saved file path: reference_files\elections.csv
2025/03/04 08:45:51 AM DEBUG:Calling is_file_updated with args=('source\\Donations_accepted_by_political_parties.csv', 'election_dates_last_modified'), kwargs={}
2025/03/04 08:45:51 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 08:45:51 AM DEBUG:Calling get_file_modification_time with args=('source\\Donations_accepted_by_political_parties.csv',), kwargs={}
2025/03/04 08:45:51 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 08:45:51 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:45:51 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 08:45:51 AM INFO:Last modification time: None
2025/03/04 08:45:51 AM INFO:is_file_updated executed successfully
2025/03/04 08:45:51 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:45:51 AM INFO:Election dates loaded from file.
2025/03/04 08:45:51 AM INFO:Election_dates_df empty - loading from pdpy.
2025/03/04 08:45:51 AM INFO:Election Dates loaded vis pdpy.
2025/03/04 08:45:51 AM DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025/03/04 08:45:51 AM INFO:Election Dates Loaded Successfully.
2025/03/04 08:45:51 AM DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/04 08:45:51 AM DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/04 08:45:51 AM INFO:load_election_dates executed successfully
2025/03/04 08:46:10 AM DEBUG:Clean Data Prep 353: Election dates: 65278
2025/03/04 08:46:10 AM DEBUG:Clean Data Prep 386: End of clean: 65278
2025/03/04 08:46:37 AM INFO:Cleaned Data completed, shape: (65278, 58)
2025/03/04 08:46:37 AM INFO:load_cleaned_data executed successfully
2025/03/04 08:46:37 AM INFO:get_cleaned_data executed successfully
2025/03/04 08:46:37 AM INFO:load_data_to_session executed successfully
2025/03/04 08:46:37 AM DEBUG:Calling load_data_to_session with args=('data_donor', <function get_donor_data at 0x0000025DAA3B9FC0>), kwargs={}
2025/03/04 08:46:37 AM DEBUG:Calling get_donor_data with args=(), kwargs={}
2025/03/04 08:46:37 AM DEBUG:Calling load_donorList_data with args=(), kwargs={'main_file': 'data_clean', 'cleaned_file': 'data_donor', 'streamlitrun': True, 'output_csv': True, 'originaldatafilepath': 'cleaned_data_fname', 'cleaneddatafilepath': 'cleaned_donorlist_fname'}
2025/03/04 08:46:37 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'output\\cleaned_data.csv', 'savedfilepath': 'output\\cleaned_donorlist.csv', 'timestamp_key': 'load_donorlist_data_last_modified'}
2025/03/04 08:46:37 AM INFO:Original file path: output\cleaned_data.csv
2025/03/04 08:46:37 AM INFO:Saved file path: output\cleaned_donorlist.csv
2025/03/04 08:46:37 AM DEBUG:Calling is_file_updated with args=('output\\cleaned_data.csv', 'load_donorlist_data_last_modified'), kwargs={}
2025/03/04 08:46:37 AM INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/04 08:46:37 AM DEBUG:Calling get_file_modification_time with args=('output\\cleaned_data.csv',), kwargs={}
2025/03/04 08:46:37 AM INFO:Getting modification time for output\cleaned_data.csv
2025/03/04 08:46:37 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:46:37 AM INFO:Current modification time: 1741077997.3217723
2025/03/04 08:46:37 AM INFO:Last modification time: None
2025/03/04 08:46:37 AM INFO:is_file_updated executed successfully
2025/03/04 08:46:37 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:46:37 AM INFO:Donor data saved to output\cleaned_donorlist.csv
2025/03/04 08:46:37 AM INFO:Donor Data summary completed
2025/03/04 08:46:37 AM INFO:Data shape: (30219, 5)
2025/03/04 08:46:37 AM INFO:load_donorList_data executed successfully
2025/03/04 08:46:37 AM INFO:get_donor_data executed successfully
2025/03/04 08:46:37 AM INFO:load_data_to_session executed successfully
2025/03/04 08:46:37 AM DEBUG:Calling load_data_to_session with args=('data_regentity', <function get_regentity_data at 0x0000025DAA3BA0E0>), kwargs={}
2025/03/04 08:46:37 AM DEBUG:Calling get_regentity_data with args=(), kwargs={}
2025/03/04 08:46:37 AM DEBUG:Calling load_regulated_entity_data with args=(), kwargs={'main_file': 'data_clean', 'cleaned_file': 'data_regentity', 'streamlitrun': True, 'output_csv': True, 'originaldatafilepath': 'cleaned_data_fname', 'cleaneddatafilepath': 'cleaned_regentity_fname'}
2025/03/04 08:46:37 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'output\\cleaned_data.csv', 'savedfilepath': 'output\\cleaned_regentity.csv', 'timestamp_key': 'load_donorlist_data_last_modified'}
2025/03/04 08:46:37 AM INFO:Original file path: output\cleaned_data.csv
2025/03/04 08:46:37 AM INFO:Saved file path: output\cleaned_regentity.csv
2025/03/04 08:46:37 AM DEBUG:Calling is_file_updated with args=('output\\cleaned_data.csv', 'load_donorlist_data_last_modified'), kwargs={}
2025/03/04 08:46:37 AM INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/04 08:46:37 AM DEBUG:Calling get_file_modification_time with args=('output\\cleaned_data.csv',), kwargs={}
2025/03/04 08:46:37 AM INFO:Getting modification time for output\cleaned_data.csv
2025/03/04 08:46:37 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:46:37 AM INFO:Current modification time: 1741077997.3217723
2025/03/04 08:46:37 AM INFO:Last modification time: 1741077997.3217723
2025/03/04 08:46:37 AM INFO:is_file_updated executed successfully
2025/03/04 08:46:37 AM INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated load_donorlist_data_last_modified instead of output\cleaned_data.csv
2025/03/04 08:46:37 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:46:37 AM INFO:load_regulated_entity_data executed successfully
2025/03/04 08:46:37 AM INFO:get_regentity_data executed successfully
2025/03/04 08:46:37 AM INFO:load_data_to_session executed successfully
2025/03/04 08:46:37 AM INFO:firstload executed successfully
2025/03/04 08:46:37 AM INFO:initialise_data executed successfully
2025/03/04 08:46:48 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:46:48 AM INFO:Running App setup...
2025/03/04 08:46:48 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:46:48 AM INFO:Setting up the package
2025/03/04 08:46:48 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:46:48 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:46:48 AM INFO:get_git_version executed successfully
2025/03/04 08:46:48 AM INFO:Version: v20.140
2025/03/04 08:46:48 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:46:48 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:46:48 AM DEBUG:LOG_LEVEL already exists in session state
2025/03/04 08:46:48 AM DEBUG:BASE_DIR already exists in session state
2025/03/04 08:46:48 AM DEBUG:filenames already exists in session state
2025/03/04 08:46:48 AM DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/04 08:46:48 AM DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/04 08:46:48 AM DEBUG:thresholds already exists in session state
2025/03/04 08:46:48 AM DEBUG:data_remappings already exists in session state
2025/03/04 08:46:48 AM DEBUG:filter_def already exists in session state
2025/03/04 08:46:48 AM DEBUG:security already exists in session state
2025/03/04 08:46:48 AM DEBUG:perc_target already exists in session state
2025/03/04 08:46:48 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/04 08:46:48 AM DEBUG:directories already exists in session state
2025/03/04 08:46:48 AM DEBUG:reference_dir already exists in session state
2025/03/04 08:46:48 AM DEBUG:data_dir already exists in session state
2025/03/04 08:46:48 AM DEBUG:output_dir already exists in session state
2025/03/04 08:46:48 AM DEBUG:logs_dir already exists in session state
2025/03/04 08:46:48 AM DEBUG:components_dir already exists in session state
2025/03/04 08:46:48 AM DEBUG:app_pages_dir already exists in session state
2025/03/04 08:46:48 AM DEBUG:utils_dir already exists in session state
2025/03/04 08:46:48 AM DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/04 08:46:48 AM DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/04 08:46:48 AM DEBUG:mppartymemb_fname already exists in session state
2025/03/04 08:46:48 AM DEBUG:donor_map_fname already exists in session state
2025/03/04 08:46:48 AM DEBUG:politician_party_fname already exists in session state
2025/03/04 08:46:48 AM DEBUG:regentity_map_fname already exists in session state
2025/03/04 08:46:48 AM DEBUG:original_data_fname already exists in session state
2025/03/04 08:46:48 AM DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/04 08:46:48 AM DEBUG:TEXT_FILE already exists in session state
2025/03/04 08:46:48 AM DEBUG:ELECTION_DATES already exists in session state
2025/03/04 08:46:48 AM DEBUG:cleaned_data_fname already exists in session state
2025/03/04 08:46:48 AM DEBUG:cleaned_donations_fname already exists in session state
2025/03/04 08:46:48 AM DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/04 08:46:48 AM DEBUG:cleaned_regentity_fname already exists in session state
2025/03/04 08:46:48 AM DEBUG:party_summary_fname already exists in session state
2025/03/04 08:46:48 AM DEBUG:imported_raw_fname already exists in session state
2025/03/04 08:46:48 AM DEBUG:source_data_fname already exists in session state
2025/03/04 08:46:48 AM DEBUG:Cash_ftr already exists in session state
2025/03/04 08:46:48 AM INFO:Session_state variables initialized
2025/03/04 08:46:48 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:46:48 AM DEBUG:output_dir: output
2025/03/04 08:46:48 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:46:48 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:46:48 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:46:48 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:46:48 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:46:48 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:46:48 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:46:48 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:46:48 AM DEBUG:components_dir: components
2025/03/04 08:46:48 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:46:48 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:46:48 AM DEBUG:utils_dir: utils
2025/03/04 08:46:48 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:46:48 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:46:48 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:46:48 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:46:48 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:46:48 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:46:48 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:46:48 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:46:48 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:46:48 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:46:48 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:46:48 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:46:48 AM DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x0000025DAA0E0CA0>}
2025/03/04 08:46:48 AM DEBUG:perc_target: 0.5
2025/03/04 08:46:48 AM DEBUG:data_dir: data
2025/03/04 08:46:48 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:46:48 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:46:48 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:46:48 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:46:48 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:46:48 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:46:48 AM DEBUG:logs_dir: logs
2025/03/04 08:46:48 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:46:48 AM DEBUG:reference_dir: reference_files
2025/03/04 08:46:48 AM INFO:Session state Setup complete
2025/03/04 08:46:48 AM INFO:initialize_session_state executed successfully
2025/03/04 08:46:48 AM INFO:Package setup complete
2025/03/04 08:46:48 AM INFO:setup_package executed successfully
2025/03/04 08:46:48 AM INFO:Running Menu setup...
2025/03/04 08:46:48 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:46:48 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:46:48 AM INFO:get_git_version executed successfully
2025/03/04 08:46:48 AM INFO:App Version: v20.161
2025/03/04 08:46:48 AM INFO:Switched to page: Head Line Figures
2025/03/04 08:46:48 AM DEBUG:Calling hlf_body with args=(), kwargs={}
2025/03/04 08:46:48 AM DEBUG:Calling load_and_filter_data with args=(), kwargs={'filter_key': None, 'pagereflabel': 'headlinefigures'}
2025/03/04 08:46:48 AM ERROR:Error in load_and_filter_data: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state["data_clean"]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
2025/03/04 08:46:48 AM ERROR:Error in hlf_body: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state["data_clean"]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
2025/03/04 08:46:48 AM ERROR:Error in pagesetup: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state["data_clean"]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
2025/03/04 08:46:48 AM CRITICAL:Menu setup crashed: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state["data_clean"]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
2025/03/04 08:53:12 AM INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/04 08:53:12 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\utils',), kwargs={}
2025/03/04 08:53:13 AM INFO:get_git_version executed successfully
2025/03/04 08:53:14 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\data',), kwargs={}
2025/03/04 08:53:14 AM INFO:get_git_version executed successfully
2025/03/04 08:53:14 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:53:14 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:53:14 AM INFO:Running App setup...
2025/03/04 08:53:14 AM INFO:Running App setup...
2025/03/04 08:53:14 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:53:14 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:53:14 AM INFO:Setting up the package
2025/03/04 08:53:14 AM INFO:Setting up the package
2025/03/04 08:53:14 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:53:14 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:53:14 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:53:14 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:53:14 AM INFO:get_git_version executed successfully
2025/03/04 08:53:14 AM INFO:get_git_version executed successfully
2025/03/04 08:53:14 AM INFO:Version: v20.140
2025/03/04 08:53:14 AM INFO:Version: v20.140
2025/03/04 08:53:14 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:53:14 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:53:14 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:53:14 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:53:14 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:53:14 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:53:14 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:53:14 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:53:14 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:53:14 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:53:14 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:53:14 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:53:14 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:53:14 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:53:14 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:53:14 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:53:14 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:53:14 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:53:14 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:53:14 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:53:14 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:53:14 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:53:14 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:53:14 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:53:14 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:53:14 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:53:14 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:53:14 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:53:14 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:53:14 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:53:14 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:53:14 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:53:14 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:53:14 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:53:14 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:53:14 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:53:14 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:53:14 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:53:14 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:53:14 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:53:14 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:53:14 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:53:14 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:53:14 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:53:14 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:53:14 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:53:14 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:53:14 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:53:14 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:53:14 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:53:14 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:53:14 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:53:14 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:53:14 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:53:14 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:53:14 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:53:14 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:53:14 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:53:14 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:53:14 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:53:14 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:53:14 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:53:14 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:53:14 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:53:14 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:53:14 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:53:14 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:53:14 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:53:14 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:53:14 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:53:14 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:53:14 AM INFO:Session_state variables initialized
2025/03/04 08:53:14 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:53:14 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:53:14 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:53:14 AM DEBUG:utils_dir: utils
2025/03/04 08:53:14 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:53:14 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:53:14 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:53:14 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:53:14 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:53:14 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:53:14 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:53:14 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:53:14 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:53:14 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:53:14 AM INFO:Session_state variables initialized
2025/03/04 08:53:14 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:53:14 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:53:14 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:53:14 AM DEBUG:utils_dir: utils
2025/03/04 08:53:14 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:53:14 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:53:14 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:53:14 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:53:14 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:53:14 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:53:14 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:53:14 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:53:14 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:53:14 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:53:14 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:53:14 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:53:14 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:53:14 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:53:14 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:53:14 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:53:14 AM DEBUG:reference_dir: reference_files
2025/03/04 08:53:14 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:53:14 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:53:14 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:53:14 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:53:14 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:53:14 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:53:14 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:53:14 AM DEBUG:logs_dir: logs
2025/03/04 08:53:14 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:53:14 AM DEBUG:perc_target: 0.5
2025/03/04 08:53:14 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:53:14 AM DEBUG:output_dir: output
2025/03/04 08:53:14 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:53:14 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:53:14 AM DEBUG:reference_dir: reference_files
2025/03/04 08:53:14 AM DEBUG:components_dir: components
2025/03/04 08:53:14 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:53:14 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:53:14 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:53:14 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:53:14 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:53:14 AM DEBUG:data_dir: data
2025/03/04 08:53:14 AM DEBUG:logs_dir: logs
2025/03/04 08:53:14 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:53:14 AM DEBUG:perc_target: 0.5
2025/03/04 08:53:14 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:53:14 AM DEBUG:output_dir: output
2025/03/04 08:53:14 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:53:14 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:53:14 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:53:14 AM DEBUG:components_dir: components
2025/03/04 08:53:14 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:53:14 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:53:14 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:53:14 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:53:14 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:53:14 AM DEBUG:data_dir: data
2025/03/04 08:53:14 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:53:14 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:53:14 AM INFO:Session state Setup complete
2025/03/04 08:53:14 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:53:14 AM INFO:initialize_session_state executed successfully
2025/03/04 08:53:14 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:53:14 AM INFO:Package setup complete
2025/03/04 08:53:14 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:53:14 AM INFO:setup_package executed successfully
2025/03/04 08:53:14 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:53:14 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:53:14 AM INFO:Running Menu setup...
2025/03/04 08:53:14 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:53:14 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:53:14 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:53:14 AM INFO:Session state Setup complete
2025/03/04 08:53:14 AM INFO:initialize_session_state executed successfully
2025/03/04 08:53:14 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\app_pages',), kwargs={}
2025/03/04 08:53:14 AM INFO:Package setup complete
2025/03/04 08:53:14 AM INFO:setup_package executed successfully
2025/03/04 08:53:14 AM INFO:Running Menu setup...
2025/03/04 08:53:14 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:53:14 AM INFO:get_git_version executed successfully
2025/03/04 08:53:14 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\components',), kwargs={}
2025/03/04 08:53:14 AM INFO:get_git_version executed successfully
2025/03/04 08:53:14 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:53:14 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:53:14 AM INFO:get_git_version executed successfully
2025/03/04 08:53:14 AM INFO:get_git_version executed successfully
2025/03/04 08:53:14 AM INFO:App Version: v20.161
2025/03/04 08:53:14 AM INFO:App Version: v20.161
2025/03/04 08:53:14 AM INFO:Switched to page: Introduction
2025/03/04 08:53:14 AM INFO:Switched to page: Head Line Figures
2025/03/04 08:53:14 AM DEBUG:Calling hlf_body with args=(), kwargs={}
2025/03/04 08:53:14 AM DEBUG:Calling load_and_filter_data with args=(), kwargs={'filter_key': None, 'pagereflabel': 'headlinefigures'}
2025/03/04 08:53:14 AM ERROR:Error in load_and_filter_data: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state["data_clean"]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
2025/03/04 08:53:14 AM INFO:pagesetup executed successfully
2025/03/04 08:53:14 AM ERROR:Error in hlf_body: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state["data_clean"]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
2025/03/04 08:53:14 AM ERROR:Error in pagesetup: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state["data_clean"]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
2025/03/04 08:53:14 AM INFO:No data found in session state, running firstload()
2025/03/04 08:53:14 AM CRITICAL:Menu setup crashed: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state["data_clean"]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
2025/03/04 08:54:37 AM INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/04 08:54:37 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\utils',), kwargs={}
2025/03/04 08:54:38 AM INFO:get_git_version executed successfully
2025/03/04 08:54:39 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\data',), kwargs={}
2025/03/04 08:54:39 AM INFO:get_git_version executed successfully
2025/03/04 08:54:39 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:54:39 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:54:39 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:54:39 AM INFO:Running App setup...
2025/03/04 08:54:39 AM INFO:Running App setup...
2025/03/04 08:54:39 AM INFO:Running App setup...
2025/03/04 08:54:39 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:54:39 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:54:39 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:54:39 AM INFO:Setting up the package
2025/03/04 08:54:39 AM INFO:Setting up the package
2025/03/04 08:54:39 AM INFO:Setting up the package
2025/03/04 08:54:39 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:54:39 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:54:39 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:54:39 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:54:39 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:54:39 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:54:39 AM INFO:get_git_version executed successfully
2025/03/04 08:54:39 AM INFO:Version: v20.140
2025/03/04 08:54:39 AM INFO:get_git_version executed successfully
2025/03/04 08:54:39 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:54:39 AM INFO:Version: v20.140
2025/03/04 08:54:39 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:54:39 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:54:39 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:54:39 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:54:39 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:54:39 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:54:39 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:54:39 AM INFO:get_git_version executed successfully
2025/03/04 08:54:39 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:54:39 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:54:39 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:54:39 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:54:39 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:54:39 AM INFO:Version: v20.140
2025/03/04 08:54:39 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:54:39 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:54:39 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:54:39 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:54:39 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:54:39 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:54:39 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:54:39 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:54:39 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:54:39 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:54:39 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:54:39 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:54:39 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:54:39 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:54:39 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:54:39 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:54:39 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:54:39 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:54:39 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:54:39 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:54:39 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:54:39 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:54:39 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:54:39 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:54:39 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:54:39 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:54:39 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:54:39 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:54:39 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:54:39 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:54:39 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:54:39 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:54:39 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:54:39 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:54:39 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:54:39 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:54:39 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:54:39 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:54:39 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:54:39 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:54:39 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:54:39 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:54:39 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:54:39 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:54:39 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:54:39 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:54:39 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:54:39 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:54:39 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:54:39 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:54:39 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:54:39 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:54:39 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:54:39 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:54:39 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:54:39 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:54:39 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:54:39 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:54:39 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:54:39 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:54:39 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:54:39 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:54:39 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:54:39 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:54:39 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:54:39 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:54:39 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:54:39 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:54:39 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:54:39 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:54:39 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:54:39 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:54:39 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:54:39 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:54:39 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:54:39 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:54:39 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:54:39 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:54:39 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:54:39 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:54:39 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:54:39 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:54:39 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:54:39 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:54:39 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:54:39 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:54:39 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:54:39 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:54:39 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:54:39 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:54:39 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:54:39 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:54:39 AM INFO:Session_state variables initialized
2025/03/04 08:54:39 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:54:39 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:54:39 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:54:39 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:54:39 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:54:39 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:54:39 AM INFO:Session_state variables initialized
2025/03/04 08:54:39 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:54:39 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:54:39 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:54:39 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:54:39 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:54:39 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:54:39 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:54:39 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:54:39 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:54:39 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:54:39 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:54:39 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:54:39 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:54:39 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:54:39 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:54:39 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:54:39 AM DEBUG:components_dir: components
2025/03/04 08:54:39 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:54:39 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:54:39 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:54:39 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:54:39 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:54:39 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:54:39 AM DEBUG:components_dir: components
2025/03/04 08:54:39 AM INFO:Session_state variables initialized
2025/03/04 08:54:39 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:54:39 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:54:39 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:54:39 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:54:39 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:54:39 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:54:39 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:54:39 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:54:39 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:54:39 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:54:39 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:54:39 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:54:39 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:54:39 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:54:39 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:54:39 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:54:39 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:54:39 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:54:39 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:54:39 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:54:39 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:54:39 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:54:39 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:54:39 AM DEBUG:components_dir: components
2025/03/04 08:54:39 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:54:39 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:54:39 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:54:39 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:54:39 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:54:39 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:54:39 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:54:39 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:54:39 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:54:39 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:54:39 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:54:39 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:54:39 AM DEBUG:reference_dir: reference_files
2025/03/04 08:54:39 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:54:39 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:54:39 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:54:39 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:54:39 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:54:39 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:54:39 AM DEBUG:reference_dir: reference_files
2025/03/04 08:54:39 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:54:39 AM DEBUG:utils_dir: utils
2025/03/04 08:54:39 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:54:39 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:54:39 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:54:39 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:54:39 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:54:39 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:54:39 AM DEBUG:utils_dir: utils
2025/03/04 08:54:39 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:54:39 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:54:39 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:54:39 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:54:39 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:54:39 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:54:39 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:54:39 AM DEBUG:data_dir: data
2025/03/04 08:54:39 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:54:39 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:54:39 AM DEBUG:output_dir: output
2025/03/04 08:54:39 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:54:39 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:54:39 AM DEBUG:logs_dir: logs
2025/03/04 08:54:39 AM DEBUG:data_dir: data
2025/03/04 08:54:39 AM DEBUG:reference_dir: reference_files
2025/03/04 08:54:39 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:54:39 AM DEBUG:output_dir: output
2025/03/04 08:54:39 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:54:39 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:54:39 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:54:39 AM DEBUG:perc_target: 0.5
2025/03/04 08:54:39 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:54:39 AM INFO:Session state Setup complete
2025/03/04 08:54:39 AM INFO:initialize_session_state executed successfully
2025/03/04 08:54:39 AM INFO:Package setup complete
2025/03/04 08:54:39 AM DEBUG:utils_dir: utils
2025/03/04 08:54:39 AM INFO:setup_package executed successfully
2025/03/04 08:54:39 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:54:39 AM INFO:Running Menu setup...
2025/03/04 08:54:39 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:54:39 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:54:39 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:54:39 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:54:39 AM DEBUG:logs_dir: logs
2025/03/04 08:54:39 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\app_pages',), kwargs={}
2025/03/04 08:54:39 AM DEBUG:data_dir: data
2025/03/04 08:54:39 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:54:39 AM DEBUG:output_dir: output
2025/03/04 08:54:39 AM DEBUG:logs_dir: logs
2025/03/04 08:54:39 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:54:39 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:54:39 AM DEBUG:perc_target: 0.5
2025/03/04 08:54:39 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:54:39 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:54:39 AM DEBUG:perc_target: 0.5
2025/03/04 08:54:39 AM INFO:Session state Setup complete
2025/03/04 08:54:39 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:54:39 AM INFO:initialize_session_state executed successfully
2025/03/04 08:54:39 AM INFO:Session state Setup complete
2025/03/04 08:54:39 AM INFO:Package setup complete
2025/03/04 08:54:39 AM INFO:initialize_session_state executed successfully
2025/03/04 08:54:39 AM INFO:setup_package executed successfully
2025/03/04 08:54:39 AM INFO:Package setup complete
2025/03/04 08:54:39 AM INFO:setup_package executed successfully
2025/03/04 08:54:39 AM INFO:Running Menu setup...
2025/03/04 08:54:39 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:54:39 AM INFO:Running Menu setup...
2025/03/04 08:54:39 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:54:39 AM INFO:get_git_version executed successfully
2025/03/04 08:54:39 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\components',), kwargs={}
2025/03/04 08:54:39 AM INFO:get_git_version executed successfully
2025/03/04 08:54:39 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:54:39 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:54:39 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:54:39 AM INFO:get_git_version executed successfully
2025/03/04 08:54:39 AM INFO:get_git_version executed successfully
2025/03/04 08:54:39 AM INFO:get_git_version executed successfully
2025/03/04 08:54:39 AM INFO:App Version: v20.161
2025/03/04 08:54:39 AM INFO:App Version: v20.161
2025/03/04 08:54:39 AM INFO:App Version: v20.161
2025/03/04 08:54:39 AM INFO:Switched to page: Head Line Figures
2025/03/04 08:54:39 AM INFO:Switched to page: Introduction
2025/03/04 08:54:39 AM DEBUG:Calling hlf_body with args=(), kwargs={}
2025/03/04 08:54:39 AM INFO:Switched to page: Introduction
2025/03/04 08:54:39 AM DEBUG:Calling load_and_filter_data with args=(), kwargs={'filter_key': None, 'pagereflabel': 'headlinefigures'}
2025/03/04 08:54:39 AM ERROR:Error in load_and_filter_data: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state["data_clean"]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
2025/03/04 08:54:39 AM INFO:pagesetup executed successfully
2025/03/04 08:54:39 AM INFO:pagesetup executed successfully
2025/03/04 08:54:40 AM ERROR:Error in hlf_body: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state["data_clean"]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
2025/03/04 08:54:40 AM ERROR:Error in pagesetup: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state["data_clean"]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
2025/03/04 08:54:40 AM INFO:No data found in session state, running firstload()
2025/03/04 08:54:40 AM INFO:No data found in session state, running firstload()
2025/03/04 08:54:40 AM CRITICAL:Menu setup crashed: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state["data_clean"]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
2025/03/04 08:54:40 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 08:54:40 AM INFO:Running first load function.
2025/03/04 08:54:40 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 08:54:40 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x000001B546E115A0>), kwargs={}
2025/03/04 08:54:40 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 08:54:40 AM DEBUG:Calling load_raw_data with args=(), kwargs={'main_file': 'raw_data', 'cleaned_file': 'raw_data_clean', 'output_csv': True, 'dedupe_donors': True, 'dedupe_regentity': True, 'originaldatafilepath': 'source_data_fname', 'processeddatafilepath': 'imported_raw_fname'}
2025/03/04 08:54:40 AM DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/04 08:54:40 AM DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/04 08:54:40 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'source\\Donations_accepted_by_political_parties.csv', 'savedfilepath': 'output\\imported_raw.csv', 'timestamp_key': 'load_raw_data_last_modified'}
2025/03/04 08:54:40 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:54:40 AM INFO:Saved file path: output\imported_raw.csv
2025/03/04 08:54:40 AM DEBUG:Calling is_file_updated with args=('source\\Donations_accepted_by_political_parties.csv', 'load_raw_data_last_modified'), kwargs={}
2025/03/04 08:54:40 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 08:54:40 AM DEBUG:Calling get_file_modification_time with args=('source\\Donations_accepted_by_political_parties.csv',), kwargs={}
2025/03/04 08:54:40 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 08:54:40 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:54:40 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 08:54:40 AM INFO:Last modification time: None
2025/03/04 08:54:40 AM INFO:is_file_updated executed successfully
2025/03/04 08:54:40 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:54:40 AM INFO:Loading raw data...
2025/03/04 08:54:40 AM DEBUG:Original data file path post raw data load: {originaldatafilepath}
2025/03/04 08:54:40 AM DEBUG:Processed data file path post raw data load: {processeddatafilepath}
2025/03/04 08:54:40 AM INFO:Data loaded successfully. Data has 65278 rows and 29 columns
2025/03/04 08:54:41 AM INFO:Data saved to output\imported_raw.csv
2025/03/04 08:54:41 AM DEBUG:Calling raw_data_cleanup with args=(), kwargs={'loaddata_df':            ECRef              RegulatedEntityName    RegulatedEntityType        Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                               ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    £1,876.56   02/09/2019  ...              NaN  86310.0             NaN  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    £2,700.00   02/09/2019  ...              NaN  86310.0             NaN  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    £4,852.58   30/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    £2,500.00   30/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    £4,524.05   29/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
...          ...                              ...                    ...          ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   £10,000.00          NaN  ...              NaN  74198.0             NaN            NaN         False
65274   C0242461               Vote Leave Limited  Permitted Participant  £100,000.00          NaN  ...              NaN  74184.0             NaN            NaN         False
65275   C0243560               Vote Leave Limited  Permitted Participant   £40,000.00          NaN  ...              NaN  74576.0             NaN            NaN         False
65276   C0319710  Conservative and Unionist Party        Political Party   £50,000.00          NaN  ...              NaN  34241.0             NaN  Great Britain         False
65277   C0319727  Conservative and Unionist Party        Political Party   £15,000.00          NaN  ...              NaN  74743.0             NaN  Great Britain         False

[65278 rows x 29 columns], 'dedupe_donors': True, 'dedupe_regentity': True, 'output_csv': True, 'originaldatafilepath': 'output\\imported_raw.csv', 'processeddatafilepath': 'cleaned_donations_fname'}
2025/03/04 08:54:41 AM INFO:Cleaning up raw data
2025/03/04 08:54:41 AM ERROR:Session state variables not initialized!
2025/03/04 08:54:41 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': None, 'savedfilepath': 'output\\cleaned_donations.csv', 'timestamp_key': 'cleaned_raw_data_last_modified'}
2025/03/04 08:54:41 AM INFO:Original file path: None
2025/03/04 08:54:41 AM INFO:Saved file path: output\cleaned_donations.csv
2025/03/04 08:54:41 AM ERROR:Error: originalfilepath is None!
2025/03/04 08:54:41 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:54:41 AM INFO:Data loaded, shape: (65278, 29)
2025/03/04 08:54:42 AM DEBUG:Calling dedupe_entity_file with args=(), kwargs={'loaddata_dd_df':            ECRef              RegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                             ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...                   86310.0                  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...                   86310.0                  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...                   86310.0                  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...                   86310.0                  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...                   86310.0                  Great Britain         False
...          ...                              ...                    ...        ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...                   74198.0                          Other         False
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                   74184.0                          Other         False
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   74576.0                          Other         False
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                   34241.0                  Great Britain         False
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                   74743.0                  Great Britain         False

[65278 rows x 29 columns], 'entity': 'RegulatedEntity', 'map_filename': 'regentity_map_fname', 'output_csv': True}
2025/03/04 08:54:42 AM DEBUG:Calling is_file_updated with args=('reference_files\\PoliticalEntityDeDuped.csv', 'regentity_map_fname_last_modified'), kwargs={}
2025/03/04 08:54:42 AM INFO:Checking if reference_files\PoliticalEntityDeDuped.csv has been updated.
2025/03/04 08:54:42 AM DEBUG:Calling get_file_modification_time with args=('reference_files\\PoliticalEntityDeDuped.csv',), kwargs={}
2025/03/04 08:54:42 AM INFO:Getting modification time for reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:54:42 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:54:42 AM INFO:Current modification time: 1740841102.2638545
2025/03/04 08:54:42 AM INFO:Last modification time: None
2025/03/04 08:54:42 AM INFO:is_file_updated executed successfully
2025/03/04 08:54:42 AM INFO:Map file regentity_map_fname has been updated. Proceeding with deduplication.
2025/03/04 08:54:42 AM INFO:File deduplication complete, shape: (65278, 34)
2025/03/04 08:54:42 AM INFO:dedupe_entity_file executed successfully
2025/03/04 08:54:42 AM DEBUG:Calling dedupe_entity_file with args=(), kwargs={'loaddata_dd_df':            ECRef      OriginalRegulatedEntityName    RegulatedEntityType  ...      OriginalRegulatedEntityName RegulatedEntityId              RegulatedEntityName
0      NC0408174                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
1      NC0408173                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
2      NC0408177                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
3      NC0408176                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
4      NC0408170                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
...          ...                              ...                    ...  ...                              ...               ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65274   C0242461               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65275   C0243560               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65276   C0319710  Conservative And Unionist Party        Political Party  ...  Conservative And Unionist Party              52.0  Conservative And Unionist Party
65277   C0319727  Conservative And Unionist Party        Political Party  ...  Conservative And Unionist Party              52.0  Conservative And Unionist Party

[65278 rows x 34 columns], 'entity': 'Donor', 'map_filename': 'donor_map_fname', 'output_csv': True}
2025/03/04 08:54:42 AM DEBUG:Calling is_file_updated with args=('reference_files\\PoliticalDonorsDeduped.csv', 'donor_map_fname_last_modified'), kwargs={}
2025/03/04 08:54:42 AM INFO:Checking if reference_files\PoliticalDonorsDeduped.csv has been updated.
2025/03/04 08:54:42 AM DEBUG:Calling get_file_modification_time with args=('reference_files\\PoliticalDonorsDeduped.csv',), kwargs={}
2025/03/04 08:54:42 AM INFO:Getting modification time for reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:54:42 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:54:42 AM INFO:Current modification time: 1740757863.2545311
2025/03/04 08:54:42 AM INFO:Last modification time: None
2025/03/04 08:54:42 AM INFO:is_file_updated executed successfully
2025/03/04 08:54:42 AM INFO:Map file donor_map_fname has been updated. Proceeding with deduplication.
2025/03/04 08:54:43 AM INFO:File deduplication complete, shape: (65278, 40)
2025/03/04 08:54:43 AM INFO:dedupe_entity_file executed successfully
2025/03/04 08:54:43 AM INFO:Raw Data cleanup completed
2025/03/04 08:54:43 AM INFO:Data shape: (65278, 40)
2025/03/04 08:54:44 AM INFO:Data saved to output\cleaned_donations.csv
2025/03/04 08:54:44 AM INFO:Data cleanup completed, shape: (65278, 40)
2025/03/04 08:54:44 AM INFO:raw_data_cleanup executed successfully
2025/03/04 08:54:44 AM INFO:load_raw_data executed successfully
2025/03/04 08:54:45 AM INFO:get_raw_data executed successfully
2025/03/04 08:54:45 AM INFO:load_data_to_session executed successfully
2025/03/04 08:54:45 AM DEBUG:st.session_state.raw_data: 65278
2025/03/04 08:54:45 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x000001B546E11A20>), kwargs={}
2025/03/04 08:54:45 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 08:54:45 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 08:54:45 AM DEBUG:Rows in Raw Data: 65278
2025/03/04 08:54:45 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'output\\cleaned_donations.csv', 'savedfilepath': 'output\\cleaned_data.csv', 'timestamp_key': 'load_raw_data_last_modified'}
2025/03/04 08:54:45 AM INFO:Original file path: output\cleaned_donations.csv
2025/03/04 08:54:45 AM INFO:Saved file path: output\cleaned_data.csv
2025/03/04 08:54:45 AM DEBUG:Calling is_file_updated with args=('output\\cleaned_donations.csv', 'load_raw_data_last_modified'), kwargs={}
2025/03/04 08:54:45 AM INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/04 08:54:45 AM DEBUG:Calling get_file_modification_time with args=('output\\cleaned_donations.csv',), kwargs={}
2025/03/04 08:54:45 AM INFO:Getting modification time for output\cleaned_donations.csv
2025/03/04 08:54:45 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:54:45 AM INFO:Current modification time: 1741078484.7183907
2025/03/04 08:54:45 AM INFO:Last modification time: 1740757862.6744745
2025/03/04 08:54:45 AM INFO:is_file_updated executed successfully
2025/03/04 08:54:45 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:54:45 AM ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/04 08:54:45 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 08:54:45 AM DEBUG:Clean Data Prep: streamlitdata load: 65278
2025/03/04 08:54:45 AM DEBUG:Clean Data Prep 123: streamlitdata load: 65278
2025/03/04 08:54:48 AM DEBUG:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ...                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...  ...                              ...        ...          ...           ...               ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...          Shaftesbury Investments          1         2016             4            201604
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                Mr Jeremy Hosking          1         2016             2            201602
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   Anthony Clarke          1         2016             6            201606
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                Mr Peter A Dubens          1         2017             5            201705
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                 Mr Ravi S Kailas          1         2017             5            201705

[65278 rows x 44 columns],), kwargs={}
2025/03/04 08:54:48 AM DEBUG:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/04 08:54:48 AM DEBUG:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/04 08:54:48 AM DEBUG:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 08:54:48 AM DEBUG:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/04 08:54:48 AM DEBUG:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 08:54:48 AM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/04 08:54:48 AM ERROR:Attempting to remove duplicates
2025/03/04 08:54:48 AM DEBUG:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 46 columns]
2025/03/04 08:54:48 AM DEBUG:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/04 08:54:48 AM INFO:Data Updated with PartyName and PartyId successfully
2025/03/04 08:54:48 AM INFO:map_mp_to_party executed successfully
2025/03/04 08:54:48 AM DEBUG:Clean Data Prep 150: Map Mps: 65278
2025/03/04 08:54:48 AM DEBUG:Clean Data Prep 235: RegEntity_Map: 65278
2025/03/04 08:54:48 AM DEBUG:Calling load_election_dates with args=(), kwargs={}
2025/03/04 08:54:48 AM DEBUG:st.session_state.ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:54:48 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'source\\Donations_accepted_by_political_parties.csv', 'savedfilepath': 'reference_files\\elections.csv', 'timestamp_key': 'election_dates_last_modified'}
2025/03/04 08:54:48 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:54:48 AM INFO:Saved file path: reference_files\elections.csv
2025/03/04 08:54:48 AM DEBUG:Calling is_file_updated with args=('source\\Donations_accepted_by_political_parties.csv', 'election_dates_last_modified'), kwargs={}
2025/03/04 08:54:48 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 08:54:48 AM DEBUG:Calling get_file_modification_time with args=('source\\Donations_accepted_by_political_parties.csv',), kwargs={}
2025/03/04 08:54:48 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 08:54:48 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:54:48 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 08:54:48 AM INFO:Last modification time: None
2025/03/04 08:54:48 AM INFO:is_file_updated executed successfully
2025/03/04 08:54:48 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:54:48 AM INFO:Election dates loaded from file.
2025/03/04 08:54:48 AM INFO:Election_dates_df empty - loading from pdpy.
2025/03/04 08:54:49 AM INFO:Election Dates loaded vis pdpy.
2025/03/04 08:54:49 AM DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025/03/04 08:54:49 AM INFO:Election Dates Loaded Successfully.
2025/03/04 08:54:49 AM DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/04 08:54:49 AM DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/04 08:54:49 AM INFO:load_election_dates executed successfully
2025/03/04 08:55:08 AM DEBUG:Clean Data Prep 353: Election dates: 65278
2025/03/04 08:55:08 AM DEBUG:Clean Data Prep 386: End of clean: 65278
2025/03/04 08:55:34 AM INFO:Cleaned Data completed, shape: (65278, 58)
2025/03/04 08:55:34 AM INFO:load_cleaned_data executed successfully
2025/03/04 08:55:34 AM INFO:get_cleaned_data executed successfully
2025/03/04 08:55:34 AM INFO:load_data_to_session executed successfully
2025/03/04 08:55:34 AM DEBUG:st.session_state.raw_data: 65278
2025/03/04 08:55:34 AM DEBUG:Calling load_data_to_session with args=('data_donor', <function get_donor_data at 0x000001B546E11B40>), kwargs={}
2025/03/04 08:55:34 AM DEBUG:Calling get_donor_data with args=(), kwargs={}
2025/03/04 08:55:34 AM DEBUG:Calling load_donorList_data with args=(), kwargs={'main_file': 'data_clean', 'cleaned_file': 'data_donor', 'streamlitrun': True, 'output_csv': True, 'originaldatafilepath': 'cleaned_data_fname', 'cleaneddatafilepath': 'cleaned_donorlist_fname'}
2025/03/04 08:55:34 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'output\\cleaned_data.csv', 'savedfilepath': 'output\\cleaned_donorlist.csv', 'timestamp_key': 'load_donorlist_data_last_modified'}
2025/03/04 08:55:34 AM INFO:Original file path: output\cleaned_data.csv
2025/03/04 08:55:34 AM INFO:Saved file path: output\cleaned_donorlist.csv
2025/03/04 08:55:34 AM DEBUG:Calling is_file_updated with args=('output\\cleaned_data.csv', 'load_donorlist_data_last_modified'), kwargs={}
2025/03/04 08:55:34 AM INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/04 08:55:34 AM DEBUG:Calling get_file_modification_time with args=('output\\cleaned_data.csv',), kwargs={}
2025/03/04 08:55:34 AM INFO:Getting modification time for output\cleaned_data.csv
2025/03/04 08:55:34 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:55:34 AM INFO:Current modification time: 1741078534.2604442
2025/03/04 08:55:34 AM INFO:Last modification time: None
2025/03/04 08:55:34 AM INFO:is_file_updated executed successfully
2025/03/04 08:55:34 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:55:34 AM INFO:Donor data saved to output\cleaned_donorlist.csv
2025/03/04 08:55:34 AM INFO:Donor Data summary completed
2025/03/04 08:55:34 AM INFO:Data shape: (30219, 5)
2025/03/04 08:55:34 AM INFO:load_donorList_data executed successfully
2025/03/04 08:55:34 AM INFO:get_donor_data executed successfully
2025/03/04 08:55:34 AM INFO:load_data_to_session executed successfully
2025/03/04 08:55:34 AM DEBUG:st.session_state.data_donor: 30219
2025/03/04 08:55:34 AM DEBUG:st.session_state.data_clean: 65278
2025/03/04 08:55:34 AM DEBUG:Calling load_data_to_session with args=('data_regentity', <function get_regentity_data at 0x000001B546E11C60>), kwargs={}
2025/03/04 08:55:34 AM DEBUG:Calling get_regentity_data with args=(), kwargs={}
2025/03/04 08:55:34 AM DEBUG:Calling load_regulated_entity_data with args=(), kwargs={'main_file': 'data_clean', 'cleaned_file': 'data_regentity', 'streamlitrun': True, 'output_csv': True, 'originaldatafilepath': 'cleaned_data_fname', 'cleaneddatafilepath': 'cleaned_regentity_fname'}
2025/03/04 08:55:34 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'output\\cleaned_data.csv', 'savedfilepath': 'output\\cleaned_regentity.csv', 'timestamp_key': 'load_donorlist_data_last_modified'}
2025/03/04 08:55:34 AM INFO:Original file path: output\cleaned_data.csv
2025/03/04 08:55:34 AM INFO:Saved file path: output\cleaned_regentity.csv
2025/03/04 08:55:34 AM DEBUG:Calling is_file_updated with args=('output\\cleaned_data.csv', 'load_donorlist_data_last_modified'), kwargs={}
2025/03/04 08:55:34 AM INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/04 08:55:34 AM DEBUG:Calling get_file_modification_time with args=('output\\cleaned_data.csv',), kwargs={}
2025/03/04 08:55:34 AM INFO:Getting modification time for output\cleaned_data.csv
2025/03/04 08:55:34 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:55:34 AM INFO:Current modification time: 1741078534.2604442
2025/03/04 08:55:34 AM INFO:Last modification time: 1741078534.2604442
2025/03/04 08:55:34 AM INFO:is_file_updated executed successfully
2025/03/04 08:55:34 AM INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated load_donorlist_data_last_modified instead of output\cleaned_data.csv
2025/03/04 08:55:34 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:55:34 AM INFO:load_regulated_entity_data executed successfully
2025/03/04 08:55:34 AM INFO:get_regentity_data executed successfully
2025/03/04 08:55:34 AM INFO:load_data_to_session executed successfully
2025/03/04 08:55:34 AM DEBUG:st.session_state.data_regentity: 1364
2025/03/04 08:55:34 AM DEBUG:st.session_state.data_donor: 30219
2025/03/04 08:55:34 AM DEBUG:st.session_state.data_clean: 65278
2025/03/04 08:55:34 AM INFO:firstload executed successfully
2025/03/04 08:55:34 AM INFO:initialise_data executed successfully
2025/03/04 08:57:23 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:57:23 AM INFO:Running App setup...
2025/03/04 08:57:23 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:57:23 AM INFO:Setting up the package
2025/03/04 08:57:23 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:57:23 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:57:23 AM INFO:get_git_version executed successfully
2025/03/04 08:57:23 AM INFO:Version: v20.140
2025/03/04 08:57:23 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:57:23 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:57:23 AM DEBUG:LOG_LEVEL already exists in session state
2025/03/04 08:57:23 AM DEBUG:BASE_DIR already exists in session state
2025/03/04 08:57:23 AM DEBUG:filenames already exists in session state
2025/03/04 08:57:23 AM DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/04 08:57:23 AM DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/04 08:57:23 AM DEBUG:thresholds already exists in session state
2025/03/04 08:57:23 AM DEBUG:data_remappings already exists in session state
2025/03/04 08:57:23 AM DEBUG:filter_def already exists in session state
2025/03/04 08:57:23 AM DEBUG:security already exists in session state
2025/03/04 08:57:23 AM DEBUG:perc_target already exists in session state
2025/03/04 08:57:23 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/04 08:57:23 AM DEBUG:directories already exists in session state
2025/03/04 08:57:23 AM DEBUG:reference_dir already exists in session state
2025/03/04 08:57:23 AM DEBUG:data_dir already exists in session state
2025/03/04 08:57:23 AM DEBUG:output_dir already exists in session state
2025/03/04 08:57:23 AM DEBUG:logs_dir already exists in session state
2025/03/04 08:57:23 AM DEBUG:components_dir already exists in session state
2025/03/04 08:57:23 AM DEBUG:app_pages_dir already exists in session state
2025/03/04 08:57:23 AM DEBUG:utils_dir already exists in session state
2025/03/04 08:57:23 AM DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/04 08:57:23 AM DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/04 08:57:23 AM DEBUG:mppartymemb_fname already exists in session state
2025/03/04 08:57:23 AM DEBUG:donor_map_fname already exists in session state
2025/03/04 08:57:23 AM DEBUG:politician_party_fname already exists in session state
2025/03/04 08:57:23 AM DEBUG:regentity_map_fname already exists in session state
2025/03/04 08:57:23 AM DEBUG:original_data_fname already exists in session state
2025/03/04 08:57:23 AM DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/04 08:57:23 AM DEBUG:TEXT_FILE already exists in session state
2025/03/04 08:57:23 AM DEBUG:ELECTION_DATES already exists in session state
2025/03/04 08:57:23 AM DEBUG:cleaned_data_fname already exists in session state
2025/03/04 08:57:23 AM DEBUG:cleaned_donations_fname already exists in session state
2025/03/04 08:57:23 AM DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/04 08:57:23 AM DEBUG:cleaned_regentity_fname already exists in session state
2025/03/04 08:57:23 AM DEBUG:party_summary_fname already exists in session state
2025/03/04 08:57:23 AM DEBUG:imported_raw_fname already exists in session state
2025/03/04 08:57:23 AM DEBUG:source_data_fname already exists in session state
2025/03/04 08:57:23 AM DEBUG:Cash_ftr already exists in session state
2025/03/04 08:57:23 AM INFO:Session_state variables initialized
2025/03/04 08:57:23 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:57:23 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:57:23 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:57:23 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:57:23 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:57:23 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:57:23 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:57:23 AM DEBUG:components_dir: components
2025/03/04 08:57:23 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:57:23 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:57:23 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:57:23 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:57:23 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:57:23 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:57:23 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:57:23 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:57:23 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:57:23 AM DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x000001B546B05480>}
2025/03/04 08:57:23 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:57:23 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:57:23 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:57:23 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:57:23 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:57:23 AM DEBUG:reference_dir: reference_files
2025/03/04 08:57:23 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:57:23 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:57:23 AM DEBUG:utils_dir: utils
2025/03/04 08:57:23 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:57:23 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:57:23 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:57:23 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:57:23 AM DEBUG:data_dir: data
2025/03/04 08:57:23 AM DEBUG:output_dir: output
2025/03/04 08:57:23 AM DEBUG:logs_dir: logs
2025/03/04 08:57:23 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:57:23 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:57:23 AM DEBUG:perc_target: 0.5
2025/03/04 08:57:23 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:57:23 AM INFO:Session state Setup complete
2025/03/04 08:57:23 AM INFO:initialize_session_state executed successfully
2025/03/04 08:57:23 AM INFO:Package setup complete
2025/03/04 08:57:23 AM INFO:setup_package executed successfully
2025/03/04 08:57:23 AM INFO:Running Menu setup...
2025/03/04 08:57:23 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:57:23 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:57:23 AM INFO:get_git_version executed successfully
2025/03/04 08:57:23 AM INFO:App Version: v20.161
2025/03/04 08:57:23 AM INFO:Switched to page: Head Line Figures
2025/03/04 08:57:23 AM DEBUG:Calling hlf_body with args=(), kwargs={}
2025/03/04 08:57:23 AM DEBUG:Calling load_and_filter_data with args=(), kwargs={'filter_key': None, 'pagereflabel': 'headlinefigures'}
2025/03/04 08:57:23 AM ERROR:Error in load_and_filter_data: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state["data_clean"]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
2025/03/04 08:57:23 AM ERROR:Error in hlf_body: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state["data_clean"]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
2025/03/04 08:57:23 AM ERROR:Error in pagesetup: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state["data_clean"]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
2025/03/04 08:57:23 AM CRITICAL:Menu setup crashed: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state["data_clean"]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
2025/03/04 08:58:00 AM INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/04 08:58:00 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\utils',), kwargs={}
2025/03/04 08:58:00 AM INFO:get_git_version executed successfully
2025/03/04 08:58:00 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\data',), kwargs={}
2025/03/04 08:58:00 AM INFO:get_git_version executed successfully
2025/03/04 08:58:00 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:58:00 AM INFO:Running App setup...
2025/03/04 08:58:00 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:58:00 AM INFO:Setting up the package
2025/03/04 08:58:00 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:58:00 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:58:00 AM INFO:get_git_version executed successfully
2025/03/04 08:58:00 AM INFO:Version: v20.140
2025/03/04 08:58:00 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:58:00 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:58:00 AM DEBUG:LOG_LEVEL already exists in session state
2025/03/04 08:58:00 AM DEBUG:BASE_DIR already exists in session state
2025/03/04 08:58:00 AM DEBUG:filenames already exists in session state
2025/03/04 08:58:00 AM DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/04 08:58:00 AM DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/04 08:58:00 AM DEBUG:thresholds already exists in session state
2025/03/04 08:58:00 AM DEBUG:data_remappings already exists in session state
2025/03/04 08:58:00 AM DEBUG:filter_def already exists in session state
2025/03/04 08:58:00 AM DEBUG:security already exists in session state
2025/03/04 08:58:00 AM DEBUG:perc_target already exists in session state
2025/03/04 08:58:00 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/04 08:58:00 AM DEBUG:directories already exists in session state
2025/03/04 08:58:00 AM DEBUG:reference_dir already exists in session state
2025/03/04 08:58:00 AM DEBUG:data_dir already exists in session state
2025/03/04 08:58:00 AM DEBUG:output_dir already exists in session state
2025/03/04 08:58:00 AM DEBUG:logs_dir already exists in session state
2025/03/04 08:58:00 AM DEBUG:components_dir already exists in session state
2025/03/04 08:58:00 AM DEBUG:app_pages_dir already exists in session state
2025/03/04 08:58:00 AM DEBUG:utils_dir already exists in session state
2025/03/04 08:58:00 AM DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/04 08:58:00 AM DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/04 08:58:00 AM DEBUG:mppartymemb_fname already exists in session state
2025/03/04 08:58:00 AM DEBUG:donor_map_fname already exists in session state
2025/03/04 08:58:00 AM DEBUG:politician_party_fname already exists in session state
2025/03/04 08:58:00 AM DEBUG:regentity_map_fname already exists in session state
2025/03/04 08:58:00 AM DEBUG:original_data_fname already exists in session state
2025/03/04 08:58:00 AM DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/04 08:58:00 AM DEBUG:TEXT_FILE already exists in session state
2025/03/04 08:58:00 AM DEBUG:ELECTION_DATES already exists in session state
2025/03/04 08:58:00 AM DEBUG:cleaned_data_fname already exists in session state
2025/03/04 08:58:00 AM DEBUG:cleaned_donations_fname already exists in session state
2025/03/04 08:58:00 AM DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/04 08:58:00 AM DEBUG:cleaned_regentity_fname already exists in session state
2025/03/04 08:58:00 AM DEBUG:party_summary_fname already exists in session state
2025/03/04 08:58:00 AM DEBUG:imported_raw_fname already exists in session state
2025/03/04 08:58:00 AM DEBUG:source_data_fname already exists in session state
2025/03/04 08:58:00 AM DEBUG:Cash_ftr already exists in session state
2025/03/04 08:58:00 AM INFO:Session_state variables initialized
2025/03/04 08:58:00 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:58:00 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:58:00 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:58:00 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:58:00 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:58:00 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:58:00 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:58:00 AM DEBUG:components_dir: components
2025/03/04 08:58:00 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:58:00 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:58:00 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:58:00 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:58:00 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:58:00 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:58:00 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:58:00 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:58:00 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:58:00 AM DEBUG:menu_selection: {'title': 'Introduction', 'function': <function introduction_body at 0x000001B535969630>}
2025/03/04 08:58:00 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:58:00 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:58:00 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:58:00 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:58:00 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:58:00 AM DEBUG:reference_dir: reference_files
2025/03/04 08:58:00 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:58:00 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:58:00 AM DEBUG:utils_dir: utils
2025/03/04 08:58:00 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:58:00 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:58:00 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:58:00 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:58:00 AM DEBUG:data_dir: data
2025/03/04 08:58:00 AM DEBUG:output_dir: output
2025/03/04 08:58:00 AM DEBUG:logs_dir: logs
2025/03/04 08:58:00 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:58:00 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:58:00 AM DEBUG:perc_target: 0.5
2025/03/04 08:58:00 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:58:00 AM INFO:Session state Setup complete
2025/03/04 08:58:00 AM INFO:initialize_session_state executed successfully
2025/03/04 08:58:00 AM INFO:Package setup complete
2025/03/04 08:58:00 AM INFO:setup_package executed successfully
2025/03/04 08:58:00 AM INFO:Running Menu setup...
2025/03/04 08:58:00 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:58:00 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\app_pages',), kwargs={}
2025/03/04 08:58:00 AM INFO:get_git_version executed successfully
2025/03/04 08:58:00 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\components',), kwargs={}
2025/03/04 08:58:00 AM INFO:get_git_version executed successfully
2025/03/04 08:58:00 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:58:00 AM INFO:get_git_version executed successfully
2025/03/04 08:58:00 AM INFO:App Version: v20.161
2025/03/04 08:58:00 AM INFO:Switched to page: Introduction
2025/03/04 08:58:00 AM INFO:pagesetup executed successfully
2025/03/04 08:58:00 AM INFO:No data found in session state, running firstload()
2025/03/04 08:58:02 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:58:02 AM INFO:Running App setup...
2025/03/04 08:58:02 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:58:02 AM INFO:Setting up the package
2025/03/04 08:58:02 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:58:02 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:58:02 AM INFO:get_git_version executed successfully
2025/03/04 08:58:02 AM INFO:Version: v20.140
2025/03/04 08:58:02 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:58:02 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:58:02 AM DEBUG:LOG_LEVEL already exists in session state
2025/03/04 08:58:02 AM DEBUG:BASE_DIR already exists in session state
2025/03/04 08:58:02 AM DEBUG:filenames already exists in session state
2025/03/04 08:58:02 AM DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/04 08:58:02 AM DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/04 08:58:02 AM DEBUG:thresholds already exists in session state
2025/03/04 08:58:02 AM DEBUG:data_remappings already exists in session state
2025/03/04 08:58:02 AM DEBUG:filter_def already exists in session state
2025/03/04 08:58:02 AM DEBUG:security already exists in session state
2025/03/04 08:58:02 AM DEBUG:perc_target already exists in session state
2025/03/04 08:58:02 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/04 08:58:02 AM DEBUG:directories already exists in session state
2025/03/04 08:58:02 AM DEBUG:reference_dir already exists in session state
2025/03/04 08:58:02 AM DEBUG:data_dir already exists in session state
2025/03/04 08:58:02 AM DEBUG:output_dir already exists in session state
2025/03/04 08:58:02 AM DEBUG:logs_dir already exists in session state
2025/03/04 08:58:02 AM DEBUG:components_dir already exists in session state
2025/03/04 08:58:02 AM DEBUG:app_pages_dir already exists in session state
2025/03/04 08:58:02 AM DEBUG:utils_dir already exists in session state
2025/03/04 08:58:02 AM DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/04 08:58:02 AM DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/04 08:58:02 AM DEBUG:mppartymemb_fname already exists in session state
2025/03/04 08:58:02 AM DEBUG:donor_map_fname already exists in session state
2025/03/04 08:58:02 AM DEBUG:politician_party_fname already exists in session state
2025/03/04 08:58:02 AM DEBUG:regentity_map_fname already exists in session state
2025/03/04 08:58:02 AM DEBUG:original_data_fname already exists in session state
2025/03/04 08:58:02 AM DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/04 08:58:02 AM DEBUG:TEXT_FILE already exists in session state
2025/03/04 08:58:02 AM DEBUG:ELECTION_DATES already exists in session state
2025/03/04 08:58:02 AM DEBUG:cleaned_data_fname already exists in session state
2025/03/04 08:58:02 AM DEBUG:cleaned_donations_fname already exists in session state
2025/03/04 08:58:02 AM DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/04 08:58:02 AM DEBUG:cleaned_regentity_fname already exists in session state
2025/03/04 08:58:02 AM DEBUG:party_summary_fname already exists in session state
2025/03/04 08:58:02 AM DEBUG:imported_raw_fname already exists in session state
2025/03/04 08:58:02 AM DEBUG:source_data_fname already exists in session state
2025/03/04 08:58:02 AM DEBUG:Cash_ftr already exists in session state
2025/03/04 08:58:02 AM INFO:Session_state variables initialized
2025/03/04 08:58:02 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:58:02 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:58:02 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:58:02 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:58:02 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:58:02 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:58:02 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:58:02 AM DEBUG:components_dir: components
2025/03/04 08:58:02 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:58:02 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:58:02 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:58:02 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:58:02 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:58:02 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:58:02 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:58:02 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:58:02 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:58:02 AM DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x000001B54E23E5F0>}
2025/03/04 08:58:02 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:58:02 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:58:02 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:58:02 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:58:02 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:58:02 AM DEBUG:reference_dir: reference_files
2025/03/04 08:58:02 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:58:02 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:58:02 AM DEBUG:utils_dir: utils
2025/03/04 08:58:02 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:58:02 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:58:02 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:58:02 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:58:02 AM DEBUG:data_dir: data
2025/03/04 08:58:02 AM DEBUG:output_dir: output
2025/03/04 08:58:02 AM DEBUG:logs_dir: logs
2025/03/04 08:58:02 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:58:02 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:58:02 AM DEBUG:perc_target: 0.5
2025/03/04 08:58:02 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:58:02 AM INFO:Session state Setup complete
2025/03/04 08:58:02 AM INFO:initialize_session_state executed successfully
2025/03/04 08:58:02 AM INFO:Package setup complete
2025/03/04 08:58:02 AM INFO:setup_package executed successfully
2025/03/04 08:58:02 AM INFO:Running Menu setup...
2025/03/04 08:58:02 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:58:02 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:58:02 AM INFO:get_git_version executed successfully
2025/03/04 08:58:02 AM INFO:App Version: v20.161
2025/03/04 08:58:02 AM INFO:Switched to page: Head Line Figures
2025/03/04 08:58:02 AM DEBUG:Calling hlf_body with args=(), kwargs={}
2025/03/04 08:58:02 AM DEBUG:Calling load_and_filter_data with args=(), kwargs={'filter_key': None, 'pagereflabel': 'headlinefigures'}
2025/03/04 08:58:02 AM ERROR:Error in load_and_filter_data: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/04 08:58:02 AM ERROR:Error in hlf_body: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/04 08:58:02 AM ERROR:Error in pagesetup: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/04 08:58:02 AM CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/04 08:58:26 AM INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/04 08:58:26 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\utils',), kwargs={}
2025/03/04 08:58:26 AM INFO:get_git_version executed successfully
2025/03/04 08:58:27 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\data',), kwargs={}
2025/03/04 08:58:27 AM INFO:get_git_version executed successfully
2025/03/04 08:58:27 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:58:27 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:58:27 AM INFO:Running App setup...
2025/03/04 08:58:27 AM INFO:Running App setup...
2025/03/04 08:58:27 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:58:27 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:58:27 AM INFO:Setting up the package
2025/03/04 08:58:27 AM INFO:Setting up the package
2025/03/04 08:58:27 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:58:27 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:58:27 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:58:27 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:58:27 AM INFO:get_git_version executed successfully
2025/03/04 08:58:27 AM INFO:get_git_version executed successfully
2025/03/04 08:58:27 AM INFO:Version: v20.140
2025/03/04 08:58:27 AM INFO:Version: v20.140
2025/03/04 08:58:27 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:58:27 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:58:27 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:58:27 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:58:27 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:58:27 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:58:27 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:58:27 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:58:27 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:58:27 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:58:27 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:58:27 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:58:27 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:58:27 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:58:27 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:58:27 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:58:27 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:58:27 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:58:27 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:58:27 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:58:27 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:58:27 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:58:27 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:58:27 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:58:27 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:58:27 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:58:27 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:58:27 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:58:27 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:58:27 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:58:27 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:58:27 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:58:27 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:58:27 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:58:27 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:58:27 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:58:27 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:58:27 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:58:27 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:58:27 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:58:27 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:58:27 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:58:27 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:58:27 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:58:27 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:58:27 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:58:27 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:58:27 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:58:27 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:58:27 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:58:27 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:58:27 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:58:27 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:58:27 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:58:27 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:58:27 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:58:27 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:58:27 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:58:27 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:58:27 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:58:27 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:58:27 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:58:27 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:58:27 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:58:27 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:58:27 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:58:27 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:58:27 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:58:27 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:58:27 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:58:27 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:58:27 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:58:27 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:58:27 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:58:27 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:58:27 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:58:27 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:58:27 AM INFO:Session_state variables initialized
2025/03/04 08:58:27 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:58:27 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:58:27 AM INFO:Session_state variables initialized
2025/03/04 08:58:27 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:58:27 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:58:27 AM DEBUG:utils_dir: utils
2025/03/04 08:58:27 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:58:27 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:58:27 AM DEBUG:utils_dir: utils
2025/03/04 08:58:27 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:58:27 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:58:27 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:58:27 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:58:27 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:58:27 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:58:27 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:58:27 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:58:27 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:58:27 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:58:27 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:58:27 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:58:27 AM DEBUG:logs_dir: logs
2025/03/04 08:58:27 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:58:27 AM DEBUG:components_dir: components
2025/03/04 08:58:27 AM DEBUG:logs_dir: logs
2025/03/04 08:58:27 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:58:27 AM DEBUG:components_dir: components
2025/03/04 08:58:27 AM DEBUG:perc_target: 0.5
2025/03/04 08:58:27 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:58:27 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:58:27 AM DEBUG:perc_target: 0.5
2025/03/04 08:58:27 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:58:27 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:58:27 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:58:27 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:58:27 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:58:27 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:58:27 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:58:27 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:58:27 AM DEBUG:data_dir: data
2025/03/04 08:58:27 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:58:27 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:58:27 AM DEBUG:data_dir: data
2025/03/04 08:58:27 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:58:27 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:58:27 AM DEBUG:output_dir: output
2025/03/04 08:58:27 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:58:27 AM DEBUG:reference_dir: reference_files
2025/03/04 08:58:27 AM DEBUG:output_dir: output
2025/03/04 08:58:27 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:58:27 AM DEBUG:reference_dir: reference_files
2025/03/04 08:58:27 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:58:27 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:58:27 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:58:27 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:58:27 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:58:27 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:58:27 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:58:27 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:58:27 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:58:27 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:58:27 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:58:27 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:58:27 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:58:27 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:58:27 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:58:27 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:58:27 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:58:27 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:58:27 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:58:27 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:58:27 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:58:27 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:58:27 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:58:27 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:58:27 AM INFO:Session state Setup complete
2025/03/04 08:58:27 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:58:27 AM INFO:initialize_session_state executed successfully
2025/03/04 08:58:27 AM INFO:Session state Setup complete
2025/03/04 08:58:27 AM INFO:Package setup complete
2025/03/04 08:58:27 AM INFO:initialize_session_state executed successfully
2025/03/04 08:58:27 AM INFO:setup_package executed successfully
2025/03/04 08:58:27 AM INFO:Package setup complete
2025/03/04 08:58:27 AM INFO:setup_package executed successfully
2025/03/04 08:58:27 AM INFO:Running Menu setup...
2025/03/04 08:58:27 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:58:27 AM INFO:Running Menu setup...
2025/03/04 08:58:27 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:58:27 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\app_pages',), kwargs={}
2025/03/04 08:58:27 AM INFO:get_git_version executed successfully
2025/03/04 08:58:27 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\components',), kwargs={}
2025/03/04 08:58:27 AM INFO:get_git_version executed successfully
2025/03/04 08:58:27 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:58:27 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:58:27 AM INFO:get_git_version executed successfully
2025/03/04 08:58:27 AM INFO:get_git_version executed successfully
2025/03/04 08:58:27 AM INFO:App Version: v20.161
2025/03/04 08:58:27 AM INFO:App Version: v20.161
2025/03/04 08:58:27 AM INFO:Switched to page: Introduction
2025/03/04 08:58:27 AM INFO:Switched to page: Head Line Figures
2025/03/04 08:58:27 AM DEBUG:Calling hlf_body with args=(), kwargs={}
2025/03/04 08:58:27 AM DEBUG:Calling load_and_filter_data with args=(), kwargs={'filter_key': None, 'pagereflabel': 'headlinefigures'}
2025/03/04 08:58:27 AM ERROR:Error in load_and_filter_data: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/04 08:58:27 AM INFO:pagesetup executed successfully
2025/03/04 08:58:27 AM ERROR:Error in hlf_body: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/04 08:58:27 AM ERROR:Error in pagesetup: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/04 08:58:27 AM INFO:No data found in session state, running firstload()
2025/03/04 08:58:27 AM CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/04 08:58:27 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 08:58:28 AM INFO:Running first load function.
2025/03/04 08:58:28 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 08:58:28 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x000002A44AC285E0>), kwargs={}
2025/03/04 08:58:28 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 08:58:28 AM DEBUG:Calling load_raw_data with args=(), kwargs={'main_file': 'raw_data', 'cleaned_file': 'raw_data_clean', 'output_csv': True, 'dedupe_donors': True, 'dedupe_regentity': True, 'originaldatafilepath': 'source_data_fname', 'processeddatafilepath': 'imported_raw_fname'}
2025/03/04 08:58:28 AM DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/04 08:58:28 AM DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/04 08:58:28 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'source\\Donations_accepted_by_political_parties.csv', 'savedfilepath': 'output\\imported_raw.csv', 'timestamp_key': 'load_raw_data_last_modified'}
2025/03/04 08:58:28 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:58:28 AM INFO:Saved file path: output\imported_raw.csv
2025/03/04 08:58:28 AM DEBUG:Calling is_file_updated with args=('source\\Donations_accepted_by_political_parties.csv', 'load_raw_data_last_modified'), kwargs={}
2025/03/04 08:58:28 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 08:58:28 AM DEBUG:Calling get_file_modification_time with args=('source\\Donations_accepted_by_political_parties.csv',), kwargs={}
2025/03/04 08:58:28 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 08:58:28 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:58:28 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 08:58:28 AM INFO:Last modification time: None
2025/03/04 08:58:28 AM INFO:is_file_updated executed successfully
2025/03/04 08:58:28 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:58:28 AM INFO:Loading raw data...
2025/03/04 08:58:28 AM DEBUG:Original data file path post raw data load: {originaldatafilepath}
2025/03/04 08:58:28 AM DEBUG:Processed data file path post raw data load: {processeddatafilepath}
2025/03/04 08:58:28 AM INFO:Data loaded successfully. Data has 65278 rows and 29 columns
2025/03/04 08:58:29 AM INFO:Data saved to output\imported_raw.csv
2025/03/04 08:58:29 AM DEBUG:Calling raw_data_cleanup with args=(), kwargs={'loaddata_df':            ECRef              RegulatedEntityName    RegulatedEntityType        Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                               ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    £1,876.56   02/09/2019  ...              NaN  86310.0             NaN  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    £2,700.00   02/09/2019  ...              NaN  86310.0             NaN  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    £4,852.58   30/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    £2,500.00   30/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    £4,524.05   29/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
...          ...                              ...                    ...          ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   £10,000.00          NaN  ...              NaN  74198.0             NaN            NaN         False
65274   C0242461               Vote Leave Limited  Permitted Participant  £100,000.00          NaN  ...              NaN  74184.0             NaN            NaN         False
65275   C0243560               Vote Leave Limited  Permitted Participant   £40,000.00          NaN  ...              NaN  74576.0             NaN            NaN         False
65276   C0319710  Conservative and Unionist Party        Political Party   £50,000.00          NaN  ...              NaN  34241.0             NaN  Great Britain         False
65277   C0319727  Conservative and Unionist Party        Political Party   £15,000.00          NaN  ...              NaN  74743.0             NaN  Great Britain         False

[65278 rows x 29 columns], 'dedupe_donors': True, 'dedupe_regentity': True, 'output_csv': True, 'originaldatafilepath': 'output\\imported_raw.csv', 'processeddatafilepath': 'cleaned_donations_fname'}
2025/03/04 08:58:29 AM INFO:Cleaning up raw data
2025/03/04 08:58:29 AM ERROR:Session state variables not initialized!
2025/03/04 08:58:29 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': None, 'savedfilepath': 'output\\cleaned_donations.csv', 'timestamp_key': 'cleaned_raw_data_last_modified'}
2025/03/04 08:58:29 AM INFO:Original file path: None
2025/03/04 08:58:29 AM INFO:Saved file path: output\cleaned_donations.csv
2025/03/04 08:58:29 AM ERROR:Error: originalfilepath is None!
2025/03/04 08:58:29 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:58:29 AM INFO:Data loaded, shape: (65278, 29)
2025/03/04 08:58:30 AM DEBUG:Calling dedupe_entity_file with args=(), kwargs={'loaddata_dd_df':            ECRef              RegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                             ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...                   86310.0                  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...                   86310.0                  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...                   86310.0                  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...                   86310.0                  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...                   86310.0                  Great Britain         False
...          ...                              ...                    ...        ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...                   74198.0                          Other         False
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                   74184.0                          Other         False
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   74576.0                          Other         False
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                   34241.0                  Great Britain         False
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                   74743.0                  Great Britain         False

[65278 rows x 29 columns], 'entity': 'RegulatedEntity', 'map_filename': 'regentity_map_fname', 'output_csv': True}
2025/03/04 08:58:30 AM DEBUG:Calling is_file_updated with args=('reference_files\\PoliticalEntityDeDuped.csv', 'regentity_map_fname_last_modified'), kwargs={}
2025/03/04 08:58:30 AM INFO:Checking if reference_files\PoliticalEntityDeDuped.csv has been updated.
2025/03/04 08:58:30 AM DEBUG:Calling get_file_modification_time with args=('reference_files\\PoliticalEntityDeDuped.csv',), kwargs={}
2025/03/04 08:58:30 AM INFO:Getting modification time for reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:58:30 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:58:30 AM INFO:Current modification time: 1740841102.2638545
2025/03/04 08:58:30 AM INFO:Last modification time: None
2025/03/04 08:58:30 AM INFO:is_file_updated executed successfully
2025/03/04 08:58:30 AM INFO:Map file regentity_map_fname has been updated. Proceeding with deduplication.
2025/03/04 08:58:30 AM INFO:File deduplication complete, shape: (65278, 34)
2025/03/04 08:58:30 AM INFO:dedupe_entity_file executed successfully
2025/03/04 08:58:30 AM DEBUG:Calling dedupe_entity_file with args=(), kwargs={'loaddata_dd_df':            ECRef      OriginalRegulatedEntityName    RegulatedEntityType  ...      OriginalRegulatedEntityName RegulatedEntityId              RegulatedEntityName
0      NC0408174                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
1      NC0408173                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
2      NC0408177                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
3      NC0408176                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
4      NC0408170                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
...          ...                              ...                    ...  ...                              ...               ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65274   C0242461               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65275   C0243560               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65276   C0319710  Conservative And Unionist Party        Political Party  ...  Conservative And Unionist Party              52.0  Conservative And Unionist Party
65277   C0319727  Conservative And Unionist Party        Political Party  ...  Conservative And Unionist Party              52.0  Conservative And Unionist Party

[65278 rows x 34 columns], 'entity': 'Donor', 'map_filename': 'donor_map_fname', 'output_csv': True}
2025/03/04 08:58:30 AM DEBUG:Calling is_file_updated with args=('reference_files\\PoliticalDonorsDeduped.csv', 'donor_map_fname_last_modified'), kwargs={}
2025/03/04 08:58:30 AM INFO:Checking if reference_files\PoliticalDonorsDeduped.csv has been updated.
2025/03/04 08:58:30 AM DEBUG:Calling get_file_modification_time with args=('reference_files\\PoliticalDonorsDeduped.csv',), kwargs={}
2025/03/04 08:58:30 AM INFO:Getting modification time for reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:58:30 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:58:30 AM INFO:Current modification time: 1740757863.2545311
2025/03/04 08:58:30 AM INFO:Last modification time: None
2025/03/04 08:58:30 AM INFO:is_file_updated executed successfully
2025/03/04 08:58:30 AM INFO:Map file donor_map_fname has been updated. Proceeding with deduplication.
2025/03/04 08:58:30 AM INFO:File deduplication complete, shape: (65278, 40)
2025/03/04 08:58:30 AM INFO:dedupe_entity_file executed successfully
2025/03/04 08:58:30 AM INFO:Raw Data cleanup completed
2025/03/04 08:58:30 AM INFO:Data shape: (65278, 40)
2025/03/04 08:58:33 AM INFO:Data saved to output\cleaned_donations.csv
2025/03/04 08:58:33 AM INFO:Data cleanup completed, shape: (65278, 40)
2025/03/04 08:58:33 AM INFO:raw_data_cleanup executed successfully
2025/03/04 08:58:33 AM INFO:load_raw_data executed successfully
2025/03/04 08:58:33 AM INFO:get_raw_data executed successfully
2025/03/04 08:58:33 AM INFO:load_data_to_session executed successfully
2025/03/04 08:58:33 AM DEBUG:st.session_state.raw_data: 65278
2025/03/04 08:58:33 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x000002A44AC28A60>), kwargs={}
2025/03/04 08:58:33 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 08:58:33 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 08:58:33 AM DEBUG:Rows in Raw Data: 65278
2025/03/04 08:58:33 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'output\\cleaned_donations.csv', 'savedfilepath': 'output\\cleaned_data.csv', 'timestamp_key': 'load_raw_data_last_modified'}
2025/03/04 08:58:33 AM INFO:Original file path: output\cleaned_donations.csv
2025/03/04 08:58:33 AM INFO:Saved file path: output\cleaned_data.csv
2025/03/04 08:58:33 AM DEBUG:Calling is_file_updated with args=('output\\cleaned_donations.csv', 'load_raw_data_last_modified'), kwargs={}
2025/03/04 08:58:33 AM INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/04 08:58:33 AM DEBUG:Calling get_file_modification_time with args=('output\\cleaned_donations.csv',), kwargs={}
2025/03/04 08:58:33 AM INFO:Getting modification time for output\cleaned_donations.csv
2025/03/04 08:58:33 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:58:33 AM INFO:Current modification time: 1741078713.5048652
2025/03/04 08:58:33 AM INFO:Last modification time: 1740757862.6744745
2025/03/04 08:58:33 AM INFO:is_file_updated executed successfully
2025/03/04 08:58:33 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:58:33 AM ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/04 08:58:33 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 08:58:33 AM DEBUG:Clean Data Prep: streamlitdata load: 65278
2025/03/04 08:58:33 AM DEBUG:Clean Data Prep 123: streamlitdata load: 65278
2025/03/04 08:58:36 AM DEBUG:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ...                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...  ...                              ...        ...          ...           ...               ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...          Shaftesbury Investments          1         2016             4            201604
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                Mr Jeremy Hosking          1         2016             2            201602
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   Anthony Clarke          1         2016             6            201606
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                Mr Peter A Dubens          1         2017             5            201705
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                 Mr Ravi S Kailas          1         2017             5            201705

[65278 rows x 44 columns],), kwargs={}
2025/03/04 08:58:36 AM DEBUG:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/04 08:58:36 AM DEBUG:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/04 08:58:36 AM DEBUG:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 08:58:36 AM DEBUG:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/04 08:58:37 AM DEBUG:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 08:58:37 AM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/04 08:58:37 AM ERROR:Attempting to remove duplicates
2025/03/04 08:58:37 AM DEBUG:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 46 columns]
2025/03/04 08:58:37 AM DEBUG:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/04 08:58:37 AM INFO:Data Updated with PartyName and PartyId successfully
2025/03/04 08:58:37 AM INFO:map_mp_to_party executed successfully
2025/03/04 08:58:37 AM DEBUG:Clean Data Prep 150: Map Mps: 65278
2025/03/04 08:58:37 AM DEBUG:Clean Data Prep 235: RegEntity_Map: 65278
2025/03/04 08:58:37 AM DEBUG:Calling load_election_dates with args=(), kwargs={}
2025/03/04 08:58:37 AM DEBUG:st.session_state.ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:58:37 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'source\\Donations_accepted_by_political_parties.csv', 'savedfilepath': 'reference_files\\elections.csv', 'timestamp_key': 'election_dates_last_modified'}
2025/03/04 08:58:37 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:58:37 AM INFO:Saved file path: reference_files\elections.csv
2025/03/04 08:58:37 AM DEBUG:Calling is_file_updated with args=('source\\Donations_accepted_by_political_parties.csv', 'election_dates_last_modified'), kwargs={}
2025/03/04 08:58:37 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 08:58:37 AM DEBUG:Calling get_file_modification_time with args=('source\\Donations_accepted_by_political_parties.csv',), kwargs={}
2025/03/04 08:58:37 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 08:58:37 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:58:37 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 08:58:37 AM INFO:Last modification time: None
2025/03/04 08:58:37 AM INFO:is_file_updated executed successfully
2025/03/04 08:58:37 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:58:37 AM INFO:Election dates loaded from file.
2025/03/04 08:58:37 AM INFO:Election_dates_df empty - loading from pdpy.
2025/03/04 08:58:37 AM INFO:Election Dates loaded vis pdpy.
2025/03/04 08:58:37 AM DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025/03/04 08:58:37 AM INFO:Election Dates Loaded Successfully.
2025/03/04 08:58:37 AM DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/04 08:58:37 AM DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/04 08:58:37 AM INFO:load_election_dates executed successfully
2025/03/04 08:58:57 AM DEBUG:Clean Data Prep 353: Election dates: 65278
2025/03/04 08:58:57 AM DEBUG:Clean Data Prep 386: End of clean: 65278
2025/03/04 08:59:24 AM INFO:Cleaned Data completed, shape: (65278, 58)
2025/03/04 08:59:24 AM INFO:load_cleaned_data executed successfully
2025/03/04 08:59:24 AM INFO:get_cleaned_data executed successfully
2025/03/04 08:59:24 AM INFO:load_data_to_session executed successfully
2025/03/04 08:59:24 AM DEBUG:st.session_state.raw_data: 65278
2025/03/04 08:59:24 AM DEBUG:Calling load_data_to_session with args=('data_donor', <function get_donor_data at 0x000002A44AC28B80>), kwargs={}
2025/03/04 08:59:24 AM DEBUG:Calling get_donor_data with args=(), kwargs={}
2025/03/04 08:59:24 AM DEBUG:Calling load_donorList_data with args=(), kwargs={'main_file': 'data_clean', 'cleaned_file': 'data_donor', 'streamlitrun': True, 'output_csv': True, 'originaldatafilepath': 'cleaned_data_fname', 'cleaneddatafilepath': 'cleaned_donorlist_fname'}
2025/03/04 08:59:24 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'output\\cleaned_data.csv', 'savedfilepath': 'output\\cleaned_donorlist.csv', 'timestamp_key': 'load_donorlist_data_last_modified'}
2025/03/04 08:59:24 AM INFO:Original file path: output\cleaned_data.csv
2025/03/04 08:59:24 AM INFO:Saved file path: output\cleaned_donorlist.csv
2025/03/04 08:59:24 AM DEBUG:Calling is_file_updated with args=('output\\cleaned_data.csv', 'load_donorlist_data_last_modified'), kwargs={}
2025/03/04 08:59:24 AM INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/04 08:59:24 AM DEBUG:Calling get_file_modification_time with args=('output\\cleaned_data.csv',), kwargs={}
2025/03/04 08:59:24 AM INFO:Getting modification time for output\cleaned_data.csv
2025/03/04 08:59:24 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:59:24 AM INFO:Current modification time: 1741078764.2643168
2025/03/04 08:59:24 AM INFO:Last modification time: None
2025/03/04 08:59:24 AM INFO:is_file_updated executed successfully
2025/03/04 08:59:24 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:59:24 AM INFO:Donor data saved to output\cleaned_donorlist.csv
2025/03/04 08:59:24 AM INFO:Donor Data summary completed
2025/03/04 08:59:24 AM INFO:Data shape: (30219, 5)
2025/03/04 08:59:24 AM INFO:load_donorList_data executed successfully
2025/03/04 08:59:24 AM INFO:get_donor_data executed successfully
2025/03/04 08:59:24 AM INFO:load_data_to_session executed successfully
2025/03/04 08:59:24 AM DEBUG:st.session_state.data_donor: 30219
2025/03/04 08:59:24 AM DEBUG:st.session_state.data_clean: 65278
2025/03/04 08:59:24 AM DEBUG:Calling load_data_to_session with args=('data_regentity', <function get_regentity_data at 0x000002A44AC28CA0>), kwargs={}
2025/03/04 08:59:24 AM DEBUG:Calling get_regentity_data with args=(), kwargs={}
2025/03/04 08:59:24 AM DEBUG:Calling load_regulated_entity_data with args=(), kwargs={'main_file': 'data_clean', 'cleaned_file': 'data_regentity', 'streamlitrun': True, 'output_csv': True, 'originaldatafilepath': 'cleaned_data_fname', 'cleaneddatafilepath': 'cleaned_regentity_fname'}
2025/03/04 08:59:24 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'output\\cleaned_data.csv', 'savedfilepath': 'output\\cleaned_regentity.csv', 'timestamp_key': 'load_donorlist_data_last_modified'}
2025/03/04 08:59:24 AM INFO:Original file path: output\cleaned_data.csv
2025/03/04 08:59:24 AM INFO:Saved file path: output\cleaned_regentity.csv
2025/03/04 08:59:24 AM DEBUG:Calling is_file_updated with args=('output\\cleaned_data.csv', 'load_donorlist_data_last_modified'), kwargs={}
2025/03/04 08:59:24 AM INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/04 08:59:24 AM DEBUG:Calling get_file_modification_time with args=('output\\cleaned_data.csv',), kwargs={}
2025/03/04 08:59:24 AM INFO:Getting modification time for output\cleaned_data.csv
2025/03/04 08:59:24 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:59:24 AM INFO:Current modification time: 1741078764.2643168
2025/03/04 08:59:24 AM INFO:Last modification time: 1741078764.2643168
2025/03/04 08:59:24 AM INFO:is_file_updated executed successfully
2025/03/04 08:59:24 AM INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated load_donorlist_data_last_modified instead of output\cleaned_data.csv
2025/03/04 08:59:24 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:59:24 AM INFO:load_regulated_entity_data executed successfully
2025/03/04 08:59:24 AM INFO:get_regentity_data executed successfully
2025/03/04 08:59:24 AM INFO:load_data_to_session executed successfully
2025/03/04 08:59:24 AM DEBUG:st.session_state.data_regentity: 1364
2025/03/04 08:59:24 AM DEBUG:st.session_state.data_donor: 30219
2025/03/04 08:59:24 AM DEBUG:st.session_state.data_clean: 65278
2025/03/04 08:59:24 AM INFO:firstload executed successfully
2025/03/04 08:59:24 AM INFO:initialise_data executed successfully
2025/03/04 08:59:31 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:59:31 AM INFO:Running App setup...
2025/03/04 08:59:31 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:59:31 AM INFO:Setting up the package
2025/03/04 08:59:31 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:59:31 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:59:31 AM INFO:get_git_version executed successfully
2025/03/04 08:59:31 AM INFO:Version: v20.140
2025/03/04 08:59:31 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:59:31 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:59:31 AM DEBUG:LOG_LEVEL already exists in session state
2025/03/04 08:59:31 AM DEBUG:BASE_DIR already exists in session state
2025/03/04 08:59:31 AM DEBUG:filenames already exists in session state
2025/03/04 08:59:31 AM DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/04 08:59:31 AM DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/04 08:59:31 AM DEBUG:thresholds already exists in session state
2025/03/04 08:59:31 AM DEBUG:data_remappings already exists in session state
2025/03/04 08:59:31 AM DEBUG:filter_def already exists in session state
2025/03/04 08:59:31 AM DEBUG:security already exists in session state
2025/03/04 08:59:31 AM DEBUG:perc_target already exists in session state
2025/03/04 08:59:31 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/04 08:59:31 AM DEBUG:directories already exists in session state
2025/03/04 08:59:31 AM DEBUG:reference_dir already exists in session state
2025/03/04 08:59:31 AM DEBUG:data_dir already exists in session state
2025/03/04 08:59:31 AM DEBUG:output_dir already exists in session state
2025/03/04 08:59:31 AM DEBUG:logs_dir already exists in session state
2025/03/04 08:59:31 AM DEBUG:components_dir already exists in session state
2025/03/04 08:59:31 AM DEBUG:app_pages_dir already exists in session state
2025/03/04 08:59:31 AM DEBUG:utils_dir already exists in session state
2025/03/04 08:59:31 AM DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/04 08:59:31 AM DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/04 08:59:31 AM DEBUG:mppartymemb_fname already exists in session state
2025/03/04 08:59:31 AM DEBUG:donor_map_fname already exists in session state
2025/03/04 08:59:31 AM DEBUG:politician_party_fname already exists in session state
2025/03/04 08:59:31 AM DEBUG:regentity_map_fname already exists in session state
2025/03/04 08:59:31 AM DEBUG:original_data_fname already exists in session state
2025/03/04 08:59:31 AM DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/04 08:59:31 AM DEBUG:TEXT_FILE already exists in session state
2025/03/04 08:59:31 AM DEBUG:ELECTION_DATES already exists in session state
2025/03/04 08:59:31 AM DEBUG:cleaned_data_fname already exists in session state
2025/03/04 08:59:31 AM DEBUG:cleaned_donations_fname already exists in session state
2025/03/04 08:59:31 AM DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/04 08:59:31 AM DEBUG:cleaned_regentity_fname already exists in session state
2025/03/04 08:59:31 AM DEBUG:party_summary_fname already exists in session state
2025/03/04 08:59:31 AM DEBUG:imported_raw_fname already exists in session state
2025/03/04 08:59:31 AM DEBUG:source_data_fname already exists in session state
2025/03/04 08:59:31 AM DEBUG:Cash_ftr already exists in session state
2025/03/04 08:59:31 AM INFO:Session_state variables initialized
2025/03/04 08:59:31 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:59:31 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:59:31 AM DEBUG:utils_dir: utils
2025/03/04 08:59:31 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:59:31 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:59:31 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:59:31 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:59:31 AM DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
30214    87478.0                       Martin Thomas          3529.41                2    1764.705000
30215    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
30216    87480.0                           Ann C Hay        157350.07                1  157350.070000
30217    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30218  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[30219 rows x 5 columns]
2025/03/04 08:59:31 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:59:31 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:59:31 AM DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/04 08:59:31 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:59:31 AM DEBUG:logs_dir: logs
2025/03/04 08:59:31 AM DEBUG:election_dates_last_modified: 1740757862.6744745
2025/03/04 08:59:31 AM DEBUG:components_dir: components
2025/03/04 08:59:31 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:59:31 AM DEBUG:perc_target: 0.5
2025/03/04 08:59:31 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:59:31 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:59:31 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:59:31 AM DEBUG:load_raw_data_last_modified: 1741078713.5048652
2025/03/04 08:59:31 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:59:31 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:59:31 AM DEBUG:data_dir: data
2025/03/04 08:59:31 AM DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[65278 rows x 58 columns]
2025/03/04 08:59:31 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:59:31 AM DEBUG:load_donorlist_data_last_modified: 1741078764.2643168
2025/03/04 08:59:31 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:59:31 AM DEBUG:donor_map_fname_last_modified: 1740757863.2545311
2025/03/04 08:59:31 AM DEBUG:output_dir: output
2025/03/04 08:59:31 AM DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[65278 rows x 40 columns]
2025/03/04 08:59:31 AM DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x000002A44A924940>}
2025/03/04 08:59:31 AM DEBUG:reference_dir: reference_files
2025/03/04 08:59:31 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:59:31 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:59:31 AM DEBUG:regentity_map_fname_last_modified: 1740841102.2638545
2025/03/04 08:59:31 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:59:31 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:59:31 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:59:31 AM DEBUG:raw_data_clean:            ECRef              RegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                             ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...                   86310.0                  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...                   86310.0                  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...                   86310.0                  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...                   86310.0                  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...                   86310.0                  Great Britain         False
...          ...                              ...                    ...        ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...                   74198.0                          Other         False
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                   74184.0                          Other         False
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   74576.0                          Other         False
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                   34241.0                  Great Britain         False
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                   74743.0                  Great Britain         False

[65278 rows x 29 columns]
2025/03/04 08:59:31 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:59:31 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:59:31 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:59:31 AM DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/04 08:59:31 AM DEBUG:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/04 08:59:31 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:59:31 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:59:31 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:59:31 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:59:31 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:59:31 AM INFO:Session state Setup complete
2025/03/04 08:59:31 AM INFO:initialize_session_state executed successfully
2025/03/04 08:59:31 AM INFO:Package setup complete
2025/03/04 08:59:31 AM INFO:setup_package executed successfully
2025/03/04 08:59:31 AM INFO:Running Menu setup...
2025/03/04 08:59:31 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:59:31 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:59:31 AM INFO:get_git_version executed successfully
2025/03/04 08:59:31 AM INFO:App Version: v20.161
2025/03/04 08:59:31 AM INFO:Switched to page: Head Line Figures
2025/03/04 08:59:31 AM DEBUG:Calling hlf_body with args=(), kwargs={}
2025/03/04 08:59:31 AM DEBUG:Calling load_and_filter_data with args=(), kwargs={'filter_key': None, 'pagereflabel': 'headlinefigures'}
2025/03/04 08:59:31 AM INFO:load_and_filter_data executed successfully
2025/03/04 08:59:31 AM DEBUG:Calling display_summary_statistics with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[65278 rows x 58 columns],            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[65278 rows x 58 columns], 'Political Donations', 'headlinefigures'), kwargs={}
2025/03/04 08:59:32 AM INFO:display_summary_statistics executed successfully
2025/03/04 08:59:32 AM DEBUG:Calling plot_bar_line_by_year with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[65278 rows x 58 columns],), kwargs={'XValues': 'YearReceived', 'YValues': 'EventCount', 'GroupData': 'RegulatedEntityType', 'XLabel': 'Year', 'YLabel': 'Donations', 'Title': 'Donations per Year & Entity Type', 'CalcType': 'sum', 'LegendTitle': 'Regulated Entity Type', 'widget_key': 'dons_by_year_n_entity'}
2025/03/04 08:59:32 AM INFO:plot_bar_line_by_year executed successfully
2025/03/04 08:59:32 AM DEBUG:Calling plot_bar_line_by_year with args=(           ECRef                OriginalRegulatedEntityName RegulatedEntityType    Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
77980   U0034053                               Labour Party     Political Party   400.00  ...                    11                   3748                        1                       289
77965  TV0036256                           Yes Campaign Ltd         Third Party   668.00  ...                   192                   3771                       15                       291
78094  TV0036257  British Declaration Of Independence [The]         Third Party  1500.00  ...                   192                   3771                       15                       291
78329  TV0036260        Campaign For An Independent Britain         Third Party  1450.00  ...                   180                   3783                       14                       291
78638  TV0036259                                 Charter 88         Third Party  1500.00  ...                   191                   3772                       15                       291
...          ...                                        ...                 ...      ...  ...                   ...                    ...                      ...                       ...
4350    V0405916                           Elisha Mccallion     Regulated Donee  1809.74  ...                    31                   4693                        3                       361
4598    V0405912                               Mickey Brady     Regulated Donee  1922.10  ...                    31                   4693                        3                       361
6096    V0405918                           Mr Chris Hazzard     Regulated Donee  3030.00  ...                    31                   4693                        3                       361
7073    V0403834                              Mr Afzal Khan     Regulated Donee  1800.00  ...                    44                   4681                        4                       361
7075    V0403400                       Ms Yasmin Qureshi Mp     Regulated Donee  1800.00  ...                    47                   4678                        4                       360

[65278 rows x 58 columns],), kwargs={'XValues': 'YearReceived', 'YValues': 'Value', 'GroupData': 'Data Safety Score', 'XLabel': 'Year', 'YLabel': 'Donations', 'Title': 'Donations Risk Score by Year', 'CalcType': 'sum', 'LegendTitle': 'Data Safety Score', 'ChartType': 'line', 'y_scale': 'linear', 'widget_key': 'dons_by_year_n_type'}
2025/03/04 08:59:32 AM INFO:plot_bar_line_by_year executed successfully
2025/03/04 08:59:33 AM ERROR:Error applying filters: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025/03/04 08:59:33 AM DEBUG:Calling plot_bar_line_by_year with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[65278 rows x 58 columns],), kwargs={'XValues': 'YearReceived', 'YValues': 'Value', 'GroupData': 'RegEntity_Group', 'XLabel': 'Year', 'YLabel': "Value of Donations £ 000's", 'Title': 'Donations GBP by Year & Entity', 'use_custom_colors': False, 'LegendTitle': 'Regulated Entity', 'widget_key': 'value_by_year_n_entity', 'CalcType': 'sum'}
2025/03/04 08:59:33 AM INFO:plot_bar_line_by_year executed successfully
2025/03/04 08:59:33 AM DEBUG:Calling plot_bar_line_by_year with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[65278 rows x 58 columns],), kwargs={'XValues': 'YearReceived', 'YValues': 'Value', 'GroupData': 'DonationType', 'XLabel': 'Year', 'YLabel': 'Total Value (£)', 'y_scale': 'log', 'ChartType': 'Line', 'LegendTitle': 'Donation Type', 'Title': 'Donations GBP Types by Year', 'widget_key': 'value_by_year_n_type', 'CalcType': 'sum'}
2025/03/04 08:59:33 AM INFO:plot_bar_line_by_year executed successfully
2025/03/04 08:59:33 AM INFO:hlf_body executed successfully
2025/03/04 08:59:33 AM INFO:pagesetup executed successfully
2025/03/04 08:59:33 AM INFO:Data already loaded in session state.
2025/03/04 08:59:38 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:59:38 AM INFO:Running App setup...
2025/03/04 08:59:38 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:59:38 AM INFO:Setting up the package
2025/03/04 08:59:38 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:59:38 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:59:38 AM INFO:get_git_version executed successfully
2025/03/04 08:59:38 AM INFO:Version: v20.140
2025/03/04 08:59:38 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:59:38 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:59:38 AM DEBUG:LOG_LEVEL already exists in session state
2025/03/04 08:59:38 AM DEBUG:BASE_DIR already exists in session state
2025/03/04 08:59:38 AM DEBUG:filenames already exists in session state
2025/03/04 08:59:38 AM DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/04 08:59:38 AM DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/04 08:59:38 AM DEBUG:thresholds already exists in session state
2025/03/04 08:59:38 AM DEBUG:data_remappings already exists in session state
2025/03/04 08:59:38 AM DEBUG:filter_def already exists in session state
2025/03/04 08:59:38 AM DEBUG:security already exists in session state
2025/03/04 08:59:38 AM DEBUG:perc_target already exists in session state
2025/03/04 08:59:38 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/04 08:59:38 AM DEBUG:directories already exists in session state
2025/03/04 08:59:38 AM DEBUG:reference_dir already exists in session state
2025/03/04 08:59:38 AM DEBUG:data_dir already exists in session state
2025/03/04 08:59:38 AM DEBUG:output_dir already exists in session state
2025/03/04 08:59:38 AM DEBUG:logs_dir already exists in session state
2025/03/04 08:59:38 AM DEBUG:components_dir already exists in session state
2025/03/04 08:59:38 AM DEBUG:app_pages_dir already exists in session state
2025/03/04 08:59:38 AM DEBUG:utils_dir already exists in session state
2025/03/04 08:59:38 AM DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/04 08:59:38 AM DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/04 08:59:38 AM DEBUG:mppartymemb_fname already exists in session state
2025/03/04 08:59:38 AM DEBUG:donor_map_fname already exists in session state
2025/03/04 08:59:38 AM DEBUG:politician_party_fname already exists in session state
2025/03/04 08:59:38 AM DEBUG:regentity_map_fname already exists in session state
2025/03/04 08:59:38 AM DEBUG:original_data_fname already exists in session state
2025/03/04 08:59:38 AM DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/04 08:59:38 AM DEBUG:TEXT_FILE already exists in session state
2025/03/04 08:59:38 AM DEBUG:ELECTION_DATES already exists in session state
2025/03/04 08:59:38 AM DEBUG:cleaned_data_fname already exists in session state
2025/03/04 08:59:38 AM DEBUG:cleaned_donations_fname already exists in session state
2025/03/04 08:59:38 AM DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/04 08:59:38 AM DEBUG:cleaned_regentity_fname already exists in session state
2025/03/04 08:59:38 AM DEBUG:party_summary_fname already exists in session state
2025/03/04 08:59:38 AM DEBUG:imported_raw_fname already exists in session state
2025/03/04 08:59:38 AM DEBUG:source_data_fname already exists in session state
2025/03/04 08:59:38 AM DEBUG:Cash_ftr already exists in session state
2025/03/04 08:59:38 AM INFO:Session_state variables initialized
2025/03/04 08:59:38 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:59:38 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:59:38 AM DEBUG:utils_dir: utils
2025/03/04 08:59:38 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:59:38 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:59:38 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:59:38 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:59:38 AM DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
30214    87478.0                       Martin Thomas          3529.41                2    1764.705000
30215    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
30216    87480.0                           Ann C Hay        157350.07                1  157350.070000
30217    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30218  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[30219 rows x 5 columns]
2025/03/04 08:59:38 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:59:38 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:59:38 AM DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/04 08:59:38 AM DEBUG:year_slider_value_by_year_n_type: (2001, 2019)
2025/03/04 08:59:38 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:59:38 AM DEBUG:year_slider_dons_by_year_n_type: (2001, 2019)
2025/03/04 08:59:38 AM DEBUG:logs_dir: logs
2025/03/04 08:59:38 AM DEBUG:election_dates_last_modified: 1740757862.6744745
2025/03/04 08:59:38 AM DEBUG:components_dir: components
2025/03/04 08:59:38 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:59:38 AM DEBUG:perc_target: 0.5
2025/03/04 08:59:38 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:59:38 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:59:38 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:59:38 AM DEBUG:load_raw_data_last_modified: 1741078713.5048652
2025/03/04 08:59:38 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:59:38 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:59:38 AM DEBUG:data_dir: data
2025/03/04 08:59:38 AM DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[65278 rows x 58 columns]
2025/03/04 08:59:38 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:59:38 AM DEBUG:load_donorlist_data_last_modified: 1741078764.2643168
2025/03/04 08:59:38 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:59:38 AM DEBUG:donor_map_fname_last_modified: 1740757863.2545311
2025/03/04 08:59:38 AM DEBUG:output_dir: output
2025/03/04 08:59:38 AM DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[65278 rows x 40 columns]
2025/03/04 08:59:38 AM DEBUG:menu_selection: {'title': 'Bequeths', 'function': <function mod_bequeths_page at 0x000002A44A9253F0>}
2025/03/04 08:59:38 AM DEBUG:reference_dir: reference_files
2025/03/04 08:59:38 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:59:38 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:59:38 AM DEBUG:year_slider_value_by_year_n_entity: (2001, 2019)
2025/03/04 08:59:38 AM DEBUG:regentity_map_fname_last_modified: 1740841102.2638545
2025/03/04 08:59:38 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:59:38 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:59:38 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:59:38 AM DEBUG:raw_data_clean:            ECRef              RegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                             ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...                   86310.0                  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...                   86310.0                  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...                   86310.0                  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...                   86310.0                  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...                   86310.0                  Great Britain         False
...          ...                              ...                    ...        ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...                   74198.0                          Other         False
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                   74184.0                          Other         False
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   74576.0                          Other         False
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                   34241.0                  Great Britain         False
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                   74743.0                  Great Britain         False

[65278 rows x 29 columns]
2025/03/04 08:59:38 AM DEBUG:year_slider_dons_by_year_n_entity: (2001, 2019)
2025/03/04 08:59:38 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:59:38 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:59:38 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:59:38 AM DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/04 08:59:38 AM DEBUG:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/04 08:59:38 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:59:38 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:59:38 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:59:38 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:59:38 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:59:38 AM INFO:Session state Setup complete
2025/03/04 08:59:38 AM INFO:initialize_session_state executed successfully
2025/03/04 08:59:38 AM INFO:Package setup complete
2025/03/04 08:59:38 AM INFO:setup_package executed successfully
2025/03/04 08:59:38 AM INFO:Running Menu setup...
2025/03/04 08:59:38 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:59:38 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:59:38 AM INFO:get_git_version executed successfully
2025/03/04 08:59:38 AM INFO:App Version: v20.161
2025/03/04 08:59:38 AM INFO:Switched to page: Bequeths
2025/03/04 08:59:38 AM DEBUG:Calling display_data_page with args=(), kwargs={'filter_key': 'Bequests_ftr', 'target_label': 'Bequest'}
2025/03/04 08:59:38 AM DEBUG:Calling load_and_filter_data with args=('Bequests_ftr', 'filtered_keytarget_label'), kwargs={}
2025/03/04 08:59:38 AM INFO:load_and_filter_data executed successfully
2025/03/04 08:59:38 AM DEBUG:Calling display_summary_statistics with args=(          ECRef      OriginalRegulatedEntityName RegulatedEntityType     Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
262    C0406279     Uk Independence Party (Ukip)     Political Party  14264.93  ...                    24                   4701                        2                       362
503    C0407123                     Labour Party     Political Party  14029.57  ...                    27                   4698                        3                       362
597    C0406346                Liberal Democrats     Political Party  67000.00  ...                    32                   4693                        3                       361
626    C0406139       Communist Party Of Britain     Political Party   6457.59  ...                    28                   4697                        3                       362
758    C0406805    Scottish National Party (Snp)     Political Party  26985.51  ...                    29                   4696                        3                       362
...         ...                              ...                 ...       ...  ...                   ...                    ...                      ...                       ...
75633  C0001887                     Labour Party     Political Party   8150.00  ...                   199                   3764                       16                       290
75700  C0001998                Liberal Democrats     Political Party   2000.00  ...                   200                   3763                       16                       290
76893  C0001202                Liberal Democrats     Political Party   8016.33  ...                    12                   3746                        1                       289
76940  C0000827  Conservative And Unionist Party     Political Party   3500.00  ...                    10                   3749                        1                       289
77160  C0000667                Liberal Democrats     Political Party   3000.00  ...                    11                   3747                        1                       289

[727 rows x 58 columns],            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[65278 rows x 58 columns], 'Bequest', 'filtered_keytarget_label'), kwargs={}
2025/03/04 08:59:38 AM INFO:display_summary_statistics executed successfully
2025/03/04 08:59:38 AM DEBUG:Calling display_textual_insights with args=('filtered_keytarget_label', 'Bequest', datetime.date(2001, 3, 15), datetime.date(2019, 6, 28), {'unique_reg_entities': 21, 'unique_donors': 580, 'unique_donations': np.int64(727), 'total_value': np.float64(31740841.519999996), 'mean_value': np.float64(43660.02960110041), 'avg_donations_per_entity': np.float64(34.61904761904762), 'avg_value_per_entity': np.float64(75169.40835151076), 'avg_donors_per_entity': np.float64(27.761904761904763), 'donors_stdev': np.float64(60.42307191005452), 'value_stdev': np.float64(156614.76933911923), 'noofdonors_per_ent_stdev': np.float64(52.076774825160555)}, {'unique_reg_entities': 1361, 'unique_donors': 24834, 'unique_donations': np.int64(65278), 'total_value': np.float64(1091979899.03), 'mean_value': np.float64(16728.14576166549), 'avg_donations_per_entity': np.float64(47.85777126099707), 'avg_value_per_entity': np.float64(9368.670870011012), 'avg_donors_per_entity': np.float64(20.80058651026393), 'donors_stdev': np.float64(809.8426322896477), 'value_stdev': np.float64(59822.87214600705), 'noofdonors_per_ent_stdev': np.float64(322.8954476447556)}, 0.5), kwargs={}
2025/03/04 08:59:38 AM INFO:display_textual_insights executed successfully
2025/03/04 08:59:38 AM DEBUG:Calling display_visualizations with args=(          ECRef      OriginalRegulatedEntityName RegulatedEntityType     Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
262    C0406279     Uk Independence Party (Ukip)     Political Party  14264.93  ...                    24                   4701                        2                       362
503    C0407123                     Labour Party     Political Party  14029.57  ...                    27                   4698                        3                       362
597    C0406346                Liberal Democrats     Political Party  67000.00  ...                    32                   4693                        3                       361
626    C0406139       Communist Party Of Britain     Political Party   6457.59  ...                    28                   4697                        3                       362
758    C0406805    Scottish National Party (Snp)     Political Party  26985.51  ...                    29                   4696                        3                       362
...         ...                              ...                 ...       ...  ...                   ...                    ...                      ...                       ...
75633  C0001887                     Labour Party     Political Party   8150.00  ...                   199                   3764                       16                       290
75700  C0001998                Liberal Democrats     Political Party   2000.00  ...                   200                   3763                       16                       290
76893  C0001202                Liberal Democrats     Political Party   8016.33  ...                    12                   3746                        1                       289
76940  C0000827  Conservative And Unionist Party     Political Party   3500.00  ...                    10                   3749                        1                       289
77160  C0000667                Liberal Democrats     Political Party   3000.00  ...                    11                   3747                        1                       289

[727 rows x 58 columns], 'Bequest', 'filtered_keytarget_label'), kwargs={}
2025/03/04 08:59:38 AM DEBUG:Calling plot_bar_line_by_year with args=(          ECRef      OriginalRegulatedEntityName RegulatedEntityType     Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
262    C0406279     Uk Independence Party (Ukip)     Political Party  14264.93  ...                    24                   4701                        2                       362
503    C0407123                     Labour Party     Political Party  14029.57  ...                    27                   4698                        3                       362
597    C0406346                Liberal Democrats     Political Party  67000.00  ...                    32                   4693                        3                       361
626    C0406139       Communist Party Of Britain     Political Party   6457.59  ...                    28                   4697                        3                       362
758    C0406805    Scottish National Party (Snp)     Political Party  26985.51  ...                    29                   4696                        3                       362
...         ...                              ...                 ...       ...  ...                   ...                    ...                      ...                       ...
75633  C0001887                     Labour Party     Political Party   8150.00  ...                   199                   3764                       16                       290
75700  C0001998                Liberal Democrats     Political Party   2000.00  ...                   200                   3763                       16                       290
76893  C0001202                Liberal Democrats     Political Party   8016.33  ...                    12                   3746                        1                       289
76940  C0000827  Conservative And Unionist Party     Political Party   3500.00  ...                    10                   3749                        1                       289
77160  C0000667                Liberal Democrats     Political Party   3000.00  ...                    11                   3747                        1                       289

[727 rows x 58 columns],), kwargs={'XValues': 'YearReceived', 'YValues': 'Value', 'GroupData': 'RegEntity_Group', 'XLabel': 'Year', 'YLabel': 'Value of Donations £', 'Title': 'Value of Bequests by Year and Entity', 'CalcType': 'sum', 'use_custom_colors': False, 'widget_key': 'leftfiltered_keytarget_label_vis', 'ChartType': 'Bar', 'LegendTitle': 'Political Entity Type', 'percentbars': True, 'y_scale': 'linear'}
2025/03/04 08:59:38 AM INFO:plot_bar_line_by_year executed successfully
2025/03/04 08:59:38 AM DEBUG:Calling plot_bar_line_by_year with args=(          ECRef      OriginalRegulatedEntityName RegulatedEntityType     Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
262    C0406279     Uk Independence Party (Ukip)     Political Party  14264.93  ...                    24                   4701                        2                       362
503    C0407123                     Labour Party     Political Party  14029.57  ...                    27                   4698                        3                       362
597    C0406346                Liberal Democrats     Political Party  67000.00  ...                    32                   4693                        3                       361
626    C0406139       Communist Party Of Britain     Political Party   6457.59  ...                    28                   4697                        3                       362
758    C0406805    Scottish National Party (Snp)     Political Party  26985.51  ...                    29                   4696                        3                       362
...         ...                              ...                 ...       ...  ...                   ...                    ...                      ...                       ...
75633  C0001887                     Labour Party     Political Party   8150.00  ...                   199                   3764                       16                       290
75700  C0001998                Liberal Democrats     Political Party   2000.00  ...                   200                   3763                       16                       290
76893  C0001202                Liberal Democrats     Political Party   8016.33  ...                    12                   3746                        1                       289
76940  C0000827  Conservative And Unionist Party     Political Party   3500.00  ...                    10                   3749                        1                       289
77160  C0000667                Liberal Democrats     Political Party   3000.00  ...                    11                   3747                        1                       289

[727 rows x 58 columns],), kwargs={'XValues': 'YearReceived', 'YValues': 'EventCount', 'GroupData': 'RegEntity_Group', 'XLabel': 'Year', 'YLabel': 'Donations', 'Title': 'Donations of Bequests by Year and Entity', 'CalcType': 'sum', 'use_custom_colors': True, 'percentbars': False, 'LegendTitle': 'Political Entity', 'ChartType': 'line', 'y_scale': 'linear', 'widget_key': 'rightfiltered_keytarget_label_vis'}
2025/03/04 08:59:38 AM INFO:plot_bar_line_by_year executed successfully
2025/03/04 08:59:38 AM INFO:display_visualizations executed successfully
2025/03/04 08:59:38 AM INFO:display_data_page executed successfully
2025/03/04 08:59:38 AM INFO:pagesetup executed successfully
2025/03/04 08:59:38 AM INFO:Data already loaded in session state.
2025/03/04 08:59:43 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:59:43 AM INFO:Running App setup...
2025/03/04 08:59:43 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:59:43 AM INFO:Setting up the package
2025/03/04 08:59:43 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:59:43 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:59:43 AM INFO:get_git_version executed successfully
2025/03/04 08:59:43 AM INFO:Version: v20.140
2025/03/04 08:59:43 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:59:43 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:59:43 AM DEBUG:LOG_LEVEL already exists in session state
2025/03/04 08:59:43 AM DEBUG:BASE_DIR already exists in session state
2025/03/04 08:59:43 AM DEBUG:filenames already exists in session state
2025/03/04 08:59:43 AM DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/04 08:59:43 AM DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/04 08:59:43 AM DEBUG:thresholds already exists in session state
2025/03/04 08:59:43 AM DEBUG:data_remappings already exists in session state
2025/03/04 08:59:43 AM DEBUG:filter_def already exists in session state
2025/03/04 08:59:43 AM DEBUG:security already exists in session state
2025/03/04 08:59:43 AM DEBUG:perc_target already exists in session state
2025/03/04 08:59:43 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/04 08:59:43 AM DEBUG:directories already exists in session state
2025/03/04 08:59:43 AM DEBUG:reference_dir already exists in session state
2025/03/04 08:59:43 AM DEBUG:data_dir already exists in session state
2025/03/04 08:59:43 AM DEBUG:output_dir already exists in session state
2025/03/04 08:59:43 AM DEBUG:logs_dir already exists in session state
2025/03/04 08:59:43 AM DEBUG:components_dir already exists in session state
2025/03/04 08:59:43 AM DEBUG:app_pages_dir already exists in session state
2025/03/04 08:59:43 AM DEBUG:utils_dir already exists in session state
2025/03/04 08:59:43 AM DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/04 08:59:43 AM DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/04 08:59:43 AM DEBUG:mppartymemb_fname already exists in session state
2025/03/04 08:59:43 AM DEBUG:donor_map_fname already exists in session state
2025/03/04 08:59:43 AM DEBUG:politician_party_fname already exists in session state
2025/03/04 08:59:43 AM DEBUG:regentity_map_fname already exists in session state
2025/03/04 08:59:43 AM DEBUG:original_data_fname already exists in session state
2025/03/04 08:59:43 AM DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/04 08:59:43 AM DEBUG:TEXT_FILE already exists in session state
2025/03/04 08:59:43 AM DEBUG:ELECTION_DATES already exists in session state
2025/03/04 08:59:43 AM DEBUG:cleaned_data_fname already exists in session state
2025/03/04 08:59:43 AM DEBUG:cleaned_donations_fname already exists in session state
2025/03/04 08:59:43 AM DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/04 08:59:43 AM DEBUG:cleaned_regentity_fname already exists in session state
2025/03/04 08:59:43 AM DEBUG:party_summary_fname already exists in session state
2025/03/04 08:59:43 AM DEBUG:imported_raw_fname already exists in session state
2025/03/04 08:59:43 AM DEBUG:source_data_fname already exists in session state
2025/03/04 08:59:43 AM DEBUG:Cash_ftr already exists in session state
2025/03/04 08:59:43 AM INFO:Session_state variables initialized
2025/03/04 08:59:43 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:59:43 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:59:43 AM DEBUG:utils_dir: utils
2025/03/04 08:59:43 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:59:43 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:59:43 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:59:43 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:59:43 AM DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
30214    87478.0                       Martin Thomas          3529.41                2    1764.705000
30215    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
30216    87480.0                           Ann C Hay        157350.07                1  157350.070000
30217    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30218  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[30219 rows x 5 columns]
2025/03/04 08:59:43 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:59:43 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:59:43 AM DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/04 08:59:43 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:59:43 AM DEBUG:logs_dir: logs
2025/03/04 08:59:43 AM DEBUG:election_dates_last_modified: 1740757862.6744745
2025/03/04 08:59:43 AM DEBUG:components_dir: components
2025/03/04 08:59:43 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:59:43 AM DEBUG:perc_target: 0.5
2025/03/04 08:59:43 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:59:43 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:59:43 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:59:43 AM DEBUG:load_raw_data_last_modified: 1741078713.5048652
2025/03/04 08:59:43 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:59:43 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:59:43 AM DEBUG:data_dir: data
2025/03/04 08:59:43 AM DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[65278 rows x 58 columns]
2025/03/04 08:59:43 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:59:43 AM DEBUG:load_donorlist_data_last_modified: 1741078764.2643168
2025/03/04 08:59:43 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:59:43 AM DEBUG:donor_map_fname_last_modified: 1740757863.2545311
2025/03/04 08:59:43 AM DEBUG:output_dir: output
2025/03/04 08:59:43 AM DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[65278 rows x 40 columns]
2025/03/04 08:59:43 AM DEBUG:menu_selection: {'title': 'Corporate Donations', 'function': <function mod_corporate_donations_page at 0x000002A44A925480>}
2025/03/04 08:59:43 AM DEBUG:reference_dir: reference_files
2025/03/04 08:59:43 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:59:43 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:59:43 AM DEBUG:regentity_map_fname_last_modified: 1740841102.2638545
2025/03/04 08:59:43 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:59:43 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:59:43 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:59:43 AM DEBUG:raw_data_clean:            ECRef              RegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                             ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...                   86310.0                  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...                   86310.0                  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...                   86310.0                  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...                   86310.0                  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...                   86310.0                  Great Britain         False
...          ...                              ...                    ...        ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...                   74198.0                          Other         False
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                   74184.0                          Other         False
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   74576.0                          Other         False
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                   34241.0                  Great Britain         False
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                   74743.0                  Great Britain         False

[65278 rows x 29 columns]
2025/03/04 08:59:43 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:59:43 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:59:43 AM DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/04 08:59:43 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:59:43 AM DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/04 08:59:43 AM DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/04 08:59:43 AM DEBUG:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/04 08:59:43 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:59:43 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:59:43 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:59:43 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:59:43 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:59:43 AM INFO:Session state Setup complete
2025/03/04 08:59:43 AM INFO:initialize_session_state executed successfully
2025/03/04 08:59:43 AM INFO:Package setup complete
2025/03/04 08:59:43 AM INFO:setup_package executed successfully
2025/03/04 08:59:43 AM INFO:Running Menu setup...
2025/03/04 08:59:43 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:59:43 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:59:43 AM INFO:get_git_version executed successfully
2025/03/04 08:59:43 AM INFO:App Version: v20.161
2025/03/04 08:59:43 AM INFO:Switched to page: Corporate Donations
2025/03/04 08:59:43 AM DEBUG:Calling display_data_page with args=(), kwargs={'filter_key': 'CorporateDonations_ftr', 'target_label': 'Corporate Donation'}
2025/03/04 08:59:43 AM DEBUG:Calling load_and_filter_data with args=('CorporateDonations_ftr', 'filtered_keytarget_label'), kwargs={}
2025/03/04 08:59:43 AM INFO:load_and_filter_data executed successfully
2025/03/04 08:59:43 AM DEBUG:Calling display_summary_statistics with args=(          ECRef                 OriginalRegulatedEntityName    RegulatedEntityType    Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
11     C0407531                    Labour For A Public-Vote        Regulated Donee  10000.0  ...                    18                   4707                        2                       363
12     C0407530                    Labour For A Public-Vote        Regulated Donee  30000.0  ...                    20                   4705                        2                       362
14     C0408135                   The Rt Hon Jeremy Hunt Mp        Regulated Donee  10000.0  ...                    18                   4707                        2                       363
15     C0408130                   The Rt Hon Jeremy Hunt Mp        Regulated Donee   2600.0  ...                    21                   4704                        2                       362
16     C0408134                   The Rt Hon Jeremy Hunt Mp        Regulated Donee   3500.0  ...                    19                   4706                        2                       362
...         ...                                         ...                    ...      ...  ...                   ...                    ...                      ...                       ...
78725  C0243534                        Labour Leave Limited  Permitted Participant  20000.0  ...                    52                   4542                        4                       350
78731  C0259702  Trade Unionists Against The European Union  Permitted Participant   8000.0  ...                    67                   4526                        6                       349
78732  C0400297                        Labour Leave Limited  Permitted Participant  75000.0  ...                    56                   4537                        5                       349
78734  I0088673                           Liberal Democrats        Political Party   1000.0  ...                   126                   4359                       10                       336
78740  C0242478                          Vote Leave Limited  Permitted Participant  10000.0  ...                    62                   4532                        5                       349

[12360 rows x 58 columns],            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[65278 rows x 58 columns], 'Corporate Donation', 'filtered_keytarget_label'), kwargs={}
2025/03/04 08:59:43 AM INFO:display_summary_statistics executed successfully
2025/03/04 08:59:43 AM DEBUG:Calling display_textual_insights with args=('filtered_keytarget_label', 'Corporate Donation', datetime.date(2001, 1, 21), datetime.date(2019, 8, 9), {'unique_reg_entities': 702, 'unique_donors': 3037, 'unique_donations': np.int64(12360), 'total_value': np.float64(197192929.72), 'mean_value': np.float64(15954.12052750809), 'avg_donations_per_entity': np.float64(17.581792318634424), 'avg_value_per_entity': np.float64(8121.302084151369), 'avg_donors_per_entity': np.float64(5.975817923186344), 'donors_stdev': np.float64(239.9280312527667), 'value_stdev': np.float64(14768.539455052343), 'noofdonors_per_ent_stdev': np.float64(65.71715475154997)}, {'unique_reg_entities': 1361, 'unique_donors': 24834, 'unique_donations': np.int64(65278), 'total_value': np.float64(1091979899.03), 'mean_value': np.float64(16728.14576166549), 'avg_donations_per_entity': np.float64(47.85777126099707), 'avg_value_per_entity': np.float64(9368.670870011012), 'avg_donors_per_entity': np.float64(20.80058651026393), 'donors_stdev': np.float64(809.8426322896477), 'value_stdev': np.float64(59822.87214600705), 'noofdonors_per_ent_stdev': np.float64(322.8954476447556)}, 0.5), kwargs={}
2025/03/04 08:59:43 AM INFO:display_textual_insights executed successfully
2025/03/04 08:59:43 AM DEBUG:Calling display_visualizations with args=(          ECRef                 OriginalRegulatedEntityName    RegulatedEntityType    Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
11     C0407531                    Labour For A Public-Vote        Regulated Donee  10000.0  ...                    18                   4707                        2                       363
12     C0407530                    Labour For A Public-Vote        Regulated Donee  30000.0  ...                    20                   4705                        2                       362
14     C0408135                   The Rt Hon Jeremy Hunt Mp        Regulated Donee  10000.0  ...                    18                   4707                        2                       363
15     C0408130                   The Rt Hon Jeremy Hunt Mp        Regulated Donee   2600.0  ...                    21                   4704                        2                       362
16     C0408134                   The Rt Hon Jeremy Hunt Mp        Regulated Donee   3500.0  ...                    19                   4706                        2                       362
...         ...                                         ...                    ...      ...  ...                   ...                    ...                      ...                       ...
78725  C0243534                        Labour Leave Limited  Permitted Participant  20000.0  ...                    52                   4542                        4                       350
78731  C0259702  Trade Unionists Against The European Union  Permitted Participant   8000.0  ...                    67                   4526                        6                       349
78732  C0400297                        Labour Leave Limited  Permitted Participant  75000.0  ...                    56                   4537                        5                       349
78734  I0088673                           Liberal Democrats        Political Party   1000.0  ...                   126                   4359                       10                       336
78740  C0242478                          Vote Leave Limited  Permitted Participant  10000.0  ...                    62                   4532                        5                       349

[12360 rows x 58 columns], 'Corporate Donation', 'filtered_keytarget_label'), kwargs={}
2025/03/04 08:59:43 AM DEBUG:Calling plot_bar_line_by_year with args=(          ECRef                 OriginalRegulatedEntityName    RegulatedEntityType    Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
11     C0407531                    Labour For A Public-Vote        Regulated Donee  10000.0  ...                    18                   4707                        2                       363
12     C0407530                    Labour For A Public-Vote        Regulated Donee  30000.0  ...                    20                   4705                        2                       362
14     C0408135                   The Rt Hon Jeremy Hunt Mp        Regulated Donee  10000.0  ...                    18                   4707                        2                       363
15     C0408130                   The Rt Hon Jeremy Hunt Mp        Regulated Donee   2600.0  ...                    21                   4704                        2                       362
16     C0408134                   The Rt Hon Jeremy Hunt Mp        Regulated Donee   3500.0  ...                    19                   4706                        2                       362
...         ...                                         ...                    ...      ...  ...                   ...                    ...                      ...                       ...
78725  C0243534                        Labour Leave Limited  Permitted Participant  20000.0  ...                    52                   4542                        4                       350
78731  C0259702  Trade Unionists Against The European Union  Permitted Participant   8000.0  ...                    67                   4526                        6                       349
78732  C0400297                        Labour Leave Limited  Permitted Participant  75000.0  ...                    56                   4537                        5                       349
78734  I0088673                           Liberal Democrats        Political Party   1000.0  ...                   126                   4359                       10                       336
78740  C0242478                          Vote Leave Limited  Permitted Participant  10000.0  ...                    62                   4532                        5                       349

[12360 rows x 58 columns],), kwargs={'XValues': 'YearReceived', 'YValues': 'Value', 'GroupData': 'RegEntity_Group', 'XLabel': 'Year', 'YLabel': 'Value of Donations £', 'Title': 'Value of Corporate Donations by Year and Entity', 'CalcType': 'sum', 'use_custom_colors': False, 'widget_key': 'leftfiltered_keytarget_label_vis', 'ChartType': 'Bar', 'LegendTitle': 'Political Entity Type', 'percentbars': True, 'y_scale': 'linear'}
2025/03/04 08:59:43 AM INFO:plot_bar_line_by_year executed successfully
2025/03/04 08:59:44 AM DEBUG:Calling plot_bar_line_by_year with args=(          ECRef                 OriginalRegulatedEntityName    RegulatedEntityType    Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
11     C0407531                    Labour For A Public-Vote        Regulated Donee  10000.0  ...                    18                   4707                        2                       363
12     C0407530                    Labour For A Public-Vote        Regulated Donee  30000.0  ...                    20                   4705                        2                       362
14     C0408135                   The Rt Hon Jeremy Hunt Mp        Regulated Donee  10000.0  ...                    18                   4707                        2                       363
15     C0408130                   The Rt Hon Jeremy Hunt Mp        Regulated Donee   2600.0  ...                    21                   4704                        2                       362
16     C0408134                   The Rt Hon Jeremy Hunt Mp        Regulated Donee   3500.0  ...                    19                   4706                        2                       362
...         ...                                         ...                    ...      ...  ...                   ...                    ...                      ...                       ...
78725  C0243534                        Labour Leave Limited  Permitted Participant  20000.0  ...                    52                   4542                        4                       350
78731  C0259702  Trade Unionists Against The European Union  Permitted Participant   8000.0  ...                    67                   4526                        6                       349
78732  C0400297                        Labour Leave Limited  Permitted Participant  75000.0  ...                    56                   4537                        5                       349
78734  I0088673                           Liberal Democrats        Political Party   1000.0  ...                   126                   4359                       10                       336
78740  C0242478                          Vote Leave Limited  Permitted Participant  10000.0  ...                    62                   4532                        5                       349

[12360 rows x 58 columns],), kwargs={'XValues': 'YearReceived', 'YValues': 'EventCount', 'GroupData': 'RegEntity_Group', 'XLabel': 'Year', 'YLabel': 'Donations', 'Title': 'Donations of Corporate Donations by Year and Entity', 'CalcType': 'sum', 'use_custom_colors': True, 'percentbars': False, 'LegendTitle': 'Political Entity', 'ChartType': 'line', 'y_scale': 'linear', 'widget_key': 'rightfiltered_keytarget_label_vis'}
2025/03/04 08:59:44 AM INFO:plot_bar_line_by_year executed successfully
2025/03/04 08:59:44 AM INFO:display_visualizations executed successfully
2025/03/04 08:59:44 AM INFO:display_data_page executed successfully
2025/03/04 08:59:44 AM INFO:pagesetup executed successfully
2025/03/04 08:59:44 AM INFO:Data already loaded in session state.
2025/03/04 08:59:45 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:59:45 AM INFO:Running App setup...
2025/03/04 08:59:45 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:59:45 AM INFO:Setting up the package
2025/03/04 08:59:45 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:59:45 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:59:45 AM INFO:get_git_version executed successfully
2025/03/04 08:59:45 AM INFO:Version: v20.140
2025/03/04 08:59:45 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:59:45 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:59:45 AM DEBUG:LOG_LEVEL already exists in session state
2025/03/04 08:59:45 AM DEBUG:BASE_DIR already exists in session state
2025/03/04 08:59:45 AM DEBUG:filenames already exists in session state
2025/03/04 08:59:45 AM DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/04 08:59:45 AM DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/04 08:59:45 AM DEBUG:thresholds already exists in session state
2025/03/04 08:59:45 AM DEBUG:data_remappings already exists in session state
2025/03/04 08:59:45 AM DEBUG:filter_def already exists in session state
2025/03/04 08:59:45 AM DEBUG:security already exists in session state
2025/03/04 08:59:45 AM DEBUG:perc_target already exists in session state
2025/03/04 08:59:45 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/04 08:59:45 AM DEBUG:directories already exists in session state
2025/03/04 08:59:45 AM DEBUG:reference_dir already exists in session state
2025/03/04 08:59:45 AM DEBUG:data_dir already exists in session state
2025/03/04 08:59:45 AM DEBUG:output_dir already exists in session state
2025/03/04 08:59:45 AM DEBUG:logs_dir already exists in session state
2025/03/04 08:59:45 AM DEBUG:components_dir already exists in session state
2025/03/04 08:59:45 AM DEBUG:app_pages_dir already exists in session state
2025/03/04 08:59:45 AM DEBUG:utils_dir already exists in session state
2025/03/04 08:59:45 AM DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/04 08:59:45 AM DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/04 08:59:45 AM DEBUG:mppartymemb_fname already exists in session state
2025/03/04 08:59:45 AM DEBUG:donor_map_fname already exists in session state
2025/03/04 08:59:45 AM DEBUG:politician_party_fname already exists in session state
2025/03/04 08:59:45 AM DEBUG:regentity_map_fname already exists in session state
2025/03/04 08:59:45 AM DEBUG:original_data_fname already exists in session state
2025/03/04 08:59:45 AM DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/04 08:59:45 AM DEBUG:TEXT_FILE already exists in session state
2025/03/04 08:59:45 AM DEBUG:ELECTION_DATES already exists in session state
2025/03/04 08:59:45 AM DEBUG:cleaned_data_fname already exists in session state
2025/03/04 08:59:45 AM DEBUG:cleaned_donations_fname already exists in session state
2025/03/04 08:59:45 AM DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/04 08:59:45 AM DEBUG:cleaned_regentity_fname already exists in session state
2025/03/04 08:59:45 AM DEBUG:party_summary_fname already exists in session state
2025/03/04 08:59:45 AM DEBUG:imported_raw_fname already exists in session state
2025/03/04 08:59:45 AM DEBUG:source_data_fname already exists in session state
2025/03/04 08:59:45 AM DEBUG:Cash_ftr already exists in session state
2025/03/04 08:59:45 AM INFO:Session_state variables initialized
2025/03/04 08:59:45 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:59:45 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:59:45 AM DEBUG:utils_dir: utils
2025/03/04 08:59:45 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:59:45 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:59:45 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:59:45 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:59:45 AM DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
30214    87478.0                       Martin Thomas          3529.41                2    1764.705000
30215    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
30216    87480.0                           Ann C Hay        157350.07                1  157350.070000
30217    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30218  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[30219 rows x 5 columns]
2025/03/04 08:59:45 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:59:45 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:59:45 AM DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/04 08:59:45 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:59:45 AM DEBUG:logs_dir: logs
2025/03/04 08:59:45 AM DEBUG:election_dates_last_modified: 1740757862.6744745
2025/03/04 08:59:45 AM DEBUG:components_dir: components
2025/03/04 08:59:45 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:59:45 AM DEBUG:perc_target: 0.5
2025/03/04 08:59:45 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:59:45 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:59:45 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:59:45 AM DEBUG:load_raw_data_last_modified: 1741078713.5048652
2025/03/04 08:59:45 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:59:45 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:59:45 AM DEBUG:data_dir: data
2025/03/04 08:59:45 AM DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[65278 rows x 58 columns]
2025/03/04 08:59:45 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:59:45 AM DEBUG:load_donorlist_data_last_modified: 1741078764.2643168
2025/03/04 08:59:45 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:59:45 AM DEBUG:donor_map_fname_last_modified: 1740757863.2545311
2025/03/04 08:59:45 AM DEBUG:output_dir: output
2025/03/04 08:59:45 AM DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[65278 rows x 40 columns]
2025/03/04 08:59:45 AM DEBUG:menu_selection: {'title': 'Sponsorships', 'function': <function mod_sponsorship_page at 0x000002A44A925240>}
2025/03/04 08:59:45 AM DEBUG:reference_dir: reference_files
2025/03/04 08:59:45 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:59:45 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:59:45 AM DEBUG:regentity_map_fname_last_modified: 1740841102.2638545
2025/03/04 08:59:45 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:59:45 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:59:45 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:59:45 AM DEBUG:raw_data_clean:            ECRef              RegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                             ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...                   86310.0                  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...                   86310.0                  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...                   86310.0                  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...                   86310.0                  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...                   86310.0                  Great Britain         False
...          ...                              ...                    ...        ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...                   74198.0                          Other         False
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                   74184.0                          Other         False
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   74576.0                          Other         False
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                   34241.0                  Great Britain         False
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                   74743.0                  Great Britain         False

[65278 rows x 29 columns]
2025/03/04 08:59:45 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:59:45 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:59:45 AM DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/04 08:59:45 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:59:45 AM DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/04 08:59:45 AM DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/04 08:59:45 AM DEBUG:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/04 08:59:45 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:59:45 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:59:45 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:59:45 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:59:45 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:59:45 AM INFO:Session state Setup complete
2025/03/04 08:59:45 AM INFO:initialize_session_state executed successfully
2025/03/04 08:59:45 AM INFO:Package setup complete
2025/03/04 08:59:45 AM INFO:setup_package executed successfully
2025/03/04 08:59:45 AM INFO:Running Menu setup...
2025/03/04 08:59:45 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:59:45 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:59:45 AM INFO:get_git_version executed successfully
2025/03/04 08:59:45 AM INFO:App Version: v20.161
2025/03/04 08:59:45 AM INFO:Switched to page: Sponsorships
2025/03/04 08:59:45 AM DEBUG:Calling display_data_page with args=(), kwargs={'filter_key': 'Sponsorships_ftr', 'target_label': 'Sponsorship'}
2025/03/04 08:59:45 AM DEBUG:Calling load_and_filter_data with args=('Sponsorships_ftr', 'filtered_keytarget_label'), kwargs={}
2025/03/04 08:59:45 AM INFO:load_and_filter_data executed successfully
2025/03/04 08:59:45 AM DEBUG:Calling display_summary_statistics with args=(           ECRef      OriginalRegulatedEntityName RegulatedEntityType     Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
144    NC0406709         Mr Richard Harrington Mp     Regulated Donee  12000.00  ...                    28                   4696                        3                       362
146    NC0406708         Mr Richard Harrington Mp     Regulated Donee  10000.00  ...                    28                   4696                        3                       362
257    NC0407501  Conservative And Unionist Party     Political Party   3556.25  ...                    25                   4700                        2                       362
422    NC0407493  Conservative And Unionist Party     Political Party   2358.48  ...                    29                   4695                        3                       362
450    NC0407481  Conservative And Unionist Party     Political Party   2358.48  ...                    29                   4695                        3                       362
...          ...                              ...                 ...       ...  ...                   ...                    ...                      ...                       ...
76414  NC0027508                     Labour Party     Political Party   5541.00  ...                     2                   3757                        1                       289
76999   C0000608                     Labour Party     Political Party   2000.00  ...                    10                   3749                        1                       289
77476   C0000391                     Labour Party     Political Party   1500.00  ...                    15                   3744                        2                       288
77942  NC0319597  Conservative And Unionist Party     Political Party   8942.00  ...                     4                   4589                        1                       353
78357  NC0319545                     Labour Party     Political Party  16800.00  ...                     4                   4590                        1                       354

[1111 rows x 58 columns],            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[65278 rows x 58 columns], 'Sponsorship', 'filtered_keytarget_label'), kwargs={}
2025/03/04 08:59:45 AM INFO:display_summary_statistics executed successfully
2025/03/04 08:59:45 AM DEBUG:Calling display_textual_insights with args=('filtered_keytarget_label', 'Sponsorship', datetime.date(2001, 2, 27), datetime.date(2019, 6, 24), {'unique_reg_entities': 50, 'unique_donors': 596, 'unique_donations': np.int64(1111), 'total_value': np.float64(8056244.3100000005), 'mean_value': np.float64(7251.345013501351), 'avg_donations_per_entity': np.float64(21.365384615384617), 'avg_value_per_entity': np.float64(8070.831145275641), 'avg_donors_per_entity': np.float64(12.01923076923077), 'donors_stdev': np.float64(90.4355536640089), 'value_stdev': np.float64(9466.08872770972), 'noofdonors_per_ent_stdev': np.float64(56.320333939732244)}, {'unique_reg_entities': 1361, 'unique_donors': 24834, 'unique_donations': np.int64(65278), 'total_value': np.float64(1091979899.03), 'mean_value': np.float64(16728.14576166549), 'avg_donations_per_entity': np.float64(47.85777126099707), 'avg_value_per_entity': np.float64(9368.670870011012), 'avg_donors_per_entity': np.float64(20.80058651026393), 'donors_stdev': np.float64(809.8426322896477), 'value_stdev': np.float64(59822.87214600705), 'noofdonors_per_ent_stdev': np.float64(322.8954476447556)}, 0.5), kwargs={}
2025/03/04 08:59:45 AM INFO:display_textual_insights executed successfully
2025/03/04 08:59:45 AM DEBUG:Calling display_visualizations with args=(           ECRef      OriginalRegulatedEntityName RegulatedEntityType     Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
144    NC0406709         Mr Richard Harrington Mp     Regulated Donee  12000.00  ...                    28                   4696                        3                       362
146    NC0406708         Mr Richard Harrington Mp     Regulated Donee  10000.00  ...                    28                   4696                        3                       362
257    NC0407501  Conservative And Unionist Party     Political Party   3556.25  ...                    25                   4700                        2                       362
422    NC0407493  Conservative And Unionist Party     Political Party   2358.48  ...                    29                   4695                        3                       362
450    NC0407481  Conservative And Unionist Party     Political Party   2358.48  ...                    29                   4695                        3                       362
...          ...                              ...                 ...       ...  ...                   ...                    ...                      ...                       ...
76414  NC0027508                     Labour Party     Political Party   5541.00  ...                     2                   3757                        1                       289
76999   C0000608                     Labour Party     Political Party   2000.00  ...                    10                   3749                        1                       289
77476   C0000391                     Labour Party     Political Party   1500.00  ...                    15                   3744                        2                       288
77942  NC0319597  Conservative And Unionist Party     Political Party   8942.00  ...                     4                   4589                        1                       353
78357  NC0319545                     Labour Party     Political Party  16800.00  ...                     4                   4590                        1                       354

[1111 rows x 58 columns], 'Sponsorship', 'filtered_keytarget_label'), kwargs={}
2025/03/04 08:59:46 AM DEBUG:Calling plot_bar_line_by_year with args=(           ECRef      OriginalRegulatedEntityName RegulatedEntityType     Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
144    NC0406709         Mr Richard Harrington Mp     Regulated Donee  12000.00  ...                    28                   4696                        3                       362
146    NC0406708         Mr Richard Harrington Mp     Regulated Donee  10000.00  ...                    28                   4696                        3                       362
257    NC0407501  Conservative And Unionist Party     Political Party   3556.25  ...                    25                   4700                        2                       362
422    NC0407493  Conservative And Unionist Party     Political Party   2358.48  ...                    29                   4695                        3                       362
450    NC0407481  Conservative And Unionist Party     Political Party   2358.48  ...                    29                   4695                        3                       362
...          ...                              ...                 ...       ...  ...                   ...                    ...                      ...                       ...
76414  NC0027508                     Labour Party     Political Party   5541.00  ...                     2                   3757                        1                       289
76999   C0000608                     Labour Party     Political Party   2000.00  ...                    10                   3749                        1                       289
77476   C0000391                     Labour Party     Political Party   1500.00  ...                    15                   3744                        2                       288
77942  NC0319597  Conservative And Unionist Party     Political Party   8942.00  ...                     4                   4589                        1                       353
78357  NC0319545                     Labour Party     Political Party  16800.00  ...                     4                   4590                        1                       354

[1111 rows x 58 columns],), kwargs={'XValues': 'YearReceived', 'YValues': 'Value', 'GroupData': 'RegEntity_Group', 'XLabel': 'Year', 'YLabel': 'Value of Donations £', 'Title': 'Value of Sponsorships by Year and Entity', 'CalcType': 'sum', 'use_custom_colors': False, 'widget_key': 'leftfiltered_keytarget_label_vis', 'ChartType': 'Bar', 'LegendTitle': 'Political Entity Type', 'percentbars': True, 'y_scale': 'linear'}
2025/03/04 08:59:46 AM INFO:plot_bar_line_by_year executed successfully
2025/03/04 08:59:46 AM DEBUG:Calling plot_bar_line_by_year with args=(           ECRef      OriginalRegulatedEntityName RegulatedEntityType     Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
144    NC0406709         Mr Richard Harrington Mp     Regulated Donee  12000.00  ...                    28                   4696                        3                       362
146    NC0406708         Mr Richard Harrington Mp     Regulated Donee  10000.00  ...                    28                   4696                        3                       362
257    NC0407501  Conservative And Unionist Party     Political Party   3556.25  ...                    25                   4700                        2                       362
422    NC0407493  Conservative And Unionist Party     Political Party   2358.48  ...                    29                   4695                        3                       362
450    NC0407481  Conservative And Unionist Party     Political Party   2358.48  ...                    29                   4695                        3                       362
...          ...                              ...                 ...       ...  ...                   ...                    ...                      ...                       ...
76414  NC0027508                     Labour Party     Political Party   5541.00  ...                     2                   3757                        1                       289
76999   C0000608                     Labour Party     Political Party   2000.00  ...                    10                   3749                        1                       289
77476   C0000391                     Labour Party     Political Party   1500.00  ...                    15                   3744                        2                       288
77942  NC0319597  Conservative And Unionist Party     Political Party   8942.00  ...                     4                   4589                        1                       353
78357  NC0319545                     Labour Party     Political Party  16800.00  ...                     4                   4590                        1                       354

[1111 rows x 58 columns],), kwargs={'XValues': 'YearReceived', 'YValues': 'EventCount', 'GroupData': 'RegEntity_Group', 'XLabel': 'Year', 'YLabel': 'Donations', 'Title': 'Donations of Sponsorships by Year and Entity', 'CalcType': 'sum', 'use_custom_colors': True, 'percentbars': False, 'LegendTitle': 'Political Entity', 'ChartType': 'line', 'y_scale': 'linear', 'widget_key': 'rightfiltered_keytarget_label_vis'}
2025/03/04 08:59:46 AM INFO:plot_bar_line_by_year executed successfully
2025/03/04 08:59:46 AM INFO:display_visualizations executed successfully
2025/03/04 08:59:46 AM INFO:display_data_page executed successfully
2025/03/04 08:59:46 AM INFO:pagesetup executed successfully
2025/03/04 08:59:46 AM INFO:Data already loaded in session state.
