2025/03/03 10:17:20 PM INFO:Logging is set up correctly! Current log level: INFO
2025/03/03 10:17:20 PM INFO:get_git_version executed successfully
2025/03/03 10:17:21 PM INFO:get_git_version executed successfully
2025/03/03 10:17:21 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/03 10:17:21 PM INFO:Running App setup...
2025/03/03 10:17:21 PM INFO:Setting up the package
2025/03/03 10:17:21 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/03 10:17:21 PM INFO:get_git_version executed successfully
2025/03/03 10:17:21 PM INFO:Version: v20.138
2025/03/03 10:17:21 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/03 10:17:21 PM INFO:Session_state variables initialized
2025/03/03 10:17:21 PM INFO:Session state Setup complete
2025/03/03 10:17:21 PM INFO:initialize_session_state executed successfully
2025/03/03 10:17:21 PM INFO:Package setup complete
2025/03/03 10:17:21 PM INFO:setup_package executed successfully
2025/03/03 10:17:21 PM INFO:Running Menu setup...
2025/03/03 10:17:21 PM INFO:get_git_version executed successfully
2025/03/03 10:17:21 PM INFO:get_git_version executed successfully
2025/03/03 10:17:22 PM INFO:get_git_version executed successfully
2025/03/03 10:17:22 PM INFO:App Version: v20.159
2025/03/03 10:17:22 PM INFO:Switched to page: Introduction
2025/03/03 10:17:22 PM INFO:pagesetup executed successfully
2025/03/03 10:17:22 PM INFO:No data found in session state, running firstload()
2025/03/03 10:17:22 PM ERROR:Error in initialise_data: invalid syntax (clean_and_enhance.py, line 298)
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 39, in initialise_data
    from data.data_loader import firstload
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 3, in <module>
    from data.clean_and_enhance import load_cleaned_data
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 298
    If st.session_state.get("ElectionDatesAscend") and st.session_state.get(
       ^^
SyntaxError: invalid syntax
2025/03/03 10:17:59 PM INFO:Logging is set up correctly! Current log level: INFO
2025/03/03 10:18:00 PM INFO:get_git_version executed successfully
2025/03/03 10:18:01 PM INFO:get_git_version executed successfully
2025/03/03 10:18:01 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/03 10:18:01 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/03 10:18:01 PM INFO:Running App setup...
2025/03/03 10:18:01 PM INFO:Running App setup...
2025/03/03 10:18:01 PM INFO:Setting up the package
2025/03/03 10:18:01 PM INFO:Setting up the package
2025/03/03 10:18:01 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/03 10:18:01 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/03 10:18:01 PM INFO:get_git_version executed successfully
2025/03/03 10:18:01 PM INFO:get_git_version executed successfully
2025/03/03 10:18:01 PM INFO:Version: v20.138
2025/03/03 10:18:01 PM INFO:Version: v20.138
2025/03/03 10:18:01 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/03 10:18:01 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/03 10:18:01 PM INFO:Session_state variables initialized
2025/03/03 10:18:01 PM INFO:Session_state variables initialized
2025/03/03 10:18:01 PM INFO:Session state Setup complete
2025/03/03 10:18:01 PM INFO:Session state Setup complete
2025/03/03 10:18:01 PM INFO:initialize_session_state executed successfully
2025/03/03 10:18:01 PM INFO:initialize_session_state executed successfully
2025/03/03 10:18:01 PM INFO:Package setup complete
2025/03/03 10:18:01 PM INFO:Package setup complete
2025/03/03 10:18:01 PM INFO:setup_package executed successfully
2025/03/03 10:18:01 PM INFO:setup_package executed successfully
2025/03/03 10:18:01 PM INFO:Running Menu setup...
2025/03/03 10:18:01 PM INFO:Running Menu setup...
2025/03/03 10:18:01 PM INFO:get_git_version executed successfully
2025/03/03 10:18:01 PM INFO:get_git_version executed successfully
2025/03/03 10:18:01 PM INFO:get_git_version executed successfully
2025/03/03 10:18:01 PM INFO:get_git_version executed successfully
2025/03/03 10:18:01 PM INFO:App Version: v20.159
2025/03/03 10:18:01 PM INFO:App Version: v20.159
2025/03/03 10:18:01 PM INFO:Switched to page: Introduction
2025/03/03 10:18:01 PM INFO:Switched to page: Introduction
2025/03/03 10:18:01 PM INFO:pagesetup executed successfully
2025/03/03 10:18:01 PM INFO:pagesetup executed successfully
2025/03/03 10:18:01 PM INFO:No data found in session state, running firstload()
2025/03/03 10:18:01 PM INFO:No data found in session state, running firstload()
2025/03/03 10:18:02 PM INFO:Running first load function.
2025/03/03 10:18:02 PM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/03 10:18:02 PM INFO:Saved file path: output\imported_raw.csv
2025/03/03 10:18:02 PM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/03 10:18:02 PM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/03 10:18:02 PM INFO:get_file_modification_time executed successfully
2025/03/03 10:18:02 PM INFO:Current modification time: 1740757862.6744745
2025/03/03 10:18:02 PM INFO:Last modification time: None
2025/03/03 10:18:02 PM INFO:is_file_updated executed successfully
2025/03/03 10:18:02 PM INFO:try_to_use_preprocessed_data executed successfully
2025/03/03 10:18:02 PM INFO:Loading raw data...
2025/03/03 10:18:02 PM INFO:Data loaded successfully. Data has 65278 rows and 29 columns
2025/03/03 10:18:03 PM INFO:Data saved to output\imported_raw.csv
2025/03/03 10:18:03 PM INFO:Cleaning up raw data
2025/03/03 10:18:03 PM ERROR:Session state variables not initialized!
2025/03/03 10:18:03 PM INFO:Original file path: None
2025/03/03 10:18:03 PM INFO:Saved file path: output\cleaned_donations.csv
2025/03/03 10:18:03 PM ERROR:Error: originalfilepath is None!
2025/03/03 10:18:03 PM INFO:try_to_use_preprocessed_data executed successfully
2025/03/03 10:18:03 PM INFO:Data loaded, shape: (65278, 29)
2025/03/03 10:18:04 PM INFO:Checking if reference_files\PoliticalEntityDeDuped.csv has been updated.
2025/03/03 10:18:04 PM INFO:Getting modification time for reference_files\PoliticalEntityDeDuped.csv
2025/03/03 10:18:04 PM INFO:get_file_modification_time executed successfully
2025/03/03 10:18:04 PM INFO:Current modification time: 1740841102.2638545
2025/03/03 10:18:04 PM INFO:Last modification time: None
2025/03/03 10:18:04 PM INFO:is_file_updated executed successfully
2025/03/03 10:18:04 PM INFO:Map file regentity_map_fname has been updated. Proceeding with deduplication.
2025/03/03 10:18:04 PM INFO:File deduplication complete, shape: (65278, 34)
2025/03/03 10:18:04 PM INFO:dedupe_entity_file executed successfully
2025/03/03 10:18:04 PM INFO:Checking if reference_files\PoliticalDonorsDeduped.csv has been updated.
2025/03/03 10:18:04 PM INFO:Getting modification time for reference_files\PoliticalDonorsDeduped.csv
2025/03/03 10:18:04 PM INFO:get_file_modification_time executed successfully
2025/03/03 10:18:04 PM INFO:Current modification time: 1740757863.2545311
2025/03/03 10:18:04 PM INFO:Last modification time: None
2025/03/03 10:18:04 PM INFO:is_file_updated executed successfully
2025/03/03 10:18:04 PM INFO:Map file donor_map_fname has been updated. Proceeding with deduplication.
2025/03/03 10:18:04 PM INFO:File deduplication complete, shape: (65278, 40)
2025/03/03 10:18:04 PM INFO:dedupe_entity_file executed successfully
2025/03/03 10:18:04 PM INFO:Raw Data cleanup completed
2025/03/03 10:18:04 PM INFO:Data shape: (65278, 40)
2025/03/03 10:18:05 PM INFO:Data saved to output\cleaned_donations.csv
2025/03/03 10:18:05 PM INFO:Data cleanup completed, shape: (65278, 40)
2025/03/03 10:18:05 PM INFO:raw_data_cleanup executed successfully
2025/03/03 10:18:06 PM INFO:load_raw_data executed successfully
2025/03/03 10:18:06 PM INFO:get_raw_data executed successfully
2025/03/03 10:18:06 PM INFO:load_data_to_session executed successfully
2025/03/03 10:18:06 PM INFO:Original file path: output\cleaned_donations.csv
2025/03/03 10:18:06 PM INFO:Saved file path: output\cleaned_data.csv
2025/03/03 10:18:06 PM INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/03 10:18:06 PM INFO:Getting modification time for output\cleaned_donations.csv
2025/03/03 10:18:06 PM INFO:get_file_modification_time executed successfully
2025/03/03 10:18:06 PM INFO:Current modification time: 1741040285.9564433
2025/03/03 10:18:06 PM INFO:Last modification time: 1740757862.6744745
2025/03/03 10:18:06 PM INFO:is_file_updated executed successfully
2025/03/03 10:18:06 PM INFO:try_to_use_preprocessed_data executed successfully
2025/03/03 10:18:06 PM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/03 10:18:09 PM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/03 10:18:09 PM ERROR:Attempting to remove duplicates
2025/03/03 10:18:09 PM INFO:Data Updated with PartyName and PartyId successfully
2025/03/03 10:18:09 PM INFO:map_mp_to_party executed successfully
2025/03/03 10:18:09 PM ERROR:Election dates not found in session state.
2025/03/03 10:18:33 PM INFO:Cleaned Data completed, shape: (65278, 58)
2025/03/03 10:18:33 PM INFO:load_cleaned_data executed successfully
2025/03/03 10:18:33 PM INFO:get_cleaned_data executed successfully
2025/03/03 10:18:33 PM INFO:load_data_to_session executed successfully
2025/03/03 10:18:33 PM INFO:Original file path: output\cleaned_data.csv
2025/03/03 10:18:33 PM INFO:Saved file path: output\cleaned_donorlist.csv
2025/03/03 10:18:33 PM INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/03 10:18:33 PM INFO:Getting modification time for output\cleaned_data.csv
2025/03/03 10:18:33 PM INFO:get_file_modification_time executed successfully
2025/03/03 10:18:33 PM INFO:Current modification time: 1741040313.6131415
2025/03/03 10:18:33 PM INFO:Last modification time: None
2025/03/03 10:18:33 PM INFO:is_file_updated executed successfully
2025/03/03 10:18:33 PM INFO:try_to_use_preprocessed_data executed successfully
2025/03/03 10:18:34 PM INFO:Donor data saved to output\cleaned_donorlist.csv
2025/03/03 10:18:34 PM INFO:Donor Data summary completed
2025/03/03 10:18:34 PM INFO:Data shape: (30219, 5)
2025/03/03 10:18:34 PM INFO:load_donorList_data executed successfully
2025/03/03 10:18:34 PM INFO:get_donor_data executed successfully
2025/03/03 10:18:34 PM INFO:load_data_to_session executed successfully
2025/03/03 10:18:34 PM INFO:Original file path: output\cleaned_data.csv
2025/03/03 10:18:34 PM INFO:Saved file path: output\cleaned_regentity.csv
2025/03/03 10:18:34 PM INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/03 10:18:34 PM INFO:Getting modification time for output\cleaned_data.csv
2025/03/03 10:18:34 PM INFO:get_file_modification_time executed successfully
2025/03/03 10:18:34 PM INFO:Current modification time: 1741040313.6131415
2025/03/03 10:18:34 PM INFO:Last modification time: 1741040313.6131415
2025/03/03 10:18:34 PM INFO:is_file_updated executed successfully
2025/03/03 10:18:34 PM INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated load_donorlist_data_last_modified instead of output\cleaned_data.csv
2025/03/03 10:18:34 PM INFO:try_to_use_preprocessed_data executed successfully
2025/03/03 10:18:34 PM INFO:load_regulated_entity_data executed successfully
2025/03/03 10:18:34 PM INFO:get_regentity_data executed successfully
2025/03/03 10:18:34 PM INFO:load_data_to_session executed successfully
2025/03/03 10:18:34 PM INFO:firstload executed successfully
2025/03/03 10:18:34 PM INFO:initialise_data executed successfully
2025/03/03 10:25:06 PM INFO:Logging is set up correctly! Current log level: INFO
2025/03/03 10:25:07 PM INFO:get_git_version executed successfully
2025/03/03 10:25:07 PM INFO:get_git_version executed successfully
2025/03/03 10:25:07 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/03 10:25:07 PM INFO:Running App setup...
2025/03/03 10:25:07 PM INFO:Setting up the package
2025/03/03 10:25:07 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/03 10:25:07 PM INFO:get_git_version executed successfully
2025/03/03 10:25:07 PM INFO:Version: v20.138
2025/03/03 10:25:07 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/03 10:25:07 PM INFO:Session_state variables initialized
2025/03/03 10:25:07 PM INFO:Session state Setup complete
2025/03/03 10:25:07 PM INFO:initialize_session_state executed successfully
2025/03/03 10:25:07 PM INFO:Package setup complete
2025/03/03 10:25:07 PM INFO:setup_package executed successfully
2025/03/03 10:25:07 PM INFO:Running Menu setup...
2025/03/03 10:25:07 PM INFO:get_git_version executed successfully
2025/03/03 10:25:07 PM INFO:get_git_version executed successfully
2025/03/03 10:25:08 PM INFO:get_git_version executed successfully
2025/03/03 10:25:08 PM INFO:App Version: v20.159
2025/03/03 10:25:08 PM INFO:Switched to page: Introduction
2025/03/03 10:25:08 PM INFO:pagesetup executed successfully
2025/03/03 10:25:08 PM INFO:No data found in session state, running firstload()
2025/03/03 10:25:08 PM ERROR:Error in initialise_data: invalid syntax (clean_and_enhance.py, line 340)
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 39, in initialise_data
    from data.data_loader import firstload
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 3, in <module>
    from data.clean_and_enhance import load_cleaned_data
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 340
    else:
    ^^^^
SyntaxError: invalid syntax
2025/03/03 10:29:54 PM INFO:Logging is set up correctly! Current log level: INFO
2025/03/03 10:29:55 PM INFO:get_git_version executed successfully
2025/03/03 10:29:56 PM INFO:get_git_version executed successfully
2025/03/03 10:29:56 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/03 10:29:56 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/03 10:29:56 PM INFO:Running App setup...
2025/03/03 10:29:56 PM INFO:Running App setup...
2025/03/03 10:29:56 PM INFO:Setting up the package
2025/03/03 10:29:56 PM INFO:Setting up the package
2025/03/03 10:29:56 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/03 10:29:56 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/03 10:29:56 PM INFO:get_git_version executed successfully
2025/03/03 10:29:56 PM INFO:get_git_version executed successfully
2025/03/03 10:29:56 PM INFO:Version: v20.138
2025/03/03 10:29:56 PM INFO:Version: v20.138
2025/03/03 10:29:56 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/03 10:29:56 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/03 10:29:56 PM INFO:Session_state variables initialized
2025/03/03 10:29:56 PM INFO:Session state Setup complete
2025/03/03 10:29:56 PM INFO:Session_state variables initialized
2025/03/03 10:29:56 PM INFO:initialize_session_state executed successfully
2025/03/03 10:29:56 PM INFO:Session state Setup complete
2025/03/03 10:29:56 PM INFO:Package setup complete
2025/03/03 10:29:56 PM INFO:initialize_session_state executed successfully
2025/03/03 10:29:56 PM INFO:setup_package executed successfully
2025/03/03 10:29:56 PM INFO:Package setup complete
2025/03/03 10:29:56 PM INFO:setup_package executed successfully
2025/03/03 10:29:56 PM INFO:Running Menu setup...
2025/03/03 10:29:56 PM INFO:Running Menu setup...
2025/03/03 10:29:56 PM INFO:get_git_version executed successfully
2025/03/03 10:29:56 PM INFO:get_git_version executed successfully
2025/03/03 10:29:56 PM INFO:get_git_version executed successfully
2025/03/03 10:29:56 PM INFO:get_git_version executed successfully
2025/03/03 10:29:56 PM INFO:App Version: v20.159
2025/03/03 10:29:56 PM INFO:App Version: v20.159
2025/03/03 10:29:56 PM INFO:Switched to page: Introduction
2025/03/03 10:29:56 PM INFO:Switched to page: Introduction
2025/03/03 10:29:56 PM INFO:pagesetup executed successfully
2025/03/03 10:29:56 PM INFO:pagesetup executed successfully
2025/03/03 10:29:56 PM INFO:No data found in session state, running firstload()
2025/03/03 10:29:56 PM INFO:No data found in session state, running firstload()
2025/03/03 10:29:57 PM INFO:Running first load function.
2025/03/03 10:29:57 PM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/03 10:29:57 PM INFO:Saved file path: output\imported_raw.csv
2025/03/03 10:29:57 PM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/03 10:29:57 PM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/03 10:29:57 PM INFO:get_file_modification_time executed successfully
2025/03/03 10:29:57 PM INFO:Current modification time: 1740757862.6744745
2025/03/03 10:29:57 PM INFO:Last modification time: None
2025/03/03 10:29:57 PM INFO:is_file_updated executed successfully
2025/03/03 10:29:57 PM INFO:try_to_use_preprocessed_data executed successfully
2025/03/03 10:29:57 PM INFO:Loading raw data...
2025/03/03 10:29:57 PM INFO:Data loaded successfully. Data has 65278 rows and 29 columns
2025/03/03 10:29:58 PM INFO:Data saved to output\imported_raw.csv
2025/03/03 10:29:58 PM INFO:Cleaning up raw data
2025/03/03 10:29:58 PM ERROR:Session state variables not initialized!
2025/03/03 10:29:58 PM INFO:Original file path: None
2025/03/03 10:29:58 PM INFO:Saved file path: output\cleaned_donations.csv
2025/03/03 10:29:58 PM ERROR:Error: originalfilepath is None!
2025/03/03 10:29:58 PM INFO:try_to_use_preprocessed_data executed successfully
2025/03/03 10:29:58 PM INFO:Data loaded, shape: (65278, 29)
2025/03/03 10:30:00 PM INFO:Running first load function.
2025/03/03 10:30:00 PM INFO:Loading raw data...
2025/03/03 10:30:00 PM INFO:Data loaded successfully. Data has 65278 rows and 29 columns
2025/03/03 10:30:01 PM INFO:Data saved to output\imported_raw.csv
2025/03/03 10:30:01 PM INFO:Cleaning up raw data
2025/03/03 10:30:01 PM ERROR:Session state variables not initialized!
2025/03/03 10:30:01 PM INFO:Data loaded, shape: (65278, 29)
2025/03/03 10:30:02 PM INFO:Checking if reference_files\PoliticalEntityDeDuped.csv has been updated.
2025/03/03 10:30:02 PM INFO:Getting modification time for reference_files\PoliticalEntityDeDuped.csv
2025/03/03 10:30:02 PM INFO:get_file_modification_time executed successfully
2025/03/03 10:30:02 PM INFO:Current modification time: 1740841102.2638545
2025/03/03 10:30:02 PM INFO:Last modification time: None
2025/03/03 10:30:02 PM INFO:is_file_updated executed successfully
2025/03/03 10:30:02 PM INFO:Map file regentity_map_fname has been updated. Proceeding with deduplication.
2025/03/03 10:30:02 PM INFO:File deduplication complete, shape: (65278, 34)
2025/03/03 10:30:02 PM INFO:dedupe_entity_file executed successfully
2025/03/03 10:30:02 PM INFO:Checking if reference_files\PoliticalDonorsDeduped.csv has been updated.
2025/03/03 10:30:02 PM INFO:Getting modification time for reference_files\PoliticalDonorsDeduped.csv
2025/03/03 10:30:02 PM INFO:get_file_modification_time executed successfully
2025/03/03 10:30:02 PM INFO:Current modification time: 1740757863.2545311
2025/03/03 10:30:02 PM INFO:Last modification time: None
2025/03/03 10:30:02 PM INFO:is_file_updated executed successfully
2025/03/03 10:30:02 PM INFO:Map file donor_map_fname has been updated. Proceeding with deduplication.
2025/03/03 10:30:02 PM INFO:File deduplication complete, shape: (65278, 40)
2025/03/03 10:30:02 PM INFO:dedupe_entity_file executed successfully
2025/03/03 10:30:02 PM INFO:Raw Data cleanup completed
2025/03/03 10:30:02 PM INFO:Data shape: (65278, 40)
2025/03/03 10:30:03 PM INFO:Data saved to output\cleaned_donations.csv
2025/03/03 10:30:03 PM INFO:Data cleanup completed, shape: (65278, 40)
2025/03/03 10:30:03 PM INFO:raw_data_cleanup executed successfully
2025/03/03 10:30:04 PM INFO:load_raw_data executed successfully
2025/03/03 10:30:04 PM INFO:get_raw_data executed successfully
2025/03/03 10:30:04 PM INFO:load_data_to_session executed successfully
2025/03/03 10:30:04 PM INFO:Original file path: output\cleaned_donations.csv
2025/03/03 10:30:04 PM INFO:Saved file path: output\cleaned_data.csv
2025/03/03 10:30:04 PM INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/03 10:30:04 PM INFO:Getting modification time for output\cleaned_donations.csv
2025/03/03 10:30:04 PM INFO:get_file_modification_time executed successfully
2025/03/03 10:30:04 PM INFO:Current modification time: 1741041003.9707513
2025/03/03 10:30:04 PM INFO:Last modification time: None
2025/03/03 10:30:04 PM INFO:is_file_updated executed successfully
2025/03/03 10:30:04 PM INFO:try_to_use_preprocessed_data executed successfully
2025/03/03 10:30:04 PM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/03 10:30:07 PM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/03 10:30:07 PM ERROR:Attempting to remove duplicates
2025/03/03 10:30:07 PM INFO:Data Updated with PartyName and PartyId successfully
2025/03/03 10:30:07 PM INFO:map_mp_to_party executed successfully
2025/03/03 10:30:07 PM INFO:Election Dates not found in session, loading now.
2025/03/03 10:30:07 PM ERROR:Error in try_to_use_preprocessed_data: try_to_use_preprocessed_data() got an unexpected keyword argument 'processeddatafilepath'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
TypeError: try_to_use_preprocessed_data() got an unexpected keyword argument 'processeddatafilepath'
2025/03/03 10:30:07 PM ERROR:Failed to load election dates: try_to_use_preprocessed_data() got an unexpected keyword argument 'processeddatafilepath'
2025/03/03 10:30:07 PM INFO:load_election_dates executed successfully
2025/03/03 10:30:07 PM ERROR:Election dates could not be loaded. Returning None.
2025/03/03 10:30:07 PM INFO:load_cleaned_data executed successfully
2025/03/03 10:30:07 PM INFO:get_cleaned_data executed successfully
2025/03/03 10:30:07 PM INFO:load_data_to_session executed successfully
2025/03/03 10:30:07 PM ERROR:Session state variables not initialized! data.load_donor_regent_lists
2025/03/03 10:30:07 PM INFO:load_donorList_data executed successfully
2025/03/03 10:30:07 PM INFO:get_donor_data executed successfully
2025/03/03 10:30:07 PM INFO:load_data_to_session executed successfully
2025/03/03 10:30:07 PM ERROR:Session state variables not initialized! data.load_donor_regent_lists
2025/03/03 10:30:07 PM INFO:load_regulated_entity_data executed successfully
2025/03/03 10:30:07 PM INFO:get_regentity_data executed successfully
2025/03/03 10:30:07 PM INFO:load_data_to_session executed successfully
2025/03/03 10:30:07 PM INFO:firstload executed successfully
2025/03/03 10:30:07 PM ERROR:Data loading failed.
2025/03/03 10:33:09 PM INFO:Logging is set up correctly! Current log level: INFO
2025/03/03 10:33:09 PM INFO:get_git_version executed successfully
2025/03/03 10:33:10 PM INFO:get_git_version executed successfully
2025/03/03 10:33:10 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/03 10:33:10 PM INFO:Running App setup...
2025/03/03 10:33:10 PM INFO:Setting up the package
2025/03/03 10:33:10 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/03 10:33:10 PM INFO:get_git_version executed successfully
2025/03/03 10:33:10 PM INFO:Version: v20.138
2025/03/03 10:33:10 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/03 10:33:10 PM INFO:Session_state variables initialized
2025/03/03 10:33:10 PM INFO:Session state Setup complete
2025/03/03 10:33:10 PM INFO:initialize_session_state executed successfully
2025/03/03 10:33:10 PM INFO:Package setup complete
2025/03/03 10:33:10 PM INFO:setup_package executed successfully
2025/03/03 10:33:10 PM INFO:Running Menu setup...
2025/03/03 10:33:10 PM INFO:get_git_version executed successfully
2025/03/03 10:33:10 PM INFO:get_git_version executed successfully
2025/03/03 10:33:10 PM INFO:get_git_version executed successfully
2025/03/03 10:33:10 PM INFO:App Version: v20.159
2025/03/03 10:33:10 PM INFO:Switched to page: Introduction
2025/03/03 10:33:10 PM INFO:pagesetup executed successfully
2025/03/03 10:33:10 PM INFO:No data found in session state, running firstload()
2025/03/03 10:33:10 PM INFO:Running first load function.
2025/03/03 10:33:10 PM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/03 10:33:10 PM INFO:Saved file path: output\imported_raw.csv
2025/03/03 10:33:10 PM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/03 10:33:10 PM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/03 10:33:10 PM INFO:get_file_modification_time executed successfully
2025/03/03 10:33:10 PM INFO:Current modification time: 1740757862.6744745
2025/03/03 10:33:10 PM INFO:Last modification time: None
2025/03/03 10:33:10 PM INFO:is_file_updated executed successfully
2025/03/03 10:33:10 PM INFO:try_to_use_preprocessed_data executed successfully
2025/03/03 10:33:10 PM INFO:Loading raw data...
2025/03/03 10:33:11 PM INFO:Data loaded successfully. Data has 65278 rows and 29 columns
2025/03/03 10:33:12 PM INFO:Data saved to output\imported_raw.csv
2025/03/03 10:33:12 PM INFO:Cleaning up raw data
2025/03/03 10:33:12 PM ERROR:Session state variables not initialized!
2025/03/03 10:33:12 PM INFO:Original file path: None
2025/03/03 10:33:12 PM INFO:Saved file path: output\cleaned_donations.csv
2025/03/03 10:33:12 PM ERROR:Error: originalfilepath is None!
2025/03/03 10:33:12 PM INFO:try_to_use_preprocessed_data executed successfully
2025/03/03 10:33:12 PM INFO:Data loaded, shape: (65278, 29)
2025/03/03 10:33:13 PM INFO:Checking if reference_files\PoliticalEntityDeDuped.csv has been updated.
2025/03/03 10:33:13 PM INFO:Getting modification time for reference_files\PoliticalEntityDeDuped.csv
2025/03/03 10:33:13 PM INFO:get_file_modification_time executed successfully
2025/03/03 10:33:13 PM INFO:Current modification time: 1740841102.2638545
2025/03/03 10:33:13 PM INFO:Last modification time: None
2025/03/03 10:33:13 PM INFO:is_file_updated executed successfully
2025/03/03 10:33:13 PM INFO:Map file regentity_map_fname has been updated. Proceeding with deduplication.
2025/03/03 10:33:13 PM INFO:File deduplication complete, shape: (65278, 34)
2025/03/03 10:33:13 PM INFO:dedupe_entity_file executed successfully
2025/03/03 10:33:13 PM INFO:Checking if reference_files\PoliticalDonorsDeduped.csv has been updated.
2025/03/03 10:33:13 PM INFO:Getting modification time for reference_files\PoliticalDonorsDeduped.csv
2025/03/03 10:33:13 PM INFO:get_file_modification_time executed successfully
2025/03/03 10:33:13 PM INFO:Current modification time: 1740757863.2545311
2025/03/03 10:33:13 PM INFO:Last modification time: None
2025/03/03 10:33:13 PM INFO:is_file_updated executed successfully
2025/03/03 10:33:13 PM INFO:Map file donor_map_fname has been updated. Proceeding with deduplication.
2025/03/03 10:33:13 PM INFO:File deduplication complete, shape: (65278, 40)
2025/03/03 10:33:13 PM INFO:dedupe_entity_file executed successfully
2025/03/03 10:33:13 PM INFO:Raw Data cleanup completed
2025/03/03 10:33:13 PM INFO:Data shape: (65278, 40)
2025/03/03 10:33:14 PM INFO:Data saved to output\cleaned_donations.csv
2025/03/03 10:33:14 PM INFO:Data cleanup completed, shape: (65278, 40)
2025/03/03 10:33:14 PM INFO:raw_data_cleanup executed successfully
2025/03/03 10:33:15 PM INFO:load_raw_data executed successfully
2025/03/03 10:33:15 PM INFO:get_raw_data executed successfully
2025/03/03 10:33:15 PM INFO:load_data_to_session executed successfully
2025/03/03 10:33:15 PM INFO:Original file path: output\cleaned_donations.csv
2025/03/03 10:33:15 PM INFO:Saved file path: output\cleaned_data.csv
2025/03/03 10:33:15 PM INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/03 10:33:15 PM INFO:Getting modification time for output\cleaned_donations.csv
2025/03/03 10:33:15 PM INFO:get_file_modification_time executed successfully
2025/03/03 10:33:15 PM INFO:Current modification time: 1741041194.962836
2025/03/03 10:33:15 PM INFO:Last modification time: 1740757862.6744745
2025/03/03 10:33:15 PM INFO:is_file_updated executed successfully
2025/03/03 10:33:15 PM INFO:try_to_use_preprocessed_data executed successfully
2025/03/03 10:33:15 PM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/03 10:33:18 PM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/03 10:33:18 PM ERROR:Attempting to remove duplicates
2025/03/03 10:33:18 PM INFO:Data Updated with PartyName and PartyId successfully
2025/03/03 10:33:18 PM INFO:map_mp_to_party executed successfully
2025/03/03 10:33:18 PM INFO:Election Dates not found in session, loading now.
2025/03/03 10:33:18 PM ERROR:Error in try_to_use_preprocessed_data: try_to_use_preprocessed_data() got an unexpected keyword argument 'processeddatafilepath'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
TypeError: try_to_use_preprocessed_data() got an unexpected keyword argument 'processeddatafilepath'
2025/03/03 10:33:18 PM ERROR:Failed to load election dates: try_to_use_preprocessed_data() got an unexpected keyword argument 'processeddatafilepath'
2025/03/03 10:33:18 PM INFO:load_election_dates executed successfully
2025/03/03 10:33:18 PM ERROR:Election dates could not be loaded. Returning None.
2025/03/03 10:33:18 PM INFO:load_cleaned_data executed successfully
2025/03/03 10:33:18 PM INFO:get_cleaned_data executed successfully
2025/03/03 10:33:18 PM INFO:load_data_to_session executed successfully
2025/03/03 10:33:18 PM ERROR:Session state variables not initialized! data.load_donor_regent_lists
2025/03/03 10:33:18 PM INFO:load_donorList_data executed successfully
2025/03/03 10:33:18 PM INFO:get_donor_data executed successfully
2025/03/03 10:33:18 PM INFO:load_data_to_session executed successfully
2025/03/03 10:33:18 PM ERROR:Session state variables not initialized! data.load_donor_regent_lists
2025/03/03 10:33:18 PM INFO:load_regulated_entity_data executed successfully
2025/03/03 10:33:18 PM INFO:get_regentity_data executed successfully
2025/03/03 10:33:18 PM INFO:load_data_to_session executed successfully
2025/03/03 10:33:18 PM INFO:firstload executed successfully
2025/03/03 10:33:18 PM ERROR:Data loading failed.
2025/03/03 10:39:26 PM INFO:Logging is set up correctly! Current log level: INFO
2025/03/03 10:39:27 PM INFO:get_git_version executed successfully
2025/03/03 10:39:27 PM INFO:get_git_version executed successfully
2025/03/03 10:39:27 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/03 10:39:27 PM INFO:Running App setup...
2025/03/03 10:39:27 PM INFO:Setting up the package
2025/03/03 10:39:27 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/03 10:39:28 PM INFO:get_git_version executed successfully
2025/03/03 10:39:28 PM INFO:Version: v20.138
2025/03/03 10:39:28 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/03 10:39:28 PM INFO:Session_state variables initialized
2025/03/03 10:39:28 PM INFO:Session state Setup complete
2025/03/03 10:39:28 PM INFO:initialize_session_state executed successfully
2025/03/03 10:39:28 PM INFO:Package setup complete
2025/03/03 10:39:28 PM INFO:setup_package executed successfully
2025/03/03 10:39:28 PM INFO:Running Menu setup...
2025/03/03 10:39:28 PM INFO:get_git_version executed successfully
2025/03/03 10:39:28 PM INFO:get_git_version executed successfully
2025/03/03 10:39:28 PM INFO:get_git_version executed successfully
2025/03/03 10:39:28 PM INFO:App Version: v20.159
2025/03/03 10:39:28 PM INFO:Switched to page: Introduction
2025/03/03 10:39:28 PM INFO:pagesetup executed successfully
2025/03/03 10:39:28 PM INFO:No data found in session state, running firstload()
2025/03/03 10:39:28 PM INFO:Running first load function.
2025/03/03 10:39:28 PM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/03 10:39:28 PM INFO:Saved file path: output\imported_raw.csv
2025/03/03 10:39:28 PM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/03 10:39:28 PM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/03 10:39:28 PM INFO:get_file_modification_time executed successfully
2025/03/03 10:39:28 PM INFO:Current modification time: 1740757862.6744745
2025/03/03 10:39:28 PM INFO:Last modification time: None
2025/03/03 10:39:28 PM INFO:is_file_updated executed successfully
2025/03/03 10:39:28 PM INFO:try_to_use_preprocessed_data executed successfully
2025/03/03 10:39:28 PM INFO:Loading raw data...
2025/03/03 10:39:29 PM INFO:Data loaded successfully. Data has 65278 rows and 29 columns
2025/03/03 10:39:29 PM INFO:Data saved to output\imported_raw.csv
2025/03/03 10:39:29 PM INFO:Cleaning up raw data
2025/03/03 10:39:29 PM ERROR:Session state variables not initialized!
2025/03/03 10:39:29 PM INFO:Original file path: None
2025/03/03 10:39:29 PM INFO:Saved file path: output\cleaned_donations.csv
2025/03/03 10:39:29 PM ERROR:Error: originalfilepath is None!
2025/03/03 10:39:29 PM INFO:try_to_use_preprocessed_data executed successfully
2025/03/03 10:39:29 PM INFO:Data loaded, shape: (65278, 29)
2025/03/03 10:39:31 PM INFO:Checking if reference_files\PoliticalEntityDeDuped.csv has been updated.
2025/03/03 10:39:31 PM INFO:Getting modification time for reference_files\PoliticalEntityDeDuped.csv
2025/03/03 10:39:31 PM INFO:get_file_modification_time executed successfully
2025/03/03 10:39:31 PM INFO:Current modification time: 1740841102.2638545
2025/03/03 10:39:31 PM INFO:Last modification time: None
2025/03/03 10:39:31 PM INFO:is_file_updated executed successfully
2025/03/03 10:39:31 PM INFO:Map file regentity_map_fname has been updated. Proceeding with deduplication.
2025/03/03 10:39:31 PM INFO:File deduplication complete, shape: (65278, 34)
2025/03/03 10:39:31 PM INFO:dedupe_entity_file executed successfully
2025/03/03 10:39:31 PM INFO:Checking if reference_files\PoliticalDonorsDeduped.csv has been updated.
2025/03/03 10:39:31 PM INFO:Getting modification time for reference_files\PoliticalDonorsDeduped.csv
2025/03/03 10:39:31 PM INFO:get_file_modification_time executed successfully
2025/03/03 10:39:31 PM INFO:Current modification time: 1740757863.2545311
2025/03/03 10:39:31 PM INFO:Last modification time: None
2025/03/03 10:39:31 PM INFO:is_file_updated executed successfully
2025/03/03 10:39:31 PM INFO:Map file donor_map_fname has been updated. Proceeding with deduplication.
2025/03/03 10:39:31 PM INFO:File deduplication complete, shape: (65278, 40)
2025/03/03 10:39:31 PM INFO:dedupe_entity_file executed successfully
2025/03/03 10:39:31 PM INFO:Raw Data cleanup completed
2025/03/03 10:39:31 PM INFO:Data shape: (65278, 40)
2025/03/03 10:39:32 PM INFO:Data saved to output\cleaned_donations.csv
2025/03/03 10:39:32 PM INFO:Data cleanup completed, shape: (65278, 40)
2025/03/03 10:39:32 PM INFO:raw_data_cleanup executed successfully
2025/03/03 10:39:32 PM INFO:load_raw_data executed successfully
2025/03/03 10:39:33 PM INFO:get_raw_data executed successfully
2025/03/03 10:39:33 PM INFO:load_data_to_session executed successfully
2025/03/03 10:39:33 PM INFO:Original file path: output\cleaned_donations.csv
2025/03/03 10:39:33 PM INFO:Saved file path: output\cleaned_data.csv
2025/03/03 10:39:33 PM INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/03 10:39:33 PM INFO:Getting modification time for output\cleaned_donations.csv
2025/03/03 10:39:33 PM INFO:get_file_modification_time executed successfully
2025/03/03 10:39:33 PM INFO:Current modification time: 1741041572.7090662
2025/03/03 10:39:33 PM INFO:Last modification time: 1740757862.6744745
2025/03/03 10:39:33 PM INFO:is_file_updated executed successfully
2025/03/03 10:39:33 PM INFO:try_to_use_preprocessed_data executed successfully
2025/03/03 10:39:33 PM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/03 10:39:36 PM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/03 10:39:36 PM ERROR:Attempting to remove duplicates
2025/03/03 10:39:36 PM INFO:Data Updated with PartyName and PartyId successfully
2025/03/03 10:39:36 PM INFO:map_mp_to_party executed successfully
2025/03/03 10:39:36 PM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/03 10:39:36 PM INFO:Saved file path: reference_files\elections.csv
2025/03/03 10:39:36 PM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/03 10:39:36 PM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/03 10:39:36 PM INFO:get_file_modification_time executed successfully
2025/03/03 10:39:36 PM INFO:Current modification time: 1740757862.6744745
2025/03/03 10:39:36 PM INFO:Last modification time: None
2025/03/03 10:39:36 PM INFO:is_file_updated executed successfully
2025/03/03 10:39:36 PM INFO:try_to_use_preprocessed_data executed successfully
2025/03/03 10:39:36 PM INFO:Election dates found in session.
2025/03/03 10:39:36 PM ERROR:Failed to load election dates: 'NoneType' object has no attribute 'head'
2025/03/03 10:39:36 PM INFO:load_election_dates executed successfully
2025/03/03 10:39:36 PM ERROR:Election dates could not be loaded. Returning None.
2025/03/03 10:39:36 PM INFO:load_cleaned_data executed successfully
2025/03/03 10:39:36 PM INFO:get_cleaned_data executed successfully
2025/03/03 10:39:36 PM INFO:load_data_to_session executed successfully
2025/03/03 10:39:36 PM ERROR:Session state variables not initialized! data.load_donor_regent_lists
2025/03/03 10:39:36 PM INFO:load_donorList_data executed successfully
2025/03/03 10:39:36 PM INFO:get_donor_data executed successfully
2025/03/03 10:39:36 PM INFO:load_data_to_session executed successfully
2025/03/03 10:39:36 PM ERROR:Session state variables not initialized! data.load_donor_regent_lists
2025/03/03 10:39:36 PM INFO:load_regulated_entity_data executed successfully
2025/03/03 10:39:36 PM INFO:get_regentity_data executed successfully
2025/03/03 10:39:36 PM INFO:load_data_to_session executed successfully
2025/03/03 10:39:36 PM INFO:firstload executed successfully
2025/03/03 10:39:36 PM ERROR:Data loading failed.
2025/03/04 01:09:37 AM INFO:Logging is set up correctly! Current log level: INFO
2025/03/04 01:09:37 AM INFO:get_git_version executed successfully
2025/03/04 01:09:38 AM INFO:get_git_version executed successfully
2025/03/04 01:09:38 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 01:09:38 AM INFO:Running App setup...
2025/03/04 01:09:38 AM INFO:Setting up the package
2025/03/04 01:09:38 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 01:09:38 AM INFO:get_git_version executed successfully
2025/03/04 01:09:38 AM INFO:Version: v20.138
2025/03/04 01:09:38 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 01:09:38 AM INFO:Session_state variables initialized
2025/03/04 01:09:38 AM INFO:Session state Setup complete
2025/03/04 01:09:38 AM INFO:initialize_session_state executed successfully
2025/03/04 01:09:38 AM INFO:Package setup complete
2025/03/04 01:09:38 AM INFO:setup_package executed successfully
2025/03/04 01:09:38 AM INFO:Running Menu setup...
2025/03/04 01:09:39 AM INFO:get_git_version executed successfully
2025/03/04 01:09:39 AM INFO:get_git_version executed successfully
2025/03/04 01:09:39 AM INFO:get_git_version executed successfully
2025/03/04 01:09:39 AM INFO:App Version: v20.159
2025/03/04 01:09:39 AM INFO:Switched to page: Introduction
2025/03/04 01:09:39 AM INFO:pagesetup executed successfully
2025/03/04 01:09:39 AM INFO:No data found in session state, running firstload()
2025/03/04 01:13:24 AM INFO:Running first load function.
2025/03/04 01:13:25 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 01:13:25 AM INFO:Saved file path: output\imported_raw.csv
2025/03/04 01:13:25 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 01:13:25 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 01:13:25 AM INFO:get_file_modification_time executed successfully
2025/03/04 01:13:25 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 01:13:25 AM INFO:Last modification time: None
2025/03/04 01:13:25 AM INFO:is_file_updated executed successfully
2025/03/04 01:13:25 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 01:13:25 AM INFO:Loading raw data...
2025/03/04 01:13:25 AM INFO:Data loaded successfully. Data has 65278 rows and 29 columns
2025/03/04 01:13:26 AM INFO:Data saved to output\imported_raw.csv
2025/03/04 01:13:26 AM INFO:Cleaning up raw data
2025/03/04 01:13:26 AM ERROR:Session state variables not initialized!
2025/03/04 01:13:26 AM INFO:Original file path: None
2025/03/04 01:13:26 AM INFO:Saved file path: output\cleaned_donations.csv
2025/03/04 01:13:26 AM ERROR:Error: originalfilepath is None!
2025/03/04 01:13:26 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 01:13:26 AM INFO:Data loaded, shape: (65278, 29)
2025/03/04 01:13:30 AM INFO:Checking if reference_files\PoliticalEntityDeDuped.csv has been updated.
2025/03/04 01:13:30 AM INFO:Getting modification time for reference_files\PoliticalEntityDeDuped.csv
2025/03/04 01:13:30 AM INFO:get_file_modification_time executed successfully
2025/03/04 01:13:30 AM INFO:Current modification time: 1740841102.2638545
2025/03/04 01:13:30 AM INFO:Last modification time: None
2025/03/04 01:13:30 AM INFO:is_file_updated executed successfully
2025/03/04 01:13:30 AM INFO:Map file regentity_map_fname has been updated. Proceeding with deduplication.
2025/03/04 01:13:30 AM INFO:File deduplication complete, shape: (65278, 34)
2025/03/04 01:13:30 AM INFO:dedupe_entity_file executed successfully
2025/03/04 01:13:30 AM INFO:Checking if reference_files\PoliticalDonorsDeduped.csv has been updated.
2025/03/04 01:13:30 AM INFO:Getting modification time for reference_files\PoliticalDonorsDeduped.csv
2025/03/04 01:13:30 AM INFO:get_file_modification_time executed successfully
2025/03/04 01:13:30 AM INFO:Current modification time: 1740757863.2545311
2025/03/04 01:13:30 AM INFO:Last modification time: None
2025/03/04 01:13:30 AM INFO:is_file_updated executed successfully
2025/03/04 01:13:30 AM INFO:Map file donor_map_fname has been updated. Proceeding with deduplication.
2025/03/04 01:13:30 AM INFO:File deduplication complete, shape: (65278, 40)
2025/03/04 01:13:30 AM INFO:dedupe_entity_file executed successfully
2025/03/04 01:13:30 AM INFO:Raw Data cleanup completed
2025/03/04 01:13:30 AM INFO:Data shape: (65278, 40)
2025/03/04 01:13:32 AM INFO:Data saved to output\cleaned_donations.csv
2025/03/04 01:13:32 AM INFO:Data cleanup completed, shape: (65278, 40)
2025/03/04 01:13:32 AM INFO:raw_data_cleanup executed successfully
2025/03/04 01:13:32 AM INFO:load_raw_data executed successfully
2025/03/04 01:13:32 AM INFO:get_raw_data executed successfully
2025/03/04 01:13:32 AM INFO:load_data_to_session executed successfully
2025/03/04 01:13:32 AM INFO:Original file path: output\cleaned_donations.csv
2025/03/04 01:13:32 AM INFO:Saved file path: output\cleaned_data.csv
2025/03/04 01:13:32 AM INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/04 01:13:32 AM INFO:Getting modification time for output\cleaned_donations.csv
2025/03/04 01:13:32 AM INFO:get_file_modification_time executed successfully
2025/03/04 01:13:32 AM INFO:Current modification time: 1741050812.154613
2025/03/04 01:13:32 AM INFO:Last modification time: 1740757862.6744745
2025/03/04 01:13:32 AM INFO:is_file_updated executed successfully
2025/03/04 01:13:32 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 01:13:32 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 01:13:40 AM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/04 01:13:40 AM ERROR:Attempting to remove duplicates
2025/03/04 01:13:40 AM INFO:Data Updated with PartyName and PartyId successfully
2025/03/04 01:13:40 AM INFO:map_mp_to_party executed successfully
2025/03/04 01:13:41 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 01:13:41 AM INFO:Saved file path: reference_files\elections.csv
2025/03/04 01:13:41 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 01:13:41 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 01:13:41 AM INFO:get_file_modification_time executed successfully
2025/03/04 01:13:41 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 01:13:41 AM INFO:Last modification time: None
2025/03/04 01:13:41 AM INFO:is_file_updated executed successfully
2025/03/04 01:13:41 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 01:13:41 AM INFO:Election dates found in session.
2025/03/04 01:13:41 AM ERROR:Failed to load election dates: 'NoneType' object has no attribute 'head'
2025/03/04 01:13:41 AM INFO:load_election_dates executed successfully
2025/03/04 01:13:41 AM ERROR:Election dates could not be loaded. Returning None.
2025/03/04 01:13:41 AM INFO:load_cleaned_data executed successfully
2025/03/04 01:13:41 AM INFO:get_cleaned_data executed successfully
2025/03/04 01:13:41 AM INFO:load_data_to_session executed successfully
2025/03/04 01:13:41 AM ERROR:Session state variables not initialized! data.load_donor_regent_lists
2025/03/04 01:13:41 AM INFO:load_donorList_data executed successfully
2025/03/04 01:13:41 AM INFO:get_donor_data executed successfully
2025/03/04 01:13:41 AM INFO:load_data_to_session executed successfully
2025/03/04 01:13:41 AM ERROR:Session state variables not initialized! data.load_donor_regent_lists
2025/03/04 01:13:41 AM INFO:load_regulated_entity_data executed successfully
2025/03/04 01:13:41 AM INFO:get_regentity_data executed successfully
2025/03/04 01:13:41 AM INFO:load_data_to_session executed successfully
2025/03/04 01:13:41 AM INFO:firstload executed successfully
2025/03/04 01:14:16 AM ERROR:Data loading failed.
2025/03/04 01:17:19 AM INFO:Logging is set up correctly! Current log level: INFO
2025/03/04 01:17:20 AM INFO:get_git_version executed successfully
2025/03/04 01:17:21 AM INFO:get_git_version executed successfully
2025/03/04 01:17:21 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 01:17:21 AM INFO:Running App setup...
2025/03/04 01:17:21 AM INFO:Setting up the package
2025/03/04 01:17:21 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 01:17:21 AM INFO:get_git_version executed successfully
2025/03/04 01:17:21 AM INFO:Version: v20.138
2025/03/04 01:17:21 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 01:17:21 AM INFO:Session_state variables initialized
2025/03/04 01:17:21 AM INFO:Session state Setup complete
2025/03/04 01:17:21 AM INFO:initialize_session_state executed successfully
2025/03/04 01:17:21 AM INFO:Package setup complete
2025/03/04 01:17:21 AM INFO:setup_package executed successfully
2025/03/04 01:17:21 AM INFO:Running Menu setup...
2025/03/04 01:17:21 AM INFO:get_git_version executed successfully
2025/03/04 01:17:21 AM INFO:get_git_version executed successfully
2025/03/04 01:17:21 AM INFO:get_git_version executed successfully
2025/03/04 01:17:21 AM INFO:App Version: v20.159
2025/03/04 01:17:21 AM INFO:Switched to page: Introduction
2025/03/04 01:17:21 AM INFO:pagesetup executed successfully
2025/03/04 01:17:21 AM INFO:No data found in session state, running firstload()
2025/03/04 01:17:33 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 01:17:33 AM INFO:Running App setup...
2025/03/04 01:17:33 AM INFO:Setting up the package
2025/03/04 01:17:33 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 01:17:33 AM INFO:get_git_version executed successfully
2025/03/04 01:17:33 AM INFO:Version: v20.138
2025/03/04 01:17:33 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 01:17:33 AM INFO:Session_state variables initialized
2025/03/04 01:17:33 AM INFO:Session state Setup complete
2025/03/04 01:17:33 AM INFO:initialize_session_state executed successfully
2025/03/04 01:17:33 AM INFO:Package setup complete
2025/03/04 01:17:33 AM INFO:setup_package executed successfully
2025/03/04 01:17:33 AM INFO:Running Menu setup...
2025/03/04 01:17:33 AM INFO:get_git_version executed successfully
2025/03/04 01:17:33 AM INFO:App Version: v20.159
2025/03/04 01:17:33 AM INFO:Switched to page: Introduction
2025/03/04 01:17:33 AM INFO:pagesetup executed successfully
2025/03/04 01:17:33 AM INFO:No data found in session state, running firstload()
2025/03/04 01:18:27 AM INFO:Running first load function.
2025/03/04 01:18:27 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 01:18:27 AM INFO:Saved file path: output\imported_raw.csv
2025/03/04 01:18:27 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 01:18:27 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 01:18:27 AM INFO:get_file_modification_time executed successfully
2025/03/04 01:18:27 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 01:18:27 AM INFO:Last modification time: None
2025/03/04 01:18:27 AM INFO:is_file_updated executed successfully
2025/03/04 01:18:27 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 01:18:27 AM INFO:Loading raw data...
2025/03/04 01:18:27 AM INFO:Data loaded successfully. Data has 65278 rows and 29 columns
2025/03/04 01:18:28 AM INFO:Data saved to output\imported_raw.csv
2025/03/04 01:18:28 AM INFO:Cleaning up raw data
2025/03/04 01:18:28 AM ERROR:Session state variables not initialized!
2025/03/04 01:18:28 AM INFO:Original file path: None
2025/03/04 01:18:28 AM INFO:Saved file path: output\cleaned_donations.csv
2025/03/04 01:18:28 AM ERROR:Error: originalfilepath is None!
2025/03/04 01:18:28 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 01:18:28 AM INFO:Data loaded, shape: (65278, 29)
2025/03/04 01:18:32 AM INFO:Checking if reference_files\PoliticalEntityDeDuped.csv has been updated.
2025/03/04 01:18:32 AM INFO:Getting modification time for reference_files\PoliticalEntityDeDuped.csv
2025/03/04 01:18:32 AM INFO:get_file_modification_time executed successfully
2025/03/04 01:18:32 AM INFO:Current modification time: 1740841102.2638545
2025/03/04 01:18:32 AM INFO:Last modification time: None
2025/03/04 01:18:32 AM INFO:is_file_updated executed successfully
2025/03/04 01:18:32 AM INFO:Map file regentity_map_fname has been updated. Proceeding with deduplication.
2025/03/04 01:18:32 AM INFO:File deduplication complete, shape: (65278, 34)
2025/03/04 01:18:32 AM INFO:dedupe_entity_file executed successfully
2025/03/04 01:18:32 AM INFO:Checking if reference_files\PoliticalDonorsDeduped.csv has been updated.
2025/03/04 01:18:32 AM INFO:Getting modification time for reference_files\PoliticalDonorsDeduped.csv
2025/03/04 01:18:32 AM INFO:get_file_modification_time executed successfully
2025/03/04 01:18:32 AM INFO:Current modification time: 1740757863.2545311
2025/03/04 01:18:32 AM INFO:Last modification time: None
2025/03/04 01:18:32 AM INFO:is_file_updated executed successfully
2025/03/04 01:18:32 AM INFO:Map file donor_map_fname has been updated. Proceeding with deduplication.
2025/03/04 01:18:32 AM INFO:File deduplication complete, shape: (65278, 40)
2025/03/04 01:18:32 AM INFO:dedupe_entity_file executed successfully
2025/03/04 01:18:32 AM INFO:Raw Data cleanup completed
2025/03/04 01:18:32 AM INFO:Data shape: (65278, 40)
2025/03/04 01:18:34 AM INFO:Data saved to output\cleaned_donations.csv
2025/03/04 01:18:34 AM INFO:Data cleanup completed, shape: (65278, 40)
2025/03/04 01:18:34 AM INFO:raw_data_cleanup executed successfully
2025/03/04 01:18:34 AM INFO:load_raw_data executed successfully
2025/03/04 01:18:34 AM INFO:get_raw_data executed successfully
2025/03/04 01:18:34 AM INFO:load_data_to_session executed successfully
2025/03/04 01:18:34 AM INFO:Original file path: output\cleaned_donations.csv
2025/03/04 01:18:34 AM INFO:Saved file path: output\cleaned_data.csv
2025/03/04 01:18:34 AM INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/04 01:18:34 AM INFO:Getting modification time for output\cleaned_donations.csv
2025/03/04 01:18:34 AM INFO:get_file_modification_time executed successfully
2025/03/04 01:18:34 AM INFO:Current modification time: 1741051114.1794376
2025/03/04 01:18:34 AM INFO:Last modification time: 1740757862.6744745
2025/03/04 01:18:34 AM INFO:is_file_updated executed successfully
2025/03/04 01:18:34 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 01:18:34 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 01:18:41 AM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/04 01:18:41 AM ERROR:Attempting to remove duplicates
2025/03/04 01:18:42 AM INFO:Data Updated with PartyName and PartyId successfully
2025/03/04 01:18:42 AM INFO:map_mp_to_party executed successfully
2025/03/04 01:20:48 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 01:20:48 AM INFO:Saved file path: reference_files\elections.csv
2025/03/04 01:20:48 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 01:20:48 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 01:20:48 AM INFO:get_file_modification_time executed successfully
2025/03/04 01:20:48 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 01:20:48 AM INFO:Last modification time: None
2025/03/04 01:20:48 AM INFO:is_file_updated executed successfully
2025/03/04 01:20:48 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 01:20:48 AM INFO:Election dates found in session.
2025/03/04 01:20:48 AM ERROR:Failed to load election dates: 'NoneType' object has no attribute 'head'
2025/03/04 01:20:48 AM INFO:load_election_dates executed successfully
2025/03/04 01:24:55 AM ERROR:Election dates could not be loaded. Returning None.
2025/03/04 01:25:05 AM INFO:load_cleaned_data executed successfully
2025/03/04 01:25:05 AM INFO:get_cleaned_data executed successfully
2025/03/04 01:25:05 AM INFO:load_data_to_session executed successfully
2025/03/04 01:25:05 AM ERROR:Session state variables not initialized! data.load_donor_regent_lists
2025/03/04 01:25:05 AM INFO:load_donorList_data executed successfully
2025/03/04 01:25:05 AM INFO:get_donor_data executed successfully
2025/03/04 01:25:05 AM INFO:load_data_to_session executed successfully
2025/03/04 01:25:05 AM ERROR:Session state variables not initialized! data.load_donor_regent_lists
2025/03/04 01:25:05 AM INFO:load_regulated_entity_data executed successfully
2025/03/04 01:25:05 AM INFO:get_regentity_data executed successfully
2025/03/04 01:25:05 AM INFO:load_data_to_session executed successfully
2025/03/04 01:25:05 AM INFO:firstload executed successfully
2025/03/04 01:25:05 AM ERROR:Data loading failed.
2025/03/04 01:25:05 AM INFO:Running first load function.
2025/03/04 01:28:12 AM INFO:Logging is set up correctly! Current log level: INFO
2025/03/04 01:28:13 AM INFO:get_git_version executed successfully
2025/03/04 01:28:13 AM INFO:get_git_version executed successfully
2025/03/04 01:28:13 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 01:28:13 AM INFO:Running App setup...
2025/03/04 01:28:13 AM INFO:Setting up the package
2025/03/04 01:28:13 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 01:28:14 AM INFO:get_git_version executed successfully
2025/03/04 01:28:14 AM INFO:Version: v20.138
2025/03/04 01:28:14 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 01:28:14 AM INFO:Session_state variables initialized
2025/03/04 01:28:14 AM INFO:Session state Setup complete
2025/03/04 01:28:14 AM INFO:initialize_session_state executed successfully
2025/03/04 01:28:14 AM INFO:Package setup complete
2025/03/04 01:28:14 AM INFO:setup_package executed successfully
2025/03/04 01:28:14 AM INFO:Running Menu setup...
2025/03/04 01:28:14 AM INFO:get_git_version executed successfully
2025/03/04 01:28:14 AM INFO:get_git_version executed successfully
2025/03/04 01:28:14 AM INFO:get_git_version executed successfully
2025/03/04 01:28:14 AM INFO:App Version: v20.159
2025/03/04 01:28:14 AM INFO:Switched to page: Introduction
2025/03/04 01:28:14 AM INFO:pagesetup executed successfully
2025/03/04 01:28:14 AM INFO:No data found in session state, running firstload()
2025/03/04 01:28:14 AM INFO:Running first load function.
2025/03/04 01:28:14 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 01:28:14 AM INFO:Saved file path: output\imported_raw.csv
2025/03/04 01:28:14 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 01:28:14 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 01:28:14 AM INFO:get_file_modification_time executed successfully
2025/03/04 01:28:14 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 01:28:14 AM INFO:Last modification time: None
2025/03/04 01:28:14 AM INFO:is_file_updated executed successfully
2025/03/04 01:28:14 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 01:28:14 AM INFO:Loading raw data...
2025/03/04 01:28:15 AM INFO:Data loaded successfully. Data has 65278 rows and 29 columns
2025/03/04 01:28:16 AM INFO:Data saved to output\imported_raw.csv
2025/03/04 01:28:16 AM INFO:Cleaning up raw data
2025/03/04 01:28:16 AM ERROR:Session state variables not initialized!
2025/03/04 01:28:16 AM INFO:Original file path: None
2025/03/04 01:28:16 AM INFO:Saved file path: output\cleaned_donations.csv
2025/03/04 01:28:16 AM ERROR:Error: originalfilepath is None!
2025/03/04 01:28:16 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 01:28:16 AM INFO:Data loaded, shape: (65278, 29)
2025/03/04 01:28:17 AM INFO:Checking if reference_files\PoliticalEntityDeDuped.csv has been updated.
2025/03/04 01:28:17 AM INFO:Getting modification time for reference_files\PoliticalEntityDeDuped.csv
2025/03/04 01:28:17 AM INFO:get_file_modification_time executed successfully
2025/03/04 01:28:17 AM INFO:Current modification time: 1740841102.2638545
2025/03/04 01:28:17 AM INFO:Last modification time: None
2025/03/04 01:28:17 AM INFO:is_file_updated executed successfully
2025/03/04 01:28:17 AM INFO:Map file regentity_map_fname has been updated. Proceeding with deduplication.
2025/03/04 01:28:17 AM INFO:File deduplication complete, shape: (65278, 34)
2025/03/04 01:28:17 AM INFO:dedupe_entity_file executed successfully
2025/03/04 01:28:17 AM INFO:Checking if reference_files\PoliticalDonorsDeduped.csv has been updated.
2025/03/04 01:28:17 AM INFO:Getting modification time for reference_files\PoliticalDonorsDeduped.csv
2025/03/04 01:28:17 AM INFO:get_file_modification_time executed successfully
2025/03/04 01:28:17 AM INFO:Current modification time: 1740757863.2545311
2025/03/04 01:28:17 AM INFO:Last modification time: None
2025/03/04 01:28:17 AM INFO:is_file_updated executed successfully
2025/03/04 01:28:17 AM INFO:Map file donor_map_fname has been updated. Proceeding with deduplication.
2025/03/04 01:28:17 AM INFO:File deduplication complete, shape: (65278, 40)
2025/03/04 01:28:17 AM INFO:dedupe_entity_file executed successfully
2025/03/04 01:28:17 AM INFO:Raw Data cleanup completed
2025/03/04 01:28:17 AM INFO:Data shape: (65278, 40)
2025/03/04 01:28:19 AM INFO:Data saved to output\cleaned_donations.csv
2025/03/04 01:28:19 AM INFO:Data cleanup completed, shape: (65278, 40)
2025/03/04 01:28:19 AM INFO:raw_data_cleanup executed successfully
2025/03/04 01:28:19 AM INFO:load_raw_data executed successfully
2025/03/04 01:28:19 AM INFO:get_raw_data executed successfully
2025/03/04 01:28:19 AM INFO:load_data_to_session executed successfully
2025/03/04 01:28:19 AM INFO:Original file path: output\cleaned_donations.csv
2025/03/04 01:28:19 AM INFO:Saved file path: output\cleaned_data.csv
2025/03/04 01:28:19 AM INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/04 01:28:19 AM INFO:Getting modification time for output\cleaned_donations.csv
2025/03/04 01:28:19 AM INFO:get_file_modification_time executed successfully
2025/03/04 01:28:19 AM INFO:Current modification time: 1741051699.4530022
2025/03/04 01:28:19 AM INFO:Last modification time: 1740757862.6744745
2025/03/04 01:28:19 AM INFO:is_file_updated executed successfully
2025/03/04 01:28:19 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 01:28:19 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 01:28:22 AM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/04 01:28:22 AM ERROR:Attempting to remove duplicates
2025/03/04 01:28:23 AM INFO:Data Updated with PartyName and PartyId successfully
2025/03/04 01:28:23 AM INFO:map_mp_to_party executed successfully
2025/03/04 01:28:23 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 01:28:23 AM INFO:Saved file path: reference_files\elections.csv
2025/03/04 01:28:23 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 01:28:23 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 01:28:23 AM INFO:get_file_modification_time executed successfully
2025/03/04 01:28:23 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 01:28:23 AM INFO:Last modification time: None
2025/03/04 01:28:23 AM INFO:is_file_updated executed successfully
2025/03/04 01:28:23 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 01:28:23 AM INFO:Election dates found in session.
2025/03/04 01:28:23 AM ERROR:Failed to load election dates: 'NoneType' object has no attribute 'head'
2025/03/04 01:28:23 AM INFO:load_election_dates executed successfully
2025/03/04 01:28:23 AM ERROR:Election dates could not be loaded. Returning None.
2025/03/04 01:28:23 AM INFO:load_cleaned_data executed successfully
2025/03/04 01:28:23 AM INFO:get_cleaned_data executed successfully
2025/03/04 01:28:23 AM INFO:load_data_to_session executed successfully
2025/03/04 01:28:23 AM ERROR:Session state variables not initialized! data.load_donor_regent_lists
2025/03/04 01:28:23 AM INFO:load_donorList_data executed successfully
2025/03/04 01:28:23 AM INFO:get_donor_data executed successfully
2025/03/04 01:28:23 AM INFO:load_data_to_session executed successfully
2025/03/04 01:28:23 AM ERROR:Session state variables not initialized! data.load_donor_regent_lists
2025/03/04 01:28:23 AM INFO:load_regulated_entity_data executed successfully
2025/03/04 01:28:23 AM INFO:get_regentity_data executed successfully
2025/03/04 01:28:23 AM INFO:load_data_to_session executed successfully
2025/03/04 01:28:23 AM INFO:firstload executed successfully
2025/03/04 01:28:23 AM ERROR:Data loading failed.
2025/03/04 01:32:36 AM INFO:Logging is set up correctly! Current log level: INFO
2025/03/04 01:32:36 AM INFO:get_git_version executed successfully
2025/03/04 01:32:37 AM INFO:get_git_version executed successfully
2025/03/04 01:32:37 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 01:32:37 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 01:32:37 AM INFO:Running App setup...
2025/03/04 01:32:37 AM INFO:Running App setup...
2025/03/04 01:32:37 AM INFO:Setting up the package
2025/03/04 01:32:37 AM INFO:Setting up the package
2025/03/04 01:32:37 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 01:32:37 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 01:32:37 AM INFO:get_git_version executed successfully
2025/03/04 01:32:37 AM INFO:get_git_version executed successfully
2025/03/04 01:32:37 AM INFO:Version: v20.138
2025/03/04 01:32:37 AM INFO:Version: v20.138
2025/03/04 01:32:37 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 01:32:37 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 01:32:37 AM INFO:Session_state variables initialized
2025/03/04 01:32:37 AM INFO:Session_state variables initialized
2025/03/04 01:32:37 AM INFO:Session state Setup complete
2025/03/04 01:32:37 AM INFO:Session state Setup complete
2025/03/04 01:32:37 AM INFO:initialize_session_state executed successfully
2025/03/04 01:32:37 AM INFO:initialize_session_state executed successfully
2025/03/04 01:32:37 AM INFO:Package setup complete
2025/03/04 01:32:37 AM INFO:Package setup complete
2025/03/04 01:32:37 AM INFO:setup_package executed successfully
2025/03/04 01:32:37 AM INFO:setup_package executed successfully
2025/03/04 01:32:37 AM INFO:Running Menu setup...
2025/03/04 01:32:37 AM INFO:Running Menu setup...
2025/03/04 01:32:37 AM INFO:get_git_version executed successfully
2025/03/04 01:32:37 AM INFO:get_git_version executed successfully
2025/03/04 01:32:37 AM INFO:get_git_version executed successfully
2025/03/04 01:32:37 AM INFO:get_git_version executed successfully
2025/03/04 01:32:37 AM INFO:App Version: v20.159
2025/03/04 01:32:37 AM INFO:App Version: v20.159
2025/03/04 01:32:37 AM INFO:Switched to page: Introduction
2025/03/04 01:32:37 AM INFO:Switched to page: Introduction
2025/03/04 01:32:37 AM INFO:pagesetup executed successfully
2025/03/04 01:32:37 AM INFO:pagesetup executed successfully
2025/03/04 01:32:37 AM INFO:No data found in session state, running firstload()
2025/03/04 01:32:37 AM INFO:No data found in session state, running firstload()
2025/03/04 01:32:38 AM INFO:Running first load function.
2025/03/04 01:32:38 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 01:32:38 AM INFO:Saved file path: output\imported_raw.csv
2025/03/04 01:32:38 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 01:32:38 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 01:32:38 AM INFO:get_file_modification_time executed successfully
2025/03/04 01:32:38 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 01:32:38 AM INFO:Last modification time: None
2025/03/04 01:32:38 AM INFO:is_file_updated executed successfully
2025/03/04 01:32:38 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 01:32:38 AM INFO:Loading raw data...
2025/03/04 01:32:38 AM INFO:Data loaded successfully. Data has 65278 rows and 29 columns
2025/03/04 01:32:39 AM INFO:Data saved to output\imported_raw.csv
2025/03/04 01:32:39 AM INFO:Cleaning up raw data
2025/03/04 01:32:39 AM ERROR:Session state variables not initialized!
2025/03/04 01:32:39 AM INFO:Original file path: None
2025/03/04 01:32:39 AM INFO:Saved file path: output\cleaned_donations.csv
2025/03/04 01:32:39 AM ERROR:Error: originalfilepath is None!
2025/03/04 01:32:39 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 01:32:39 AM INFO:Data loaded, shape: (65278, 29)
2025/03/04 01:32:40 AM INFO:Checking if reference_files\PoliticalEntityDeDuped.csv has been updated.
2025/03/04 01:32:40 AM INFO:Getting modification time for reference_files\PoliticalEntityDeDuped.csv
2025/03/04 01:32:40 AM INFO:get_file_modification_time executed successfully
2025/03/04 01:32:40 AM INFO:Current modification time: 1740841102.2638545
2025/03/04 01:32:40 AM INFO:Last modification time: None
2025/03/04 01:32:40 AM INFO:is_file_updated executed successfully
2025/03/04 01:32:40 AM INFO:Map file regentity_map_fname has been updated. Proceeding with deduplication.
2025/03/04 01:32:40 AM INFO:File deduplication complete, shape: (65278, 34)
2025/03/04 01:32:40 AM INFO:dedupe_entity_file executed successfully
2025/03/04 01:32:40 AM INFO:Checking if reference_files\PoliticalDonorsDeduped.csv has been updated.
2025/03/04 01:32:40 AM INFO:Getting modification time for reference_files\PoliticalDonorsDeduped.csv
2025/03/04 01:32:40 AM INFO:get_file_modification_time executed successfully
2025/03/04 01:32:40 AM INFO:Current modification time: 1740757863.2545311
2025/03/04 01:32:40 AM INFO:Last modification time: None
2025/03/04 01:32:40 AM INFO:is_file_updated executed successfully
2025/03/04 01:32:40 AM INFO:Map file donor_map_fname has been updated. Proceeding with deduplication.
2025/03/04 01:32:41 AM INFO:File deduplication complete, shape: (65278, 40)
2025/03/04 01:32:41 AM INFO:dedupe_entity_file executed successfully
2025/03/04 01:32:41 AM INFO:Raw Data cleanup completed
2025/03/04 01:32:41 AM INFO:Data shape: (65278, 40)
2025/03/04 01:32:42 AM INFO:Data saved to output\cleaned_donations.csv
2025/03/04 01:32:42 AM INFO:Data cleanup completed, shape: (65278, 40)
2025/03/04 01:32:42 AM INFO:raw_data_cleanup executed successfully
2025/03/04 01:32:42 AM INFO:load_raw_data executed successfully
2025/03/04 01:32:43 AM INFO:get_raw_data executed successfully
2025/03/04 01:32:43 AM INFO:load_data_to_session executed successfully
2025/03/04 01:32:43 AM INFO:Original file path: output\cleaned_donations.csv
2025/03/04 01:32:43 AM INFO:Saved file path: output\cleaned_data.csv
2025/03/04 01:32:43 AM INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/04 01:32:43 AM INFO:Getting modification time for output\cleaned_donations.csv
2025/03/04 01:32:43 AM INFO:get_file_modification_time executed successfully
2025/03/04 01:32:43 AM INFO:Current modification time: 1741051962.6857357
2025/03/04 01:32:43 AM INFO:Last modification time: 1740757862.6744745
2025/03/04 01:32:43 AM INFO:is_file_updated executed successfully
2025/03/04 01:32:43 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 01:32:43 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 01:32:46 AM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/04 01:32:46 AM ERROR:Attempting to remove duplicates
2025/03/04 01:32:46 AM INFO:Data Updated with PartyName and PartyId successfully
2025/03/04 01:32:46 AM INFO:map_mp_to_party executed successfully
2025/03/04 01:32:46 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 01:32:46 AM INFO:Saved file path: reference_files\elections.csv
2025/03/04 01:32:46 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 01:32:46 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 01:32:46 AM INFO:get_file_modification_time executed successfully
2025/03/04 01:32:46 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 01:32:46 AM INFO:Last modification time: None
2025/03/04 01:32:46 AM INFO:is_file_updated executed successfully
2025/03/04 01:32:46 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 01:32:46 AM INFO:Election dates found in session.
2025/03/04 01:32:46 AM ERROR:Failed to load election dates: 'NoneType' object has no attribute 'head'
2025/03/04 01:32:46 AM INFO:load_election_dates executed successfully
2025/03/04 01:32:46 AM ERROR:Election dates could not be loaded. Returning None.
2025/03/04 01:32:46 AM INFO:load_cleaned_data executed successfully
2025/03/04 01:32:46 AM INFO:get_cleaned_data executed successfully
2025/03/04 01:32:46 AM INFO:load_data_to_session executed successfully
2025/03/04 01:32:46 AM ERROR:Session state variables not initialized! data.load_donor_regent_lists
2025/03/04 01:32:46 AM INFO:load_donorList_data executed successfully
2025/03/04 01:32:46 AM INFO:get_donor_data executed successfully
2025/03/04 01:32:46 AM INFO:load_data_to_session executed successfully
2025/03/04 01:32:46 AM ERROR:Session state variables not initialized! data.load_donor_regent_lists
2025/03/04 01:32:46 AM INFO:load_regulated_entity_data executed successfully
2025/03/04 01:32:46 AM INFO:get_regentity_data executed successfully
2025/03/04 01:32:46 AM INFO:load_data_to_session executed successfully
2025/03/04 01:32:46 AM INFO:firstload executed successfully
2025/03/04 01:32:46 AM ERROR:Data loading failed.
2025/03/04 01:32:46 AM INFO:Running first load function.
2025/03/04 01:32:46 AM INFO:firstload executed successfully
2025/03/04 01:32:46 AM ERROR:Data loading failed.
2025/03/04 01:34:05 AM INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/04 01:34:05 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\utils',), kwargs={}
2025/03/04 01:34:05 AM INFO:get_git_version executed successfully
2025/03/04 01:34:06 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\data',), kwargs={}
2025/03/04 01:34:06 AM INFO:get_git_version executed successfully
2025/03/04 01:34:06 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 01:34:06 AM INFO:Running App setup...
2025/03/04 01:34:06 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 01:34:06 AM INFO:Setting up the package
2025/03/04 01:34:06 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 01:34:06 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 01:34:06 AM INFO:get_git_version executed successfully
2025/03/04 01:34:06 AM INFO:Version: v20.138
2025/03/04 01:34:06 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 01:34:06 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 01:34:06 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 01:34:06 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 01:34:06 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 01:34:06 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 01:34:06 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 01:34:06 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 01:34:06 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 01:34:06 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 01:34:06 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 01:34:06 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 01:34:06 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 01:34:06 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 01:34:06 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 01:34:06 AM DEBUG:Initialised data_dir with value: data
2025/03/04 01:34:06 AM DEBUG:Initialised output_dir with value: output
2025/03/04 01:34:06 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 01:34:06 AM DEBUG:Initialised components_dir with value: components
2025/03/04 01:34:06 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 01:34:06 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 01:34:06 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 01:34:06 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 01:34:06 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 01:34:06 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 01:34:06 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 01:34:06 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 01:34:06 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 01:34:06 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 01:34:06 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 01:34:06 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 01:34:06 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 01:34:06 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 01:34:06 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 01:34:06 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 01:34:06 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 01:34:06 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 01:34:06 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 01:34:06 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 01:34:06 AM INFO:Session_state variables initialized
2025/03/04 01:34:06 AM DEBUG:data_dir: data
2025/03/04 01:34:06 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 01:34:06 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 01:34:06 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 01:34:06 AM DEBUG:reference_dir: reference_files
2025/03/04 01:34:06 AM DEBUG:logs_dir: logs
2025/03/04 01:34:06 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 01:34:06 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 01:34:06 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 01:34:06 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 01:34:06 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 01:34:06 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 01:34:06 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 01:34:06 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 01:34:06 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 01:34:06 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 01:34:06 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 01:34:06 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 01:34:06 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 01:34:06 AM DEBUG:output_dir: output
2025/03/04 01:34:06 AM DEBUG:components_dir: components
2025/03/04 01:34:06 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 01:34:06 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 01:34:06 AM DEBUG:perc_target: 0.5
2025/03/04 01:34:06 AM DEBUG:utils_dir: utils
2025/03/04 01:34:06 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 01:34:06 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 01:34:06 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 01:34:06 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 01:34:06 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 01:34:06 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 01:34:06 AM DEBUG:app_pages_dir: app_pages
2025/03/04 01:34:06 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 01:34:06 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 01:34:06 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 01:34:06 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 01:34:06 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 01:34:06 AM INFO:Session state Setup complete
2025/03/04 01:34:06 AM INFO:initialize_session_state executed successfully
2025/03/04 01:34:06 AM INFO:Package setup complete
2025/03/04 01:34:06 AM INFO:setup_package executed successfully
2025/03/04 01:34:06 AM INFO:Running Menu setup...
2025/03/04 01:34:06 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 01:34:06 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\app_pages',), kwargs={}
2025/03/04 01:34:06 AM INFO:get_git_version executed successfully
2025/03/04 01:34:06 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\components',), kwargs={}
2025/03/04 01:34:06 AM INFO:get_git_version executed successfully
2025/03/04 01:34:06 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 01:34:06 AM INFO:get_git_version executed successfully
2025/03/04 01:34:06 AM INFO:App Version: v20.159
2025/03/04 01:34:06 AM INFO:Switched to page: Introduction
2025/03/04 01:34:06 AM INFO:pagesetup executed successfully
2025/03/04 01:34:06 AM INFO:No data found in session state, running firstload()
2025/03/04 01:34:06 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 01:34:07 AM INFO:Running first load function.
2025/03/04 01:34:07 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 01:34:07 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x000001D883A7C8B0>), kwargs={}
2025/03/04 01:34:07 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 01:34:07 AM DEBUG:Calling load_raw_data with args=(), kwargs={'main_file': 'raw_data', 'cleaned_file': 'raw_data_clean', 'output_csv': True, 'dedupe_donors': True, 'dedupe_regentity': True, 'originaldatafilepath': 'source_data_fname', 'processeddatafilepath': 'imported_raw_fname'}
2025/03/04 01:34:07 AM DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/04 01:34:07 AM DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/04 01:34:07 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'source\\Donations_accepted_by_political_parties.csv', 'savedfilepath': 'output\\imported_raw.csv', 'timestamp_key': 'load_raw_data_last_modified'}
2025/03/04 01:34:07 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 01:34:07 AM INFO:Saved file path: output\imported_raw.csv
2025/03/04 01:34:07 AM DEBUG:Calling is_file_updated with args=('source\\Donations_accepted_by_political_parties.csv', 'load_raw_data_last_modified'), kwargs={}
2025/03/04 01:34:07 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 01:34:07 AM DEBUG:Calling get_file_modification_time with args=('source\\Donations_accepted_by_political_parties.csv',), kwargs={}
2025/03/04 01:34:07 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 01:34:07 AM INFO:get_file_modification_time executed successfully
2025/03/04 01:34:07 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 01:34:07 AM INFO:Last modification time: None
2025/03/04 01:34:07 AM INFO:is_file_updated executed successfully
2025/03/04 01:34:07 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 01:34:07 AM INFO:Loading raw data...
2025/03/04 01:34:07 AM DEBUG:Original data file path post raw data load: {originaldatafilepath}
2025/03/04 01:34:07 AM DEBUG:Processed data file path post raw data load: {processeddatafilepath}
2025/03/04 01:34:07 AM INFO:Data loaded successfully. Data has 65278 rows and 29 columns
2025/03/04 01:34:08 AM INFO:Data saved to output\imported_raw.csv
2025/03/04 01:34:08 AM DEBUG:Calling raw_data_cleanup with args=(), kwargs={'loaddata_df':            ECRef              RegulatedEntityName    RegulatedEntityType        Value AcceptedDate AccountingUnitName  ... RegulatedEntityId AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                                                  ...                                                                                         
0      NC0408174                   Mr Andy Street        Regulated Donee    1,876.56   02/09/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    2,700.00   02/09/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    4,852.58   30/08/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    2,500.00   30/08/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    4,524.05   29/08/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
...          ...                              ...                    ...          ...          ...                ...  ...               ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10,000.00          NaN                NaN  ...              3945              NaN  74198.0             NaN            NaN         False
65274   C0242461               Vote Leave Limited  Permitted Participant  100,000.00          NaN                NaN  ...              3945              NaN  74184.0             NaN            NaN         False
65275   C0243560               Vote Leave Limited  Permitted Participant   40,000.00          NaN                NaN  ...              3945              NaN  74576.0             NaN            NaN         False
65276   C0319710  Conservative and Unionist Party        Political Party   50,000.00          NaN      Central Party  ...                52              NaN  34241.0             NaN  Great Britain         False
65277   C0319727  Conservative and Unionist Party        Political Party   15,000.00          NaN      Central Party  ...                52              NaN  74743.0             NaN  Great Britain         False

[65278 rows x 29 columns], 'dedupe_donors': True, 'dedupe_regentity': True, 'output_csv': True, 'originaldatafilepath': 'output\\imported_raw.csv', 'processeddatafilepath': 'cleaned_donations_fname'}
2025/03/04 01:34:08 AM INFO:Cleaning up raw data
2025/03/04 01:34:08 AM ERROR:Session state variables not initialized!
2025/03/04 01:34:08 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': None, 'savedfilepath': 'output\\cleaned_donations.csv', 'timestamp_key': 'cleaned_raw_data_last_modified'}
2025/03/04 01:34:08 AM INFO:Original file path: None
2025/03/04 01:34:08 AM INFO:Saved file path: output\cleaned_donations.csv
2025/03/04 01:34:08 AM ERROR:Error: originalfilepath is None!
2025/03/04 01:34:08 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 01:34:08 AM INFO:Data loaded, shape: (65278, 29)
2025/03/04 01:34:09 AM DEBUG:Calling dedupe_entity_file with args=(), kwargs={'loaddata_dd_df':            ECRef              RegulatedEntityName    RegulatedEntityType      Value AcceptedDate AccountingUnitName  ... RegulatedEntityId AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                                                ...                                                                                         
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019                     ...              8015                   86310.0                  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019                     ...              8015                   86310.0                  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019                     ...              8015                   86310.0                  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019                     ...              8015                   86310.0                  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019                     ...              8015                   86310.0                  Great Britain         False
...          ...                              ...                    ...        ...          ...                ...  ...               ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN                     ...              3945                   74198.0                          Other         False
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN                     ...              3945                   74184.0                          Other         False
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN                     ...              3945                   74576.0                          Other         False
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN      Central Party  ...                52                   34241.0                  Great Britain         False
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN      Central Party  ...                52                   74743.0                  Great Britain         False

[65278 rows x 29 columns], 'entity': 'RegulatedEntity', 'map_filename': 'regentity_map_fname', 'output_csv': True}
2025/03/04 01:34:09 AM DEBUG:Calling is_file_updated with args=('reference_files\\PoliticalEntityDeDuped.csv', 'regentity_map_fname_last_modified'), kwargs={}
2025/03/04 01:34:09 AM INFO:Checking if reference_files\PoliticalEntityDeDuped.csv has been updated.
2025/03/04 01:34:09 AM DEBUG:Calling get_file_modification_time with args=('reference_files\\PoliticalEntityDeDuped.csv',), kwargs={}
2025/03/04 01:34:09 AM INFO:Getting modification time for reference_files\PoliticalEntityDeDuped.csv
2025/03/04 01:34:09 AM INFO:get_file_modification_time executed successfully
2025/03/04 01:34:09 AM INFO:Current modification time: 1740841102.2638545
2025/03/04 01:34:09 AM INFO:Last modification time: None
2025/03/04 01:34:09 AM INFO:is_file_updated executed successfully
2025/03/04 01:34:09 AM INFO:Map file regentity_map_fname has been updated. Proceeding with deduplication.
2025/03/04 01:34:09 AM INFO:File deduplication complete, shape: (65278, 34)
2025/03/04 01:34:09 AM INFO:dedupe_entity_file executed successfully
2025/03/04 01:34:09 AM DEBUG:Calling dedupe_entity_file with args=(), kwargs={'loaddata_dd_df':            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...       CleanedRegulatedEntityName      OriginalRegulatedEntityName RegulatedEntityId              RegulatedEntityName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                      Andy Street                      Andy Street            8015.0                      Andy Street
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                      Andy Street                      Andy Street            8015.0                      Andy Street
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                      Andy Street                      Andy Street            8015.0                      Andy Street
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                      Andy Street                      Andy Street            8015.0                      Andy Street
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                      Andy Street                      Andy Street            8015.0                      Andy Street
...          ...                              ...                    ...        ...  ...                              ...                              ...               ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...               Vote Leave Limited               Vote Leave Limited            3945.0               Vote Leave Limited
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...               Vote Leave Limited               Vote Leave Limited            3945.0               Vote Leave Limited
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...               Vote Leave Limited               Vote Leave Limited            3945.0               Vote Leave Limited
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...  Conservative And Unionist Party  Conservative And Unionist Party              52.0  Conservative And Unionist Party
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...  Conservative And Unionist Party  Conservative And Unionist Party              52.0  Conservative And Unionist Party

[65278 rows x 34 columns], 'entity': 'Donor', 'map_filename': 'donor_map_fname', 'output_csv': True}
2025/03/04 01:34:09 AM DEBUG:Calling is_file_updated with args=('reference_files\\PoliticalDonorsDeduped.csv', 'donor_map_fname_last_modified'), kwargs={}
2025/03/04 01:34:09 AM INFO:Checking if reference_files\PoliticalDonorsDeduped.csv has been updated.
2025/03/04 01:34:09 AM DEBUG:Calling get_file_modification_time with args=('reference_files\\PoliticalDonorsDeduped.csv',), kwargs={}
2025/03/04 01:34:09 AM INFO:Getting modification time for reference_files\PoliticalDonorsDeduped.csv
2025/03/04 01:34:09 AM INFO:get_file_modification_time executed successfully
2025/03/04 01:34:09 AM INFO:Current modification time: 1740757863.2545311
2025/03/04 01:34:09 AM INFO:Last modification time: None
2025/03/04 01:34:09 AM INFO:is_file_updated executed successfully
2025/03/04 01:34:09 AM INFO:Map file donor_map_fname has been updated. Proceeding with deduplication.
2025/03/04 01:34:09 AM INFO:File deduplication complete, shape: (65278, 40)
2025/03/04 01:34:09 AM INFO:dedupe_entity_file executed successfully
2025/03/04 01:34:09 AM INFO:Raw Data cleanup completed
2025/03/04 01:34:09 AM INFO:Data shape: (65278, 40)
2025/03/04 01:34:11 AM INFO:Data saved to output\cleaned_donations.csv
2025/03/04 01:34:11 AM INFO:Data cleanup completed, shape: (65278, 40)
2025/03/04 01:34:11 AM INFO:raw_data_cleanup executed successfully
2025/03/04 01:34:11 AM INFO:load_raw_data executed successfully
2025/03/04 01:34:11 AM INFO:get_raw_data executed successfully
2025/03/04 01:34:11 AM INFO:load_data_to_session executed successfully
2025/03/04 01:34:11 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x000001D883A7C940>), kwargs={}
2025/03/04 01:34:11 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 01:34:11 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 01:34:11 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'output\\cleaned_donations.csv', 'savedfilepath': 'output\\cleaned_data.csv', 'timestamp_key': 'load_raw_data_last_modified'}
2025/03/04 01:34:11 AM INFO:Original file path: output\cleaned_donations.csv
2025/03/04 01:34:11 AM INFO:Saved file path: output\cleaned_data.csv
2025/03/04 01:34:11 AM DEBUG:Calling is_file_updated with args=('output\\cleaned_donations.csv', 'load_raw_data_last_modified'), kwargs={}
2025/03/04 01:34:11 AM INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/04 01:34:11 AM DEBUG:Calling get_file_modification_time with args=('output\\cleaned_donations.csv',), kwargs={}
2025/03/04 01:34:11 AM INFO:Getting modification time for output\cleaned_donations.csv
2025/03/04 01:34:11 AM INFO:get_file_modification_time executed successfully
2025/03/04 01:34:11 AM INFO:Current modification time: 1741052051.4123464
2025/03/04 01:34:11 AM INFO:Last modification time: 1740757862.6744745
2025/03/04 01:34:11 AM INFO:is_file_updated executed successfully
2025/03/04 01:34:11 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 01:34:11 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 01:34:14 AM DEBUG:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate AccountingUnitName  ...  DonorId                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...                ...  ...      ...                              ...        ...          ...           ...               ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN                     ...  74198.0          Shaftesbury Investments          1         2016             4            201604
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN                     ...  74184.0                Mr Jeremy Hosking          1         2016             2            201602
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN                     ...  23556.0                   Anthony Clarke          1         2016             6            201606
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN      Central Party  ...   2146.0                Mr Peter A Dubens          1         2017             5            201705
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN      Central Party  ...  74743.0                 Mr Ravi S Kailas          1         2017             5            201705

[65278 rows x 44 columns],), kwargs={}
2025/03/04 01:34:14 AM DEBUG:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/04 01:34:14 AM DEBUG:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/04 01:34:14 AM DEBUG:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 01:34:14 AM DEBUG:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/04 01:34:14 AM DEBUG:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 01:34:15 AM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/04 01:34:15 AM ERROR:Attempting to remove duplicates
2025/03/04 01:34:15 AM DEBUG:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 46 columns]
2025/03/04 01:34:15 AM DEBUG:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/04 01:34:15 AM INFO:Data Updated with PartyName and PartyId successfully
2025/03/04 01:34:15 AM INFO:map_mp_to_party executed successfully
2025/03/04 01:34:15 AM DEBUG:Calling load_election_dates with args=(), kwargs={}
2025/03/04 01:34:15 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'source\\Donations_accepted_by_political_parties.csv', 'savedfilepath': 'reference_files\\elections.csv', 'timestamp_key': 'election_dates_last_modified'}
2025/03/04 01:34:15 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 01:34:15 AM INFO:Saved file path: reference_files\elections.csv
2025/03/04 01:34:15 AM DEBUG:Calling is_file_updated with args=('source\\Donations_accepted_by_political_parties.csv', 'election_dates_last_modified'), kwargs={}
2025/03/04 01:34:15 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 01:34:15 AM DEBUG:Calling get_file_modification_time with args=('source\\Donations_accepted_by_political_parties.csv',), kwargs={}
2025/03/04 01:34:15 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 01:34:15 AM INFO:get_file_modification_time executed successfully
2025/03/04 01:34:15 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 01:34:15 AM INFO:Last modification time: None
2025/03/04 01:34:15 AM INFO:is_file_updated executed successfully
2025/03/04 01:34:15 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 01:34:15 AM INFO:Election dates found in session.
2025/03/04 01:34:15 AM ERROR:Failed to load election dates: 'NoneType' object has no attribute 'head'
2025/03/04 01:34:15 AM INFO:load_election_dates executed successfully
2025/03/04 01:34:15 AM ERROR:Election dates could not be loaded. Returning None.
2025/03/04 01:34:15 AM INFO:load_cleaned_data executed successfully
2025/03/04 01:34:15 AM INFO:get_cleaned_data executed successfully
2025/03/04 01:34:15 AM INFO:load_data_to_session executed successfully
2025/03/04 01:34:15 AM DEBUG:Calling load_data_to_session with args=('data_donor', <function get_donor_data at 0x000001D883A7CAF0>), kwargs={}
2025/03/04 01:34:15 AM DEBUG:Calling get_donor_data with args=(), kwargs={}
2025/03/04 01:34:15 AM DEBUG:Calling load_donorList_data with args=(), kwargs={'main_file': 'data_clean', 'cleaned_file': 'data_donor', 'streamlitrun': True, 'output_csv': True, 'originaldatafilepath': 'cleaned_data_fname', 'cleaneddatafilepath': 'cleaned_donorlist_fname'}
2025/03/04 01:34:15 AM ERROR:Session state variables not initialized! data.load_donor_regent_lists
2025/03/04 01:34:15 AM INFO:load_donorList_data executed successfully
2025/03/04 01:34:15 AM INFO:get_donor_data executed successfully
2025/03/04 01:34:15 AM INFO:load_data_to_session executed successfully
2025/03/04 01:34:15 AM DEBUG:Calling load_data_to_session with args=('data_regentity', <function get_regentity_data at 0x000001D883A7CC10>), kwargs={}
2025/03/04 01:34:15 AM DEBUG:Calling get_regentity_data with args=(), kwargs={}
2025/03/04 01:34:15 AM DEBUG:Calling load_regulated_entity_data with args=(), kwargs={'main_file': 'data_clean', 'cleaned_file': 'data_regentity', 'streamlitrun': True, 'output_csv': True, 'originaldatafilepath': 'cleaned_data_fname', 'cleaneddatafilepath': 'cleaned_regentity_fname'}
2025/03/04 01:34:15 AM ERROR:Session state variables not initialized! data.load_donor_regent_lists
2025/03/04 01:34:15 AM INFO:load_regulated_entity_data executed successfully
2025/03/04 01:34:15 AM INFO:get_regentity_data executed successfully
2025/03/04 01:34:15 AM INFO:load_data_to_session executed successfully
2025/03/04 01:34:15 AM INFO:firstload executed successfully
2025/03/04 01:34:15 AM ERROR:Data loading failed.
2025/03/04 01:34:25 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 01:34:25 AM INFO:Running App setup...
2025/03/04 01:34:25 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 01:34:25 AM INFO:Setting up the package
2025/03/04 01:34:25 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 01:34:25 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 01:34:25 AM INFO:get_git_version executed successfully
2025/03/04 01:34:25 AM INFO:Version: v20.138
2025/03/04 01:34:25 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 01:34:25 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 01:34:25 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 01:34:25 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 01:34:25 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 01:34:25 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 01:34:25 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 01:34:25 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 01:34:25 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 01:34:25 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 01:34:25 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 01:34:25 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 01:34:25 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 01:34:25 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 01:34:25 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 01:34:25 AM DEBUG:Initialised data_dir with value: data
2025/03/04 01:34:25 AM DEBUG:Initialised output_dir with value: output
2025/03/04 01:34:25 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 01:34:25 AM DEBUG:Initialised components_dir with value: components
2025/03/04 01:34:25 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 01:34:25 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 01:34:25 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 01:34:25 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 01:34:25 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 01:34:25 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 01:34:25 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 01:34:25 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 01:34:25 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 01:34:25 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 01:34:25 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 01:34:25 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 01:34:25 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 01:34:25 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 01:34:25 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 01:34:25 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 01:34:25 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 01:34:25 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 01:34:25 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 01:34:25 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 01:34:25 AM INFO:Session_state variables initialized
2025/03/04 01:34:25 AM DEBUG:data_dir: data
2025/03/04 01:34:25 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 01:34:25 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 01:34:25 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 01:34:25 AM DEBUG:reference_dir: reference_files
2025/03/04 01:34:25 AM DEBUG:logs_dir: logs
2025/03/04 01:34:25 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 01:34:25 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 01:34:25 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 01:34:25 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 01:34:25 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 01:34:25 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 01:34:25 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 01:34:25 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 01:34:25 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 01:34:25 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 01:34:25 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 01:34:25 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 01:34:25 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 01:34:25 AM DEBUG:output_dir: output
2025/03/04 01:34:25 AM DEBUG:components_dir: components
2025/03/04 01:34:25 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 01:34:25 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 01:34:25 AM DEBUG:perc_target: 0.5
2025/03/04 01:34:25 AM DEBUG:utils_dir: utils
2025/03/04 01:34:25 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 01:34:25 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 01:34:25 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 01:34:25 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 01:34:25 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 01:34:25 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 01:34:25 AM DEBUG:app_pages_dir: app_pages
2025/03/04 01:34:25 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 01:34:25 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 01:34:25 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 01:34:25 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 01:34:25 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 01:34:25 AM INFO:Session state Setup complete
2025/03/04 01:34:25 AM INFO:initialize_session_state executed successfully
2025/03/04 01:34:25 AM INFO:Package setup complete
2025/03/04 01:34:25 AM INFO:setup_package executed successfully
2025/03/04 01:34:25 AM INFO:Running Menu setup...
2025/03/04 01:34:25 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 01:34:25 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 01:34:25 AM INFO:get_git_version executed successfully
2025/03/04 01:34:25 AM INFO:App Version: v20.159
2025/03/04 01:34:25 AM INFO:Switched to page: Introduction
2025/03/04 01:34:25 AM INFO:pagesetup executed successfully
2025/03/04 01:34:25 AM INFO:No data found in session state, running firstload()
2025/03/04 01:34:25 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 01:34:25 AM INFO:Running first load function.
2025/03/04 01:34:25 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 01:34:25 AM INFO:firstload executed successfully
2025/03/04 01:34:25 AM ERROR:Data loading failed.
2025/03/04 01:34:28 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 01:34:28 AM INFO:Running App setup...
2025/03/04 01:34:28 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 01:34:28 AM INFO:Setting up the package
2025/03/04 01:34:28 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 01:34:28 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 01:34:28 AM INFO:get_git_version executed successfully
2025/03/04 01:34:28 AM INFO:Version: v20.138
2025/03/04 01:34:28 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 01:34:28 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 01:34:28 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 01:34:28 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 01:34:28 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 01:34:28 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 01:34:28 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 01:34:28 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 01:34:28 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 01:34:28 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 01:34:28 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 01:34:28 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 01:34:28 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 01:34:28 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 01:34:28 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 01:34:28 AM DEBUG:Initialised data_dir with value: data
2025/03/04 01:34:28 AM DEBUG:Initialised output_dir with value: output
2025/03/04 01:34:28 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 01:34:28 AM DEBUG:Initialised components_dir with value: components
2025/03/04 01:34:28 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 01:34:28 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 01:34:28 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 01:34:28 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 01:34:28 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 01:34:28 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 01:34:28 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 01:34:28 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 01:34:28 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 01:34:28 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 01:34:28 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 01:34:28 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 01:34:28 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 01:34:28 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 01:34:28 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 01:34:28 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 01:34:28 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 01:34:28 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 01:34:28 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 01:34:28 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 01:34:28 AM INFO:Session_state variables initialized
2025/03/04 01:34:28 AM DEBUG:data_dir: data
2025/03/04 01:34:28 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 01:34:28 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 01:34:28 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 01:34:28 AM DEBUG:reference_dir: reference_files
2025/03/04 01:34:28 AM DEBUG:logs_dir: logs
2025/03/04 01:34:28 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 01:34:28 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 01:34:28 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 01:34:28 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 01:34:28 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 01:34:28 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 01:34:28 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 01:34:28 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 01:34:28 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 01:34:28 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 01:34:28 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 01:34:28 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 01:34:28 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 01:34:28 AM DEBUG:output_dir: output
2025/03/04 01:34:28 AM DEBUG:components_dir: components
2025/03/04 01:34:28 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 01:34:28 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 01:34:28 AM DEBUG:perc_target: 0.5
2025/03/04 01:34:28 AM DEBUG:utils_dir: utils
2025/03/04 01:34:28 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 01:34:28 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 01:34:28 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 01:34:28 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 01:34:28 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 01:34:28 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 01:34:28 AM DEBUG:app_pages_dir: app_pages
2025/03/04 01:34:28 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 01:34:28 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 01:34:28 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 01:34:28 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 01:34:28 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 01:34:28 AM INFO:Session state Setup complete
2025/03/04 01:34:28 AM INFO:initialize_session_state executed successfully
2025/03/04 01:34:28 AM INFO:Package setup complete
2025/03/04 01:34:28 AM INFO:setup_package executed successfully
2025/03/04 01:34:28 AM INFO:Running Menu setup...
2025/03/04 01:34:28 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 01:34:28 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 01:34:28 AM INFO:get_git_version executed successfully
2025/03/04 01:34:28 AM INFO:App Version: v20.159
2025/03/04 01:34:28 AM INFO:Switched to page: Introduction
2025/03/04 01:34:28 AM INFO:pagesetup executed successfully
2025/03/04 01:34:28 AM INFO:No data found in session state, running firstload()
2025/03/04 01:34:28 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 01:34:28 AM INFO:Running first load function.
2025/03/04 01:34:28 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 01:34:28 AM INFO:firstload executed successfully
2025/03/04 01:34:28 AM ERROR:Data loading failed.
2025/03/04 07:38:18 AM INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/04 07:38:18 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\utils',), kwargs={}
2025/03/04 07:38:18 AM INFO:get_git_version executed successfully
2025/03/04 07:38:19 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\data',), kwargs={}
2025/03/04 07:38:19 AM INFO:get_git_version executed successfully
2025/03/04 07:38:19 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 07:38:19 AM INFO:Running App setup...
2025/03/04 07:38:19 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 07:38:19 AM INFO:Setting up the package
2025/03/04 07:38:19 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 07:38:19 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 07:38:19 AM INFO:get_git_version executed successfully
2025/03/04 07:38:19 AM INFO:Version: v20.138
2025/03/04 07:38:19 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 07:38:19 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:38:19 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 07:38:19 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 07:38:19 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:38:19 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 07:38:19 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 07:38:19 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:38:19 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:38:19 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:38:19 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:38:19 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 07:38:19 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 07:38:19 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:38:19 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 07:38:19 AM DEBUG:Initialised data_dir with value: data
2025/03/04 07:38:19 AM DEBUG:Initialised output_dir with value: output
2025/03/04 07:38:19 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 07:38:19 AM DEBUG:Initialised components_dir with value: components
2025/03/04 07:38:19 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 07:38:19 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 07:38:19 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:38:19 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:38:19 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 07:38:19 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:38:19 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:38:19 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:38:19 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 07:38:19 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 07:38:19 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 07:38:19 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 07:38:19 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 07:38:19 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 07:38:19 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 07:38:19 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 07:38:19 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 07:38:19 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 07:38:19 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:38:19 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 07:38:19 AM INFO:Session_state variables initialized
2025/03/04 07:38:19 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 07:38:19 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:38:19 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:38:19 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 07:38:19 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 07:38:19 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:38:19 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 07:38:19 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 07:38:19 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 07:38:19 AM DEBUG:utils_dir: utils
2025/03/04 07:38:19 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 07:38:19 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:38:19 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:38:19 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 07:38:19 AM DEBUG:data_dir: data
2025/03/04 07:38:19 AM DEBUG:components_dir: components
2025/03/04 07:38:19 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 07:38:19 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 07:38:19 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:38:19 AM DEBUG:app_pages_dir: app_pages
2025/03/04 07:38:19 AM DEBUG:output_dir: output
2025/03/04 07:38:19 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:38:19 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 07:38:19 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:38:19 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:38:19 AM DEBUG:reference_dir: reference_files
2025/03/04 07:38:19 AM DEBUG:logs_dir: logs
2025/03/04 07:38:19 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:38:19 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:38:19 AM DEBUG:perc_target: 0.5
2025/03/04 07:38:19 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 07:38:19 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 07:38:19 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:38:19 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 07:38:19 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 07:38:19 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:38:19 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 07:38:19 AM INFO:Session state Setup complete
2025/03/04 07:38:19 AM INFO:initialize_session_state executed successfully
2025/03/04 07:38:19 AM INFO:Package setup complete
2025/03/04 07:38:19 AM INFO:setup_package executed successfully
2025/03/04 07:38:19 AM INFO:Running Menu setup...
2025/03/04 07:38:19 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 07:38:19 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\app_pages',), kwargs={}
2025/03/04 07:38:19 AM INFO:get_git_version executed successfully
2025/03/04 07:38:19 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\components',), kwargs={}
2025/03/04 07:38:19 AM INFO:get_git_version executed successfully
2025/03/04 07:38:19 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 07:38:19 AM INFO:get_git_version executed successfully
2025/03/04 07:38:19 AM INFO:App Version: v20.159
2025/03/04 07:38:19 AM INFO:Switched to page: Introduction
2025/03/04 07:38:19 AM INFO:pagesetup executed successfully
2025/03/04 07:38:19 AM INFO:No data found in session state, running firstload()
2025/03/04 07:38:19 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 07:38:20 AM ERROR:Error in initialise_data: invalid syntax (GenElectionRelationship.py, line 59)
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 39, in initialise_data
    from data.data_loader import firstload
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 3, in <module>
    from data.clean_and_enhance import load_cleaned_data
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 8, in <module>
    from data.GenElectionRelationship import(GenElectionRelation2,
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 59
    else Exception as e:
    ^^^^
SyntaxError: invalid syntax
2025/03/04 07:45:58 AM INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/04 07:45:58 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\utils',), kwargs={}
2025/03/04 07:45:58 AM INFO:get_git_version executed successfully
2025/03/04 07:45:59 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\data',), kwargs={}
2025/03/04 07:45:59 AM INFO:get_git_version executed successfully
2025/03/04 07:45:59 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 07:45:59 AM INFO:Running App setup...
2025/03/04 07:45:59 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 07:45:59 AM INFO:Setting up the package
2025/03/04 07:45:59 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 07:45:59 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 07:45:59 AM INFO:get_git_version executed successfully
2025/03/04 07:45:59 AM INFO:Version: v20.138
2025/03/04 07:45:59 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 07:45:59 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:45:59 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 07:45:59 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 07:45:59 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:45:59 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 07:45:59 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 07:45:59 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:45:59 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:45:59 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:45:59 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:45:59 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 07:45:59 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 07:45:59 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:45:59 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 07:45:59 AM DEBUG:Initialised data_dir with value: data
2025/03/04 07:45:59 AM DEBUG:Initialised output_dir with value: output
2025/03/04 07:45:59 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 07:45:59 AM DEBUG:Initialised components_dir with value: components
2025/03/04 07:45:59 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 07:45:59 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 07:45:59 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:45:59 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:45:59 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 07:45:59 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:45:59 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:45:59 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:45:59 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 07:45:59 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 07:45:59 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 07:45:59 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 07:45:59 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 07:45:59 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 07:45:59 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 07:45:59 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 07:45:59 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 07:45:59 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 07:45:59 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:45:59 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 07:45:59 AM INFO:Session_state variables initialized
2025/03/04 07:45:59 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 07:45:59 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 07:45:59 AM DEBUG:app_pages_dir: app_pages
2025/03/04 07:45:59 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 07:45:59 AM DEBUG:output_dir: output
2025/03/04 07:45:59 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:45:59 AM DEBUG:data_dir: data
2025/03/04 07:45:59 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 07:45:59 AM DEBUG:perc_target: 0.5
2025/03/04 07:45:59 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 07:45:59 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 07:45:59 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:45:59 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 07:45:59 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 07:45:59 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:45:59 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:45:59 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:45:59 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:45:59 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:45:59 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:45:59 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 07:45:59 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 07:45:59 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 07:45:59 AM DEBUG:logs_dir: logs
2025/03/04 07:45:59 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:45:59 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:45:59 AM DEBUG:reference_dir: reference_files
2025/03/04 07:45:59 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:45:59 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 07:45:59 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:45:59 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 07:45:59 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:45:59 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 07:45:59 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 07:45:59 AM DEBUG:utils_dir: utils
2025/03/04 07:45:59 AM DEBUG:components_dir: components
2025/03/04 07:45:59 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 07:45:59 AM INFO:Session state Setup complete
2025/03/04 07:45:59 AM INFO:initialize_session_state executed successfully
2025/03/04 07:45:59 AM INFO:Package setup complete
2025/03/04 07:45:59 AM INFO:setup_package executed successfully
2025/03/04 07:45:59 AM INFO:Running Menu setup...
2025/03/04 07:45:59 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 07:45:59 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\app_pages',), kwargs={}
2025/03/04 07:45:59 AM INFO:get_git_version executed successfully
2025/03/04 07:45:59 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\components',), kwargs={}
2025/03/04 07:45:59 AM INFO:get_git_version executed successfully
2025/03/04 07:45:59 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 07:45:59 AM INFO:get_git_version executed successfully
2025/03/04 07:45:59 AM INFO:App Version: v20.159
2025/03/04 07:45:59 AM INFO:Switched to page: Introduction
2025/03/04 07:45:59 AM INFO:pagesetup executed successfully
2025/03/04 07:45:59 AM INFO:No data found in session state, running firstload()
2025/03/04 07:45:59 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 07:46:00 AM ERROR:Error in initialise_data: invalid syntax (GenElectionRelationship.py, line 56)
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 39, in initialise_data
    from data.data_loader import firstload
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 3, in <module>
    from data.clean_and_enhance import load_cleaned_data
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 8, in <module>
    from data.GenElectionRelationship import(GenElectionRelation2,
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 56
    else Exception as e:
    ^^^^
SyntaxError: invalid syntax
2025/03/04 07:46:24 AM INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/04 07:46:24 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\utils',), kwargs={}
2025/03/04 07:46:25 AM INFO:get_git_version executed successfully
2025/03/04 07:46:25 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\data',), kwargs={}
2025/03/04 07:46:26 AM INFO:get_git_version executed successfully
2025/03/04 07:46:26 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 07:46:26 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 07:46:26 AM INFO:Running App setup...
2025/03/04 07:46:26 AM INFO:Running App setup...
2025/03/04 07:46:26 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 07:46:26 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 07:46:26 AM INFO:Setting up the package
2025/03/04 07:46:26 AM INFO:Setting up the package
2025/03/04 07:46:26 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 07:46:26 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 07:46:26 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 07:46:26 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 07:46:26 AM INFO:get_git_version executed successfully
2025/03/04 07:46:26 AM INFO:get_git_version executed successfully
2025/03/04 07:46:26 AM INFO:Version: v20.138
2025/03/04 07:46:26 AM INFO:Version: v20.138
2025/03/04 07:46:26 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 07:46:26 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 07:46:26 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:46:26 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:46:26 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 07:46:26 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 07:46:26 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 07:46:26 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 07:46:26 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:46:26 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:46:26 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 07:46:26 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 07:46:26 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 07:46:26 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 07:46:26 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:46:26 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:46:26 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:46:26 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:46:26 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:46:26 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:46:26 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:46:26 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:46:26 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 07:46:26 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 07:46:26 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 07:46:26 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 07:46:26 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:46:26 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:46:26 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 07:46:26 AM DEBUG:Initialised data_dir with value: data
2025/03/04 07:46:26 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 07:46:26 AM DEBUG:Initialised output_dir with value: output
2025/03/04 07:46:26 AM DEBUG:Initialised data_dir with value: data
2025/03/04 07:46:26 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 07:46:26 AM DEBUG:Initialised output_dir with value: output
2025/03/04 07:46:26 AM DEBUG:Initialised components_dir with value: components
2025/03/04 07:46:26 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 07:46:26 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 07:46:26 AM DEBUG:Initialised components_dir with value: components
2025/03/04 07:46:26 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 07:46:26 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 07:46:26 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:46:26 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 07:46:26 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:46:26 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:46:26 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 07:46:26 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:46:26 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:46:26 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 07:46:26 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:46:26 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:46:26 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:46:26 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:46:26 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 07:46:26 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:46:26 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 07:46:26 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 07:46:26 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 07:46:26 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 07:46:26 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 07:46:26 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 07:46:26 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 07:46:26 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 07:46:26 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 07:46:26 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 07:46:26 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 07:46:26 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 07:46:26 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 07:46:26 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 07:46:26 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 07:46:26 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 07:46:26 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 07:46:26 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 07:46:26 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:46:26 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 07:46:26 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 07:46:26 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:46:26 AM INFO:Session_state variables initialized
2025/03/04 07:46:26 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 07:46:26 AM DEBUG:data_dir: data
2025/03/04 07:46:26 AM INFO:Session_state variables initialized
2025/03/04 07:46:26 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 07:46:26 AM DEBUG:data_dir: data
2025/03/04 07:46:26 AM DEBUG:logs_dir: logs
2025/03/04 07:46:26 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 07:46:26 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 07:46:26 AM DEBUG:logs_dir: logs
2025/03/04 07:46:26 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 07:46:26 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 07:46:26 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:46:26 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 07:46:26 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:46:26 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:46:26 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:46:26 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:46:26 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:46:26 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:46:26 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 07:46:26 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:46:26 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 07:46:26 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 07:46:26 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:46:26 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 07:46:26 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:46:26 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:46:26 AM DEBUG:components_dir: components
2025/03/04 07:46:26 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:46:26 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:46:26 AM DEBUG:components_dir: components
2025/03/04 07:46:26 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 07:46:26 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:46:26 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:46:26 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 07:46:26 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 07:46:26 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:46:26 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 07:46:26 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 07:46:26 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:46:26 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 07:46:26 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 07:46:26 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:46:26 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 07:46:26 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 07:46:26 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:46:26 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 07:46:26 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:46:26 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:46:26 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 07:46:26 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:46:26 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:46:26 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 07:46:26 AM DEBUG:output_dir: output
2025/03/04 07:46:26 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:46:26 AM DEBUG:reference_dir: reference_files
2025/03/04 07:46:26 AM DEBUG:output_dir: output
2025/03/04 07:46:26 AM DEBUG:perc_target: 0.5
2025/03/04 07:46:26 AM DEBUG:reference_dir: reference_files
2025/03/04 07:46:26 AM DEBUG:utils_dir: utils
2025/03/04 07:46:26 AM DEBUG:perc_target: 0.5
2025/03/04 07:46:26 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 07:46:26 AM DEBUG:utils_dir: utils
2025/03/04 07:46:26 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 07:46:26 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 07:46:26 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 07:46:26 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 07:46:26 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 07:46:26 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 07:46:26 AM DEBUG:app_pages_dir: app_pages
2025/03/04 07:46:26 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 07:46:26 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:46:26 AM DEBUG:app_pages_dir: app_pages
2025/03/04 07:46:26 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 07:46:26 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:46:26 AM INFO:Session state Setup complete
2025/03/04 07:46:26 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 07:46:26 AM INFO:initialize_session_state executed successfully
2025/03/04 07:46:26 AM INFO:Session state Setup complete
2025/03/04 07:46:26 AM INFO:Package setup complete
2025/03/04 07:46:26 AM INFO:initialize_session_state executed successfully
2025/03/04 07:46:26 AM INFO:setup_package executed successfully
2025/03/04 07:46:26 AM INFO:Package setup complete
2025/03/04 07:46:26 AM INFO:setup_package executed successfully
2025/03/04 07:46:26 AM INFO:Running Menu setup...
2025/03/04 07:46:26 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 07:46:26 AM INFO:Running Menu setup...
2025/03/04 07:46:26 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 07:46:26 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\app_pages',), kwargs={}
2025/03/04 07:46:26 AM INFO:get_git_version executed successfully
2025/03/04 07:46:26 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\components',), kwargs={}
2025/03/04 07:46:26 AM INFO:get_git_version executed successfully
2025/03/04 07:46:26 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 07:46:26 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 07:46:26 AM INFO:get_git_version executed successfully
2025/03/04 07:46:26 AM INFO:get_git_version executed successfully
2025/03/04 07:46:26 AM INFO:App Version: v20.159
2025/03/04 07:46:26 AM INFO:App Version: v20.159
2025/03/04 07:46:26 AM INFO:Switched to page: Introduction
2025/03/04 07:46:26 AM INFO:Switched to page: Introduction
2025/03/04 07:46:26 AM INFO:pagesetup executed successfully
2025/03/04 07:46:26 AM INFO:pagesetup executed successfully
2025/03/04 07:46:26 AM INFO:No data found in session state, running firstload()
2025/03/04 07:46:26 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 07:46:26 AM INFO:No data found in session state, running firstload()
2025/03/04 07:46:26 AM ERROR:Error in initialise_data: invalid syntax (GenElectionRelationship.py, line 56)
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 39, in initialise_data
    from data.data_loader import firstload
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 3, in <module>
    from data.clean_and_enhance import load_cleaned_data
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 8, in <module>
    from data.GenElectionRelationship import(GenElectionRelation2,
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 56
    else:
    ^^^^
SyntaxError: invalid syntax
2025/03/04 07:46:26 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 07:46:26 AM ERROR:Error in initialise_data: invalid syntax (GenElectionRelationship.py, line 56)
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 39, in initialise_data
    from data.data_loader import firstload
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 3, in <module>
    from data.clean_and_enhance import load_cleaned_data
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 8, in <module>
    from data.GenElectionRelationship import(GenElectionRelation2,
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 56
    else:
    ^^^^
SyntaxError: invalid syntax
2025/03/04 07:48:15 AM INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/04 07:48:16 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\utils',), kwargs={}
2025/03/04 07:48:16 AM INFO:get_git_version executed successfully
2025/03/04 07:48:17 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\data',), kwargs={}
2025/03/04 07:48:17 AM INFO:get_git_version executed successfully
2025/03/04 07:48:17 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 07:48:17 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 07:48:17 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 07:48:17 AM INFO:Running App setup...
2025/03/04 07:48:17 AM INFO:Running App setup...
2025/03/04 07:48:17 AM INFO:Running App setup...
2025/03/04 07:48:17 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 07:48:17 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 07:48:17 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 07:48:17 AM INFO:Setting up the package
2025/03/04 07:48:17 AM INFO:Setting up the package
2025/03/04 07:48:17 AM INFO:Setting up the package
2025/03/04 07:48:17 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 07:48:17 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 07:48:17 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 07:48:17 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 07:48:17 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 07:48:17 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 07:48:17 AM INFO:get_git_version executed successfully
2025/03/04 07:48:17 AM INFO:get_git_version executed successfully
2025/03/04 07:48:17 AM INFO:get_git_version executed successfully
2025/03/04 07:48:17 AM INFO:Version: v20.138
2025/03/04 07:48:17 AM INFO:Version: v20.138
2025/03/04 07:48:17 AM INFO:Version: v20.138
2025/03/04 07:48:17 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 07:48:17 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 07:48:17 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 07:48:17 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:48:17 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:48:17 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:48:17 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 07:48:17 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 07:48:17 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 07:48:17 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 07:48:17 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 07:48:17 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 07:48:17 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:48:17 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:48:17 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:48:17 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 07:48:17 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 07:48:17 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 07:48:17 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 07:48:17 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 07:48:17 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 07:48:17 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:48:17 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:48:17 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:48:17 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:48:17 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:48:17 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:48:17 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:48:17 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:48:17 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:48:17 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:48:17 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:48:17 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:48:17 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 07:48:17 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 07:48:17 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 07:48:17 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 07:48:17 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 07:48:17 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 07:48:17 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:48:17 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:48:17 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:48:17 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 07:48:17 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 07:48:17 AM DEBUG:Initialised data_dir with value: data
2025/03/04 07:48:17 AM DEBUG:Initialised data_dir with value: data
2025/03/04 07:48:17 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 07:48:17 AM DEBUG:Initialised output_dir with value: output
2025/03/04 07:48:17 AM DEBUG:Initialised output_dir with value: output
2025/03/04 07:48:17 AM DEBUG:Initialised data_dir with value: data
2025/03/04 07:48:17 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 07:48:17 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 07:48:17 AM DEBUG:Initialised output_dir with value: output
2025/03/04 07:48:17 AM DEBUG:Initialised components_dir with value: components
2025/03/04 07:48:17 AM DEBUG:Initialised components_dir with value: components
2025/03/04 07:48:17 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 07:48:17 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 07:48:17 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 07:48:17 AM DEBUG:Initialised components_dir with value: components
2025/03/04 07:48:17 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 07:48:17 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 07:48:17 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 07:48:17 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:48:17 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:48:17 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 07:48:17 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:48:17 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:48:17 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:48:17 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 07:48:17 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 07:48:17 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:48:17 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:48:17 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:48:17 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 07:48:17 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:48:17 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:48:17 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:48:17 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:48:17 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:48:17 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:48:17 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 07:48:17 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 07:48:17 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:48:17 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 07:48:17 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 07:48:17 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 07:48:17 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 07:48:17 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 07:48:17 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 07:48:17 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 07:48:17 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 07:48:17 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 07:48:17 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 07:48:17 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 07:48:17 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 07:48:17 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 07:48:17 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 07:48:17 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 07:48:17 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 07:48:17 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 07:48:17 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 07:48:17 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 07:48:17 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 07:48:17 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 07:48:17 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 07:48:17 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 07:48:17 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 07:48:17 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 07:48:17 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 07:48:17 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 07:48:17 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:48:17 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:48:17 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 07:48:17 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 07:48:17 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 07:48:17 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:48:17 AM INFO:Session_state variables initialized
2025/03/04 07:48:17 AM INFO:Session_state variables initialized
2025/03/04 07:48:17 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 07:48:17 AM DEBUG:utils_dir: utils
2025/03/04 07:48:17 AM DEBUG:utils_dir: utils
2025/03/04 07:48:17 AM INFO:Session_state variables initialized
2025/03/04 07:48:17 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 07:48:17 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 07:48:17 AM DEBUG:utils_dir: utils
2025/03/04 07:48:17 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:48:17 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:48:17 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 07:48:17 AM DEBUG:components_dir: components
2025/03/04 07:48:17 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:48:17 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:48:17 AM DEBUG:components_dir: components
2025/03/04 07:48:17 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:48:17 AM DEBUG:components_dir: components
2025/03/04 07:48:17 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:48:17 AM DEBUG:app_pages_dir: app_pages
2025/03/04 07:48:17 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:48:17 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:48:17 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:48:17 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:48:17 AM DEBUG:app_pages_dir: app_pages
2025/03/04 07:48:17 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:48:17 AM DEBUG:app_pages_dir: app_pages
2025/03/04 07:48:17 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:48:17 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:48:17 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:48:17 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:48:17 AM DEBUG:output_dir: output
2025/03/04 07:48:17 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:48:17 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:48:17 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 07:48:17 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:48:17 AM DEBUG:output_dir: output
2025/03/04 07:48:17 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 07:48:17 AM DEBUG:output_dir: output
2025/03/04 07:48:17 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 07:48:17 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 07:48:17 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 07:48:17 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 07:48:17 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:48:17 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 07:48:17 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 07:48:17 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:48:17 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 07:48:17 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:48:17 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 07:48:17 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:48:17 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:48:17 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:48:17 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:48:17 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 07:48:17 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 07:48:17 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 07:48:17 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:48:17 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:48:17 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:48:17 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 07:48:17 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:48:17 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 07:48:17 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:48:17 AM DEBUG:logs_dir: logs
2025/03/04 07:48:17 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:48:17 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:48:17 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 07:48:17 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:48:17 AM DEBUG:logs_dir: logs
2025/03/04 07:48:17 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 07:48:17 AM DEBUG:logs_dir: logs
2025/03/04 07:48:17 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 07:48:17 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 07:48:17 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 07:48:17 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 07:48:17 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 07:48:17 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 07:48:17 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 07:48:17 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:48:17 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 07:48:17 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 07:48:17 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 07:48:17 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 07:48:17 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:48:17 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 07:48:17 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:48:17 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 07:48:17 AM DEBUG:data_dir: data
2025/03/04 07:48:17 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 07:48:17 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 07:48:17 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:48:17 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 07:48:17 AM DEBUG:data_dir: data
2025/03/04 07:48:17 AM DEBUG:perc_target: 0.5
2025/03/04 07:48:17 AM DEBUG:data_dir: data
2025/03/04 07:48:17 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:48:17 AM DEBUG:reference_dir: reference_files
2025/03/04 07:48:17 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:48:17 AM DEBUG:perc_target: 0.5
2025/03/04 07:48:17 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 07:48:17 AM DEBUG:perc_target: 0.5
2025/03/04 07:48:17 AM DEBUG:reference_dir: reference_files
2025/03/04 07:48:17 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 07:48:17 AM DEBUG:reference_dir: reference_files
2025/03/04 07:48:17 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 07:48:17 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 07:48:17 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 07:48:17 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 07:48:17 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 07:48:17 AM INFO:Session state Setup complete
2025/03/04 07:48:17 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 07:48:17 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 07:48:17 AM INFO:initialize_session_state executed successfully
2025/03/04 07:48:17 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 07:48:17 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 07:48:17 AM INFO:Package setup complete
2025/03/04 07:48:17 AM INFO:Session state Setup complete
2025/03/04 07:48:17 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 07:48:17 AM INFO:setup_package executed successfully
2025/03/04 07:48:17 AM INFO:initialize_session_state executed successfully
2025/03/04 07:48:17 AM INFO:Session state Setup complete
2025/03/04 07:48:17 AM INFO:Package setup complete
2025/03/04 07:48:17 AM INFO:initialize_session_state executed successfully
2025/03/04 07:48:17 AM INFO:Running Menu setup...
2025/03/04 07:48:17 AM INFO:setup_package executed successfully
2025/03/04 07:48:17 AM INFO:Package setup complete
2025/03/04 07:48:17 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 07:48:17 AM INFO:setup_package executed successfully
2025/03/04 07:48:17 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\app_pages',), kwargs={}
2025/03/04 07:48:17 AM INFO:Running Menu setup...
2025/03/04 07:48:17 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 07:48:17 AM INFO:Running Menu setup...
2025/03/04 07:48:17 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 07:48:17 AM INFO:get_git_version executed successfully
2025/03/04 07:48:17 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\components',), kwargs={}
2025/03/04 07:48:17 AM INFO:get_git_version executed successfully
2025/03/04 07:48:18 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 07:48:18 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 07:48:18 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 07:48:18 AM INFO:get_git_version executed successfully
2025/03/04 07:48:18 AM INFO:get_git_version executed successfully
2025/03/04 07:48:18 AM INFO:get_git_version executed successfully
2025/03/04 07:48:18 AM INFO:App Version: v20.159
2025/03/04 07:48:18 AM INFO:App Version: v20.159
2025/03/04 07:48:18 AM INFO:App Version: v20.159
2025/03/04 07:48:18 AM INFO:Switched to page: Introduction
2025/03/04 07:48:18 AM INFO:Switched to page: Introduction
2025/03/04 07:48:18 AM INFO:Switched to page: Introduction
2025/03/04 07:48:18 AM INFO:pagesetup executed successfully
2025/03/04 07:48:18 AM INFO:pagesetup executed successfully
2025/03/04 07:48:18 AM INFO:pagesetup executed successfully
2025/03/04 07:48:18 AM INFO:No data found in session state, running firstload()
2025/03/04 07:48:18 AM INFO:No data found in session state, running firstload()
2025/03/04 07:48:18 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 07:48:18 AM INFO:No data found in session state, running firstload()
2025/03/04 07:48:18 AM INFO:Running first load function.
2025/03/04 07:48:18 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 07:48:18 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x0000029E795DE170>), kwargs={}
2025/03/04 07:48:18 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 07:48:18 AM DEBUG:Calling load_raw_data with args=(), kwargs={'main_file': 'raw_data', 'cleaned_file': 'raw_data_clean', 'output_csv': True, 'dedupe_donors': True, 'dedupe_regentity': True, 'originaldatafilepath': 'source_data_fname', 'processeddatafilepath': 'imported_raw_fname'}
2025/03/04 07:48:18 AM DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/04 07:48:18 AM DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/04 07:48:18 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'source\\Donations_accepted_by_political_parties.csv', 'savedfilepath': 'output\\imported_raw.csv', 'timestamp_key': 'load_raw_data_last_modified'}
2025/03/04 07:48:18 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:48:18 AM INFO:Saved file path: output\imported_raw.csv
2025/03/04 07:48:18 AM DEBUG:Calling is_file_updated with args=('source\\Donations_accepted_by_political_parties.csv', 'load_raw_data_last_modified'), kwargs={}
2025/03/04 07:48:18 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 07:48:18 AM DEBUG:Calling get_file_modification_time with args=('source\\Donations_accepted_by_political_parties.csv',), kwargs={}
2025/03/04 07:48:18 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 07:48:18 AM INFO:get_file_modification_time executed successfully
2025/03/04 07:48:18 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 07:48:18 AM INFO:Last modification time: None
2025/03/04 07:48:18 AM INFO:is_file_updated executed successfully
2025/03/04 07:48:18 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 07:48:18 AM INFO:Loading raw data...
2025/03/04 07:48:18 AM DEBUG:Original data file path post raw data load: {originaldatafilepath}
2025/03/04 07:48:18 AM DEBUG:Processed data file path post raw data load: {processeddatafilepath}
2025/03/04 07:48:18 AM INFO:Data loaded successfully. Data has 65278 rows and 29 columns
2025/03/04 07:48:19 AM INFO:Data saved to output\imported_raw.csv
2025/03/04 07:48:19 AM DEBUG:Calling raw_data_cleanup with args=(), kwargs={'loaddata_df':            ECRef              RegulatedEntityName    RegulatedEntityType        Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                               ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    1,876.56   02/09/2019  ...              NaN  86310.0             NaN  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    2,700.00   02/09/2019  ...              NaN  86310.0             NaN  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    4,852.58   30/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    2,500.00   30/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    4,524.05   29/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
...          ...                              ...                    ...          ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10,000.00          NaN  ...              NaN  74198.0             NaN            NaN         False
65274   C0242461               Vote Leave Limited  Permitted Participant  100,000.00          NaN  ...              NaN  74184.0             NaN            NaN         False
65275   C0243560               Vote Leave Limited  Permitted Participant   40,000.00          NaN  ...              NaN  74576.0             NaN            NaN         False
65276   C0319710  Conservative and Unionist Party        Political Party   50,000.00          NaN  ...              NaN  34241.0             NaN  Great Britain         False
65277   C0319727  Conservative and Unionist Party        Political Party   15,000.00          NaN  ...              NaN  74743.0             NaN  Great Britain         False

[65278 rows x 29 columns], 'dedupe_donors': True, 'dedupe_regentity': True, 'output_csv': True, 'originaldatafilepath': 'output\\imported_raw.csv', 'processeddatafilepath': 'cleaned_donations_fname'}
2025/03/04 07:48:19 AM INFO:Cleaning up raw data
2025/03/04 07:48:19 AM ERROR:Session state variables not initialized!
2025/03/04 07:48:19 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': None, 'savedfilepath': 'output\\cleaned_donations.csv', 'timestamp_key': 'cleaned_raw_data_last_modified'}
2025/03/04 07:48:19 AM INFO:Original file path: None
2025/03/04 07:48:19 AM INFO:Saved file path: output\cleaned_donations.csv
2025/03/04 07:48:19 AM ERROR:Error: originalfilepath is None!
2025/03/04 07:48:19 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 07:48:19 AM INFO:Data loaded, shape: (65278, 29)
2025/03/04 07:48:20 AM DEBUG:Calling dedupe_entity_file with args=(), kwargs={'loaddata_dd_df':            ECRef              RegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                             ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...                   86310.0                  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...                   86310.0                  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...                   86310.0                  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...                   86310.0                  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...                   86310.0                  Great Britain         False
...          ...                              ...                    ...        ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...                   74198.0                          Other         False
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                   74184.0                          Other         False
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   74576.0                          Other         False
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                   34241.0                  Great Britain         False
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                   74743.0                  Great Britain         False

[65278 rows x 29 columns], 'entity': 'RegulatedEntity', 'map_filename': 'regentity_map_fname', 'output_csv': True}
2025/03/04 07:48:20 AM DEBUG:Calling is_file_updated with args=('reference_files\\PoliticalEntityDeDuped.csv', 'regentity_map_fname_last_modified'), kwargs={}
2025/03/04 07:48:20 AM INFO:Checking if reference_files\PoliticalEntityDeDuped.csv has been updated.
2025/03/04 07:48:20 AM DEBUG:Calling get_file_modification_time with args=('reference_files\\PoliticalEntityDeDuped.csv',), kwargs={}
2025/03/04 07:48:20 AM INFO:Getting modification time for reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:48:20 AM INFO:get_file_modification_time executed successfully
2025/03/04 07:48:20 AM INFO:Current modification time: 1740841102.2638545
2025/03/04 07:48:20 AM INFO:Last modification time: None
2025/03/04 07:48:20 AM INFO:is_file_updated executed successfully
2025/03/04 07:48:20 AM INFO:Map file regentity_map_fname has been updated. Proceeding with deduplication.
2025/03/04 07:48:21 AM INFO:File deduplication complete, shape: (65278, 34)
2025/03/04 07:48:21 AM INFO:dedupe_entity_file executed successfully
2025/03/04 07:48:21 AM DEBUG:Calling dedupe_entity_file with args=(), kwargs={'loaddata_dd_df':            ECRef      OriginalRegulatedEntityName    RegulatedEntityType  ...      OriginalRegulatedEntityName RegulatedEntityId              RegulatedEntityName
0      NC0408174                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
1      NC0408173                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
2      NC0408177                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
3      NC0408176                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
4      NC0408170                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
...          ...                              ...                    ...  ...                              ...               ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65274   C0242461               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65275   C0243560               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65276   C0319710  Conservative And Unionist Party        Political Party  ...  Conservative And Unionist Party              52.0  Conservative And Unionist Party
65277   C0319727  Conservative And Unionist Party        Political Party  ...  Conservative And Unionist Party              52.0  Conservative And Unionist Party

[65278 rows x 34 columns], 'entity': 'Donor', 'map_filename': 'donor_map_fname', 'output_csv': True}
2025/03/04 07:48:21 AM DEBUG:Calling is_file_updated with args=('reference_files\\PoliticalDonorsDeduped.csv', 'donor_map_fname_last_modified'), kwargs={}
2025/03/04 07:48:21 AM INFO:Checking if reference_files\PoliticalDonorsDeduped.csv has been updated.
2025/03/04 07:48:21 AM DEBUG:Calling get_file_modification_time with args=('reference_files\\PoliticalDonorsDeduped.csv',), kwargs={}
2025/03/04 07:48:21 AM INFO:Getting modification time for reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:48:21 AM INFO:get_file_modification_time executed successfully
2025/03/04 07:48:21 AM INFO:Current modification time: 1740757863.2545311
2025/03/04 07:48:21 AM INFO:Last modification time: None
2025/03/04 07:48:21 AM INFO:is_file_updated executed successfully
2025/03/04 07:48:21 AM INFO:Map file donor_map_fname has been updated. Proceeding with deduplication.
2025/03/04 07:48:21 AM INFO:File deduplication complete, shape: (65278, 40)
2025/03/04 07:48:21 AM INFO:dedupe_entity_file executed successfully
2025/03/04 07:48:21 AM INFO:Raw Data cleanup completed
2025/03/04 07:48:21 AM INFO:Data shape: (65278, 40)
2025/03/04 07:48:22 AM INFO:Data saved to output\cleaned_donations.csv
2025/03/04 07:48:22 AM INFO:Data cleanup completed, shape: (65278, 40)
2025/03/04 07:48:22 AM INFO:raw_data_cleanup executed successfully
2025/03/04 07:48:22 AM INFO:load_raw_data executed successfully
2025/03/04 07:48:22 AM INFO:get_raw_data executed successfully
2025/03/04 07:48:22 AM INFO:load_data_to_session executed successfully
2025/03/04 07:48:22 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x0000029E795DE290>), kwargs={}
2025/03/04 07:48:22 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 07:48:22 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 07:48:22 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'output\\cleaned_donations.csv', 'savedfilepath': 'output\\cleaned_data.csv', 'timestamp_key': 'load_raw_data_last_modified'}
2025/03/04 07:48:22 AM INFO:Original file path: output\cleaned_donations.csv
2025/03/04 07:48:22 AM INFO:Saved file path: output\cleaned_data.csv
2025/03/04 07:48:22 AM DEBUG:Calling is_file_updated with args=('output\\cleaned_donations.csv', 'load_raw_data_last_modified'), kwargs={}
2025/03/04 07:48:22 AM INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/04 07:48:22 AM DEBUG:Calling get_file_modification_time with args=('output\\cleaned_donations.csv',), kwargs={}
2025/03/04 07:48:22 AM INFO:Getting modification time for output\cleaned_donations.csv
2025/03/04 07:48:22 AM INFO:get_file_modification_time executed successfully
2025/03/04 07:48:22 AM INFO:Current modification time: 1741074502.550315
2025/03/04 07:48:22 AM INFO:Last modification time: 1740757862.6744745
2025/03/04 07:48:22 AM INFO:is_file_updated executed successfully
2025/03/04 07:48:22 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 07:48:22 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 07:48:25 AM DEBUG:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ...                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...  ...                              ...        ...          ...           ...               ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...          Shaftesbury Investments          1         2016             4            201604
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                Mr Jeremy Hosking          1         2016             2            201602
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   Anthony Clarke          1         2016             6            201606
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                Mr Peter A Dubens          1         2017             5            201705
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                 Mr Ravi S Kailas          1         2017             5            201705

[65278 rows x 44 columns],), kwargs={}
2025/03/04 07:48:25 AM DEBUG:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/04 07:48:25 AM DEBUG:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/04 07:48:25 AM DEBUG:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 07:48:25 AM DEBUG:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/04 07:48:25 AM DEBUG:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 07:48:25 AM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/04 07:48:25 AM ERROR:Attempting to remove duplicates
2025/03/04 07:48:26 AM DEBUG:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 46 columns]
2025/03/04 07:48:26 AM DEBUG:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/04 07:48:26 AM INFO:Data Updated with PartyName and PartyId successfully
2025/03/04 07:48:26 AM INFO:map_mp_to_party executed successfully
2025/03/04 07:48:26 AM DEBUG:Calling load_election_dates with args=(), kwargs={}
2025/03/04 07:48:26 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'source\\Donations_accepted_by_political_parties.csv', 'savedfilepath': 'reference_files\\elections.csv', 'timestamp_key': 'election_dates_last_modified'}
2025/03/04 07:48:26 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:48:26 AM INFO:Saved file path: reference_files\elections.csv
2025/03/04 07:48:26 AM DEBUG:Calling is_file_updated with args=('source\\Donations_accepted_by_political_parties.csv', 'election_dates_last_modified'), kwargs={}
2025/03/04 07:48:26 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 07:48:26 AM DEBUG:Calling get_file_modification_time with args=('source\\Donations_accepted_by_political_parties.csv',), kwargs={}
2025/03/04 07:48:26 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 07:48:26 AM INFO:get_file_modification_time executed successfully
2025/03/04 07:48:26 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 07:48:26 AM INFO:Last modification time: None
2025/03/04 07:48:26 AM INFO:is_file_updated executed successfully
2025/03/04 07:48:26 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 07:48:26 AM INFO:Election dates loaded from file.
2025/03/04 07:48:26 AM ERROR:Error in load_election_dates: 'NoneType' object has no attribute 'head'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 26, in load_election_dates
    logger.debug(f"election_dates_df: {election_dates_df.head()}")
AttributeError: 'NoneType' object has no attribute 'head'
2025/03/04 07:48:26 AM ERROR:Error in load_cleaned_data: 'NoneType' object has no attribute 'head'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 26, in load_election_dates
    logger.debug(f"election_dates_df: {election_dates_df.head()}")
AttributeError: 'NoneType' object has no attribute 'head'
2025/03/04 07:48:26 AM ERROR:Error in get_cleaned_data: 'NoneType' object has no attribute 'head'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 26, in load_election_dates
    logger.debug(f"election_dates_df: {election_dates_df.head()}")
AttributeError: 'NoneType' object has no attribute 'head'
2025/03/04 07:48:26 AM ERROR:Error in load_data_to_session: 'NoneType' object has no attribute 'head'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 26, in load_election_dates
    logger.debug(f"election_dates_df: {election_dates_df.head()}")
AttributeError: 'NoneType' object has no attribute 'head'
2025/03/04 07:48:26 AM ERROR:Error in firstload: 'NoneType' object has no attribute 'head'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 26, in load_election_dates
    logger.debug(f"election_dates_df: {election_dates_df.head()}")
AttributeError: 'NoneType' object has no attribute 'head'
2025/03/04 07:48:26 AM ERROR:Error in initialise_data: 'NoneType' object has no attribute 'head'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 42, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 26, in load_election_dates
    logger.debug(f"election_dates_df: {election_dates_df.head()}")
AttributeError: 'NoneType' object has no attribute 'head'
2025/03/04 07:48:26 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 07:48:26 AM INFO:Running first load function.
2025/03/04 07:48:26 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 07:48:26 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x0000029E795DE170>), kwargs={}
2025/03/04 07:48:26 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 07:48:26 AM INFO:get_raw_data executed successfully
2025/03/04 07:48:26 AM INFO:load_data_to_session executed successfully
2025/03/04 07:48:26 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x0000029E795DE290>), kwargs={}
2025/03/04 07:48:26 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 07:48:26 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 07:48:26 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 07:48:29 AM DEBUG:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ...                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...  ...                              ...        ...          ...           ...               ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...          Shaftesbury Investments          1         2016             4            201604
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                Mr Jeremy Hosking          1         2016             2            201602
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   Anthony Clarke          1         2016             6            201606
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                Mr Peter A Dubens          1         2017             5            201705
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                 Mr Ravi S Kailas          1         2017             5            201705

[65278 rows x 44 columns],), kwargs={}
2025/03/04 07:48:29 AM DEBUG:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/04 07:48:29 AM DEBUG:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/04 07:48:29 AM DEBUG:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 07:48:29 AM DEBUG:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/04 07:48:29 AM DEBUG:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 07:48:29 AM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/04 07:48:29 AM ERROR:Attempting to remove duplicates
2025/03/04 07:48:30 AM DEBUG:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 46 columns]
2025/03/04 07:48:30 AM DEBUG:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/04 07:48:30 AM INFO:Data Updated with PartyName and PartyId successfully
2025/03/04 07:48:30 AM INFO:map_mp_to_party executed successfully
2025/03/04 07:48:30 AM DEBUG:Calling load_election_dates with args=(), kwargs={}
2025/03/04 07:48:30 AM INFO:Election dates loaded from file.
2025/03/04 07:48:30 AM ERROR:Error in load_election_dates: 'NoneType' object has no attribute 'head'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 26, in load_election_dates
    logger.debug(f"election_dates_df: {election_dates_df.head()}")
AttributeError: 'NoneType' object has no attribute 'head'
2025/03/04 07:48:30 AM ERROR:Error in load_cleaned_data: 'NoneType' object has no attribute 'head'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 26, in load_election_dates
    logger.debug(f"election_dates_df: {election_dates_df.head()}")
AttributeError: 'NoneType' object has no attribute 'head'
2025/03/04 07:48:30 AM ERROR:Error in get_cleaned_data: 'NoneType' object has no attribute 'head'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 26, in load_election_dates
    logger.debug(f"election_dates_df: {election_dates_df.head()}")
AttributeError: 'NoneType' object has no attribute 'head'
2025/03/04 07:48:30 AM ERROR:Error in load_data_to_session: 'NoneType' object has no attribute 'head'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 26, in load_election_dates
    logger.debug(f"election_dates_df: {election_dates_df.head()}")
AttributeError: 'NoneType' object has no attribute 'head'
2025/03/04 07:48:30 AM ERROR:Error in firstload: 'NoneType' object has no attribute 'head'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 26, in load_election_dates
    logger.debug(f"election_dates_df: {election_dates_df.head()}")
AttributeError: 'NoneType' object has no attribute 'head'
2025/03/04 07:48:30 AM ERROR:Error in initialise_data: 'NoneType' object has no attribute 'head'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 42, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 26, in load_election_dates
    logger.debug(f"election_dates_df: {election_dates_df.head()}")
AttributeError: 'NoneType' object has no attribute 'head'
2025/03/04 07:48:30 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 07:48:30 AM INFO:Running first load function.
2025/03/04 07:48:30 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 07:48:30 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x0000029E795DE170>), kwargs={}
2025/03/04 07:48:30 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 07:48:30 AM INFO:get_raw_data executed successfully
2025/03/04 07:48:30 AM INFO:load_data_to_session executed successfully
2025/03/04 07:48:30 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x0000029E795DE290>), kwargs={}
2025/03/04 07:48:30 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 07:48:30 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 07:48:30 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 07:48:33 AM DEBUG:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ...                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...  ...                              ...        ...          ...           ...               ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...          Shaftesbury Investments          1         2016             4            201604
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                Mr Jeremy Hosking          1         2016             2            201602
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   Anthony Clarke          1         2016             6            201606
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                Mr Peter A Dubens          1         2017             5            201705
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                 Mr Ravi S Kailas          1         2017             5            201705

[65278 rows x 44 columns],), kwargs={}
2025/03/04 07:48:33 AM DEBUG:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/04 07:48:33 AM DEBUG:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/04 07:48:33 AM DEBUG:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 07:48:33 AM DEBUG:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/04 07:48:33 AM DEBUG:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 07:48:33 AM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/04 07:48:33 AM ERROR:Attempting to remove duplicates
2025/03/04 07:48:34 AM DEBUG:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 46 columns]
2025/03/04 07:48:34 AM DEBUG:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/04 07:48:34 AM INFO:Data Updated with PartyName and PartyId successfully
2025/03/04 07:48:34 AM INFO:map_mp_to_party executed successfully
2025/03/04 07:48:34 AM DEBUG:Calling load_election_dates with args=(), kwargs={}
2025/03/04 07:48:34 AM INFO:Election dates loaded from file.
2025/03/04 07:48:34 AM ERROR:Error in load_election_dates: 'NoneType' object has no attribute 'head'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 26, in load_election_dates
    logger.debug(f"election_dates_df: {election_dates_df.head()}")
AttributeError: 'NoneType' object has no attribute 'head'
2025/03/04 07:48:34 AM ERROR:Error in load_cleaned_data: 'NoneType' object has no attribute 'head'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 26, in load_election_dates
    logger.debug(f"election_dates_df: {election_dates_df.head()}")
AttributeError: 'NoneType' object has no attribute 'head'
2025/03/04 07:48:34 AM ERROR:Error in get_cleaned_data: 'NoneType' object has no attribute 'head'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 26, in load_election_dates
    logger.debug(f"election_dates_df: {election_dates_df.head()}")
AttributeError: 'NoneType' object has no attribute 'head'
2025/03/04 07:48:34 AM ERROR:Error in load_data_to_session: 'NoneType' object has no attribute 'head'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 26, in load_election_dates
    logger.debug(f"election_dates_df: {election_dates_df.head()}")
AttributeError: 'NoneType' object has no attribute 'head'
2025/03/04 07:48:34 AM ERROR:Error in firstload: 'NoneType' object has no attribute 'head'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 26, in load_election_dates
    logger.debug(f"election_dates_df: {election_dates_df.head()}")
AttributeError: 'NoneType' object has no attribute 'head'
2025/03/04 07:48:34 AM ERROR:Error in initialise_data: 'NoneType' object has no attribute 'head'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 42, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 26, in load_election_dates
    logger.debug(f"election_dates_df: {election_dates_df.head()}")
AttributeError: 'NoneType' object has no attribute 'head'
2025/03/04 07:55:02 AM INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/04 07:55:02 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\utils',), kwargs={}
2025/03/04 07:55:03 AM INFO:get_git_version executed successfully
2025/03/04 07:55:03 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\data',), kwargs={}
2025/03/04 07:55:04 AM INFO:get_git_version executed successfully
2025/03/04 07:55:04 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 07:55:04 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 07:55:04 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 07:55:04 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 07:55:04 AM INFO:Running App setup...
2025/03/04 07:55:04 AM INFO:Running App setup...
2025/03/04 07:55:04 AM INFO:Running App setup...
2025/03/04 07:55:04 AM INFO:Running App setup...
2025/03/04 07:55:04 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 07:55:04 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 07:55:04 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 07:55:04 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 07:55:04 AM INFO:Setting up the package
2025/03/04 07:55:04 AM INFO:Setting up the package
2025/03/04 07:55:04 AM INFO:Setting up the package
2025/03/04 07:55:04 AM INFO:Setting up the package
2025/03/04 07:55:04 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 07:55:04 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 07:55:04 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 07:55:04 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 07:55:04 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 07:55:04 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 07:55:04 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 07:55:04 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 07:55:04 AM INFO:get_git_version executed successfully
2025/03/04 07:55:04 AM INFO:get_git_version executed successfully
2025/03/04 07:55:04 AM INFO:Version: v20.138
2025/03/04 07:55:04 AM INFO:get_git_version executed successfully
2025/03/04 07:55:04 AM INFO:Version: v20.138
2025/03/04 07:55:04 AM INFO:get_git_version executed successfully
2025/03/04 07:55:04 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 07:55:04 AM INFO:Version: v20.138
2025/03/04 07:55:04 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 07:55:04 AM INFO:Version: v20.138
2025/03/04 07:55:04 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:55:04 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 07:55:04 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:55:04 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 07:55:04 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 07:55:04 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:55:04 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 07:55:04 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:55:04 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 07:55:04 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 07:55:04 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 07:55:04 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 07:55:04 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:55:04 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 07:55:04 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:55:04 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 07:55:04 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 07:55:04 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:55:04 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 07:55:04 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:55:04 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 07:55:04 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 07:55:04 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 07:55:04 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 07:55:04 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:55:04 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 07:55:04 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:55:04 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 07:55:04 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:55:04 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:55:04 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:55:04 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:55:04 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:55:04 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:55:04 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:55:04 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:55:04 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:55:04 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:55:04 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:55:04 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:55:04 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 07:55:04 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:55:04 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 07:55:04 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:55:04 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 07:55:04 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 07:55:04 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 07:55:04 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 07:55:04 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:55:04 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 07:55:04 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:55:04 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 07:55:04 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:55:04 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:55:04 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 07:55:04 AM DEBUG:Initialised data_dir with value: data
2025/03/04 07:55:04 AM DEBUG:Initialised output_dir with value: output
2025/03/04 07:55:04 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 07:55:04 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 07:55:04 AM DEBUG:Initialised components_dir with value: components
2025/03/04 07:55:04 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 07:55:04 AM DEBUG:Initialised data_dir with value: data
2025/03/04 07:55:04 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 07:55:04 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 07:55:04 AM DEBUG:Initialised data_dir with value: data
2025/03/04 07:55:04 AM DEBUG:Initialised output_dir with value: output
2025/03/04 07:55:04 AM DEBUG:Initialised data_dir with value: data
2025/03/04 07:55:04 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 07:55:04 AM DEBUG:Initialised output_dir with value: output
2025/03/04 07:55:04 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 07:55:04 AM DEBUG:Initialised output_dir with value: output
2025/03/04 07:55:04 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:55:04 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 07:55:04 AM DEBUG:Initialised components_dir with value: components
2025/03/04 07:55:04 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 07:55:04 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:55:04 AM DEBUG:Initialised components_dir with value: components
2025/03/04 07:55:04 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 07:55:04 AM DEBUG:Initialised components_dir with value: components
2025/03/04 07:55:04 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 07:55:04 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 07:55:04 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 07:55:04 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 07:55:04 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:55:04 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 07:55:04 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:55:04 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 07:55:04 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:55:04 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:55:04 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:55:04 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:55:04 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:55:04 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:55:04 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 07:55:04 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:55:04 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 07:55:04 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 07:55:04 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:55:04 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 07:55:04 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 07:55:04 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:55:04 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:55:04 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:55:04 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 07:55:04 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:55:04 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:55:04 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:55:04 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 07:55:04 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:55:04 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 07:55:04 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:55:04 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 07:55:04 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 07:55:04 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 07:55:04 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 07:55:04 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 07:55:04 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 07:55:04 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 07:55:04 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 07:55:04 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 07:55:04 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 07:55:04 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 07:55:04 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 07:55:04 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 07:55:04 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 07:55:04 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 07:55:04 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 07:55:04 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 07:55:04 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 07:55:04 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 07:55:04 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 07:55:04 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 07:55:04 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 07:55:04 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 07:55:04 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 07:55:04 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:55:04 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 07:55:04 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 07:55:04 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 07:55:04 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 07:55:04 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 07:55:04 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 07:55:04 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 07:55:04 AM INFO:Session_state variables initialized
2025/03/04 07:55:04 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 07:55:04 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 07:55:04 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 07:55:04 AM DEBUG:data_dir: data
2025/03/04 07:55:04 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 07:55:04 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:55:04 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 07:55:04 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 07:55:04 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:55:04 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 07:55:04 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:55:04 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 07:55:04 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 07:55:04 AM INFO:Session_state variables initialized
2025/03/04 07:55:04 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 07:55:04 AM DEBUG:output_dir: output
2025/03/04 07:55:04 AM INFO:Session_state variables initialized
2025/03/04 07:55:04 AM DEBUG:data_dir: data
2025/03/04 07:55:04 AM INFO:Session_state variables initialized
2025/03/04 07:55:04 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 07:55:04 AM DEBUG:data_dir: data
2025/03/04 07:55:04 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 07:55:04 AM DEBUG:data_dir: data
2025/03/04 07:55:04 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 07:55:04 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 07:55:04 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 07:55:04 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 07:55:04 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:55:04 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 07:55:04 AM DEBUG:output_dir: output
2025/03/04 07:55:04 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 07:55:04 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:55:04 AM DEBUG:output_dir: output
2025/03/04 07:55:04 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 07:55:04 AM DEBUG:output_dir: output
2025/03/04 07:55:04 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:55:04 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 07:55:04 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 07:55:04 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 07:55:04 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:55:04 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 07:55:04 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:55:04 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 07:55:04 AM DEBUG:perc_target: 0.5
2025/03/04 07:55:04 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:55:04 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:55:04 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:55:04 AM DEBUG:logs_dir: logs
2025/03/04 07:55:04 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:55:04 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:55:04 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:55:04 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 07:55:04 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:55:04 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:55:04 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:55:04 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 07:55:04 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:55:04 AM DEBUG:perc_target: 0.5
2025/03/04 07:55:04 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:55:04 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:55:04 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:55:04 AM DEBUG:logs_dir: logs
2025/03/04 07:55:04 AM DEBUG:perc_target: 0.5
2025/03/04 07:55:04 AM DEBUG:logs_dir: logs
2025/03/04 07:55:04 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 07:55:04 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 07:55:04 AM DEBUG:perc_target: 0.5
2025/03/04 07:55:04 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 07:55:04 AM DEBUG:utils_dir: utils
2025/03/04 07:55:04 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 07:55:04 AM DEBUG:logs_dir: logs
2025/03/04 07:55:04 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 07:55:04 AM DEBUG:app_pages_dir: app_pages
2025/03/04 07:55:04 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:55:04 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 07:55:04 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:55:04 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:55:04 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:55:04 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 07:55:04 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:55:04 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 07:55:04 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 07:55:04 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:55:04 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 07:55:04 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:55:04 AM DEBUG:utils_dir: utils
2025/03/04 07:55:04 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:55:04 AM DEBUG:utils_dir: utils
2025/03/04 07:55:04 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 07:55:04 AM DEBUG:app_pages_dir: app_pages
2025/03/04 07:55:04 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 07:55:04 AM DEBUG:app_pages_dir: app_pages
2025/03/04 07:55:04 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 07:55:04 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:55:04 AM DEBUG:utils_dir: utils
2025/03/04 07:55:04 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:55:04 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 07:55:04 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 07:55:04 AM DEBUG:app_pages_dir: app_pages
2025/03/04 07:55:04 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 07:55:04 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 07:55:04 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:55:04 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:55:04 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:55:04 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:55:04 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 07:55:04 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 07:55:04 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 07:55:04 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 07:55:04 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 07:55:04 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:55:04 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 07:55:04 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:55:04 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 07:55:04 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 07:55:04 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 07:55:04 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 07:55:04 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 07:55:04 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 07:55:04 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 07:55:04 AM DEBUG:components_dir: components
2025/03/04 07:55:04 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:55:04 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 07:55:04 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:55:04 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 07:55:04 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 07:55:04 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 07:55:04 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 07:55:04 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:55:04 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:55:04 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:55:04 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:55:04 AM DEBUG:reference_dir: reference_files
2025/03/04 07:55:04 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 07:55:04 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 07:55:04 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 07:55:04 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:55:04 AM DEBUG:components_dir: components
2025/03/04 07:55:04 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:55:04 AM DEBUG:components_dir: components
2025/03/04 07:55:04 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 07:55:04 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 07:55:04 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 07:55:04 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 07:55:04 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:55:04 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:55:04 AM DEBUG:components_dir: components
2025/03/04 07:55:04 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:55:04 AM INFO:Session state Setup complete
2025/03/04 07:55:04 AM DEBUG:reference_dir: reference_files
2025/03/04 07:55:04 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 07:55:04 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:55:04 AM INFO:initialize_session_state executed successfully
2025/03/04 07:55:04 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:55:04 AM DEBUG:reference_dir: reference_files
2025/03/04 07:55:04 AM DEBUG:reference_dir: reference_files
2025/03/04 07:55:04 AM INFO:Package setup complete
2025/03/04 07:55:04 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 07:55:04 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:55:04 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:55:04 AM INFO:setup_package executed successfully
2025/03/04 07:55:04 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:55:04 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 07:55:04 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 07:55:04 AM INFO:Session state Setup complete
2025/03/04 07:55:04 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:55:04 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:55:04 AM INFO:Running Menu setup...
2025/03/04 07:55:04 AM INFO:initialize_session_state executed successfully
2025/03/04 07:55:04 AM INFO:Session state Setup complete
2025/03/04 07:55:04 AM INFO:Session state Setup complete
2025/03/04 07:55:04 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 07:55:04 AM INFO:Package setup complete
2025/03/04 07:55:04 AM INFO:initialize_session_state executed successfully
2025/03/04 07:55:04 AM INFO:initialize_session_state executed successfully
2025/03/04 07:55:04 AM INFO:setup_package executed successfully
2025/03/04 07:55:04 AM INFO:Package setup complete
2025/03/04 07:55:04 AM INFO:Package setup complete
2025/03/04 07:55:04 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\app_pages',), kwargs={}
2025/03/04 07:55:04 AM INFO:setup_package executed successfully
2025/03/04 07:55:04 AM INFO:setup_package executed successfully
2025/03/04 07:55:04 AM INFO:Running Menu setup...
2025/03/04 07:55:04 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 07:55:04 AM INFO:Running Menu setup...
2025/03/04 07:55:04 AM INFO:Running Menu setup...
2025/03/04 07:55:04 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 07:55:04 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 07:55:04 AM INFO:get_git_version executed successfully
2025/03/04 07:55:04 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\components',), kwargs={}
2025/03/04 07:55:04 AM INFO:get_git_version executed successfully
2025/03/04 07:55:04 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 07:55:04 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 07:55:04 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 07:55:04 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 07:55:04 AM INFO:get_git_version executed successfully
2025/03/04 07:55:04 AM INFO:get_git_version executed successfully
2025/03/04 07:55:04 AM INFO:get_git_version executed successfully
2025/03/04 07:55:04 AM INFO:get_git_version executed successfully
2025/03/04 07:55:04 AM INFO:App Version: v20.159
2025/03/04 07:55:04 AM INFO:App Version: v20.159
2025/03/04 07:55:04 AM INFO:App Version: v20.159
2025/03/04 07:55:04 AM INFO:App Version: v20.159
2025/03/04 07:55:04 AM INFO:Switched to page: Introduction
2025/03/04 07:55:04 AM INFO:Switched to page: Introduction
2025/03/04 07:55:04 AM INFO:Switched to page: Introduction
2025/03/04 07:55:04 AM INFO:Switched to page: Introduction
2025/03/04 07:55:04 AM INFO:pagesetup executed successfully
2025/03/04 07:55:04 AM INFO:pagesetup executed successfully
2025/03/04 07:55:04 AM INFO:pagesetup executed successfully
2025/03/04 07:55:04 AM INFO:pagesetup executed successfully
2025/03/04 07:55:04 AM INFO:No data found in session state, running firstload()
2025/03/04 07:55:04 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 07:55:04 AM INFO:No data found in session state, running firstload()
2025/03/04 07:55:04 AM INFO:No data found in session state, running firstload()
2025/03/04 07:55:04 AM INFO:No data found in session state, running firstload()
2025/03/04 07:55:05 AM INFO:Running first load function.
2025/03/04 07:55:05 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 07:55:05 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x0000021A4FEEEB90>), kwargs={}
2025/03/04 07:55:05 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 07:55:05 AM DEBUG:Calling load_raw_data with args=(), kwargs={'main_file': 'raw_data', 'cleaned_file': 'raw_data_clean', 'output_csv': True, 'dedupe_donors': True, 'dedupe_regentity': True, 'originaldatafilepath': 'source_data_fname', 'processeddatafilepath': 'imported_raw_fname'}
2025/03/04 07:55:05 AM DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/04 07:55:05 AM DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/04 07:55:05 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'source\\Donations_accepted_by_political_parties.csv', 'savedfilepath': 'output\\imported_raw.csv', 'timestamp_key': 'load_raw_data_last_modified'}
2025/03/04 07:55:05 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:55:05 AM INFO:Saved file path: output\imported_raw.csv
2025/03/04 07:55:05 AM DEBUG:Calling is_file_updated with args=('source\\Donations_accepted_by_political_parties.csv', 'load_raw_data_last_modified'), kwargs={}
2025/03/04 07:55:05 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 07:55:05 AM DEBUG:Calling get_file_modification_time with args=('source\\Donations_accepted_by_political_parties.csv',), kwargs={}
2025/03/04 07:55:05 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 07:55:05 AM INFO:get_file_modification_time executed successfully
2025/03/04 07:55:05 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 07:55:05 AM INFO:Last modification time: None
2025/03/04 07:55:05 AM INFO:is_file_updated executed successfully
2025/03/04 07:55:05 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 07:55:05 AM INFO:Loading raw data...
2025/03/04 07:55:05 AM DEBUG:Original data file path post raw data load: {originaldatafilepath}
2025/03/04 07:55:05 AM DEBUG:Processed data file path post raw data load: {processeddatafilepath}
2025/03/04 07:55:05 AM INFO:Data loaded successfully. Data has 65278 rows and 29 columns
2025/03/04 07:55:06 AM INFO:Data saved to output\imported_raw.csv
2025/03/04 07:55:06 AM DEBUG:Calling raw_data_cleanup with args=(), kwargs={'loaddata_df':            ECRef              RegulatedEntityName    RegulatedEntityType        Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                               ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    1,876.56   02/09/2019  ...              NaN  86310.0             NaN  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    2,700.00   02/09/2019  ...              NaN  86310.0             NaN  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    4,852.58   30/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    2,500.00   30/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    4,524.05   29/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
...          ...                              ...                    ...          ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10,000.00          NaN  ...              NaN  74198.0             NaN            NaN         False
65274   C0242461               Vote Leave Limited  Permitted Participant  100,000.00          NaN  ...              NaN  74184.0             NaN            NaN         False
65275   C0243560               Vote Leave Limited  Permitted Participant   40,000.00          NaN  ...              NaN  74576.0             NaN            NaN         False
65276   C0319710  Conservative and Unionist Party        Political Party   50,000.00          NaN  ...              NaN  34241.0             NaN  Great Britain         False
65277   C0319727  Conservative and Unionist Party        Political Party   15,000.00          NaN  ...              NaN  74743.0             NaN  Great Britain         False

[65278 rows x 29 columns], 'dedupe_donors': True, 'dedupe_regentity': True, 'output_csv': True, 'originaldatafilepath': 'output\\imported_raw.csv', 'processeddatafilepath': 'cleaned_donations_fname'}
2025/03/04 07:55:06 AM INFO:Cleaning up raw data
2025/03/04 07:55:06 AM ERROR:Session state variables not initialized!
2025/03/04 07:55:06 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': None, 'savedfilepath': 'output\\cleaned_donations.csv', 'timestamp_key': 'cleaned_raw_data_last_modified'}
2025/03/04 07:55:06 AM INFO:Original file path: None
2025/03/04 07:55:06 AM INFO:Saved file path: output\cleaned_donations.csv
2025/03/04 07:55:06 AM ERROR:Error: originalfilepath is None!
2025/03/04 07:55:06 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 07:55:06 AM INFO:Data loaded, shape: (65278, 29)
2025/03/04 07:55:07 AM DEBUG:Calling dedupe_entity_file with args=(), kwargs={'loaddata_dd_df':            ECRef              RegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                             ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...                   86310.0                  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...                   86310.0                  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...                   86310.0                  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...                   86310.0                  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...                   86310.0                  Great Britain         False
...          ...                              ...                    ...        ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...                   74198.0                          Other         False
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                   74184.0                          Other         False
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   74576.0                          Other         False
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                   34241.0                  Great Britain         False
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                   74743.0                  Great Britain         False

[65278 rows x 29 columns], 'entity': 'RegulatedEntity', 'map_filename': 'regentity_map_fname', 'output_csv': True}
2025/03/04 07:55:07 AM DEBUG:Calling is_file_updated with args=('reference_files\\PoliticalEntityDeDuped.csv', 'regentity_map_fname_last_modified'), kwargs={}
2025/03/04 07:55:07 AM INFO:Checking if reference_files\PoliticalEntityDeDuped.csv has been updated.
2025/03/04 07:55:07 AM DEBUG:Calling get_file_modification_time with args=('reference_files\\PoliticalEntityDeDuped.csv',), kwargs={}
2025/03/04 07:55:07 AM INFO:Getting modification time for reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:55:07 AM INFO:get_file_modification_time executed successfully
2025/03/04 07:55:07 AM INFO:Current modification time: 1740841102.2638545
2025/03/04 07:55:07 AM INFO:Last modification time: None
2025/03/04 07:55:07 AM INFO:is_file_updated executed successfully
2025/03/04 07:55:07 AM INFO:Map file regentity_map_fname has been updated. Proceeding with deduplication.
2025/03/04 07:55:07 AM INFO:File deduplication complete, shape: (65278, 34)
2025/03/04 07:55:07 AM INFO:dedupe_entity_file executed successfully
2025/03/04 07:55:07 AM DEBUG:Calling dedupe_entity_file with args=(), kwargs={'loaddata_dd_df':            ECRef      OriginalRegulatedEntityName    RegulatedEntityType  ...      OriginalRegulatedEntityName RegulatedEntityId              RegulatedEntityName
0      NC0408174                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
1      NC0408173                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
2      NC0408177                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
3      NC0408176                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
4      NC0408170                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
...          ...                              ...                    ...  ...                              ...               ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65274   C0242461               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65275   C0243560               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65276   C0319710  Conservative And Unionist Party        Political Party  ...  Conservative And Unionist Party              52.0  Conservative And Unionist Party
65277   C0319727  Conservative And Unionist Party        Political Party  ...  Conservative And Unionist Party              52.0  Conservative And Unionist Party

[65278 rows x 34 columns], 'entity': 'Donor', 'map_filename': 'donor_map_fname', 'output_csv': True}
2025/03/04 07:55:07 AM DEBUG:Calling is_file_updated with args=('reference_files\\PoliticalDonorsDeduped.csv', 'donor_map_fname_last_modified'), kwargs={}
2025/03/04 07:55:07 AM INFO:Checking if reference_files\PoliticalDonorsDeduped.csv has been updated.
2025/03/04 07:55:07 AM DEBUG:Calling get_file_modification_time with args=('reference_files\\PoliticalDonorsDeduped.csv',), kwargs={}
2025/03/04 07:55:07 AM INFO:Getting modification time for reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:55:07 AM INFO:get_file_modification_time executed successfully
2025/03/04 07:55:07 AM INFO:Current modification time: 1740757863.2545311
2025/03/04 07:55:07 AM INFO:Last modification time: None
2025/03/04 07:55:07 AM INFO:is_file_updated executed successfully
2025/03/04 07:55:07 AM INFO:Map file donor_map_fname has been updated. Proceeding with deduplication.
2025/03/04 07:55:07 AM INFO:File deduplication complete, shape: (65278, 40)
2025/03/04 07:55:07 AM INFO:dedupe_entity_file executed successfully
2025/03/04 07:55:07 AM INFO:Raw Data cleanup completed
2025/03/04 07:55:07 AM INFO:Data shape: (65278, 40)
2025/03/04 07:55:08 AM INFO:Data saved to output\cleaned_donations.csv
2025/03/04 07:55:08 AM INFO:Data cleanup completed, shape: (65278, 40)
2025/03/04 07:55:08 AM INFO:raw_data_cleanup executed successfully
2025/03/04 07:55:09 AM INFO:load_raw_data executed successfully
2025/03/04 07:55:09 AM INFO:get_raw_data executed successfully
2025/03/04 07:55:09 AM INFO:load_data_to_session executed successfully
2025/03/04 07:55:09 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x0000021A4FEEEC20>), kwargs={}
2025/03/04 07:55:09 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 07:55:09 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 07:55:09 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'output\\cleaned_donations.csv', 'savedfilepath': 'output\\cleaned_data.csv', 'timestamp_key': 'load_raw_data_last_modified'}
2025/03/04 07:55:09 AM INFO:Original file path: output\cleaned_donations.csv
2025/03/04 07:55:09 AM INFO:Saved file path: output\cleaned_data.csv
2025/03/04 07:55:09 AM DEBUG:Calling is_file_updated with args=('output\\cleaned_donations.csv', 'load_raw_data_last_modified'), kwargs={}
2025/03/04 07:55:09 AM INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/04 07:55:09 AM DEBUG:Calling get_file_modification_time with args=('output\\cleaned_donations.csv',), kwargs={}
2025/03/04 07:55:09 AM INFO:Getting modification time for output\cleaned_donations.csv
2025/03/04 07:55:09 AM INFO:get_file_modification_time executed successfully
2025/03/04 07:55:09 AM INFO:Current modification time: 1741074908.981631
2025/03/04 07:55:09 AM INFO:Last modification time: 1740757862.6744745
2025/03/04 07:55:09 AM INFO:is_file_updated executed successfully
2025/03/04 07:55:09 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 07:55:09 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 07:55:12 AM DEBUG:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ...                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...  ...                              ...        ...          ...           ...               ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...          Shaftesbury Investments          1         2016             4            201604
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                Mr Jeremy Hosking          1         2016             2            201602
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   Anthony Clarke          1         2016             6            201606
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                Mr Peter A Dubens          1         2017             5            201705
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                 Mr Ravi S Kailas          1         2017             5            201705

[65278 rows x 44 columns],), kwargs={}
2025/03/04 07:55:12 AM DEBUG:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/04 07:55:12 AM DEBUG:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/04 07:55:12 AM DEBUG:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 07:55:12 AM DEBUG:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/04 07:55:12 AM DEBUG:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 07:55:12 AM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/04 07:55:12 AM ERROR:Attempting to remove duplicates
2025/03/04 07:55:13 AM DEBUG:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 46 columns]
2025/03/04 07:55:13 AM DEBUG:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/04 07:55:13 AM INFO:Data Updated with PartyName and PartyId successfully
2025/03/04 07:55:13 AM INFO:map_mp_to_party executed successfully
2025/03/04 07:55:13 AM DEBUG:Calling load_election_dates with args=(), kwargs={}
2025/03/04 07:55:13 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'source\\Donations_accepted_by_political_parties.csv', 'savedfilepath': 'reference_files\\elections.csv', 'timestamp_key': 'election_dates_last_modified'}
2025/03/04 07:55:13 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:55:13 AM INFO:Saved file path: reference_files\elections.csv
2025/03/04 07:55:13 AM DEBUG:Calling is_file_updated with args=('source\\Donations_accepted_by_political_parties.csv', 'election_dates_last_modified'), kwargs={}
2025/03/04 07:55:13 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 07:55:13 AM DEBUG:Calling get_file_modification_time with args=('source\\Donations_accepted_by_political_parties.csv',), kwargs={}
2025/03/04 07:55:13 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 07:55:13 AM INFO:get_file_modification_time executed successfully
2025/03/04 07:55:13 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 07:55:13 AM INFO:Last modification time: None
2025/03/04 07:55:13 AM INFO:is_file_updated executed successfully
2025/03/04 07:55:13 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 07:55:13 AM INFO:Election dates loaded from file.
2025/03/04 07:55:13 AM ERROR:Error in load_election_dates: 'NoneType' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 27, in load_election_dates
    ElectionDates_dict = election_dates_df.to_dict(orient='index')
AttributeError: 'NoneType' object has no attribute 'to_dict'
2025/03/04 07:55:13 AM ERROR:Error in load_cleaned_data: 'NoneType' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 27, in load_election_dates
    ElectionDates_dict = election_dates_df.to_dict(orient='index')
AttributeError: 'NoneType' object has no attribute 'to_dict'
2025/03/04 07:55:13 AM ERROR:Error in get_cleaned_data: 'NoneType' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 27, in load_election_dates
    ElectionDates_dict = election_dates_df.to_dict(orient='index')
AttributeError: 'NoneType' object has no attribute 'to_dict'
2025/03/04 07:55:13 AM ERROR:Error in load_data_to_session: 'NoneType' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 27, in load_election_dates
    ElectionDates_dict = election_dates_df.to_dict(orient='index')
AttributeError: 'NoneType' object has no attribute 'to_dict'
2025/03/04 07:55:13 AM ERROR:Error in firstload: 'NoneType' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 27, in load_election_dates
    ElectionDates_dict = election_dates_df.to_dict(orient='index')
AttributeError: 'NoneType' object has no attribute 'to_dict'
2025/03/04 07:55:13 AM ERROR:Error in initialise_data: 'NoneType' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 42, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 27, in load_election_dates
    ElectionDates_dict = election_dates_df.to_dict(orient='index')
AttributeError: 'NoneType' object has no attribute 'to_dict'
2025/03/04 07:55:13 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 07:55:13 AM INFO:Running first load function.
2025/03/04 07:55:13 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 07:55:13 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x0000021A4FEEEB90>), kwargs={}
2025/03/04 07:55:13 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 07:55:13 AM INFO:get_raw_data executed successfully
2025/03/04 07:55:13 AM INFO:load_data_to_session executed successfully
2025/03/04 07:55:13 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x0000021A4FEEEC20>), kwargs={}
2025/03/04 07:55:13 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 07:55:13 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 07:55:13 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 07:55:16 AM DEBUG:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ...                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...  ...                              ...        ...          ...           ...               ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...          Shaftesbury Investments          1         2016             4            201604
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                Mr Jeremy Hosking          1         2016             2            201602
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   Anthony Clarke          1         2016             6            201606
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                Mr Peter A Dubens          1         2017             5            201705
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                 Mr Ravi S Kailas          1         2017             5            201705

[65278 rows x 44 columns],), kwargs={}
2025/03/04 07:55:16 AM DEBUG:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/04 07:55:16 AM DEBUG:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/04 07:55:16 AM DEBUG:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 07:55:16 AM DEBUG:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/04 07:55:16 AM DEBUG:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 07:55:17 AM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/04 07:55:17 AM ERROR:Attempting to remove duplicates
2025/03/04 07:55:17 AM DEBUG:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 46 columns]
2025/03/04 07:55:17 AM DEBUG:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/04 07:55:17 AM INFO:Data Updated with PartyName and PartyId successfully
2025/03/04 07:55:17 AM INFO:map_mp_to_party executed successfully
2025/03/04 07:55:17 AM DEBUG:Calling load_election_dates with args=(), kwargs={}
2025/03/04 07:55:17 AM INFO:Election dates loaded from file.
2025/03/04 07:55:17 AM ERROR:Error in load_election_dates: 'NoneType' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 27, in load_election_dates
    ElectionDates_dict = election_dates_df.to_dict(orient='index')
AttributeError: 'NoneType' object has no attribute 'to_dict'
2025/03/04 07:55:17 AM ERROR:Error in load_cleaned_data: 'NoneType' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 27, in load_election_dates
    ElectionDates_dict = election_dates_df.to_dict(orient='index')
AttributeError: 'NoneType' object has no attribute 'to_dict'
2025/03/04 07:55:17 AM ERROR:Error in get_cleaned_data: 'NoneType' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 27, in load_election_dates
    ElectionDates_dict = election_dates_df.to_dict(orient='index')
AttributeError: 'NoneType' object has no attribute 'to_dict'
2025/03/04 07:55:17 AM ERROR:Error in load_data_to_session: 'NoneType' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 27, in load_election_dates
    ElectionDates_dict = election_dates_df.to_dict(orient='index')
AttributeError: 'NoneType' object has no attribute 'to_dict'
2025/03/04 07:55:17 AM ERROR:Error in firstload: 'NoneType' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 27, in load_election_dates
    ElectionDates_dict = election_dates_df.to_dict(orient='index')
AttributeError: 'NoneType' object has no attribute 'to_dict'
2025/03/04 07:55:17 AM ERROR:Error in initialise_data: 'NoneType' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 42, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 27, in load_election_dates
    ElectionDates_dict = election_dates_df.to_dict(orient='index')
AttributeError: 'NoneType' object has no attribute 'to_dict'
2025/03/04 07:55:17 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 07:55:17 AM INFO:Running first load function.
2025/03/04 07:55:17 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 07:55:17 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x0000021A4FEEEB90>), kwargs={}
2025/03/04 07:55:17 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 07:55:17 AM INFO:get_raw_data executed successfully
2025/03/04 07:55:17 AM INFO:load_data_to_session executed successfully
2025/03/04 07:55:17 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x0000021A4FEEEC20>), kwargs={}
2025/03/04 07:55:17 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 07:55:17 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 07:55:17 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 07:55:20 AM DEBUG:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ...                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...  ...                              ...        ...          ...           ...               ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...          Shaftesbury Investments          1         2016             4            201604
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                Mr Jeremy Hosking          1         2016             2            201602
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   Anthony Clarke          1         2016             6            201606
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                Mr Peter A Dubens          1         2017             5            201705
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                 Mr Ravi S Kailas          1         2017             5            201705

[65278 rows x 44 columns],), kwargs={}
2025/03/04 07:55:21 AM DEBUG:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/04 07:55:21 AM DEBUG:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/04 07:55:21 AM DEBUG:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 07:55:21 AM DEBUG:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/04 07:55:21 AM DEBUG:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 07:55:21 AM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/04 07:55:21 AM ERROR:Attempting to remove duplicates
2025/03/04 07:55:21 AM DEBUG:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 46 columns]
2025/03/04 07:55:21 AM DEBUG:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/04 07:55:21 AM INFO:Data Updated with PartyName and PartyId successfully
2025/03/04 07:55:21 AM INFO:map_mp_to_party executed successfully
2025/03/04 07:55:21 AM DEBUG:Calling load_election_dates with args=(), kwargs={}
2025/03/04 07:55:21 AM INFO:Election dates loaded from file.
2025/03/04 07:55:21 AM ERROR:Error in load_election_dates: 'NoneType' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 27, in load_election_dates
    ElectionDates_dict = election_dates_df.to_dict(orient='index')
AttributeError: 'NoneType' object has no attribute 'to_dict'
2025/03/04 07:55:21 AM ERROR:Error in load_cleaned_data: 'NoneType' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 27, in load_election_dates
    ElectionDates_dict = election_dates_df.to_dict(orient='index')
AttributeError: 'NoneType' object has no attribute 'to_dict'
2025/03/04 07:55:21 AM ERROR:Error in get_cleaned_data: 'NoneType' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 27, in load_election_dates
    ElectionDates_dict = election_dates_df.to_dict(orient='index')
AttributeError: 'NoneType' object has no attribute 'to_dict'
2025/03/04 07:55:21 AM ERROR:Error in load_data_to_session: 'NoneType' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 27, in load_election_dates
    ElectionDates_dict = election_dates_df.to_dict(orient='index')
AttributeError: 'NoneType' object has no attribute 'to_dict'
2025/03/04 07:55:21 AM ERROR:Error in firstload: 'NoneType' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 27, in load_election_dates
    ElectionDates_dict = election_dates_df.to_dict(orient='index')
AttributeError: 'NoneType' object has no attribute 'to_dict'
2025/03/04 07:55:21 AM ERROR:Error in initialise_data: 'NoneType' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 42, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 27, in load_election_dates
    ElectionDates_dict = election_dates_df.to_dict(orient='index')
AttributeError: 'NoneType' object has no attribute 'to_dict'
2025/03/04 07:55:21 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 07:55:22 AM INFO:Running first load function.
2025/03/04 07:55:22 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 07:55:22 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x0000021A4FEEEB90>), kwargs={}
2025/03/04 07:55:22 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 07:55:22 AM INFO:get_raw_data executed successfully
2025/03/04 07:55:22 AM INFO:load_data_to_session executed successfully
2025/03/04 07:55:22 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x0000021A4FEEEC20>), kwargs={}
2025/03/04 07:55:22 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 07:55:22 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 07:55:22 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 07:55:24 AM DEBUG:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ...                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...  ...                              ...        ...          ...           ...               ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...          Shaftesbury Investments          1         2016             4            201604
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                Mr Jeremy Hosking          1         2016             2            201602
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   Anthony Clarke          1         2016             6            201606
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                Mr Peter A Dubens          1         2017             5            201705
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                 Mr Ravi S Kailas          1         2017             5            201705

[65278 rows x 44 columns],), kwargs={}
2025/03/04 07:55:24 AM DEBUG:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/04 07:55:24 AM DEBUG:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/04 07:55:24 AM DEBUG:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 07:55:25 AM DEBUG:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/04 07:55:25 AM DEBUG:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 07:55:25 AM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/04 07:55:25 AM ERROR:Attempting to remove duplicates
2025/03/04 07:55:25 AM DEBUG:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 46 columns]
2025/03/04 07:55:25 AM DEBUG:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/04 07:55:25 AM INFO:Data Updated with PartyName and PartyId successfully
2025/03/04 07:55:25 AM INFO:map_mp_to_party executed successfully
2025/03/04 07:55:25 AM DEBUG:Calling load_election_dates with args=(), kwargs={}
2025/03/04 07:55:25 AM INFO:Election dates loaded from file.
2025/03/04 07:55:25 AM ERROR:Error in load_election_dates: 'NoneType' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 27, in load_election_dates
    ElectionDates_dict = election_dates_df.to_dict(orient='index')
AttributeError: 'NoneType' object has no attribute 'to_dict'
2025/03/04 07:55:25 AM ERROR:Error in load_cleaned_data: 'NoneType' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 27, in load_election_dates
    ElectionDates_dict = election_dates_df.to_dict(orient='index')
AttributeError: 'NoneType' object has no attribute 'to_dict'
2025/03/04 07:55:25 AM ERROR:Error in get_cleaned_data: 'NoneType' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 27, in load_election_dates
    ElectionDates_dict = election_dates_df.to_dict(orient='index')
AttributeError: 'NoneType' object has no attribute 'to_dict'
2025/03/04 07:55:25 AM ERROR:Error in load_data_to_session: 'NoneType' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 27, in load_election_dates
    ElectionDates_dict = election_dates_df.to_dict(orient='index')
AttributeError: 'NoneType' object has no attribute 'to_dict'
2025/03/04 07:55:25 AM ERROR:Error in firstload: 'NoneType' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 27, in load_election_dates
    ElectionDates_dict = election_dates_df.to_dict(orient='index')
AttributeError: 'NoneType' object has no attribute 'to_dict'
2025/03/04 07:55:25 AM ERROR:Error in initialise_data: 'NoneType' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 42, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 27, in load_election_dates
    ElectionDates_dict = election_dates_df.to_dict(orient='index')
AttributeError: 'NoneType' object has no attribute 'to_dict'
2025/03/04 07:59:40 AM INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/04 07:59:40 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\utils',), kwargs={}
2025/03/04 07:59:41 AM INFO:get_git_version executed successfully
2025/03/04 07:59:41 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\data',), kwargs={}
2025/03/04 07:59:41 AM INFO:get_git_version executed successfully
2025/03/04 07:59:41 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 07:59:41 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 07:59:41 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 07:59:41 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 07:59:41 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 07:59:41 AM INFO:Running App setup...
2025/03/04 07:59:41 AM INFO:Running App setup...
2025/03/04 07:59:41 AM INFO:Running App setup...
2025/03/04 07:59:41 AM INFO:Running App setup...
2025/03/04 07:59:41 AM INFO:Running App setup...
2025/03/04 07:59:41 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 07:59:41 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 07:59:41 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 07:59:41 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 07:59:41 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 07:59:41 AM INFO:Setting up the package
2025/03/04 07:59:41 AM INFO:Setting up the package
2025/03/04 07:59:41 AM INFO:Setting up the package
2025/03/04 07:59:41 AM INFO:Setting up the package
2025/03/04 07:59:41 AM INFO:Setting up the package
2025/03/04 07:59:41 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 07:59:41 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 07:59:41 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 07:59:41 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 07:59:41 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 07:59:41 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 07:59:41 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 07:59:41 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 07:59:41 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 07:59:41 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 07:59:42 AM INFO:get_git_version executed successfully
2025/03/04 07:59:42 AM INFO:get_git_version executed successfully
2025/03/04 07:59:42 AM INFO:get_git_version executed successfully
2025/03/04 07:59:42 AM INFO:get_git_version executed successfully
2025/03/04 07:59:42 AM INFO:Version: v20.138
2025/03/04 07:59:42 AM INFO:get_git_version executed successfully
2025/03/04 07:59:42 AM INFO:Version: v20.138
2025/03/04 07:59:42 AM INFO:Version: v20.138
2025/03/04 07:59:42 AM INFO:Version: v20.138
2025/03/04 07:59:42 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 07:59:42 AM INFO:Version: v20.138
2025/03/04 07:59:42 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 07:59:42 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 07:59:42 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 07:59:42 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:59:42 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 07:59:42 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:59:42 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:59:42 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:59:42 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 07:59:42 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:59:42 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 07:59:42 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 07:59:42 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 07:59:42 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 07:59:42 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 07:59:42 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 07:59:42 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 07:59:42 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 07:59:42 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:59:42 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 07:59:42 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:59:42 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:59:42 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:59:42 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 07:59:42 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:59:42 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 07:59:42 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 07:59:42 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 07:59:42 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 07:59:42 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 07:59:42 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 07:59:42 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 07:59:42 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 07:59:42 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:59:42 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 07:59:42 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:59:42 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:59:42 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:59:42 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:59:42 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:59:42 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:59:42 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:59:42 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:59:42 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:59:42 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:59:42 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:59:42 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:59:42 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:59:42 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:59:42 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:59:42 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:59:42 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:59:42 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:59:42 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 07:59:42 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:59:42 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 07:59:42 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 07:59:42 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 07:59:42 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 07:59:42 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 07:59:42 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 07:59:42 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 07:59:42 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 07:59:42 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:59:42 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 07:59:42 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:59:42 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:59:42 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:59:42 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:59:42 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 07:59:42 AM DEBUG:Initialised data_dir with value: data
2025/03/04 07:59:42 AM DEBUG:Initialised output_dir with value: output
2025/03/04 07:59:42 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 07:59:42 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 07:59:42 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 07:59:42 AM DEBUG:Initialised data_dir with value: data
2025/03/04 07:59:42 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 07:59:42 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 07:59:42 AM DEBUG:Initialised components_dir with value: components
2025/03/04 07:59:42 AM DEBUG:Initialised data_dir with value: data
2025/03/04 07:59:42 AM DEBUG:Initialised output_dir with value: output
2025/03/04 07:59:42 AM DEBUG:Initialised data_dir with value: data
2025/03/04 07:59:42 AM DEBUG:Initialised data_dir with value: data
2025/03/04 07:59:42 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 07:59:42 AM DEBUG:Initialised output_dir with value: output
2025/03/04 07:59:42 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 07:59:42 AM DEBUG:Initialised output_dir with value: output
2025/03/04 07:59:42 AM DEBUG:Initialised output_dir with value: output
2025/03/04 07:59:42 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 07:59:42 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 07:59:42 AM DEBUG:Initialised components_dir with value: components
2025/03/04 07:59:42 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 07:59:42 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 07:59:42 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:59:42 AM DEBUG:Initialised components_dir with value: components
2025/03/04 07:59:42 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 07:59:42 AM DEBUG:Initialised components_dir with value: components
2025/03/04 07:59:42 AM DEBUG:Initialised components_dir with value: components
2025/03/04 07:59:42 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:59:42 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 07:59:42 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 07:59:42 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 07:59:42 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 07:59:42 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 07:59:42 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 07:59:42 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:59:42 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 07:59:42 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 07:59:42 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:59:42 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:59:42 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:59:42 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:59:42 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:59:42 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:59:42 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:59:42 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 07:59:42 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:59:42 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:59:42 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:59:42 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 07:59:42 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:59:42 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 07:59:42 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 07:59:42 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 07:59:42 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:59:42 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:59:42 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:59:42 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:59:42 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 07:59:42 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:59:42 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:59:42 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:59:42 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:59:42 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 07:59:42 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:59:42 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 07:59:42 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:59:42 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:59:42 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 07:59:42 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 07:59:42 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 07:59:42 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 07:59:42 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 07:59:42 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 07:59:42 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 07:59:42 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 07:59:42 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 07:59:42 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 07:59:42 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 07:59:42 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 07:59:42 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 07:59:42 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 07:59:42 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 07:59:42 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 07:59:42 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 07:59:42 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 07:59:42 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 07:59:42 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 07:59:42 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 07:59:42 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 07:59:42 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 07:59:42 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 07:59:42 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 07:59:42 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 07:59:42 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 07:59:42 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 07:59:42 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 07:59:42 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 07:59:42 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 07:59:42 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 07:59:42 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 07:59:42 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 07:59:42 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 07:59:42 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:59:42 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 07:59:42 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 07:59:42 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 07:59:42 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 07:59:42 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 07:59:42 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 07:59:42 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 07:59:42 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 07:59:42 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 07:59:42 AM INFO:Session_state variables initialized
2025/03/04 07:59:42 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 07:59:42 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:59:42 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 07:59:42 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 07:59:42 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 07:59:42 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:59:42 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 07:59:42 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:59:42 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:59:42 AM DEBUG:output_dir: output
2025/03/04 07:59:42 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 07:59:42 AM INFO:Session_state variables initialized
2025/03/04 07:59:42 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 07:59:42 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 07:59:42 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 07:59:42 AM INFO:Session_state variables initialized
2025/03/04 07:59:42 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 07:59:42 AM INFO:Session_state variables initialized
2025/03/04 07:59:42 AM INFO:Session_state variables initialized
2025/03/04 07:59:42 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 07:59:42 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 07:59:42 AM DEBUG:output_dir: output
2025/03/04 07:59:42 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 07:59:42 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 07:59:42 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:59:42 AM DEBUG:output_dir: output
2025/03/04 07:59:42 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 07:59:42 AM DEBUG:output_dir: output
2025/03/04 07:59:42 AM DEBUG:output_dir: output
2025/03/04 07:59:42 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:59:42 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 07:59:42 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 07:59:42 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 07:59:42 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 07:59:42 AM DEBUG:app_pages_dir: app_pages
2025/03/04 07:59:42 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 07:59:42 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:59:42 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 07:59:42 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 07:59:42 AM DEBUG:perc_target: 0.5
2025/03/04 07:59:42 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:59:42 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:59:42 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 07:59:42 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:59:42 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:59:42 AM DEBUG:app_pages_dir: app_pages
2025/03/04 07:59:42 AM DEBUG:perc_target: 0.5
2025/03/04 07:59:42 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:59:42 AM DEBUG:app_pages_dir: app_pages
2025/03/04 07:59:42 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:59:42 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:59:42 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:59:42 AM DEBUG:reference_dir: reference_files
2025/03/04 07:59:42 AM DEBUG:perc_target: 0.5
2025/03/04 07:59:42 AM DEBUG:reference_dir: reference_files
2025/03/04 07:59:42 AM DEBUG:app_pages_dir: app_pages
2025/03/04 07:59:42 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 07:59:42 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:59:42 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:59:42 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:59:42 AM DEBUG:perc_target: 0.5
2025/03/04 07:59:42 AM DEBUG:app_pages_dir: app_pages
2025/03/04 07:59:42 AM DEBUG:logs_dir: logs
2025/03/04 07:59:42 AM DEBUG:reference_dir: reference_files
2025/03/04 07:59:42 AM DEBUG:logs_dir: logs
2025/03/04 07:59:42 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:59:42 AM DEBUG:perc_target: 0.5
2025/03/04 07:59:42 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 07:59:42 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:59:42 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 07:59:42 AM DEBUG:reference_dir: reference_files
2025/03/04 07:59:42 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 07:59:42 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 07:59:42 AM DEBUG:logs_dir: logs
2025/03/04 07:59:42 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 07:59:42 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:59:42 AM DEBUG:reference_dir: reference_files
2025/03/04 07:59:42 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:59:42 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 07:59:42 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:59:42 AM DEBUG:logs_dir: logs
2025/03/04 07:59:42 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 07:59:42 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 07:59:42 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 07:59:42 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 07:59:42 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 07:59:42 AM DEBUG:logs_dir: logs
2025/03/04 07:59:42 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:59:42 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:59:42 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:59:42 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 07:59:42 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 07:59:42 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 07:59:42 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 07:59:42 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 07:59:42 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:59:42 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 07:59:42 AM DEBUG:utils_dir: utils
2025/03/04 07:59:42 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:59:42 AM DEBUG:utils_dir: utils
2025/03/04 07:59:42 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 07:59:42 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 07:59:42 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:59:42 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 07:59:42 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:59:42 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:59:42 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 07:59:42 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 07:59:42 AM DEBUG:utils_dir: utils
2025/03/04 07:59:42 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 07:59:42 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 07:59:42 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:59:42 AM DEBUG:components_dir: components
2025/03/04 07:59:42 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:59:42 AM DEBUG:components_dir: components
2025/03/04 07:59:42 AM DEBUG:utils_dir: utils
2025/03/04 07:59:42 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 07:59:42 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:59:42 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 07:59:42 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:59:42 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:59:42 AM DEBUG:utils_dir: utils
2025/03/04 07:59:42 AM DEBUG:data_dir: data
2025/03/04 07:59:42 AM DEBUG:components_dir: components
2025/03/04 07:59:42 AM DEBUG:data_dir: data
2025/03/04 07:59:42 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 07:59:42 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 07:59:42 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 07:59:42 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:59:42 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 07:59:42 AM DEBUG:components_dir: components
2025/03/04 07:59:42 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 07:59:42 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:59:42 AM DEBUG:data_dir: data
2025/03/04 07:59:42 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:59:42 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:59:42 AM DEBUG:components_dir: components
2025/03/04 07:59:42 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 07:59:42 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 07:59:42 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 07:59:42 AM DEBUG:data_dir: data
2025/03/04 07:59:42 AM DEBUG:data_dir: data
2025/03/04 07:59:42 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 07:59:42 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:59:42 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 07:59:42 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 07:59:42 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 07:59:42 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:59:42 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 07:59:42 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:59:42 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:59:42 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 07:59:42 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 07:59:42 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 07:59:42 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 07:59:42 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 07:59:42 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 07:59:42 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 07:59:42 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:59:42 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 07:59:42 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 07:59:42 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 07:59:42 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:59:42 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 07:59:42 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:59:42 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:59:42 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 07:59:42 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 07:59:42 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 07:59:42 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 07:59:42 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 07:59:42 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 07:59:42 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 07:59:42 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:59:42 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 07:59:42 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 07:59:42 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 07:59:42 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 07:59:42 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 07:59:42 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 07:59:42 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:59:42 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:59:42 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:59:42 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 07:59:42 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:59:42 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 07:59:42 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 07:59:42 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:59:42 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 07:59:42 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:59:42 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 07:59:42 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 07:59:42 AM INFO:Session state Setup complete
2025/03/04 07:59:42 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:59:42 AM INFO:Session state Setup complete
2025/03/04 07:59:42 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 07:59:42 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 07:59:42 AM INFO:initialize_session_state executed successfully
2025/03/04 07:59:42 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:59:42 AM INFO:initialize_session_state executed successfully
2025/03/04 07:59:42 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:59:42 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 07:59:42 AM INFO:Package setup complete
2025/03/04 07:59:42 AM INFO:Session state Setup complete
2025/03/04 07:59:42 AM INFO:Package setup complete
2025/03/04 07:59:42 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:59:42 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 07:59:42 AM INFO:setup_package executed successfully
2025/03/04 07:59:42 AM INFO:initialize_session_state executed successfully
2025/03/04 07:59:42 AM INFO:setup_package executed successfully
2025/03/04 07:59:42 AM INFO:Session state Setup complete
2025/03/04 07:59:42 AM INFO:Session state Setup complete
2025/03/04 07:59:42 AM INFO:Package setup complete
2025/03/04 07:59:42 AM INFO:initialize_session_state executed successfully
2025/03/04 07:59:42 AM INFO:initialize_session_state executed successfully
2025/03/04 07:59:42 AM INFO:Running Menu setup...
2025/03/04 07:59:42 AM INFO:setup_package executed successfully
2025/03/04 07:59:42 AM INFO:Running Menu setup...
2025/03/04 07:59:42 AM INFO:Package setup complete
2025/03/04 07:59:42 AM INFO:Package setup complete
2025/03/04 07:59:42 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 07:59:42 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 07:59:42 AM INFO:setup_package executed successfully
2025/03/04 07:59:42 AM INFO:setup_package executed successfully
2025/03/04 07:59:42 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\app_pages',), kwargs={}
2025/03/04 07:59:42 AM INFO:Running Menu setup...
2025/03/04 07:59:42 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 07:59:42 AM INFO:Running Menu setup...
2025/03/04 07:59:42 AM INFO:Running Menu setup...
2025/03/04 07:59:42 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 07:59:42 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 07:59:42 AM INFO:get_git_version executed successfully
2025/03/04 07:59:42 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\components',), kwargs={}
2025/03/04 07:59:42 AM INFO:get_git_version executed successfully
2025/03/04 07:59:42 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 07:59:42 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 07:59:42 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 07:59:42 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 07:59:42 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 07:59:42 AM INFO:get_git_version executed successfully
2025/03/04 07:59:42 AM INFO:get_git_version executed successfully
2025/03/04 07:59:42 AM INFO:get_git_version executed successfully
2025/03/04 07:59:42 AM INFO:App Version: v20.159
2025/03/04 07:59:42 AM INFO:get_git_version executed successfully
2025/03/04 07:59:42 AM INFO:get_git_version executed successfully
2025/03/04 07:59:42 AM INFO:App Version: v20.159
2025/03/04 07:59:42 AM INFO:App Version: v20.159
2025/03/04 07:59:42 AM INFO:App Version: v20.159
2025/03/04 07:59:42 AM INFO:Switched to page: Introduction
2025/03/04 07:59:42 AM INFO:App Version: v20.159
2025/03/04 07:59:42 AM INFO:Switched to page: Introduction
2025/03/04 07:59:42 AM INFO:Switched to page: Introduction
2025/03/04 07:59:42 AM INFO:Switched to page: Introduction
2025/03/04 07:59:42 AM INFO:Switched to page: Introduction
2025/03/04 07:59:42 AM INFO:pagesetup executed successfully
2025/03/04 07:59:42 AM INFO:pagesetup executed successfully
2025/03/04 07:59:42 AM INFO:pagesetup executed successfully
2025/03/04 07:59:42 AM INFO:pagesetup executed successfully
2025/03/04 07:59:42 AM INFO:pagesetup executed successfully
2025/03/04 07:59:42 AM INFO:No data found in session state, running firstload()
2025/03/04 07:59:42 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 07:59:42 AM INFO:No data found in session state, running firstload()
2025/03/04 07:59:42 AM INFO:No data found in session state, running firstload()
2025/03/04 07:59:42 AM INFO:No data found in session state, running firstload()
2025/03/04 07:59:42 AM INFO:No data found in session state, running firstload()
2025/03/04 07:59:43 AM INFO:Running first load function.
2025/03/04 07:59:43 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 07:59:43 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x00000207100BB520>), kwargs={}
2025/03/04 07:59:43 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 07:59:43 AM DEBUG:Calling load_raw_data with args=(), kwargs={'main_file': 'raw_data', 'cleaned_file': 'raw_data_clean', 'output_csv': True, 'dedupe_donors': True, 'dedupe_regentity': True, 'originaldatafilepath': 'source_data_fname', 'processeddatafilepath': 'imported_raw_fname'}
2025/03/04 07:59:43 AM DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/04 07:59:43 AM DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/04 07:59:43 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'source\\Donations_accepted_by_political_parties.csv', 'savedfilepath': 'output\\imported_raw.csv', 'timestamp_key': 'load_raw_data_last_modified'}
2025/03/04 07:59:43 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:59:43 AM INFO:Saved file path: output\imported_raw.csv
2025/03/04 07:59:43 AM DEBUG:Calling is_file_updated with args=('source\\Donations_accepted_by_political_parties.csv', 'load_raw_data_last_modified'), kwargs={}
2025/03/04 07:59:43 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 07:59:43 AM DEBUG:Calling get_file_modification_time with args=('source\\Donations_accepted_by_political_parties.csv',), kwargs={}
2025/03/04 07:59:43 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 07:59:43 AM INFO:get_file_modification_time executed successfully
2025/03/04 07:59:43 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 07:59:43 AM INFO:Last modification time: None
2025/03/04 07:59:43 AM INFO:is_file_updated executed successfully
2025/03/04 07:59:43 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 07:59:43 AM INFO:Loading raw data...
2025/03/04 07:59:43 AM DEBUG:Original data file path post raw data load: {originaldatafilepath}
2025/03/04 07:59:43 AM DEBUG:Processed data file path post raw data load: {processeddatafilepath}
2025/03/04 07:59:43 AM INFO:Data loaded successfully. Data has 65278 rows and 29 columns
2025/03/04 07:59:44 AM INFO:Data saved to output\imported_raw.csv
2025/03/04 07:59:44 AM DEBUG:Calling raw_data_cleanup with args=(), kwargs={'loaddata_df':            ECRef              RegulatedEntityName    RegulatedEntityType        Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                               ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    1,876.56   02/09/2019  ...              NaN  86310.0             NaN  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    2,700.00   02/09/2019  ...              NaN  86310.0             NaN  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    4,852.58   30/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    2,500.00   30/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    4,524.05   29/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
...          ...                              ...                    ...          ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10,000.00          NaN  ...              NaN  74198.0             NaN            NaN         False
65274   C0242461               Vote Leave Limited  Permitted Participant  100,000.00          NaN  ...              NaN  74184.0             NaN            NaN         False
65275   C0243560               Vote Leave Limited  Permitted Participant   40,000.00          NaN  ...              NaN  74576.0             NaN            NaN         False
65276   C0319710  Conservative and Unionist Party        Political Party   50,000.00          NaN  ...              NaN  34241.0             NaN  Great Britain         False
65277   C0319727  Conservative and Unionist Party        Political Party   15,000.00          NaN  ...              NaN  74743.0             NaN  Great Britain         False

[65278 rows x 29 columns], 'dedupe_donors': True, 'dedupe_regentity': True, 'output_csv': True, 'originaldatafilepath': 'output\\imported_raw.csv', 'processeddatafilepath': 'cleaned_donations_fname'}
2025/03/04 07:59:44 AM INFO:Cleaning up raw data
2025/03/04 07:59:44 AM ERROR:Session state variables not initialized!
2025/03/04 07:59:44 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': None, 'savedfilepath': 'output\\cleaned_donations.csv', 'timestamp_key': 'cleaned_raw_data_last_modified'}
2025/03/04 07:59:44 AM INFO:Original file path: None
2025/03/04 07:59:44 AM INFO:Saved file path: output\cleaned_donations.csv
2025/03/04 07:59:44 AM ERROR:Error: originalfilepath is None!
2025/03/04 07:59:44 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 07:59:44 AM INFO:Data loaded, shape: (65278, 29)
2025/03/04 07:59:45 AM DEBUG:Calling dedupe_entity_file with args=(), kwargs={'loaddata_dd_df':            ECRef              RegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                             ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...                   86310.0                  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...                   86310.0                  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...                   86310.0                  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...                   86310.0                  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...                   86310.0                  Great Britain         False
...          ...                              ...                    ...        ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...                   74198.0                          Other         False
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                   74184.0                          Other         False
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   74576.0                          Other         False
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                   34241.0                  Great Britain         False
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                   74743.0                  Great Britain         False

[65278 rows x 29 columns], 'entity': 'RegulatedEntity', 'map_filename': 'regentity_map_fname', 'output_csv': True}
2025/03/04 07:59:45 AM DEBUG:Calling is_file_updated with args=('reference_files\\PoliticalEntityDeDuped.csv', 'regentity_map_fname_last_modified'), kwargs={}
2025/03/04 07:59:45 AM INFO:Checking if reference_files\PoliticalEntityDeDuped.csv has been updated.
2025/03/04 07:59:45 AM DEBUG:Calling get_file_modification_time with args=('reference_files\\PoliticalEntityDeDuped.csv',), kwargs={}
2025/03/04 07:59:45 AM INFO:Getting modification time for reference_files\PoliticalEntityDeDuped.csv
2025/03/04 07:59:45 AM INFO:get_file_modification_time executed successfully
2025/03/04 07:59:45 AM INFO:Current modification time: 1740841102.2638545
2025/03/04 07:59:45 AM INFO:Last modification time: None
2025/03/04 07:59:45 AM INFO:is_file_updated executed successfully
2025/03/04 07:59:45 AM INFO:Map file regentity_map_fname has been updated. Proceeding with deduplication.
2025/03/04 07:59:45 AM INFO:File deduplication complete, shape: (65278, 34)
2025/03/04 07:59:45 AM INFO:dedupe_entity_file executed successfully
2025/03/04 07:59:45 AM DEBUG:Calling dedupe_entity_file with args=(), kwargs={'loaddata_dd_df':            ECRef      OriginalRegulatedEntityName    RegulatedEntityType  ...      OriginalRegulatedEntityName RegulatedEntityId              RegulatedEntityName
0      NC0408174                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
1      NC0408173                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
2      NC0408177                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
3      NC0408176                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
4      NC0408170                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
...          ...                              ...                    ...  ...                              ...               ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65274   C0242461               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65275   C0243560               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65276   C0319710  Conservative And Unionist Party        Political Party  ...  Conservative And Unionist Party              52.0  Conservative And Unionist Party
65277   C0319727  Conservative And Unionist Party        Political Party  ...  Conservative And Unionist Party              52.0  Conservative And Unionist Party

[65278 rows x 34 columns], 'entity': 'Donor', 'map_filename': 'donor_map_fname', 'output_csv': True}
2025/03/04 07:59:45 AM DEBUG:Calling is_file_updated with args=('reference_files\\PoliticalDonorsDeduped.csv', 'donor_map_fname_last_modified'), kwargs={}
2025/03/04 07:59:45 AM INFO:Checking if reference_files\PoliticalDonorsDeduped.csv has been updated.
2025/03/04 07:59:45 AM DEBUG:Calling get_file_modification_time with args=('reference_files\\PoliticalDonorsDeduped.csv',), kwargs={}
2025/03/04 07:59:45 AM INFO:Getting modification time for reference_files\PoliticalDonorsDeduped.csv
2025/03/04 07:59:45 AM INFO:get_file_modification_time executed successfully
2025/03/04 07:59:45 AM INFO:Current modification time: 1740757863.2545311
2025/03/04 07:59:45 AM INFO:Last modification time: None
2025/03/04 07:59:45 AM INFO:is_file_updated executed successfully
2025/03/04 07:59:45 AM INFO:Map file donor_map_fname has been updated. Proceeding with deduplication.
2025/03/04 07:59:46 AM INFO:File deduplication complete, shape: (65278, 40)
2025/03/04 07:59:46 AM INFO:dedupe_entity_file executed successfully
2025/03/04 07:59:46 AM INFO:Raw Data cleanup completed
2025/03/04 07:59:46 AM INFO:Data shape: (65278, 40)
2025/03/04 07:59:47 AM INFO:Data saved to output\cleaned_donations.csv
2025/03/04 07:59:47 AM INFO:Data cleanup completed, shape: (65278, 40)
2025/03/04 07:59:47 AM INFO:raw_data_cleanup executed successfully
2025/03/04 07:59:47 AM INFO:load_raw_data executed successfully
2025/03/04 07:59:47 AM INFO:get_raw_data executed successfully
2025/03/04 07:59:47 AM INFO:load_data_to_session executed successfully
2025/03/04 07:59:47 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x00000207100BB5B0>), kwargs={}
2025/03/04 07:59:47 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 07:59:47 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 07:59:47 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'output\\cleaned_donations.csv', 'savedfilepath': 'output\\cleaned_data.csv', 'timestamp_key': 'load_raw_data_last_modified'}
2025/03/04 07:59:47 AM INFO:Original file path: output\cleaned_donations.csv
2025/03/04 07:59:47 AM INFO:Saved file path: output\cleaned_data.csv
2025/03/04 07:59:47 AM DEBUG:Calling is_file_updated with args=('output\\cleaned_donations.csv', 'load_raw_data_last_modified'), kwargs={}
2025/03/04 07:59:47 AM INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/04 07:59:47 AM DEBUG:Calling get_file_modification_time with args=('output\\cleaned_donations.csv',), kwargs={}
2025/03/04 07:59:47 AM INFO:Getting modification time for output\cleaned_donations.csv
2025/03/04 07:59:47 AM INFO:get_file_modification_time executed successfully
2025/03/04 07:59:47 AM INFO:Current modification time: 1741075187.5424786
2025/03/04 07:59:47 AM INFO:Last modification time: 1740757862.6744745
2025/03/04 07:59:47 AM INFO:is_file_updated executed successfully
2025/03/04 07:59:47 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 07:59:47 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 07:59:51 AM DEBUG:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ...                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...  ...                              ...        ...          ...           ...               ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...          Shaftesbury Investments          1         2016             4            201604
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                Mr Jeremy Hosking          1         2016             2            201602
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   Anthony Clarke          1         2016             6            201606
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                Mr Peter A Dubens          1         2017             5            201705
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                 Mr Ravi S Kailas          1         2017             5            201705

[65278 rows x 44 columns],), kwargs={}
2025/03/04 07:59:51 AM DEBUG:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/04 07:59:51 AM DEBUG:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/04 07:59:51 AM DEBUG:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 07:59:51 AM DEBUG:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/04 07:59:51 AM DEBUG:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 07:59:51 AM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/04 07:59:51 AM ERROR:Attempting to remove duplicates
2025/03/04 07:59:51 AM DEBUG:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 46 columns]
2025/03/04 07:59:51 AM DEBUG:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/04 07:59:51 AM INFO:Data Updated with PartyName and PartyId successfully
2025/03/04 07:59:51 AM INFO:map_mp_to_party executed successfully
2025/03/04 07:59:51 AM DEBUG:Calling load_election_dates with args=(), kwargs={}
2025/03/04 07:59:51 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'source\\Donations_accepted_by_political_parties.csv', 'savedfilepath': 'reference_files\\elections.csv', 'timestamp_key': 'election_dates_last_modified'}
2025/03/04 07:59:51 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 07:59:51 AM INFO:Saved file path: reference_files\elections.csv
2025/03/04 07:59:51 AM DEBUG:Calling is_file_updated with args=('source\\Donations_accepted_by_political_parties.csv', 'election_dates_last_modified'), kwargs={}
2025/03/04 07:59:51 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 07:59:51 AM DEBUG:Calling get_file_modification_time with args=('source\\Donations_accepted_by_political_parties.csv',), kwargs={}
2025/03/04 07:59:51 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 07:59:51 AM INFO:get_file_modification_time executed successfully
2025/03/04 07:59:51 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 07:59:51 AM INFO:Last modification time: None
2025/03/04 07:59:51 AM INFO:is_file_updated executed successfully
2025/03/04 07:59:51 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 07:59:51 AM INFO:Election dates loaded from file.
2025/03/04 07:59:51 AM INFO:Election_dates_df empty - loading from pdpy.
2025/03/04 07:59:51 AM ERROR:Error in load_election_dates: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 07:59:51 AM ERROR:Error in load_cleaned_data: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 07:59:51 AM ERROR:Error in get_cleaned_data: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 07:59:52 AM ERROR:Error in load_data_to_session: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 07:59:52 AM ERROR:Error in firstload: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 07:59:52 AM ERROR:Error in initialise_data: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 42, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 07:59:52 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 07:59:52 AM INFO:Running first load function.
2025/03/04 07:59:52 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 07:59:52 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x00000207100BB520>), kwargs={}
2025/03/04 07:59:52 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 07:59:52 AM INFO:get_raw_data executed successfully
2025/03/04 07:59:52 AM INFO:load_data_to_session executed successfully
2025/03/04 07:59:52 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x00000207100BB5B0>), kwargs={}
2025/03/04 07:59:52 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 07:59:52 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 07:59:52 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 07:59:55 AM DEBUG:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ...                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...  ...                              ...        ...          ...           ...               ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...          Shaftesbury Investments          1         2016             4            201604
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                Mr Jeremy Hosking          1         2016             2            201602
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   Anthony Clarke          1         2016             6            201606
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                Mr Peter A Dubens          1         2017             5            201705
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                 Mr Ravi S Kailas          1         2017             5            201705

[65278 rows x 44 columns],), kwargs={}
2025/03/04 07:59:55 AM DEBUG:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/04 07:59:55 AM DEBUG:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/04 07:59:55 AM DEBUG:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 07:59:55 AM DEBUG:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/04 07:59:55 AM DEBUG:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 07:59:55 AM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/04 07:59:55 AM ERROR:Attempting to remove duplicates
2025/03/04 07:59:55 AM DEBUG:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 46 columns]
2025/03/04 07:59:55 AM DEBUG:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/04 07:59:55 AM INFO:Data Updated with PartyName and PartyId successfully
2025/03/04 07:59:55 AM INFO:map_mp_to_party executed successfully
2025/03/04 07:59:56 AM DEBUG:Calling load_election_dates with args=(), kwargs={}
2025/03/04 07:59:56 AM INFO:Election dates loaded from file.
2025/03/04 07:59:56 AM INFO:Election_dates_df empty - loading from pdpy.
2025/03/04 07:59:56 AM ERROR:Error in load_election_dates: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 07:59:56 AM ERROR:Error in load_cleaned_data: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 07:59:56 AM ERROR:Error in get_cleaned_data: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 07:59:56 AM ERROR:Error in load_data_to_session: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 07:59:56 AM ERROR:Error in firstload: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 07:59:56 AM ERROR:Error in initialise_data: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 42, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 07:59:56 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 07:59:56 AM INFO:Running first load function.
2025/03/04 07:59:56 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 07:59:56 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x00000207100BB520>), kwargs={}
2025/03/04 07:59:56 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 07:59:56 AM INFO:get_raw_data executed successfully
2025/03/04 07:59:56 AM INFO:load_data_to_session executed successfully
2025/03/04 07:59:56 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x00000207100BB5B0>), kwargs={}
2025/03/04 07:59:56 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 07:59:56 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 07:59:56 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 07:59:59 AM DEBUG:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ...                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...  ...                              ...        ...          ...           ...               ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...          Shaftesbury Investments          1         2016             4            201604
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                Mr Jeremy Hosking          1         2016             2            201602
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   Anthony Clarke          1         2016             6            201606
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                Mr Peter A Dubens          1         2017             5            201705
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                 Mr Ravi S Kailas          1         2017             5            201705

[65278 rows x 44 columns],), kwargs={}
2025/03/04 07:59:59 AM DEBUG:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/04 07:59:59 AM DEBUG:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/04 07:59:59 AM DEBUG:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 07:59:59 AM DEBUG:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/04 07:59:59 AM DEBUG:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 07:59:59 AM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/04 07:59:59 AM ERROR:Attempting to remove duplicates
2025/03/04 07:59:59 AM DEBUG:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 46 columns]
2025/03/04 07:59:59 AM DEBUG:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/04 07:59:59 AM INFO:Data Updated with PartyName and PartyId successfully
2025/03/04 07:59:59 AM INFO:map_mp_to_party executed successfully
2025/03/04 08:00:00 AM DEBUG:Calling load_election_dates with args=(), kwargs={}
2025/03/04 08:00:00 AM INFO:Election dates loaded from file.
2025/03/04 08:00:00 AM INFO:Election_dates_df empty - loading from pdpy.
2025/03/04 08:00:00 AM ERROR:Error in load_election_dates: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 08:00:00 AM ERROR:Error in load_cleaned_data: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 08:00:00 AM ERROR:Error in get_cleaned_data: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 08:00:00 AM ERROR:Error in load_data_to_session: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 08:00:00 AM ERROR:Error in firstload: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 08:00:00 AM ERROR:Error in initialise_data: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 42, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 08:00:00 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 08:00:00 AM INFO:Running first load function.
2025/03/04 08:00:00 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 08:00:00 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x00000207100BB520>), kwargs={}
2025/03/04 08:00:00 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 08:00:00 AM INFO:get_raw_data executed successfully
2025/03/04 08:00:00 AM INFO:load_data_to_session executed successfully
2025/03/04 08:00:00 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x00000207100BB5B0>), kwargs={}
2025/03/04 08:00:00 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 08:00:00 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 08:00:00 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 08:00:04 AM DEBUG:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ...                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...  ...                              ...        ...          ...           ...               ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...          Shaftesbury Investments          1         2016             4            201604
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                Mr Jeremy Hosking          1         2016             2            201602
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   Anthony Clarke          1         2016             6            201606
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                Mr Peter A Dubens          1         2017             5            201705
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                 Mr Ravi S Kailas          1         2017             5            201705

[65278 rows x 44 columns],), kwargs={}
2025/03/04 08:00:04 AM DEBUG:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/04 08:00:04 AM DEBUG:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/04 08:00:04 AM DEBUG:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 08:00:04 AM DEBUG:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/04 08:00:04 AM DEBUG:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 08:00:05 AM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/04 08:00:05 AM ERROR:Attempting to remove duplicates
2025/03/04 08:00:05 AM DEBUG:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 46 columns]
2025/03/04 08:00:05 AM DEBUG:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/04 08:00:05 AM INFO:Data Updated with PartyName and PartyId successfully
2025/03/04 08:00:05 AM INFO:map_mp_to_party executed successfully
2025/03/04 08:00:05 AM DEBUG:Calling load_election_dates with args=(), kwargs={}
2025/03/04 08:00:05 AM INFO:Election dates loaded from file.
2025/03/04 08:00:05 AM INFO:Election_dates_df empty - loading from pdpy.
2025/03/04 08:00:05 AM ERROR:Error in load_election_dates: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 08:00:05 AM ERROR:Error in load_cleaned_data: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 08:00:05 AM ERROR:Error in get_cleaned_data: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 08:00:05 AM ERROR:Error in load_data_to_session: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 08:00:05 AM ERROR:Error in firstload: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 08:00:05 AM ERROR:Error in initialise_data: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 42, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 08:00:05 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 08:00:05 AM INFO:Running first load function.
2025/03/04 08:00:05 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 08:00:05 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x00000207100BB520>), kwargs={}
2025/03/04 08:00:05 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 08:00:05 AM INFO:get_raw_data executed successfully
2025/03/04 08:00:05 AM INFO:load_data_to_session executed successfully
2025/03/04 08:00:05 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x00000207100BB5B0>), kwargs={}
2025/03/04 08:00:05 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 08:00:05 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 08:00:05 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 08:00:09 AM DEBUG:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ...                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...  ...                              ...        ...          ...           ...               ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...          Shaftesbury Investments          1         2016             4            201604
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                Mr Jeremy Hosking          1         2016             2            201602
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   Anthony Clarke          1         2016             6            201606
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                Mr Peter A Dubens          1         2017             5            201705
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                 Mr Ravi S Kailas          1         2017             5            201705

[65278 rows x 44 columns],), kwargs={}
2025/03/04 08:00:09 AM DEBUG:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/04 08:00:09 AM DEBUG:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/04 08:00:09 AM DEBUG:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 08:00:09 AM DEBUG:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/04 08:00:09 AM DEBUG:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 08:00:09 AM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/04 08:00:09 AM ERROR:Attempting to remove duplicates
2025/03/04 08:00:09 AM DEBUG:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 46 columns]
2025/03/04 08:00:09 AM DEBUG:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/04 08:00:09 AM INFO:Data Updated with PartyName and PartyId successfully
2025/03/04 08:00:09 AM INFO:map_mp_to_party executed successfully
2025/03/04 08:00:10 AM DEBUG:Calling load_election_dates with args=(), kwargs={}
2025/03/04 08:00:10 AM INFO:Election dates loaded from file.
2025/03/04 08:00:10 AM INFO:Election_dates_df empty - loading from pdpy.
2025/03/04 08:00:10 AM ERROR:Error in load_election_dates: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 08:00:10 AM ERROR:Error in load_cleaned_data: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 08:00:10 AM ERROR:Error in get_cleaned_data: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 08:00:10 AM ERROR:Error in load_data_to_session: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 08:00:10 AM ERROR:Error in firstload: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 08:00:10 AM ERROR:Error in initialise_data: name 'election_dict' is not defined
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 42, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 89, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 37, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 302, in load_cleaned_data
    load_election_dates()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\GenElectionRelationship.py", line 29, in load_election_dates
    ElectionDates_dict = get_general_elections_dict()
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 95, in get_general_elections_dict
    election_dates.apply(add_row, axis=1)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
  File "H:\python310\lib\site-packages\pdpy\elections.py", line 100, in add_row
    election_dict[row['name']] = {
NameError: name 'election_dict' is not defined
2025/03/04 08:01:04 AM INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/04 08:01:04 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\utils',), kwargs={}
2025/03/04 08:01:05 AM INFO:get_git_version executed successfully
2025/03/04 08:01:06 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\data',), kwargs={}
2025/03/04 08:01:06 AM INFO:get_git_version executed successfully
2025/03/04 08:01:06 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM INFO:Running App setup...
2025/03/04 08:01:06 AM INFO:Running App setup...
2025/03/04 08:01:06 AM INFO:Running App setup...
2025/03/04 08:01:06 AM INFO:Running App setup...
2025/03/04 08:01:06 AM INFO:Running App setup...
2025/03/04 08:01:06 AM INFO:Running App setup...
2025/03/04 08:01:06 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:01:06 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:01:06 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:01:06 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:01:06 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:01:06 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:01:06 AM INFO:Setting up the package
2025/03/04 08:01:06 AM INFO:Setting up the package
2025/03/04 08:01:06 AM INFO:Setting up the package
2025/03/04 08:01:06 AM INFO:Setting up the package
2025/03/04 08:01:06 AM INFO:Setting up the package
2025/03/04 08:01:06 AM INFO:Setting up the package
2025/03/04 08:01:06 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:01:06 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:01:06 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:01:06 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:01:06 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:01:06 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:01:06 AM INFO:get_git_version executed successfully
2025/03/04 08:01:06 AM INFO:get_git_version executed successfully
2025/03/04 08:01:06 AM INFO:get_git_version executed successfully
2025/03/04 08:01:06 AM INFO:get_git_version executed successfully
2025/03/04 08:01:06 AM INFO:Version: v20.138
2025/03/04 08:01:06 AM INFO:get_git_version executed successfully
2025/03/04 08:01:06 AM INFO:get_git_version executed successfully
2025/03/04 08:01:06 AM INFO:Version: v20.138
2025/03/04 08:01:06 AM INFO:Version: v20.138
2025/03/04 08:01:06 AM INFO:Version: v20.138
2025/03/04 08:01:06 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:01:06 AM INFO:Version: v20.138
2025/03/04 08:01:06 AM INFO:Version: v20.138
2025/03/04 08:01:06 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:01:06 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:01:06 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:01:06 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:01:06 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:01:06 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:01:06 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:01:06 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:01:06 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:01:06 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:01:06 AM DEBUG:Initialised LOG_LEVEL with value: DEBUG
2025/03/04 08:01:06 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:01:06 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:01:06 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:01:06 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:01:06 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:01:06 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:01:06 AM DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:01:06 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:01:06 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:01:06 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:01:06 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:01:06 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:01:06 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:01:06 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:01:06 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:01:06 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:01:06 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:01:06 AM DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 08:01:06 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:01:06 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:01:06 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:01:06 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:01:06 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:01:06 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:01:06 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:01:06 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:01:06 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:01:06 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:01:06 AM DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 08:01:06 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:01:06 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:01:06 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:01:06 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:01:06 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:01:06 AM DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:01:06 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:01:06 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:01:06 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:01:06 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:01:06 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:01:06 AM DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:01:06 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:01:06 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:01:06 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:01:06 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:01:06 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:01:06 AM DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:01:06 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:01:06 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:01:06 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:01:06 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:01:06 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:01:06 AM DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:01:06 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:01:06 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:01:06 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:01:06 AM DEBUG:Initialised perc_target with value: 0.5
2025/03/04 08:01:06 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:01:06 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:01:06 AM DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 08:01:06 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:01:06 AM DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:01:06 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:01:06 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:01:06 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:01:06 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:01:06 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:01:06 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:01:06 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:01:06 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:01:06 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:01:06 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:01:06 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:01:06 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:01:06 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:01:06 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:01:06 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:01:06 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:01:06 AM DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 08:01:06 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:01:06 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:01:06 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:01:06 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:01:06 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:01:06 AM DEBUG:Initialised data_dir with value: data
2025/03/04 08:01:06 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:01:06 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:01:06 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:01:06 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:01:06 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:01:06 AM DEBUG:Initialised output_dir with value: output
2025/03/04 08:01:06 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:01:06 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:01:06 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:01:06 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:01:06 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:01:06 AM DEBUG:Initialised logs_dir with value: logs
2025/03/04 08:01:06 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:01:06 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:01:06 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:01:06 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:01:06 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:01:06 AM DEBUG:Initialised components_dir with value: components
2025/03/04 08:01:06 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:01:06 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:01:06 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:01:06 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:01:06 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:01:06 AM DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 08:01:06 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:01:06 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:01:06 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:01:06 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:01:06 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:01:06 AM DEBUG:Initialised utils_dir with value: utils
2025/03/04 08:01:06 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:01:06 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:01:06 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:01:06 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:01:06 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:01:06 AM DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:01:06 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:01:06 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:01:06 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:01:06 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:01:06 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:01:06 AM DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:01:06 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:01:06 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:01:06 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:01:06 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:01:06 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:01:06 AM DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 08:01:06 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:01:06 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:01:06 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:01:06 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:01:06 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:01:06 AM DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:01:06 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:01:06 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:01:06 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:01:06 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:01:06 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:01:06 AM DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:01:06 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:01:06 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:01:06 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:01:06 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:01:06 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:01:06 AM DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:01:06 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:01:06 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:01:06 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:01:06 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:01:06 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:01:06 AM DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 08:01:06 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:01:06 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:01:06 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:01:06 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:01:06 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:01:06 AM DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 08:01:06 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:01:06 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:01:06 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:01:06 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:01:06 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:01:06 AM DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 08:01:06 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:01:06 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:01:06 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:01:06 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:01:06 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:01:06 AM DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 08:01:06 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:01:06 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:01:06 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:01:06 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:01:06 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:01:06 AM DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 08:01:06 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:01:06 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:01:06 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:01:06 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:01:06 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:01:06 AM DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 08:01:06 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:01:06 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:01:06 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:01:06 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:01:06 AM INFO:Session_state variables initialized
2025/03/04 08:01:06 AM DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 08:01:06 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:01:06 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:01:06 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:01:06 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:01:06 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:01:06 AM DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 08:01:06 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:01:06 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:01:06 AM INFO:Session_state variables initialized
2025/03/04 08:01:06 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:01:06 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:01:06 AM DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 08:01:06 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:01:06 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:01:06 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:01:06 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:01:06 AM DEBUG:data_dir: data
2025/03/04 08:01:06 AM DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 08:01:06 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:01:06 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:01:06 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:01:06 AM INFO:Session_state variables initialized
2025/03/04 08:01:06 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:01:06 AM DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:01:06 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:01:06 AM INFO:Session_state variables initialized
2025/03/04 08:01:06 AM DEBUG:data_dir: data
2025/03/04 08:01:06 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:01:06 AM DEBUG:output_dir: output
2025/03/04 08:01:06 AM DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 08:01:06 AM INFO:Session_state variables initialized
2025/03/04 08:01:06 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:01:06 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:01:06 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:01:06 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:01:06 AM INFO:Session_state variables initialized
2025/03/04 08:01:06 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:01:06 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:01:06 AM DEBUG:output_dir: output
2025/03/04 08:01:06 AM DEBUG:data_dir: data
2025/03/04 08:01:06 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:01:06 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:01:06 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:01:06 AM DEBUG:data_dir: data
2025/03/04 08:01:06 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:01:06 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:01:06 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:01:06 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:01:06 AM DEBUG:data_dir: data
2025/03/04 08:01:06 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:01:06 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:01:06 AM DEBUG:output_dir: output
2025/03/04 08:01:06 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:01:06 AM DEBUG:data_dir: data
2025/03/04 08:01:06 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:01:06 AM DEBUG:output_dir: output
2025/03/04 08:01:06 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:01:06 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:01:06 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:01:06 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:01:06 AM DEBUG:output_dir: output
2025/03/04 08:01:06 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:01:06 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:01:06 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:01:06 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM DEBUG:output_dir: output
2025/03/04 08:01:06 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:01:06 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:01:06 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:01:06 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:01:06 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:01:06 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:01:06 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:01:06 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:01:06 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:01:06 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:01:06 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:01:06 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:01:06 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:01:06 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:01:06 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:01:06 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:01:06 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:01:06 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:01:06 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:01:06 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:01:06 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:01:06 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:01:06 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:01:06 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:01:06 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:01:06 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:01:06 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:01:06 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:01:06 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:01:06 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:01:06 AM DEBUG:utils_dir: utils
2025/03/04 08:01:06 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:01:06 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:01:06 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:01:06 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:01:06 AM DEBUG:utils_dir: utils
2025/03/04 08:01:06 AM DEBUG:reference_dir: reference_files
2025/03/04 08:01:06 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:01:06 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:01:06 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:01:06 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:01:06 AM DEBUG:reference_dir: reference_files
2025/03/04 08:01:06 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:01:06 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:01:06 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:01:06 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:01:06 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:01:06 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:01:06 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:01:06 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:01:06 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:01:06 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:01:06 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:01:06 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:01:06 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:01:06 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:01:06 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:01:06 AM DEBUG:utils_dir: utils
2025/03/04 08:01:06 AM DEBUG:utils_dir: utils
2025/03/04 08:01:06 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:01:06 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:01:06 AM DEBUG:logs_dir: logs
2025/03/04 08:01:06 AM DEBUG:utils_dir: utils
2025/03/04 08:01:06 AM DEBUG:reference_dir: reference_files
2025/03/04 08:01:06 AM DEBUG:reference_dir: reference_files
2025/03/04 08:01:06 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:01:06 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:01:06 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:01:06 AM DEBUG:reference_dir: reference_files
2025/03/04 08:01:06 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:01:06 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:01:06 AM DEBUG:logs_dir: logs
2025/03/04 08:01:06 AM DEBUG:utils_dir: utils
2025/03/04 08:01:06 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:01:06 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:01:06 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:01:06 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:01:06 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:01:06 AM DEBUG:reference_dir: reference_files
2025/03/04 08:01:06 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:01:06 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:01:06 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:01:06 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:01:06 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:01:06 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:01:06 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:01:06 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:01:06 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:01:06 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:01:06 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:01:06 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:01:06 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:01:06 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:01:06 AM DEBUG:logs_dir: logs
2025/03/04 08:01:06 AM DEBUG:logs_dir: logs
2025/03/04 08:01:06 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:01:06 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:01:06 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:01:06 AM DEBUG:logs_dir: logs
2025/03/04 08:01:06 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:01:06 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:01:06 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:01:06 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:01:06 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:01:06 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:01:06 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:01:06 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:01:06 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:01:06 AM DEBUG:logs_dir: logs
2025/03/04 08:01:06 AM DEBUG:components_dir: components
2025/03/04 08:01:06 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:01:06 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:01:06 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:01:06 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:01:06 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:01:06 AM DEBUG:perc_target: 0.5
2025/03/04 08:01:06 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:01:06 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:01:06 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:01:06 AM DEBUG:components_dir: components
2025/03/04 08:01:06 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:01:06 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:01:06 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:01:06 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:01:06 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:01:06 AM DEBUG:perc_target: 0.5
2025/03/04 08:01:06 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:01:06 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:01:06 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:01:06 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:01:06 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:01:06 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:01:06 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:01:06 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:01:06 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:01:06 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:01:06 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:01:06 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:01:06 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:01:06 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:01:06 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:01:06 AM DEBUG:components_dir: components
2025/03/04 08:01:06 AM DEBUG:components_dir: components
2025/03/04 08:01:06 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:01:06 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:01:06 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:01:06 AM DEBUG:components_dir: components
2025/03/04 08:01:06 AM DEBUG:perc_target: 0.5
2025/03/04 08:01:06 AM DEBUG:perc_target: 0.5
2025/03/04 08:01:06 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:01:06 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:01:06 AM INFO:Session state Setup complete
2025/03/04 08:01:06 AM DEBUG:perc_target: 0.5
2025/03/04 08:01:06 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:01:06 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:01:06 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:01:06 AM DEBUG:components_dir: components
2025/03/04 08:01:06 AM INFO:initialize_session_state executed successfully
2025/03/04 08:01:06 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:01:06 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:01:06 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:01:06 AM INFO:Session state Setup complete
2025/03/04 08:01:06 AM DEBUG:perc_target: 0.5
2025/03/04 08:01:06 AM INFO:Package setup complete
2025/03/04 08:01:06 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:01:06 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:01:06 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:01:06 AM INFO:initialize_session_state executed successfully
2025/03/04 08:01:06 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:01:06 AM INFO:setup_package executed successfully
2025/03/04 08:01:06 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:01:06 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:01:06 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:01:06 AM INFO:Package setup complete
2025/03/04 08:01:06 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:01:06 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:01:06 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:01:06 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:01:06 AM INFO:setup_package executed successfully
2025/03/04 08:01:06 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:01:06 AM INFO:Running Menu setup...
2025/03/04 08:01:06 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:01:06 AM INFO:Session state Setup complete
2025/03/04 08:01:06 AM INFO:Session state Setup complete
2025/03/04 08:01:06 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:01:06 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:01:06 AM INFO:Session state Setup complete
2025/03/04 08:01:06 AM INFO:initialize_session_state executed successfully
2025/03/04 08:01:06 AM INFO:initialize_session_state executed successfully
2025/03/04 08:01:06 AM INFO:Running Menu setup...
2025/03/04 08:01:06 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:01:06 AM INFO:initialize_session_state executed successfully
2025/03/04 08:01:06 AM INFO:Package setup complete
2025/03/04 08:01:06 AM INFO:Package setup complete
2025/03/04 08:01:06 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:01:06 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\app_pages',), kwargs={}
2025/03/04 08:01:06 AM INFO:Session state Setup complete
2025/03/04 08:01:06 AM INFO:Package setup complete
2025/03/04 08:01:06 AM INFO:setup_package executed successfully
2025/03/04 08:01:06 AM INFO:setup_package executed successfully
2025/03/04 08:01:06 AM INFO:initialize_session_state executed successfully
2025/03/04 08:01:06 AM INFO:setup_package executed successfully
2025/03/04 08:01:06 AM INFO:Package setup complete
2025/03/04 08:01:06 AM INFO:Running Menu setup...
2025/03/04 08:01:06 AM INFO:Running Menu setup...
2025/03/04 08:01:06 AM INFO:setup_package executed successfully
2025/03/04 08:01:06 AM INFO:Running Menu setup...
2025/03/04 08:01:06 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:01:06 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:01:06 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:01:06 AM INFO:Running Menu setup...
2025/03/04 08:01:06 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:01:06 AM INFO:get_git_version executed successfully
2025/03/04 08:01:06 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\components',), kwargs={}
2025/03/04 08:01:06 AM INFO:get_git_version executed successfully
2025/03/04 08:01:07 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:01:07 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:01:07 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:01:07 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:01:07 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:01:07 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:01:07 AM INFO:get_git_version executed successfully
2025/03/04 08:01:07 AM INFO:get_git_version executed successfully
2025/03/04 08:01:07 AM INFO:App Version: v20.159
2025/03/04 08:01:07 AM INFO:get_git_version executed successfully
2025/03/04 08:01:07 AM INFO:get_git_version executed successfully
2025/03/04 08:01:07 AM INFO:App Version: v20.159
2025/03/04 08:01:07 AM INFO:get_git_version executed successfully
2025/03/04 08:01:07 AM INFO:get_git_version executed successfully
2025/03/04 08:01:07 AM INFO:Switched to page: Introduction
2025/03/04 08:01:07 AM INFO:App Version: v20.159
2025/03/04 08:01:07 AM INFO:App Version: v20.159
2025/03/04 08:01:07 AM INFO:App Version: v20.159
2025/03/04 08:01:07 AM INFO:Switched to page: Introduction
2025/03/04 08:01:07 AM INFO:App Version: v20.159
2025/03/04 08:01:07 AM INFO:Switched to page: Introduction
2025/03/04 08:01:07 AM INFO:Switched to page: Introduction
2025/03/04 08:01:07 AM INFO:Switched to page: Introduction
2025/03/04 08:01:07 AM INFO:Switched to page: Introduction
2025/03/04 08:01:07 AM INFO:pagesetup executed successfully
2025/03/04 08:01:07 AM INFO:pagesetup executed successfully
2025/03/04 08:01:07 AM INFO:pagesetup executed successfully
2025/03/04 08:01:07 AM INFO:pagesetup executed successfully
2025/03/04 08:01:07 AM INFO:pagesetup executed successfully
2025/03/04 08:01:07 AM INFO:pagesetup executed successfully
2025/03/04 08:01:07 AM INFO:No data found in session state, running firstload()
2025/03/04 08:01:07 AM DEBUG:Calling initialise_data with args=(), kwargs={}
2025/03/04 08:01:07 AM INFO:No data found in session state, running firstload()
2025/03/04 08:01:07 AM INFO:No data found in session state, running firstload()
2025/03/04 08:01:07 AM INFO:No data found in session state, running firstload()
2025/03/04 08:01:07 AM INFO:No data found in session state, running firstload()
2025/03/04 08:01:07 AM INFO:No data found in session state, running firstload()
2025/03/04 08:01:07 AM INFO:Running first load function.
2025/03/04 08:01:07 AM DEBUG:Calling firstload with args=(), kwargs={}
2025/03/04 08:01:07 AM DEBUG:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x0000017BCCF8BAC0>), kwargs={}
2025/03/04 08:01:07 AM DEBUG:Calling get_raw_data with args=(), kwargs={}
2025/03/04 08:01:07 AM DEBUG:Calling load_raw_data with args=(), kwargs={'main_file': 'raw_data', 'cleaned_file': 'raw_data_clean', 'output_csv': True, 'dedupe_donors': True, 'dedupe_regentity': True, 'originaldatafilepath': 'source_data_fname', 'processeddatafilepath': 'imported_raw_fname'}
2025/03/04 08:01:07 AM DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/04 08:01:07 AM DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/04 08:01:07 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'source\\Donations_accepted_by_political_parties.csv', 'savedfilepath': 'output\\imported_raw.csv', 'timestamp_key': 'load_raw_data_last_modified'}
2025/03/04 08:01:07 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:01:07 AM INFO:Saved file path: output\imported_raw.csv
2025/03/04 08:01:07 AM DEBUG:Calling is_file_updated with args=('source\\Donations_accepted_by_political_parties.csv', 'load_raw_data_last_modified'), kwargs={}
2025/03/04 08:01:07 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 08:01:07 AM DEBUG:Calling get_file_modification_time with args=('source\\Donations_accepted_by_political_parties.csv',), kwargs={}
2025/03/04 08:01:07 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 08:01:07 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:01:07 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 08:01:07 AM INFO:Last modification time: None
2025/03/04 08:01:07 AM INFO:is_file_updated executed successfully
2025/03/04 08:01:07 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:01:07 AM INFO:Loading raw data...
2025/03/04 08:01:07 AM DEBUG:Original data file path post raw data load: {originaldatafilepath}
2025/03/04 08:01:07 AM DEBUG:Processed data file path post raw data load: {processeddatafilepath}
2025/03/04 08:01:07 AM INFO:Data loaded successfully. Data has 65278 rows and 29 columns
2025/03/04 08:01:08 AM INFO:Data saved to output\imported_raw.csv
2025/03/04 08:01:08 AM DEBUG:Calling raw_data_cleanup with args=(), kwargs={'loaddata_df':            ECRef              RegulatedEntityName    RegulatedEntityType        Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                               ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    1,876.56   02/09/2019  ...              NaN  86310.0             NaN  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    2,700.00   02/09/2019  ...              NaN  86310.0             NaN  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    4,852.58   30/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    2,500.00   30/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    4,524.05   29/08/2019  ...              NaN  86310.0             NaN  Great Britain         False
...          ...                              ...                    ...          ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10,000.00          NaN  ...              NaN  74198.0             NaN            NaN         False
65274   C0242461               Vote Leave Limited  Permitted Participant  100,000.00          NaN  ...              NaN  74184.0             NaN            NaN         False
65275   C0243560               Vote Leave Limited  Permitted Participant   40,000.00          NaN  ...              NaN  74576.0             NaN            NaN         False
65276   C0319710  Conservative and Unionist Party        Political Party   50,000.00          NaN  ...              NaN  34241.0             NaN  Great Britain         False
65277   C0319727  Conservative and Unionist Party        Political Party   15,000.00          NaN  ...              NaN  74743.0             NaN  Great Britain         False

[65278 rows x 29 columns], 'dedupe_donors': True, 'dedupe_regentity': True, 'output_csv': True, 'originaldatafilepath': 'output\\imported_raw.csv', 'processeddatafilepath': 'cleaned_donations_fname'}
2025/03/04 08:01:08 AM INFO:Cleaning up raw data
2025/03/04 08:01:08 AM ERROR:Session state variables not initialized!
2025/03/04 08:01:08 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': None, 'savedfilepath': 'output\\cleaned_donations.csv', 'timestamp_key': 'cleaned_raw_data_last_modified'}
2025/03/04 08:01:08 AM INFO:Original file path: None
2025/03/04 08:01:08 AM INFO:Saved file path: output\cleaned_donations.csv
2025/03/04 08:01:08 AM ERROR:Error: originalfilepath is None!
2025/03/04 08:01:08 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:01:08 AM INFO:Data loaded, shape: (65278, 29)
2025/03/04 08:01:10 AM DEBUG:Calling dedupe_entity_file with args=(), kwargs={'loaddata_dd_df':            ECRef              RegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ... AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                             ...                                                                       
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...                   86310.0                  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...                   86310.0                  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...                   86310.0                  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...                   86310.0                  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...                   86310.0                  Great Britain         False
...          ...                              ...                    ...        ...          ...  ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...                   74198.0                          Other         False
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                   74184.0                          Other         False
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   74576.0                          Other         False
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                   34241.0                  Great Britain         False
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                   74743.0                  Great Britain         False

[65278 rows x 29 columns], 'entity': 'RegulatedEntity', 'map_filename': 'regentity_map_fname', 'output_csv': True}
2025/03/04 08:01:10 AM DEBUG:Calling is_file_updated with args=('reference_files\\PoliticalEntityDeDuped.csv', 'regentity_map_fname_last_modified'), kwargs={}
2025/03/04 08:01:10 AM INFO:Checking if reference_files\PoliticalEntityDeDuped.csv has been updated.
2025/03/04 08:01:10 AM DEBUG:Calling get_file_modification_time with args=('reference_files\\PoliticalEntityDeDuped.csv',), kwargs={}
2025/03/04 08:01:10 AM INFO:Getting modification time for reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:01:10 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:01:10 AM INFO:Current modification time: 1740841102.2638545
2025/03/04 08:01:10 AM INFO:Last modification time: None
2025/03/04 08:01:10 AM INFO:is_file_updated executed successfully
2025/03/04 08:01:10 AM INFO:Map file regentity_map_fname has been updated. Proceeding with deduplication.
2025/03/04 08:01:10 AM INFO:File deduplication complete, shape: (65278, 34)
2025/03/04 08:01:10 AM INFO:dedupe_entity_file executed successfully
2025/03/04 08:01:10 AM DEBUG:Calling dedupe_entity_file with args=(), kwargs={'loaddata_dd_df':            ECRef      OriginalRegulatedEntityName    RegulatedEntityType  ...      OriginalRegulatedEntityName RegulatedEntityId              RegulatedEntityName
0      NC0408174                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
1      NC0408173                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
2      NC0408177                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
3      NC0408176                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
4      NC0408170                   Mr Andy Street        Regulated Donee  ...                      Andy Street            8015.0                      Andy Street
...          ...                              ...                    ...  ...                              ...               ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65274   C0242461               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65275   C0243560               Vote Leave Limited  Permitted Participant  ...               Vote Leave Limited            3945.0               Vote Leave Limited
65276   C0319710  Conservative And Unionist Party        Political Party  ...  Conservative And Unionist Party              52.0  Conservative And Unionist Party
65277   C0319727  Conservative And Unionist Party        Political Party  ...  Conservative And Unionist Party              52.0  Conservative And Unionist Party

[65278 rows x 34 columns], 'entity': 'Donor', 'map_filename': 'donor_map_fname', 'output_csv': True}
2025/03/04 08:01:10 AM DEBUG:Calling is_file_updated with args=('reference_files\\PoliticalDonorsDeduped.csv', 'donor_map_fname_last_modified'), kwargs={}
2025/03/04 08:01:10 AM INFO:Checking if reference_files\PoliticalDonorsDeduped.csv has been updated.
2025/03/04 08:01:10 AM DEBUG:Calling get_file_modification_time with args=('reference_files\\PoliticalDonorsDeduped.csv',), kwargs={}
2025/03/04 08:01:10 AM INFO:Getting modification time for reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:01:10 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:01:10 AM INFO:Current modification time: 1740757863.2545311
2025/03/04 08:01:10 AM INFO:Last modification time: None
2025/03/04 08:01:10 AM INFO:is_file_updated executed successfully
2025/03/04 08:01:10 AM INFO:Map file donor_map_fname has been updated. Proceeding with deduplication.
2025/03/04 08:01:10 AM INFO:File deduplication complete, shape: (65278, 40)
2025/03/04 08:01:10 AM INFO:dedupe_entity_file executed successfully
2025/03/04 08:01:10 AM INFO:Raw Data cleanup completed
2025/03/04 08:01:10 AM INFO:Data shape: (65278, 40)
2025/03/04 08:01:11 AM INFO:Data saved to output\cleaned_donations.csv
2025/03/04 08:01:11 AM INFO:Data cleanup completed, shape: (65278, 40)
2025/03/04 08:01:11 AM INFO:raw_data_cleanup executed successfully
2025/03/04 08:01:12 AM INFO:load_raw_data executed successfully
2025/03/04 08:01:12 AM INFO:get_raw_data executed successfully
2025/03/04 08:01:12 AM INFO:load_data_to_session executed successfully
2025/03/04 08:01:12 AM DEBUG:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x0000017BCCF8BB50>), kwargs={}
2025/03/04 08:01:12 AM DEBUG:Calling get_cleaned_data with args=(), kwargs={}
2025/03/04 08:01:12 AM DEBUG:Calling load_cleaned_data with args=(), kwargs={'originaldatafilepath': 'cleaned_donations_fname', 'processeddatafilepath': 'cleaned_data_fname', 'datafile': 'raw_data', 'streamlitrun': True, 'output_csv': True, 'main_file': 'raw_data', 'cleaned_file': 'data_clean'}
2025/03/04 08:01:12 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'output\\cleaned_donations.csv', 'savedfilepath': 'output\\cleaned_data.csv', 'timestamp_key': 'load_raw_data_last_modified'}
2025/03/04 08:01:12 AM INFO:Original file path: output\cleaned_donations.csv
2025/03/04 08:01:12 AM INFO:Saved file path: output\cleaned_data.csv
2025/03/04 08:01:12 AM DEBUG:Calling is_file_updated with args=('output\\cleaned_donations.csv', 'load_raw_data_last_modified'), kwargs={}
2025/03/04 08:01:12 AM INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/04 08:01:12 AM DEBUG:Calling get_file_modification_time with args=('output\\cleaned_donations.csv',), kwargs={}
2025/03/04 08:01:12 AM INFO:Getting modification time for output\cleaned_donations.csv
2025/03/04 08:01:12 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:01:12 AM INFO:Current modification time: 1741075271.8696096
2025/03/04 08:01:12 AM INFO:Last modification time: 1740757862.6744745
2025/03/04 08:01:12 AM INFO:is_file_updated executed successfully
2025/03/04 08:01:12 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:01:12 AM INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 08:01:15 AM DEBUG:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate  ...                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019  ...  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019  ...  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...  ...                              ...        ...          ...           ...               ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN  ...          Shaftesbury Investments          1         2016             4            201604
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN  ...                Mr Jeremy Hosking          1         2016             2            201602
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN  ...                   Anthony Clarke          1         2016             6            201606
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN  ...                Mr Peter A Dubens          1         2017             5            201705
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN  ...                 Mr Ravi S Kailas          1         2017             5            201705

[65278 rows x 44 columns],), kwargs={}
2025/03/04 08:01:15 AM DEBUG:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/04 08:01:15 AM DEBUG:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/04 08:01:15 AM DEBUG:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 08:01:15 AM DEBUG:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/04 08:01:15 AM DEBUG:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/04 08:01:15 AM ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/04 08:01:15 AM ERROR:Attempting to remove duplicates
2025/03/04 08:01:15 AM DEBUG:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 46 columns]
2025/03/04 08:01:15 AM DEBUG:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/04 08:01:15 AM INFO:Data Updated with PartyName and PartyId successfully
2025/03/04 08:01:15 AM INFO:map_mp_to_party executed successfully
2025/03/04 08:01:16 AM DEBUG:Calling load_election_dates with args=(), kwargs={}
2025/03/04 08:01:16 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'source\\Donations_accepted_by_political_parties.csv', 'savedfilepath': 'reference_files\\elections.csv', 'timestamp_key': 'election_dates_last_modified'}
2025/03/04 08:01:16 AM INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:01:16 AM INFO:Saved file path: reference_files\elections.csv
2025/03/04 08:01:16 AM DEBUG:Calling is_file_updated with args=('source\\Donations_accepted_by_political_parties.csv', 'election_dates_last_modified'), kwargs={}
2025/03/04 08:01:16 AM INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 08:01:16 AM DEBUG:Calling get_file_modification_time with args=('source\\Donations_accepted_by_political_parties.csv',), kwargs={}
2025/03/04 08:01:16 AM INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 08:01:16 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:01:16 AM INFO:Current modification time: 1740757862.6744745
2025/03/04 08:01:16 AM INFO:Last modification time: None
2025/03/04 08:01:16 AM INFO:is_file_updated executed successfully
2025/03/04 08:01:16 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:01:16 AM INFO:Election dates loaded from file.
2025/03/04 08:01:16 AM INFO:Election_dates_df empty - loading from pdpy.
2025/03/04 08:01:16 AM INFO:Election Dates loaded vis pdpy.
2025/03/04 08:01:16 AM DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025/03/04 08:01:16 AM INFO:Election Dates Loaded Successfully.
2025/03/04 08:01:16 AM DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/04 08:01:16 AM DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/04 08:01:16 AM INFO:load_election_dates executed successfully
2025/03/04 08:02:01 AM INFO:Cleaned Data completed, shape: (65278, 58)
2025/03/04 08:02:01 AM INFO:load_cleaned_data executed successfully
2025/03/04 08:02:02 AM INFO:get_cleaned_data executed successfully
2025/03/04 08:02:02 AM INFO:load_data_to_session executed successfully
2025/03/04 08:02:02 AM DEBUG:Calling load_data_to_session with args=('data_donor', <function get_donor_data at 0x0000017BCCF8BD00>), kwargs={}
2025/03/04 08:02:02 AM DEBUG:Calling get_donor_data with args=(), kwargs={}
2025/03/04 08:02:02 AM DEBUG:Calling load_donorList_data with args=(), kwargs={'main_file': 'data_clean', 'cleaned_file': 'data_donor', 'streamlitrun': True, 'output_csv': True, 'originaldatafilepath': 'cleaned_data_fname', 'cleaneddatafilepath': 'cleaned_donorlist_fname'}
2025/03/04 08:02:02 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'output\\cleaned_data.csv', 'savedfilepath': 'output\\cleaned_donorlist.csv', 'timestamp_key': 'load_donorlist_data_last_modified'}
2025/03/04 08:02:02 AM INFO:Original file path: output\cleaned_data.csv
2025/03/04 08:02:02 AM INFO:Saved file path: output\cleaned_donorlist.csv
2025/03/04 08:02:02 AM DEBUG:Calling is_file_updated with args=('output\\cleaned_data.csv', 'load_donorlist_data_last_modified'), kwargs={}
2025/03/04 08:02:02 AM INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/04 08:02:02 AM DEBUG:Calling get_file_modification_time with args=('output\\cleaned_data.csv',), kwargs={}
2025/03/04 08:02:02 AM INFO:Getting modification time for output\cleaned_data.csv
2025/03/04 08:02:02 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:02:02 AM INFO:Current modification time: 1741075321.763669
2025/03/04 08:02:02 AM INFO:Last modification time: None
2025/03/04 08:02:02 AM INFO:is_file_updated executed successfully
2025/03/04 08:02:02 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:02:02 AM INFO:Donor data saved to output\cleaned_donorlist.csv
2025/03/04 08:02:02 AM INFO:Donor Data summary completed
2025/03/04 08:02:02 AM INFO:Data shape: (30219, 5)
2025/03/04 08:02:02 AM INFO:load_donorList_data executed successfully
2025/03/04 08:02:02 AM INFO:get_donor_data executed successfully
2025/03/04 08:02:02 AM INFO:load_data_to_session executed successfully
2025/03/04 08:02:02 AM DEBUG:Calling load_data_to_session with args=('data_regentity', <function get_regentity_data at 0x0000017BCCF8BE20>), kwargs={}
2025/03/04 08:02:02 AM DEBUG:Calling get_regentity_data with args=(), kwargs={}
2025/03/04 08:02:02 AM DEBUG:Calling load_regulated_entity_data with args=(), kwargs={'main_file': 'data_clean', 'cleaned_file': 'data_regentity', 'streamlitrun': True, 'output_csv': True, 'originaldatafilepath': 'cleaned_data_fname', 'cleaneddatafilepath': 'cleaned_regentity_fname'}
2025/03/04 08:02:02 AM DEBUG:Calling try_to_use_preprocessed_data with args=(), kwargs={'originalfilepath': 'output\\cleaned_data.csv', 'savedfilepath': 'output\\cleaned_regentity.csv', 'timestamp_key': 'load_donorlist_data_last_modified'}
2025/03/04 08:02:02 AM INFO:Original file path: output\cleaned_data.csv
2025/03/04 08:02:02 AM INFO:Saved file path: output\cleaned_regentity.csv
2025/03/04 08:02:02 AM DEBUG:Calling is_file_updated with args=('output\\cleaned_data.csv', 'load_donorlist_data_last_modified'), kwargs={}
2025/03/04 08:02:02 AM INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/04 08:02:02 AM DEBUG:Calling get_file_modification_time with args=('output\\cleaned_data.csv',), kwargs={}
2025/03/04 08:02:02 AM INFO:Getting modification time for output\cleaned_data.csv
2025/03/04 08:02:02 AM INFO:get_file_modification_time executed successfully
2025/03/04 08:02:02 AM INFO:Current modification time: 1741075321.763669
2025/03/04 08:02:02 AM INFO:Last modification time: 1741075321.763669
2025/03/04 08:02:02 AM INFO:is_file_updated executed successfully
2025/03/04 08:02:02 AM INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated load_donorlist_data_last_modified instead of output\cleaned_data.csv
2025/03/04 08:02:02 AM INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 08:02:02 AM INFO:load_regulated_entity_data executed successfully
2025/03/04 08:02:02 AM INFO:get_regentity_data executed successfully
2025/03/04 08:02:02 AM INFO:load_data_to_session executed successfully
2025/03/04 08:02:02 AM INFO:firstload executed successfully
2025/03/04 08:02:02 AM INFO:initialise_data executed successfully
2025/03/04 08:03:47 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 08:03:47 AM INFO:Running App setup...
2025/03/04 08:03:47 AM DEBUG:Calling setup_package with args=(), kwargs={}
2025/03/04 08:03:47 AM INFO:Setting up the package
2025/03/04 08:03:47 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 08:03:47 AM DEBUG:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',), kwargs={}
2025/03/04 08:03:47 AM INFO:get_git_version executed successfully
2025/03/04 08:03:47 AM INFO:Version: v20.138
2025/03/04 08:03:47 AM DEBUG:Calling initialize_session_state with args=(), kwargs={}
2025/03/04 08:03:47 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:03:47 AM DEBUG:LOG_LEVEL already exists in session state
2025/03/04 08:03:47 AM DEBUG:BASE_DIR already exists in session state
2025/03/04 08:03:47 AM DEBUG:filenames already exists in session state
2025/03/04 08:03:47 AM DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/04 08:03:47 AM DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/04 08:03:47 AM DEBUG:thresholds already exists in session state
2025/03/04 08:03:47 AM DEBUG:data_remappings already exists in session state
2025/03/04 08:03:47 AM DEBUG:filter_def already exists in session state
2025/03/04 08:03:47 AM DEBUG:security already exists in session state
2025/03/04 08:03:47 AM DEBUG:perc_target already exists in session state
2025/03/04 08:03:47 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/04 08:03:47 AM DEBUG:directories already exists in session state
2025/03/04 08:03:47 AM DEBUG:reference_dir already exists in session state
2025/03/04 08:03:47 AM DEBUG:data_dir already exists in session state
2025/03/04 08:03:47 AM DEBUG:output_dir already exists in session state
2025/03/04 08:03:47 AM DEBUG:logs_dir already exists in session state
2025/03/04 08:03:47 AM DEBUG:components_dir already exists in session state
2025/03/04 08:03:47 AM DEBUG:app_pages_dir already exists in session state
2025/03/04 08:03:47 AM DEBUG:utils_dir already exists in session state
2025/03/04 08:03:47 AM DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/04 08:03:47 AM DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/04 08:03:47 AM DEBUG:mppartymemb_fname already exists in session state
2025/03/04 08:03:47 AM DEBUG:donor_map_fname already exists in session state
2025/03/04 08:03:47 AM DEBUG:politician_party_fname already exists in session state
2025/03/04 08:03:47 AM DEBUG:regentity_map_fname already exists in session state
2025/03/04 08:03:47 AM DEBUG:original_data_fname already exists in session state
2025/03/04 08:03:47 AM DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/04 08:03:47 AM DEBUG:TEXT_FILE already exists in session state
2025/03/04 08:03:47 AM DEBUG:ELECTION_DATES already exists in session state
2025/03/04 08:03:47 AM DEBUG:cleaned_data_fname already exists in session state
2025/03/04 08:03:47 AM DEBUG:cleaned_donations_fname already exists in session state
2025/03/04 08:03:47 AM DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/04 08:03:47 AM DEBUG:cleaned_regentity_fname already exists in session state
2025/03/04 08:03:47 AM DEBUG:party_summary_fname already exists in session state
2025/03/04 08:03:47 AM DEBUG:imported_raw_fname already exists in session state
2025/03/04 08:03:47 AM DEBUG:source_data_fname already exists in session state
2025/03/04 08:03:47 AM DEBUG:Cash_ftr already exists in session state
2025/03/04 08:03:47 AM INFO:Session_state variables initialized
2025/03/04 08:03:47 AM DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 08:03:47 AM DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 08:03:47 AM DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 08:03:47 AM DEBUG:data_dir: data
2025/03/04 08:03:47 AM DEBUG:output_dir: output
2025/03/04 08:03:47 AM DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 08:03:47 AM DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x0000017BCCCB23B0>}
2025/03/04 08:03:47 AM DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 08:03:47 AM DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 08:03:47 AM DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 08:03:47 AM DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 08:03:47 AM DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 08:03:47 AM DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 08:03:47 AM DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 08:03:47 AM DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 08:03:47 AM DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 08:03:47 AM DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 08:03:47 AM DEBUG:utils_dir: utils
2025/03/04 08:03:47 AM DEBUG:reference_dir: reference_files
2025/03/04 08:03:47 AM DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 08:03:47 AM DEBUG:LOG_LEVEL: DEBUG
2025/03/04 08:03:47 AM DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 08:03:47 AM DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 08:03:47 AM DEBUG:logs_dir: logs
2025/03/04 08:03:47 AM DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 08:03:47 AM DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 08:03:47 AM DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 08:03:47 AM DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 08:03:47 AM DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 08:03:47 AM DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 08:03:47 AM DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 08:03:47 AM DEBUG:components_dir: components
2025/03/04 08:03:47 AM DEBUG:perc_target: 0.5
2025/03/04 08:03:47 AM DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 08:03:47 AM DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 08:03:47 AM DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 08:03:47 AM DEBUG:app_pages_dir: app_pages
2025/03/04 08:03:47 AM DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 08:03:47 AM INFO:Session state Setup complete
2025/03/04 08:03:47 AM INFO:initialize_session_state executed successfully
2025/03/04 08:03:47 AM INFO:Package setup complete
2025/03/04 08:03:47 AM INFO:setup_package executed successfully
2025/03/04 08:03:47 AM INFO:Running Menu setup...
2025/03/04 08:03:47 AM DEBUG:Calling pagesetup with args=(), kwargs={}
2025/03/04 08:03:47 AM DEBUG:Calling get_git_version with args=(), kwargs={}
2025/03/04 08:03:47 AM INFO:get_git_version executed successfully
2025/03/04 08:03:47 AM INFO:App Version: v20.159
2025/03/04 08:03:47 AM INFO:Switched to page: Head Line Figures
2025/03/04 08:03:47 AM DEBUG:Calling hlf_body with args=(), kwargs={}
2025/03/04 08:03:47 AM DEBUG:Calling load_and_filter_data with args=(), kwargs={'filter_key': None, 'pagereflabel': 'headlinefigures'}
2025/03/04 08:03:47 AM ERROR:Error in load_and_filter_data: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state["data_clean"]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
2025/03/04 08:03:47 AM ERROR:Error in hlf_body: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state["data_clean"]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
2025/03/04 08:03:47 AM ERROR:Error in pagesetup: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state["data_clean"]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
2025/03/04 08:03:47 AM CRITICAL:Menu setup crashed: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 39, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 33, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 23, in load_and_filter_data
    cleaned_df = st.session_state["data_clean"]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
