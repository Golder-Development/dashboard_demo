2025/02/28 09:56:17 PM INFO:Logging is set up correctly!
2025/02/28 09:56:17 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\utils',)
2025/02/28 09:56:17 PM INFO:get_git_version executed successfully
2025/02/28 09:56:17 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\data',)
2025/02/28 09:56:17 PM INFO:get_git_version executed successfully
2025/02/28 09:56:18 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\components',)
2025/02/28 09:56:18 PM INFO:get_git_version executed successfully
2025/02/28 09:56:18 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/02/28 09:56:18 PM INFO:Setting up the package
2025/02/28 09:56:18 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/02/28 09:56:18 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',)
2025/02/28 09:56:18 PM INFO:get_git_version executed successfully
2025/02/28 09:56:18 PM INFO:Version: v20.113
2025/02/28 09:56:18 PM INFO:Calling initialize_session_state with args=()
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('BASE_DIR', 'H:\\VScode\\dashboard_demo-1')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('filenames', {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}})
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('PLACEHOLDER_DATE', Timestamp('1900-01-01 00:00:00'))
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('PLACEHOLDER_ID', 1000001)
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('thresholds', {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'})
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('data_remappings', {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}})
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('filter_def', {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}})
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('security', {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''})
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('perc_target', 0.5)
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('directories', {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'})
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('reference_dir', 'H:\\VScode\\dashboard_demo-1\\reference_files')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('data_dir', 'H:\\VScode\\dashboard_demo-1\\data')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('output_dir', 'H:\\VScode\\dashboard_demo-1\\output')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('logs_dir', 'H:\\VScode\\dashboard_demo-1\\logs')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('components_dir', 'H:\\VScode\\dashboard_demo-1\\components')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('app_pages_dir', 'H:\\VScode\\dashboard_demo-1\\app_pages')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('utils_dir', 'H:\\VScode\\dashboard_demo-1\\utils')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('directories', {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'})
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('Donor_dedupe_cleaned_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\Donor_dedupe_cleaned_data.csv')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('ListofPoliticalPeople_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\ListOfPoliticalPeople.csv')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('mppartymemb_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\mppartymemb_pypd.csv')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('donor_map_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\PoliticalDonorsDeDuped.csv')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('politician_party_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\ListOfPoliticalPeople_Final.csv')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('regentity_map_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\PoliticalEntityDeDuped.csv')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('potential_donor_duplicates_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\potential_donor_duplicates.csv')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('potential_regulatedentity_duplicates_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\potential_regentiity_duplicates.csv')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('original_data_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\original_data.csv')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('CREDENTIALS_FILE', 'H:\\VScode\\dashboard_demo-1\\reference_files\\admin_credentials.json')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('TEXT_FILE', 'H:\\VScode\\dashboard_demo-1\\reference_files\\admin_text.json')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('cleaned_data_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_data.csv')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('cleaned_donations_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_donations.csv')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('cleaned_donorlist_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_donorlist.csv')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('cleaned_regentity_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_regentity.csv')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('party_summary_fname', 'H:\\VScode\\dashboard_demo-1\\output\\party_summary.csv')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'Donations_accepted_by_political_parties.csv')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'H:\\VScode\\dashboard_demo-1\\Donations_accepted_by_political_parties.csv')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'H:\\VScode\\dashboard_demo-1\\Donations_accepted_by_political_parties.csv')
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Calling init_state_var with args=('Cash_ftr', {'DonationType': 'Cash'})
2025/02/28 09:56:18 PM INFO:init_state_var executed successfully
2025/02/28 09:56:18 PM INFO:Session_state variables initialized
2025/02/28 09:56:18 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/02/28 09:56:18 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/02/28 09:56:18 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/02/28 09:56:18 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/02/28 09:56:18 PM INFO:directories: {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/02/28 09:56:18 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/02/28 09:56:18 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/02/28 09:56:18 PM INFO:perc_target: 0.5
2025/02/28 09:56:18 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/02/28 09:56:18 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/02/28 09:56:18 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/02/28 09:56:18 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/02/28 09:56:18 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/02/28 09:56:18 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/02/28 09:56:18 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/02/28 09:56:18 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/02/28 09:56:18 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/02/28 09:56:18 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/02/28 09:56:18 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/02/28 09:56:18 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/02/28 09:56:18 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/02/28 09:56:18 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/02/28 09:56:18 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/02/28 09:56:18 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/02/28 09:56:18 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/02/28 09:56:18 PM INFO:PLACEHOLDER_ID: 1000001
2025/02/28 09:56:18 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/02/28 09:56:18 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/02/28 09:56:18 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/02/28 09:56:18 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/02/28 09:56:18 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/02/28 09:56:18 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/02/28 09:56:18 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/02/28 09:56:18 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/02/28 09:56:18 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/02/28 09:56:18 PM INFO:Session state Setup complete
2025/02/28 09:56:18 PM INFO:initialize_session_state executed successfully
2025/02/28 09:56:18 PM INFO:Package setup complete
2025/02/28 09:56:18 PM INFO:Calling pagesetup with args=()
2025/02/28 09:56:18 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\app_pages',)
2025/02/28 09:56:18 PM INFO:get_git_version executed successfully
2025/02/28 09:56:19 PM INFO:Calling get_git_version with args=()
2025/02/28 09:56:19 PM INFO:get_git_version executed successfully
2025/02/28 09:56:19 PM INFO:App Version: v20.128
2025/02/28 09:56:19 PM INFO:Switched to page: Introduction
2025/02/28 09:56:19 PM INFO:pagesetup executed successfully
2025/02/28 09:56:19 PM INFO:Calling firstload with args=()
2025/02/28 09:56:19 PM INFO:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x00000266E1DF60E0>)
2025/02/28 09:56:19 PM INFO:Calling get_raw_data with args=()
2025/02/28 09:56:19 PM INFO:Calling load_raw_data with args=()
2025/02/28 09:56:19 PM INFO:Calling raw_data_cleanup with args=(           ECRef              RegulatedEntityName    RegulatedEntityType        Value AcceptedDate AccountingUnitName  ... RegulatedEntityId AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                                                  ...                                                                                         
0      NC0408174                   Mr Andy Street        Regulated Donee    £1,876.56   02/09/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    £2,700.00   02/09/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    £4,852.58   30/08/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    £2,500.00   30/08/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    £4,524.05   29/08/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
...          ...                              ...                    ...          ...          ...                ...  ...               ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   £10,000.00          NaN                NaN  ...              3945              NaN  74198.0             NaN            NaN         False
65274   C0242461               Vote Leave Limited  Permitted Participant  £100,000.00          NaN                NaN  ...              3945              NaN  74184.0             NaN            NaN         False
65275   C0243560               Vote Leave Limited  Permitted Participant   £40,000.00          NaN                NaN  ...              3945              NaN  74576.0             NaN            NaN         False
65276   C0319710  Conservative and Unionist Party        Political Party   £50,000.00          NaN      Central Party  ...                52              NaN  34241.0             NaN  Great Britain         False
65277   C0319727  Conservative and Unionist Party        Political Party   £15,000.00          NaN      Central Party  ...                52              NaN  74743.0             NaN  Great Britain         False

[65278 rows x 29 columns],)
2025/02/28 09:56:21 PM INFO:Calling dedupe_entity_file with args=()
2025/02/28 09:56:21 PM INFO:map_filename: regentity_map_fname
2025/02/28 09:56:21 PM INFO:map_filename found: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/02/28 09:56:21 PM INFO:Dedupe by file
2025/02/28 09:56:21 PM INFO:Dedupe by file, shape: (65279, 34)
2025/02/28 09:56:21 PM INFO:dedupe_entity_file executed successfully
2025/02/28 09:56:21 PM INFO:Calling dedupe_entity_file with args=()
2025/02/28 09:56:21 PM INFO:map_filename: donor_map_fname
2025/02/28 09:56:21 PM INFO:map_filename found: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/02/28 09:56:21 PM INFO:Dedupe by file
2025/02/28 09:56:21 PM INFO:Dedupe by file, shape: (66011, 40)
2025/02/28 09:56:21 PM INFO:dedupe_entity_file executed successfully
2025/02/28 09:56:21 PM INFO:Data cleanup completed, shape: (66011, 40)
2025/02/28 09:56:21 PM INFO:raw_data_cleanup executed successfully
2025/02/28 09:56:23 PM INFO:load_raw_data executed successfully
2025/02/28 09:56:23 PM INFO:get_raw_data executed successfully
2025/02/28 09:56:23 PM INFO:load_data_to_session executed successfully
2025/02/28 09:56:23 PM INFO:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x00000266E1DF6950>)
2025/02/28 09:56:23 PM INFO:Calling get_cleaned_data with args=()
2025/02/28 09:56:23 PM INFO:Calling load_cleaned_data with args=()
2025/02/28 09:56:26 PM INFO:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate AccountingUnitName  ...  DonorId                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...                ...  ...      ...                              ...        ...          ...           ...               ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN                     ...  74198.0          Shaftesbury Investments          1         2016             4            201604
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN                     ...  74184.0                Mr Jeremy Hosking          1         2016             2            201602
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN                     ...  23556.0                   Anthony Clarke          1         2016             6            201606
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN      Central Party  ...   2146.0                Mr Peter A Dubens          1         2017             5            201705
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN      Central Party  ...  74743.0                 Mr Ravi S Kailas          1         2017             5            201705

[66011 rows x 44 columns],)
2025/02/28 09:56:26 PM INFO:politician_party_dict:    Original RegulatedEntityId  RegulatedEntityId OriginalRegulatedEntityName  RegulatedEntityName   RegisterName                   RegulatedDoneeType RegulatedEntityType      CleanedName    Status PoliticalParty_pdpy
0                        6304               6304             Alec Shelbrooke      Alec Shelbrooke  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee  Alec Shelbrooke       NaN        Conservative
1                        6423               6423           Andrew Bingham Mp    Andrew Bingham Mp  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee   Andrew Bingham        Mp        Conservative
2                        1425               1425         Mr Boris Johnson Mp  Mr Boris Johnson Mp  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee    Boris Johnson   Mr & Mp        Conservative
3                        2061               2061          Mr John Lamont Msp   Mr John Lamont Msp  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee      John Lamont  Mr & Msp        Conservative
4                        6417               6417              Mr Sean Anstee       Mr Sean Anstee  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee      Sean Anstee        Mr             Unknown
2025/02/28 09:56:26 PM INFO:PartyUpdate_df: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}
2025/02/28 09:56:26 PM INFO:loaddata_df:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ...                        DonorName EventCount YearReceived MonthReceived YearMonthReceived PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...  Conservative And Unionist Party          1         2019             9            201909     NaN
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...  Conservative And Unionist Party          1         2019             9            201909     NaN
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...  Conservative And Unionist Party          1         2019             8            201908     NaN
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...  Conservative And Unionist Party          1         2019             8            201908     NaN
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...  Conservative And Unionist Party          1         2019             8            201908     0.0

[5 rows x 45 columns]
2025/02/28 09:56:26 PM ERROR:Error in map_mp_to_party: 'PartyName'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 191, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 234, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "index.pyx", line 242, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "index.pyx", line 134, in pandas._libs.index._unpack_bool_indexer
KeyError: 'PartyName'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 33, in map_mp_to_party
    loaddata_df['PartyId'] = loaddata_df['PartyName'].map()
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'PartyName'
2025/02/28 09:56:26 PM ERROR:Error in load_cleaned_data: 'PartyName'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 191, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 234, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "index.pyx", line 242, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "index.pyx", line 134, in pandas._libs.index._unpack_bool_indexer
KeyError: 'PartyName'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 33, in map_mp_to_party
    loaddata_df['PartyId'] = loaddata_df['PartyName'].map()
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'PartyName'
2025/02/28 09:56:26 PM ERROR:Error in get_cleaned_data: 'PartyName'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 191, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 234, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "index.pyx", line 242, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "index.pyx", line 134, in pandas._libs.index._unpack_bool_indexer
KeyError: 'PartyName'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 24, in get_cleaned_data
    return load_cleaned_data(datafile=None, output_csv=True, streamlitrun=True)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 33, in map_mp_to_party
    loaddata_df['PartyId'] = loaddata_df['PartyName'].map()
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'PartyName'
2025/02/28 09:56:26 PM ERROR:Error in load_data_to_session: 'PartyName'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 191, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 234, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "index.pyx", line 242, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "index.pyx", line 134, in pandas._libs.index._unpack_bool_indexer
KeyError: 'PartyName'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 50, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 24, in get_cleaned_data
    return load_cleaned_data(datafile=None, output_csv=True, streamlitrun=True)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 33, in map_mp_to_party
    loaddata_df['PartyId'] = loaddata_df['PartyName'].map()
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'PartyName'
2025/02/28 09:56:26 PM ERROR:Error in firstload: 'PartyName'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 191, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 234, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "index.pyx", line 242, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "index.pyx", line 134, in pandas._libs.index._unpack_bool_indexer
KeyError: 'PartyName'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 56, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 50, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 24, in get_cleaned_data
    return load_cleaned_data(datafile=None, output_csv=True, streamlitrun=True)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 33, in map_mp_to_party
    loaddata_df['PartyId'] = loaddata_df['PartyName'].map()
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'PartyName'
2025/02/28 10:07:35 PM INFO:Logging is set up correctly!
2025/02/28 10:07:35 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\utils',)
2025/02/28 10:07:35 PM INFO:get_git_version executed successfully
2025/02/28 10:07:36 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\data',)
2025/02/28 10:07:36 PM INFO:get_git_version executed successfully
2025/02/28 10:07:36 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\components',)
2025/02/28 10:07:36 PM INFO:get_git_version executed successfully
2025/02/28 10:07:36 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/02/28 10:07:36 PM INFO:Setting up the package
2025/02/28 10:07:36 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/02/28 10:07:36 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',)
2025/02/28 10:07:36 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/02/28 10:07:36 PM INFO:Setting up the package
2025/02/28 10:07:36 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/02/28 10:07:36 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',)
2025/02/28 10:07:36 PM INFO:get_git_version executed successfully
2025/02/28 10:07:36 PM INFO:get_git_version executed successfully
2025/02/28 10:07:36 PM INFO:Version: v20.113
2025/02/28 10:07:36 PM INFO:Version: v20.113
2025/02/28 10:07:36 PM INFO:Calling initialize_session_state with args=()
2025/02/28 10:07:36 PM INFO:Calling initialize_session_state with args=()
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('BASE_DIR', 'H:\\VScode\\dashboard_demo-1')
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('BASE_DIR', 'H:\\VScode\\dashboard_demo-1')
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('filenames', {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}})
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('filenames', {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}})
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('PLACEHOLDER_DATE', Timestamp('1900-01-01 00:00:00'))
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('PLACEHOLDER_DATE', Timestamp('1900-01-01 00:00:00'))
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('PLACEHOLDER_ID', 1000001)
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('PLACEHOLDER_ID', 1000001)
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('thresholds', {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'})
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('thresholds', {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'})
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('data_remappings', {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}})
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('data_remappings', {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}})
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('filter_def', {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}})
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('filter_def', {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}})
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('security', {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''})
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('security', {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''})
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('perc_target', 0.5)
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('perc_target', 0.5)
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('directories', {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'})
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('directories', {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'})
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('reference_dir', 'H:\\VScode\\dashboard_demo-1\\reference_files')
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('reference_dir', 'H:\\VScode\\dashboard_demo-1\\reference_files')
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('data_dir', 'H:\\VScode\\dashboard_demo-1\\data')
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('data_dir', 'H:\\VScode\\dashboard_demo-1\\data')
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('output_dir', 'H:\\VScode\\dashboard_demo-1\\output')
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('output_dir', 'H:\\VScode\\dashboard_demo-1\\output')
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('logs_dir', 'H:\\VScode\\dashboard_demo-1\\logs')
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('logs_dir', 'H:\\VScode\\dashboard_demo-1\\logs')
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('components_dir', 'H:\\VScode\\dashboard_demo-1\\components')
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('components_dir', 'H:\\VScode\\dashboard_demo-1\\components')
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('app_pages_dir', 'H:\\VScode\\dashboard_demo-1\\app_pages')
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('app_pages_dir', 'H:\\VScode\\dashboard_demo-1\\app_pages')
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('utils_dir', 'H:\\VScode\\dashboard_demo-1\\utils')
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('utils_dir', 'H:\\VScode\\dashboard_demo-1\\utils')
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('directories', {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'})
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('directories', {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'})
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('Donor_dedupe_cleaned_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\Donor_dedupe_cleaned_data.csv')
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('Donor_dedupe_cleaned_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\Donor_dedupe_cleaned_data.csv')
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('ListofPoliticalPeople_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\ListOfPoliticalPeople.csv')
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('ListofPoliticalPeople_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\ListOfPoliticalPeople.csv')
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('mppartymemb_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\mppartymemb_pypd.csv')
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('mppartymemb_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\mppartymemb_pypd.csv')
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('donor_map_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\PoliticalDonorsDeDuped.csv')
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('donor_map_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\PoliticalDonorsDeDuped.csv')
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('politician_party_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\ListOfPoliticalPeople_Final.csv')
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('politician_party_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\ListOfPoliticalPeople_Final.csv')
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('regentity_map_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\PoliticalEntityDeDuped.csv')
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('regentity_map_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\PoliticalEntityDeDuped.csv')
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('potential_donor_duplicates_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\potential_donor_duplicates.csv')
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('potential_donor_duplicates_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\potential_donor_duplicates.csv')
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('potential_regulatedentity_duplicates_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\potential_regentiity_duplicates.csv')
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('potential_regulatedentity_duplicates_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\potential_regentiity_duplicates.csv')
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('original_data_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\original_data.csv')
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('original_data_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\original_data.csv')
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('CREDENTIALS_FILE', 'H:\\VScode\\dashboard_demo-1\\reference_files\\admin_credentials.json')
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('CREDENTIALS_FILE', 'H:\\VScode\\dashboard_demo-1\\reference_files\\admin_credentials.json')
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('TEXT_FILE', 'H:\\VScode\\dashboard_demo-1\\reference_files\\admin_text.json')
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('TEXT_FILE', 'H:\\VScode\\dashboard_demo-1\\reference_files\\admin_text.json')
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('cleaned_data_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_data.csv')
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('cleaned_data_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_data.csv')
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('cleaned_donations_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_donations.csv')
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('cleaned_donations_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_donations.csv')
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('cleaned_donorlist_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_donorlist.csv')
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('cleaned_donorlist_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_donorlist.csv')
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('cleaned_regentity_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_regentity.csv')
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('cleaned_regentity_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_regentity.csv')
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('party_summary_fname', 'H:\\VScode\\dashboard_demo-1\\output\\party_summary.csv')
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('party_summary_fname', 'H:\\VScode\\dashboard_demo-1\\output\\party_summary.csv')
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:init_state_var executed successfully
2025/02/28 10:07:36 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'Donations_accepted_by_political_parties.csv')
2025/02/28 10:07:37 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'Donations_accepted_by_political_parties.csv')
2025/02/28 10:07:37 PM INFO:init_state_var executed successfully
2025/02/28 10:07:37 PM INFO:init_state_var executed successfully
2025/02/28 10:07:37 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'H:\\VScode\\dashboard_demo-1\\Donations_accepted_by_political_parties.csv')
2025/02/28 10:07:37 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'H:\\VScode\\dashboard_demo-1\\Donations_accepted_by_political_parties.csv')
2025/02/28 10:07:37 PM INFO:init_state_var executed successfully
2025/02/28 10:07:37 PM INFO:init_state_var executed successfully
2025/02/28 10:07:37 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'H:\\VScode\\dashboard_demo-1\\Donations_accepted_by_political_parties.csv')
2025/02/28 10:07:37 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'H:\\VScode\\dashboard_demo-1\\Donations_accepted_by_political_parties.csv')
2025/02/28 10:07:37 PM INFO:init_state_var executed successfully
2025/02/28 10:07:37 PM INFO:init_state_var executed successfully
2025/02/28 10:07:37 PM INFO:Calling init_state_var with args=('Cash_ftr', {'DonationType': 'Cash'})
2025/02/28 10:07:37 PM INFO:Calling init_state_var with args=('Cash_ftr', {'DonationType': 'Cash'})
2025/02/28 10:07:37 PM INFO:init_state_var executed successfully
2025/02/28 10:07:37 PM INFO:init_state_var executed successfully
2025/02/28 10:07:37 PM INFO:Session_state variables initialized
2025/02/28 10:07:37 PM INFO:Session_state variables initialized
2025/02/28 10:07:37 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/02/28 10:07:37 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/02/28 10:07:37 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/02/28 10:07:37 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/02/28 10:07:37 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/02/28 10:07:37 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/02/28 10:07:37 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/02/28 10:07:37 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/02/28 10:07:37 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/02/28 10:07:37 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/02/28 10:07:37 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/02/28 10:07:37 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/02/28 10:07:37 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/02/28 10:07:37 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/02/28 10:07:37 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/02/28 10:07:37 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/02/28 10:07:37 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/02/28 10:07:37 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/02/28 10:07:37 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/02/28 10:07:37 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/02/28 10:07:37 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/02/28 10:07:37 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/02/28 10:07:37 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/02/28 10:07:37 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/02/28 10:07:37 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/02/28 10:07:37 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/02/28 10:07:37 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/02/28 10:07:37 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/02/28 10:07:37 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/02/28 10:07:37 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/02/28 10:07:37 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/02/28 10:07:37 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/02/28 10:07:37 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/02/28 10:07:37 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/02/28 10:07:37 PM INFO:directories: {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/02/28 10:07:37 PM INFO:directories: {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/02/28 10:07:37 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/02/28 10:07:37 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/02/28 10:07:37 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/02/28 10:07:37 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/02/28 10:07:37 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/02/28 10:07:37 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/02/28 10:07:37 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/02/28 10:07:37 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/02/28 10:07:37 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/02/28 10:07:37 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/02/28 10:07:37 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/02/28 10:07:37 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/02/28 10:07:37 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/02/28 10:07:37 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/02/28 10:07:37 PM INFO:perc_target: 0.5
2025/02/28 10:07:37 PM INFO:perc_target: 0.5
2025/02/28 10:07:37 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/02/28 10:07:37 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/02/28 10:07:37 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/02/28 10:07:37 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/02/28 10:07:37 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/02/28 10:07:37 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/02/28 10:07:37 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/02/28 10:07:37 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/02/28 10:07:37 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/02/28 10:07:37 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/02/28 10:07:37 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/02/28 10:07:37 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/02/28 10:07:37 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/02/28 10:07:37 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/02/28 10:07:37 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/02/28 10:07:37 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/02/28 10:07:37 PM INFO:PLACEHOLDER_ID: 1000001
2025/02/28 10:07:37 PM INFO:PLACEHOLDER_ID: 1000001
2025/02/28 10:07:37 PM INFO:Session state Setup complete
2025/02/28 10:07:37 PM INFO:Session state Setup complete
2025/02/28 10:07:37 PM INFO:initialize_session_state executed successfully
2025/02/28 10:07:37 PM INFO:initialize_session_state executed successfully
2025/02/28 10:07:37 PM INFO:Package setup complete
2025/02/28 10:07:37 PM INFO:Package setup complete
2025/02/28 10:07:37 PM INFO:Calling pagesetup with args=()
2025/02/28 10:07:37 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\app_pages',)
2025/02/28 10:07:37 PM INFO:Calling pagesetup with args=()
2025/02/28 10:07:37 PM INFO:get_git_version executed successfully
2025/02/28 10:07:37 PM INFO:Calling get_git_version with args=()
2025/02/28 10:07:37 PM INFO:get_git_version executed successfully
2025/02/28 10:07:37 PM INFO:App Version: v20.128
2025/02/28 10:07:37 PM INFO:Switched to page: Introduction
2025/02/28 10:07:37 PM INFO:pagesetup executed successfully
2025/02/28 10:07:37 PM INFO:Calling firstload with args=()
2025/02/28 10:07:37 PM INFO:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x0000022DFA04AB90>)
2025/02/28 10:07:37 PM INFO:Calling get_raw_data with args=()
2025/02/28 10:07:37 PM INFO:Calling load_raw_data with args=()
2025/02/28 10:07:37 PM INFO:Calling raw_data_cleanup with args=(           ECRef              RegulatedEntityName    RegulatedEntityType        Value AcceptedDate AccountingUnitName  ... RegulatedEntityId AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                                                  ...                                                                                         
0      NC0408174                   Mr Andy Street        Regulated Donee    £1,876.56   02/09/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    £2,700.00   02/09/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    £4,852.58   30/08/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    £2,500.00   30/08/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    £4,524.05   29/08/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
...          ...                              ...                    ...          ...          ...                ...  ...               ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   £10,000.00          NaN                NaN  ...              3945              NaN  74198.0             NaN            NaN         False
65274   C0242461               Vote Leave Limited  Permitted Participant  £100,000.00          NaN                NaN  ...              3945              NaN  74184.0             NaN            NaN         False
65275   C0243560               Vote Leave Limited  Permitted Participant   £40,000.00          NaN                NaN  ...              3945              NaN  74576.0             NaN            NaN         False
65276   C0319710  Conservative and Unionist Party        Political Party   £50,000.00          NaN      Central Party  ...                52              NaN  34241.0             NaN  Great Britain         False
65277   C0319727  Conservative and Unionist Party        Political Party   £15,000.00          NaN      Central Party  ...                52              NaN  74743.0             NaN  Great Britain         False

[65278 rows x 29 columns],)
2025/02/28 10:07:39 PM INFO:Calling dedupe_entity_file with args=()
2025/02/28 10:07:39 PM INFO:map_filename: regentity_map_fname
2025/02/28 10:07:39 PM INFO:map_filename found: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/02/28 10:07:39 PM INFO:Dedupe by file
2025/02/28 10:07:39 PM INFO:Dedupe by file, shape: (65279, 34)
2025/02/28 10:07:39 PM INFO:dedupe_entity_file executed successfully
2025/02/28 10:07:39 PM INFO:Calling dedupe_entity_file with args=()
2025/02/28 10:07:39 PM INFO:map_filename: donor_map_fname
2025/02/28 10:07:39 PM INFO:map_filename found: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/02/28 10:07:39 PM INFO:Dedupe by file
2025/02/28 10:07:39 PM INFO:Dedupe by file, shape: (66011, 40)
2025/02/28 10:07:39 PM INFO:dedupe_entity_file executed successfully
2025/02/28 10:07:39 PM INFO:Data cleanup completed, shape: (66011, 40)
2025/02/28 10:07:39 PM INFO:raw_data_cleanup executed successfully
2025/02/28 10:07:40 PM INFO:load_raw_data executed successfully
2025/02/28 10:07:40 PM INFO:get_raw_data executed successfully
2025/02/28 10:07:40 PM INFO:load_data_to_session executed successfully
2025/02/28 10:07:40 PM INFO:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x0000022DFA04B400>)
2025/02/28 10:07:40 PM INFO:Calling get_cleaned_data with args=()
2025/02/28 10:07:40 PM INFO:Calling load_cleaned_data with args=()
2025/02/28 10:07:43 PM INFO:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate AccountingUnitName  ...  DonorId                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...                ...  ...      ...                              ...        ...          ...           ...               ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN                     ...  74198.0          Shaftesbury Investments          1         2016             4            201604
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN                     ...  74184.0                Mr Jeremy Hosking          1         2016             2            201602
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN                     ...  23556.0                   Anthony Clarke          1         2016             6            201606
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN      Central Party  ...   2146.0                Mr Peter A Dubens          1         2017             5            201705
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN      Central Party  ...  74743.0                 Mr Ravi S Kailas          1         2017             5            201705

[66011 rows x 44 columns],)
2025/02/28 10:07:43 PM INFO:Calling get_git_version with args=()
2025/02/28 10:07:43 PM INFO:get_git_version executed successfully
2025/02/28 10:07:43 PM INFO:App Version: v20.128
2025/02/28 10:07:43 PM INFO:Switched to page: Introduction
2025/02/28 10:07:43 PM INFO:pagesetup executed successfully
2025/02/28 10:07:43 PM INFO:Calling firstload with args=()
2025/02/28 10:07:43 PM INFO:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x0000022DFA04AB90>)
2025/02/28 10:07:43 PM INFO:Calling get_raw_data with args=()
2025/02/28 10:07:44 PM INFO:get_raw_data executed successfully
2025/02/28 10:07:44 PM INFO:load_data_to_session executed successfully
2025/02/28 10:07:44 PM INFO:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x0000022DFA04B400>)
2025/02/28 10:07:44 PM INFO:Calling get_cleaned_data with args=()
2025/02/28 10:07:44 PM INFO:Calling load_cleaned_data with args=()
2025/02/28 10:07:46 PM INFO:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate AccountingUnitName  ...  DonorId                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...                ...  ...      ...                              ...        ...          ...           ...               ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN                     ...  74198.0          Shaftesbury Investments          1         2016             4            201604
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN                     ...  74184.0                Mr Jeremy Hosking          1         2016             2            201602
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN                     ...  23556.0                   Anthony Clarke          1         2016             6            201606
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN      Central Party  ...   2146.0                Mr Peter A Dubens          1         2017             5            201705
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN      Central Party  ...  74743.0                 Mr Ravi S Kailas          1         2017             5            201705

[66011 rows x 44 columns],)
2025/02/28 10:07:46 PM INFO:politician_party_dict:    Original RegulatedEntityId  RegulatedEntityId OriginalRegulatedEntityName  RegulatedEntityName   RegisterName                   RegulatedDoneeType RegulatedEntityType      CleanedName    Status PoliticalParty_pdpy
0                        6304               6304             Alec Shelbrooke      Alec Shelbrooke  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee  Alec Shelbrooke       NaN        Conservative
1                        6423               6423           Andrew Bingham Mp    Andrew Bingham Mp  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee   Andrew Bingham        Mp        Conservative
2                        1425               1425         Mr Boris Johnson Mp  Mr Boris Johnson Mp  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee    Boris Johnson   Mr & Mp        Conservative
3                        2061               2061          Mr John Lamont Msp   Mr John Lamont Msp  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee      John Lamont  Mr & Msp        Conservative
4                        6417               6417              Mr Sean Anstee       Mr Sean Anstee  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee      Sean Anstee        Mr             Unknown
2025/02/28 10:07:46 PM INFO:PartyUpdate_df: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}
2025/02/28 10:07:46 PM INFO:loaddata_df:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ...                        DonorName EventCount YearReceived MonthReceived YearMonthReceived PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...  Conservative And Unionist Party          1         2019             9            201909     NaN
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...  Conservative And Unionist Party          1         2019             9            201909     NaN
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...  Conservative And Unionist Party          1         2019             8            201908     NaN
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...  Conservative And Unionist Party          1         2019             8            201908     NaN
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...  Conservative And Unionist Party          1         2019             8            201908     0.0

[5 rows x 45 columns]
2025/02/28 10:07:46 PM ERROR:Error in map_mp_to_party: "['PartyId'] not in index"
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 37, in map_mp_to_party
    RegulatedEntityNameMatch = RegulatedEntityNameMatch[['PartyId', 'PartyName']]
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PartyId'] not in index"
2025/02/28 10:07:46 PM ERROR:Error in load_cleaned_data: "['PartyId'] not in index"
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 37, in map_mp_to_party
    RegulatedEntityNameMatch = RegulatedEntityNameMatch[['PartyId', 'PartyName']]
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PartyId'] not in index"
2025/02/28 10:07:46 PM ERROR:Error in get_cleaned_data: "['PartyId'] not in index"
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 24, in get_cleaned_data
    return load_cleaned_data(datafile=None, output_csv=True, streamlitrun=True)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 37, in map_mp_to_party
    RegulatedEntityNameMatch = RegulatedEntityNameMatch[['PartyId', 'PartyName']]
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PartyId'] not in index"
2025/02/28 10:07:46 PM ERROR:Error in load_data_to_session: "['PartyId'] not in index"
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 50, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 24, in get_cleaned_data
    return load_cleaned_data(datafile=None, output_csv=True, streamlitrun=True)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 37, in map_mp_to_party
    RegulatedEntityNameMatch = RegulatedEntityNameMatch[['PartyId', 'PartyName']]
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PartyId'] not in index"
2025/02/28 10:07:46 PM ERROR:Error in firstload: "['PartyId'] not in index"
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 56, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 50, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 24, in get_cleaned_data
    return load_cleaned_data(datafile=None, output_csv=True, streamlitrun=True)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 37, in map_mp_to_party
    RegulatedEntityNameMatch = RegulatedEntityNameMatch[['PartyId', 'PartyName']]
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PartyId'] not in index"
2025/02/28 10:10:45 PM INFO:Logging is set up correctly!
2025/02/28 10:10:45 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\utils',)
2025/02/28 10:10:45 PM INFO:get_git_version executed successfully
2025/02/28 10:10:45 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\data',)
2025/02/28 10:10:45 PM INFO:get_git_version executed successfully
2025/02/28 10:10:46 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\components',)
2025/02/28 10:10:46 PM INFO:get_git_version executed successfully
2025/02/28 10:10:46 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/02/28 10:10:46 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/02/28 10:10:46 PM INFO:Setting up the package
2025/02/28 10:10:46 PM INFO:Setting up the package
2025/02/28 10:10:46 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/02/28 10:10:46 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/02/28 10:10:46 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',)
2025/02/28 10:10:46 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',)
2025/02/28 10:10:46 PM INFO:get_git_version executed successfully
2025/02/28 10:10:46 PM INFO:get_git_version executed successfully
2025/02/28 10:10:46 PM INFO:Version: v20.113
2025/02/28 10:10:46 PM INFO:Version: v20.113
2025/02/28 10:10:46 PM INFO:Calling initialize_session_state with args=()
2025/02/28 10:10:46 PM INFO:Calling initialize_session_state with args=()
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('BASE_DIR', 'H:\\VScode\\dashboard_demo-1')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('BASE_DIR', 'H:\\VScode\\dashboard_demo-1')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('filenames', {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}})
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('filenames', {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}})
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('PLACEHOLDER_DATE', Timestamp('1900-01-01 00:00:00'))
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('PLACEHOLDER_DATE', Timestamp('1900-01-01 00:00:00'))
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('PLACEHOLDER_ID', 1000001)
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('PLACEHOLDER_ID', 1000001)
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('thresholds', {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'})
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('thresholds', {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'})
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('data_remappings', {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}})
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('data_remappings', {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}})
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('filter_def', {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}})
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('filter_def', {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}})
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('security', {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''})
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('security', {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''})
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('perc_target', 0.5)
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('perc_target', 0.5)
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('directories', {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'})
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('directories', {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'})
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('reference_dir', 'H:\\VScode\\dashboard_demo-1\\reference_files')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('reference_dir', 'H:\\VScode\\dashboard_demo-1\\reference_files')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('data_dir', 'H:\\VScode\\dashboard_demo-1\\data')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('data_dir', 'H:\\VScode\\dashboard_demo-1\\data')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('output_dir', 'H:\\VScode\\dashboard_demo-1\\output')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('output_dir', 'H:\\VScode\\dashboard_demo-1\\output')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('logs_dir', 'H:\\VScode\\dashboard_demo-1\\logs')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('logs_dir', 'H:\\VScode\\dashboard_demo-1\\logs')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('components_dir', 'H:\\VScode\\dashboard_demo-1\\components')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('components_dir', 'H:\\VScode\\dashboard_demo-1\\components')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('app_pages_dir', 'H:\\VScode\\dashboard_demo-1\\app_pages')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('app_pages_dir', 'H:\\VScode\\dashboard_demo-1\\app_pages')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('utils_dir', 'H:\\VScode\\dashboard_demo-1\\utils')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('utils_dir', 'H:\\VScode\\dashboard_demo-1\\utils')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('directories', {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'})
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('directories', {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'})
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('Donor_dedupe_cleaned_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\Donor_dedupe_cleaned_data.csv')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('Donor_dedupe_cleaned_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\Donor_dedupe_cleaned_data.csv')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('ListofPoliticalPeople_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\ListOfPoliticalPeople.csv')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('ListofPoliticalPeople_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\ListOfPoliticalPeople.csv')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('mppartymemb_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\mppartymemb_pypd.csv')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('mppartymemb_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\mppartymemb_pypd.csv')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('donor_map_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\PoliticalDonorsDeDuped.csv')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('donor_map_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\PoliticalDonorsDeDuped.csv')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('politician_party_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\ListOfPoliticalPeople_Final.csv')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('politician_party_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\ListOfPoliticalPeople_Final.csv')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('regentity_map_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\PoliticalEntityDeDuped.csv')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('regentity_map_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\PoliticalEntityDeDuped.csv')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('potential_donor_duplicates_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\potential_donor_duplicates.csv')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('potential_donor_duplicates_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\potential_donor_duplicates.csv')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('potential_regulatedentity_duplicates_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\potential_regentiity_duplicates.csv')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('potential_regulatedentity_duplicates_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\potential_regentiity_duplicates.csv')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('original_data_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\original_data.csv')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('original_data_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\original_data.csv')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('CREDENTIALS_FILE', 'H:\\VScode\\dashboard_demo-1\\reference_files\\admin_credentials.json')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('CREDENTIALS_FILE', 'H:\\VScode\\dashboard_demo-1\\reference_files\\admin_credentials.json')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('TEXT_FILE', 'H:\\VScode\\dashboard_demo-1\\reference_files\\admin_text.json')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('TEXT_FILE', 'H:\\VScode\\dashboard_demo-1\\reference_files\\admin_text.json')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('cleaned_data_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_data.csv')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('cleaned_data_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_data.csv')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('cleaned_donations_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_donations.csv')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('cleaned_donations_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_donations.csv')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('cleaned_donorlist_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_donorlist.csv')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('cleaned_donorlist_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_donorlist.csv')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('cleaned_regentity_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_regentity.csv')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('cleaned_regentity_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_regentity.csv')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('party_summary_fname', 'H:\\VScode\\dashboard_demo-1\\output\\party_summary.csv')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('party_summary_fname', 'H:\\VScode\\dashboard_demo-1\\output\\party_summary.csv')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'Donations_accepted_by_political_parties.csv')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'Donations_accepted_by_political_parties.csv')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'H:\\VScode\\dashboard_demo-1\\Donations_accepted_by_political_parties.csv')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'H:\\VScode\\dashboard_demo-1\\Donations_accepted_by_political_parties.csv')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'H:\\VScode\\dashboard_demo-1\\Donations_accepted_by_political_parties.csv')
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'H:\\VScode\\dashboard_demo-1\\Donations_accepted_by_political_parties.csv')
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('Cash_ftr', {'DonationType': 'Cash'})
2025/02/28 10:10:46 PM INFO:Calling init_state_var with args=('Cash_ftr', {'DonationType': 'Cash'})
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:init_state_var executed successfully
2025/02/28 10:10:46 PM INFO:Session_state variables initialized
2025/02/28 10:10:46 PM INFO:Session_state variables initialized
2025/02/28 10:10:46 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/02/28 10:10:46 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/02/28 10:10:46 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/02/28 10:10:46 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/02/28 10:10:46 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/02/28 10:10:46 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/02/28 10:10:46 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/02/28 10:10:46 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/02/28 10:10:46 PM INFO:perc_target: 0.5
2025/02/28 10:10:46 PM INFO:perc_target: 0.5
2025/02/28 10:10:46 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/02/28 10:10:46 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/02/28 10:10:46 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/02/28 10:10:46 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/02/28 10:10:46 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/02/28 10:10:46 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/02/28 10:10:46 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/02/28 10:10:46 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/02/28 10:10:46 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/02/28 10:10:46 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/02/28 10:10:46 PM INFO:directories: {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/02/28 10:10:46 PM INFO:directories: {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/02/28 10:10:46 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/02/28 10:10:46 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/02/28 10:10:46 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/02/28 10:10:46 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/02/28 10:10:46 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/02/28 10:10:46 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/02/28 10:10:46 PM INFO:PLACEHOLDER_ID: 1000001
2025/02/28 10:10:46 PM INFO:PLACEHOLDER_ID: 1000001
2025/02/28 10:10:46 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/02/28 10:10:46 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/02/28 10:10:46 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/02/28 10:10:46 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/02/28 10:10:46 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/02/28 10:10:46 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/02/28 10:10:46 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/02/28 10:10:46 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/02/28 10:10:46 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/02/28 10:10:46 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/02/28 10:10:46 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/02/28 10:10:46 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/02/28 10:10:46 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/02/28 10:10:46 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/02/28 10:10:46 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/02/28 10:10:46 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/02/28 10:10:46 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/02/28 10:10:46 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/02/28 10:10:46 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/02/28 10:10:46 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/02/28 10:10:46 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/02/28 10:10:46 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/02/28 10:10:46 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/02/28 10:10:46 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/02/28 10:10:46 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/02/28 10:10:46 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/02/28 10:10:46 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/02/28 10:10:46 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/02/28 10:10:46 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/02/28 10:10:46 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/02/28 10:10:46 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/02/28 10:10:46 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/02/28 10:10:46 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/02/28 10:10:46 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/02/28 10:10:46 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/02/28 10:10:46 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/02/28 10:10:46 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/02/28 10:10:46 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/02/28 10:10:46 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/02/28 10:10:46 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/02/28 10:10:46 PM INFO:Session state Setup complete
2025/02/28 10:10:46 PM INFO:Session state Setup complete
2025/02/28 10:10:46 PM INFO:initialize_session_state executed successfully
2025/02/28 10:10:46 PM INFO:initialize_session_state executed successfully
2025/02/28 10:10:46 PM INFO:Package setup complete
2025/02/28 10:10:46 PM INFO:Package setup complete
2025/02/28 10:10:46 PM INFO:Calling pagesetup with args=()
2025/02/28 10:10:46 PM INFO:Calling pagesetup with args=()
2025/02/28 10:10:46 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\app_pages',)
2025/02/28 10:10:46 PM INFO:get_git_version executed successfully
2025/02/28 10:10:46 PM INFO:Calling get_git_version with args=()
2025/02/28 10:10:46 PM INFO:get_git_version executed successfully
2025/02/28 10:10:46 PM INFO:App Version: v20.128
2025/02/28 10:10:46 PM INFO:Switched to page: Introduction
2025/02/28 10:10:46 PM INFO:pagesetup executed successfully
2025/02/28 10:10:46 PM INFO:Calling firstload with args=()
2025/02/28 10:10:46 PM INFO:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x000001E98FF6E7A0>)
2025/02/28 10:10:46 PM INFO:Calling get_raw_data with args=()
2025/02/28 10:10:46 PM INFO:Calling load_raw_data with args=()
2025/02/28 10:10:47 PM INFO:Calling raw_data_cleanup with args=(           ECRef              RegulatedEntityName    RegulatedEntityType        Value AcceptedDate AccountingUnitName  ... RegulatedEntityId AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                                                  ...                                                                                         
0      NC0408174                   Mr Andy Street        Regulated Donee    £1,876.56   02/09/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    £2,700.00   02/09/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    £4,852.58   30/08/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    £2,500.00   30/08/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    £4,524.05   29/08/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
...          ...                              ...                    ...          ...          ...                ...  ...               ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   £10,000.00          NaN                NaN  ...              3945              NaN  74198.0             NaN            NaN         False
65274   C0242461               Vote Leave Limited  Permitted Participant  £100,000.00          NaN                NaN  ...              3945              NaN  74184.0             NaN            NaN         False
65275   C0243560               Vote Leave Limited  Permitted Participant   £40,000.00          NaN                NaN  ...              3945              NaN  74576.0             NaN            NaN         False
65276   C0319710  Conservative and Unionist Party        Political Party   £50,000.00          NaN      Central Party  ...                52              NaN  34241.0             NaN  Great Britain         False
65277   C0319727  Conservative and Unionist Party        Political Party   £15,000.00          NaN      Central Party  ...                52              NaN  74743.0             NaN  Great Britain         False

[65278 rows x 29 columns],)
2025/02/28 10:10:48 PM INFO:Calling dedupe_entity_file with args=()
2025/02/28 10:10:48 PM INFO:map_filename: regentity_map_fname
2025/02/28 10:10:48 PM INFO:map_filename found: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/02/28 10:10:48 PM INFO:Dedupe by file
2025/02/28 10:10:48 PM INFO:Dedupe by file, shape: (65279, 34)
2025/02/28 10:10:48 PM INFO:dedupe_entity_file executed successfully
2025/02/28 10:10:48 PM INFO:Calling dedupe_entity_file with args=()
2025/02/28 10:10:48 PM INFO:map_filename: donor_map_fname
2025/02/28 10:10:48 PM INFO:map_filename found: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/02/28 10:10:48 PM INFO:Dedupe by file
2025/02/28 10:10:48 PM INFO:Dedupe by file, shape: (66011, 40)
2025/02/28 10:10:48 PM INFO:dedupe_entity_file executed successfully
2025/02/28 10:10:48 PM INFO:Data cleanup completed, shape: (66011, 40)
2025/02/28 10:10:48 PM INFO:raw_data_cleanup executed successfully
2025/02/28 10:10:49 PM INFO:load_raw_data executed successfully
2025/02/28 10:10:50 PM INFO:get_raw_data executed successfully
2025/02/28 10:10:50 PM INFO:Calling get_git_version with args=()
2025/02/28 10:10:50 PM INFO:get_git_version executed successfully
2025/02/28 10:10:50 PM INFO:App Version: v20.128
2025/02/28 10:10:50 PM INFO:Switched to page: Introduction
2025/02/28 10:10:50 PM INFO:pagesetup executed successfully
2025/02/28 10:10:50 PM INFO:Calling firstload with args=()
2025/02/28 10:10:50 PM INFO:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x000001E98FF6E7A0>)
2025/02/28 10:10:50 PM INFO:Calling get_raw_data with args=()
2025/02/28 10:10:50 PM INFO:get_raw_data executed successfully
2025/02/28 10:10:50 PM INFO:load_data_to_session executed successfully
2025/02/28 10:10:50 PM INFO:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x000001E98FF6F010>)
2025/02/28 10:10:50 PM INFO:Calling get_cleaned_data with args=()
2025/02/28 10:10:50 PM INFO:Calling load_cleaned_data with args=()
2025/02/28 10:10:53 PM INFO:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate AccountingUnitName  ...  DonorId                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...                ...  ...      ...                              ...        ...          ...           ...               ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN                     ...  74198.0          Shaftesbury Investments          1         2016             4            201604
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN                     ...  74184.0                Mr Jeremy Hosking          1         2016             2            201602
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN                     ...  23556.0                   Anthony Clarke          1         2016             6            201606
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN      Central Party  ...   2146.0                Mr Peter A Dubens          1         2017             5            201705
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN      Central Party  ...  74743.0                 Mr Ravi S Kailas          1         2017             5            201705

[66011 rows x 44 columns],)
2025/02/28 10:10:53 PM INFO:politician_party_dict:    Original RegulatedEntityId  RegulatedEntityId OriginalRegulatedEntityName  RegulatedEntityName   RegisterName                   RegulatedDoneeType RegulatedEntityType      CleanedName    Status PoliticalParty_pdpy
0                        6304               6304             Alec Shelbrooke      Alec Shelbrooke  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee  Alec Shelbrooke       NaN        Conservative
1                        6423               6423           Andrew Bingham Mp    Andrew Bingham Mp  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee   Andrew Bingham        Mp        Conservative
2                        1425               1425         Mr Boris Johnson Mp  Mr Boris Johnson Mp  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee    Boris Johnson   Mr & Mp        Conservative
3                        2061               2061          Mr John Lamont Msp   Mr John Lamont Msp  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee      John Lamont  Mr & Msp        Conservative
4                        6417               6417              Mr Sean Anstee       Mr Sean Anstee  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee      Sean Anstee        Mr             Unknown
2025/02/28 10:10:53 PM INFO:PartyUpdate_df: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}
2025/02/28 10:10:53 PM INFO:loaddata_df:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ...                        DonorName EventCount YearReceived MonthReceived YearMonthReceived PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...  Conservative And Unionist Party          1         2019             9            201909     NaN
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...  Conservative And Unionist Party          1         2019             9            201909     NaN
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...  Conservative And Unionist Party          1         2019             8            201908     NaN
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...  Conservative And Unionist Party          1         2019             8            201908     NaN
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...  Conservative And Unionist Party          1         2019             8            201908     0.0

[5 rows x 45 columns]
2025/02/28 10:10:53 PM ERROR:Error in map_mp_to_party: "['PartyId'] not in index"
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 52, in map_mp_to_party
    RegulatedEntityNameMatch[['PartyId', 'PartyName']]
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PartyId'] not in index"
2025/02/28 10:10:53 PM ERROR:Error in load_cleaned_data: "['PartyId'] not in index"
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 52, in map_mp_to_party
    RegulatedEntityNameMatch[['PartyId', 'PartyName']]
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PartyId'] not in index"
2025/02/28 10:10:53 PM ERROR:Error in get_cleaned_data: "['PartyId'] not in index"
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 24, in get_cleaned_data
    return load_cleaned_data(datafile=None, output_csv=True, streamlitrun=True)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 52, in map_mp_to_party
    RegulatedEntityNameMatch[['PartyId', 'PartyName']]
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PartyId'] not in index"
2025/02/28 10:10:53 PM ERROR:Error in load_data_to_session: "['PartyId'] not in index"
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 50, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 24, in get_cleaned_data
    return load_cleaned_data(datafile=None, output_csv=True, streamlitrun=True)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 52, in map_mp_to_party
    RegulatedEntityNameMatch[['PartyId', 'PartyName']]
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PartyId'] not in index"
2025/02/28 10:10:53 PM ERROR:Error in firstload: "['PartyId'] not in index"
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 56, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 50, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 24, in get_cleaned_data
    return load_cleaned_data(datafile=None, output_csv=True, streamlitrun=True)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 52, in map_mp_to_party
    RegulatedEntityNameMatch[['PartyId', 'PartyName']]
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PartyId'] not in index"
2025/02/28 10:15:15 PM INFO:Logging is set up correctly!
2025/02/28 10:15:15 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\utils',)
2025/02/28 10:15:15 PM INFO:get_git_version executed successfully
2025/02/28 10:15:16 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\data',)
2025/02/28 10:15:16 PM INFO:get_git_version executed successfully
2025/02/28 10:15:16 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\components',)
2025/02/28 10:15:16 PM INFO:get_git_version executed successfully
2025/02/28 10:15:16 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/02/28 10:15:16 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/02/28 10:15:16 PM INFO:Setting up the package
2025/02/28 10:15:16 PM INFO:Setting up the package
2025/02/28 10:15:16 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/02/28 10:15:16 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/02/28 10:15:16 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',)
2025/02/28 10:15:16 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',)
2025/02/28 10:15:16 PM INFO:get_git_version executed successfully
2025/02/28 10:15:16 PM INFO:get_git_version executed successfully
2025/02/28 10:15:16 PM INFO:Version: v20.113
2025/02/28 10:15:16 PM INFO:Version: v20.113
2025/02/28 10:15:16 PM INFO:Calling initialize_session_state with args=()
2025/02/28 10:15:16 PM INFO:Calling initialize_session_state with args=()
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('BASE_DIR', 'H:\\VScode\\dashboard_demo-1')
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('BASE_DIR', 'H:\\VScode\\dashboard_demo-1')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('filenames', {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}})
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('filenames', {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}})
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('PLACEHOLDER_DATE', Timestamp('1900-01-01 00:00:00'))
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('PLACEHOLDER_DATE', Timestamp('1900-01-01 00:00:00'))
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('PLACEHOLDER_ID', 1000001)
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('PLACEHOLDER_ID', 1000001)
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('thresholds', {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'})
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('thresholds', {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'})
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('data_remappings', {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}})
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('data_remappings', {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}})
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('filter_def', {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}})
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('filter_def', {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}})
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('security', {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''})
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('security', {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''})
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('perc_target', 0.5)
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('perc_target', 0.5)
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('directories', {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'})
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('directories', {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'})
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('reference_dir', 'H:\\VScode\\dashboard_demo-1\\reference_files')
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('reference_dir', 'H:\\VScode\\dashboard_demo-1\\reference_files')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('data_dir', 'H:\\VScode\\dashboard_demo-1\\data')
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('data_dir', 'H:\\VScode\\dashboard_demo-1\\data')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('output_dir', 'H:\\VScode\\dashboard_demo-1\\output')
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('output_dir', 'H:\\VScode\\dashboard_demo-1\\output')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('logs_dir', 'H:\\VScode\\dashboard_demo-1\\logs')
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('logs_dir', 'H:\\VScode\\dashboard_demo-1\\logs')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('components_dir', 'H:\\VScode\\dashboard_demo-1\\components')
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('components_dir', 'H:\\VScode\\dashboard_demo-1\\components')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('app_pages_dir', 'H:\\VScode\\dashboard_demo-1\\app_pages')
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('app_pages_dir', 'H:\\VScode\\dashboard_demo-1\\app_pages')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('utils_dir', 'H:\\VScode\\dashboard_demo-1\\utils')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('utils_dir', 'H:\\VScode\\dashboard_demo-1\\utils')
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('directories', {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'})
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('directories', {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'})
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('Donor_dedupe_cleaned_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\Donor_dedupe_cleaned_data.csv')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('ListofPoliticalPeople_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\ListOfPoliticalPeople.csv')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('Donor_dedupe_cleaned_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\Donor_dedupe_cleaned_data.csv')
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('mppartymemb_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\mppartymemb_pypd.csv')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('ListofPoliticalPeople_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\ListOfPoliticalPeople.csv')
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('donor_map_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\PoliticalDonorsDeDuped.csv')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('mppartymemb_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\mppartymemb_pypd.csv')
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('politician_party_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\ListOfPoliticalPeople_Final.csv')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('donor_map_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\PoliticalDonorsDeDuped.csv')
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('regentity_map_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\PoliticalEntityDeDuped.csv')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('politician_party_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\ListOfPoliticalPeople_Final.csv')
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('potential_donor_duplicates_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\potential_donor_duplicates.csv')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('regentity_map_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\PoliticalEntityDeDuped.csv')
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('potential_regulatedentity_duplicates_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\potential_regentiity_duplicates.csv')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('potential_donor_duplicates_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\potential_donor_duplicates.csv')
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('original_data_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\original_data.csv')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('potential_regulatedentity_duplicates_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\potential_regentiity_duplicates.csv')
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('CREDENTIALS_FILE', 'H:\\VScode\\dashboard_demo-1\\reference_files\\admin_credentials.json')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('original_data_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\original_data.csv')
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('TEXT_FILE', 'H:\\VScode\\dashboard_demo-1\\reference_files\\admin_text.json')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('CREDENTIALS_FILE', 'H:\\VScode\\dashboard_demo-1\\reference_files\\admin_credentials.json')
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('cleaned_data_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_data.csv')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('TEXT_FILE', 'H:\\VScode\\dashboard_demo-1\\reference_files\\admin_text.json')
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('cleaned_donations_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_donations.csv')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('cleaned_data_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_data.csv')
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('cleaned_donorlist_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_donorlist.csv')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('cleaned_donations_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_donations.csv')
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('cleaned_regentity_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_regentity.csv')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('cleaned_donorlist_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_donorlist.csv')
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('party_summary_fname', 'H:\\VScode\\dashboard_demo-1\\output\\party_summary.csv')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('cleaned_regentity_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_regentity.csv')
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'Donations_accepted_by_political_parties.csv')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('party_summary_fname', 'H:\\VScode\\dashboard_demo-1\\output\\party_summary.csv')
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'H:\\VScode\\dashboard_demo-1\\Donations_accepted_by_political_parties.csv')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'Donations_accepted_by_political_parties.csv')
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'H:\\VScode\\dashboard_demo-1\\Donations_accepted_by_political_parties.csv')
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'H:\\VScode\\dashboard_demo-1\\Donations_accepted_by_political_parties.csv')
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('Cash_ftr', {'DonationType': 'Cash'})
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'H:\\VScode\\dashboard_demo-1\\Donations_accepted_by_political_parties.csv')
2025/02/28 10:15:16 PM INFO:Session_state variables initialized
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/02/28 10:15:16 PM INFO:Calling init_state_var with args=('Cash_ftr', {'DonationType': 'Cash'})
2025/02/28 10:15:16 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/02/28 10:15:16 PM INFO:init_state_var executed successfully
2025/02/28 10:15:16 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/02/28 10:15:16 PM INFO:Session_state variables initialized
2025/02/28 10:15:16 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/02/28 10:15:16 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/02/28 10:15:16 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/02/28 10:15:16 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/02/28 10:15:16 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/02/28 10:15:16 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/02/28 10:15:16 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/02/28 10:15:16 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/02/28 10:15:16 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/02/28 10:15:16 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/02/28 10:15:16 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/02/28 10:15:16 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/02/28 10:15:16 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/02/28 10:15:16 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/02/28 10:15:16 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/02/28 10:15:16 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/02/28 10:15:16 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/02/28 10:15:16 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/02/28 10:15:16 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/02/28 10:15:16 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/02/28 10:15:16 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/02/28 10:15:16 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/02/28 10:15:16 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/02/28 10:15:16 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/02/28 10:15:16 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/02/28 10:15:16 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/02/28 10:15:16 PM INFO:perc_target: 0.5
2025/02/28 10:15:16 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/02/28 10:15:16 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/02/28 10:15:16 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/02/28 10:15:16 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/02/28 10:15:16 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/02/28 10:15:16 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/02/28 10:15:16 PM INFO:perc_target: 0.5
2025/02/28 10:15:16 PM INFO:directories: {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/02/28 10:15:16 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/02/28 10:15:16 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/02/28 10:15:16 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/02/28 10:15:16 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/02/28 10:15:16 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/02/28 10:15:16 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/02/28 10:15:16 PM INFO:directories: {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/02/28 10:15:16 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/02/28 10:15:16 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/02/28 10:15:16 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/02/28 10:15:16 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/02/28 10:15:16 PM INFO:PLACEHOLDER_ID: 1000001
2025/02/28 10:15:16 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/02/28 10:15:16 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/02/28 10:15:16 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/02/28 10:15:16 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/02/28 10:15:16 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/02/28 10:15:16 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/02/28 10:15:16 PM INFO:PLACEHOLDER_ID: 1000001
2025/02/28 10:15:16 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/02/28 10:15:16 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/02/28 10:15:16 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/02/28 10:15:16 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/02/28 10:15:16 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/02/28 10:15:16 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/02/28 10:15:16 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/02/28 10:15:16 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/02/28 10:15:16 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/02/28 10:15:16 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/02/28 10:15:16 PM INFO:Session state Setup complete
2025/02/28 10:15:16 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/02/28 10:15:16 PM INFO:initialize_session_state executed successfully
2025/02/28 10:15:16 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/02/28 10:15:16 PM INFO:Package setup complete
2025/02/28 10:15:16 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/02/28 10:15:16 PM INFO:Session state Setup complete
2025/02/28 10:15:16 PM INFO:Calling pagesetup with args=()
2025/02/28 10:15:16 PM INFO:initialize_session_state executed successfully
2025/02/28 10:15:16 PM INFO:Package setup complete
2025/02/28 10:15:16 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\app_pages',)
2025/02/28 10:15:16 PM INFO:Calling pagesetup with args=()
2025/02/28 10:15:16 PM INFO:get_git_version executed successfully
2025/02/28 10:15:16 PM INFO:Calling get_git_version with args=()
2025/02/28 10:15:17 PM INFO:get_git_version executed successfully
2025/02/28 10:15:17 PM INFO:App Version: v20.128
2025/02/28 10:15:17 PM INFO:Switched to page: Introduction
2025/02/28 10:15:17 PM INFO:pagesetup executed successfully
2025/02/28 10:15:17 PM INFO:Calling firstload with args=()
2025/02/28 10:15:17 PM INFO:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x000001EB7276E7A0>)
2025/02/28 10:15:17 PM INFO:Calling get_raw_data with args=()
2025/02/28 10:15:17 PM INFO:Calling load_raw_data with args=()
2025/02/28 10:15:17 PM INFO:Calling raw_data_cleanup with args=(           ECRef              RegulatedEntityName    RegulatedEntityType        Value AcceptedDate AccountingUnitName  ... RegulatedEntityId AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                                                  ...                                                                                         
0      NC0408174                   Mr Andy Street        Regulated Donee    £1,876.56   02/09/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    £2,700.00   02/09/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    £4,852.58   30/08/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    £2,500.00   30/08/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    £4,524.05   29/08/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
...          ...                              ...                    ...          ...          ...                ...  ...               ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   £10,000.00          NaN                NaN  ...              3945              NaN  74198.0             NaN            NaN         False
65274   C0242461               Vote Leave Limited  Permitted Participant  £100,000.00          NaN                NaN  ...              3945              NaN  74184.0             NaN            NaN         False
65275   C0243560               Vote Leave Limited  Permitted Participant   £40,000.00          NaN                NaN  ...              3945              NaN  74576.0             NaN            NaN         False
65276   C0319710  Conservative and Unionist Party        Political Party   £50,000.00          NaN      Central Party  ...                52              NaN  34241.0             NaN  Great Britain         False
65277   C0319727  Conservative and Unionist Party        Political Party   £15,000.00          NaN      Central Party  ...                52              NaN  74743.0             NaN  Great Britain         False

[65278 rows x 29 columns],)
2025/02/28 10:15:18 PM INFO:Calling dedupe_entity_file with args=()
2025/02/28 10:15:18 PM INFO:map_filename: regentity_map_fname
2025/02/28 10:15:18 PM INFO:map_filename found: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/02/28 10:15:18 PM INFO:Dedupe by file
2025/02/28 10:15:18 PM INFO:Dedupe by file, shape: (65279, 34)
2025/02/28 10:15:18 PM INFO:dedupe_entity_file executed successfully
2025/02/28 10:15:18 PM INFO:Calling dedupe_entity_file with args=()
2025/02/28 10:15:18 PM INFO:map_filename: donor_map_fname
2025/02/28 10:15:18 PM INFO:map_filename found: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/02/28 10:15:18 PM INFO:Dedupe by file
2025/02/28 10:15:18 PM INFO:Dedupe by file, shape: (66011, 40)
2025/02/28 10:15:18 PM INFO:dedupe_entity_file executed successfully
2025/02/28 10:15:18 PM INFO:Data cleanup completed, shape: (66011, 40)
2025/02/28 10:15:18 PM INFO:raw_data_cleanup executed successfully
2025/02/28 10:15:20 PM INFO:load_raw_data executed successfully
2025/02/28 10:15:20 PM INFO:get_raw_data executed successfully
2025/02/28 10:15:20 PM INFO:load_data_to_session executed successfully
2025/02/28 10:15:20 PM INFO:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x000001EB7276F010>)
2025/02/28 10:15:20 PM INFO:Calling get_cleaned_data with args=()
2025/02/28 10:15:20 PM INFO:Calling load_cleaned_data with args=()
2025/02/28 10:15:23 PM INFO:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate AccountingUnitName  ...  DonorId                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...                ...  ...      ...                              ...        ...          ...           ...               ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN                     ...  74198.0          Shaftesbury Investments          1         2016             4            201604
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN                     ...  74184.0                Mr Jeremy Hosking          1         2016             2            201602
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN                     ...  23556.0                   Anthony Clarke          1         2016             6            201606
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN      Central Party  ...   2146.0                Mr Peter A Dubens          1         2017             5            201705
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN      Central Party  ...  74743.0                 Mr Ravi S Kailas          1         2017             5            201705

[66011 rows x 44 columns],)
2025/02/28 10:15:23 PM INFO:politician_party_dict:    Original RegulatedEntityId  RegulatedEntityId OriginalRegulatedEntityName  RegulatedEntityName   RegisterName                   RegulatedDoneeType RegulatedEntityType      CleanedName    Status PoliticalParty_pdpy
0                        6304               6304             Alec Shelbrooke      Alec Shelbrooke  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee  Alec Shelbrooke       NaN        Conservative
1                        6423               6423           Andrew Bingham Mp    Andrew Bingham Mp  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee   Andrew Bingham        Mp        Conservative
2                        1425               1425         Mr Boris Johnson Mp  Mr Boris Johnson Mp  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee    Boris Johnson   Mr & Mp        Conservative
3                        2061               2061          Mr John Lamont Msp   Mr John Lamont Msp  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee      John Lamont  Mr & Msp        Conservative
4                        6417               6417              Mr Sean Anstee       Mr Sean Anstee  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee      Sean Anstee        Mr             Unknown
2025/02/28 10:15:23 PM INFO:PartyUpdate_df: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}
2025/02/28 10:15:23 PM INFO:loaddata_df:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ...                        DonorName EventCount YearReceived MonthReceived YearMonthReceived PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...  Conservative And Unionist Party          1         2019             9            201909     NaN
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...  Conservative And Unionist Party          1         2019             9            201909     NaN
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...  Conservative And Unionist Party          1         2019             8            201908     NaN
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...  Conservative And Unionist Party          1         2019             8            201908     NaN
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...  Conservative And Unionist Party          1         2019             8            201908     0.0

[5 rows x 45 columns]
2025/02/28 10:15:23 PM INFO:RegulatedEntityNameMatch:    CleanedRegulatedEntityId  RegulatedEntityId                                          PartyName                                RegulatedEntityName
0                        17                 17                                  English Democrats                                  English Democrats
1                        19                 19                         Legalise Cannabis Alliance                         Legalise Cannabis Alliance
2                        30                 30        Upminster And Cranham Residents Association        Upminster And Cranham Residents Association
3                        44                 44  Independent Kidderminster Hospital And Health ...  Independent Kidderminster Hospital And Health ...
4                        46                 46                           Scottish Socialist Party                           Scottish Socialist Party
2025/02/28 10:15:23 PM ERROR:Error in map_mp_to_party: "['PartyId'] not in index"
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 55, in map_mp_to_party
    RegulatedEntityNameMatch[['PartyId', 'PartyName']]
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PartyId'] not in index"
2025/02/28 10:15:23 PM ERROR:Error in load_cleaned_data: "['PartyId'] not in index"
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 55, in map_mp_to_party
    RegulatedEntityNameMatch[['PartyId', 'PartyName']]
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PartyId'] not in index"
2025/02/28 10:15:23 PM ERROR:Error in get_cleaned_data: "['PartyId'] not in index"
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 24, in get_cleaned_data
    return load_cleaned_data(datafile=None, output_csv=True, streamlitrun=True)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 55, in map_mp_to_party
    RegulatedEntityNameMatch[['PartyId', 'PartyName']]
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PartyId'] not in index"
2025/02/28 10:15:23 PM ERROR:Error in load_data_to_session: "['PartyId'] not in index"
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 50, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 24, in get_cleaned_data
    return load_cleaned_data(datafile=None, output_csv=True, streamlitrun=True)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 55, in map_mp_to_party
    RegulatedEntityNameMatch[['PartyId', 'PartyName']]
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PartyId'] not in index"
2025/02/28 10:15:23 PM ERROR:Error in firstload: "['PartyId'] not in index"
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 56, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 50, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 24, in get_cleaned_data
    return load_cleaned_data(datafile=None, output_csv=True, streamlitrun=True)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 55, in map_mp_to_party
    RegulatedEntityNameMatch[['PartyId', 'PartyName']]
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PartyId'] not in index"
2025/02/28 10:15:23 PM INFO:Calling get_git_version with args=()
2025/02/28 10:15:23 PM INFO:get_git_version executed successfully
2025/02/28 10:15:23 PM INFO:App Version: v20.128
2025/02/28 10:15:23 PM INFO:Switched to page: Introduction
2025/02/28 10:15:23 PM INFO:pagesetup executed successfully
2025/02/28 10:15:23 PM INFO:Calling firstload with args=()
2025/02/28 10:15:23 PM INFO:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x000001EB7276E7A0>)
2025/02/28 10:15:23 PM INFO:Calling get_raw_data with args=()
2025/02/28 10:15:23 PM INFO:get_raw_data executed successfully
2025/02/28 10:15:23 PM INFO:load_data_to_session executed successfully
2025/02/28 10:15:23 PM INFO:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x000001EB7276F010>)
2025/02/28 10:15:23 PM INFO:Calling get_cleaned_data with args=()
2025/02/28 10:15:23 PM INFO:Calling load_cleaned_data with args=()
2025/02/28 10:15:26 PM INFO:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate AccountingUnitName  ...  DonorId                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...                ...  ...      ...                              ...        ...          ...           ...               ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN                     ...  74198.0          Shaftesbury Investments          1         2016             4            201604
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN                     ...  74184.0                Mr Jeremy Hosking          1         2016             2            201602
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN                     ...  23556.0                   Anthony Clarke          1         2016             6            201606
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN      Central Party  ...   2146.0                Mr Peter A Dubens          1         2017             5            201705
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN      Central Party  ...  74743.0                 Mr Ravi S Kailas          1         2017             5            201705

[66011 rows x 44 columns],)
2025/02/28 10:15:26 PM INFO:politician_party_dict:    Original RegulatedEntityId  RegulatedEntityId OriginalRegulatedEntityName  RegulatedEntityName   RegisterName                   RegulatedDoneeType RegulatedEntityType      CleanedName    Status PoliticalParty_pdpy
0                        6304               6304             Alec Shelbrooke      Alec Shelbrooke  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee  Alec Shelbrooke       NaN        Conservative
1                        6423               6423           Andrew Bingham Mp    Andrew Bingham Mp  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee   Andrew Bingham        Mp        Conservative
2                        1425               1425         Mr Boris Johnson Mp  Mr Boris Johnson Mp  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee    Boris Johnson   Mr & Mp        Conservative
3                        2061               2061          Mr John Lamont Msp   Mr John Lamont Msp  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee      John Lamont  Mr & Msp        Conservative
4                        6417               6417              Mr Sean Anstee       Mr Sean Anstee  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee      Sean Anstee        Mr             Unknown
2025/02/28 10:15:26 PM INFO:PartyUpdate_df: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}
2025/02/28 10:15:26 PM INFO:loaddata_df:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ...                        DonorName EventCount YearReceived MonthReceived YearMonthReceived PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...  Conservative And Unionist Party          1         2019             9            201909     NaN
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...  Conservative And Unionist Party          1         2019             9            201909     NaN
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...  Conservative And Unionist Party          1         2019             8            201908     NaN
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...  Conservative And Unionist Party          1         2019             8            201908     NaN
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...  Conservative And Unionist Party          1         2019             8            201908     0.0

[5 rows x 45 columns]
2025/02/28 10:15:26 PM INFO:RegulatedEntityNameMatch:    CleanedRegulatedEntityId  RegulatedEntityId                                          PartyName                                RegulatedEntityName
0                        17                 17                                  English Democrats                                  English Democrats
1                        19                 19                         Legalise Cannabis Alliance                         Legalise Cannabis Alliance
2                        30                 30        Upminster And Cranham Residents Association        Upminster And Cranham Residents Association
3                        44                 44  Independent Kidderminster Hospital And Health ...  Independent Kidderminster Hospital And Health ...
4                        46                 46                           Scottish Socialist Party                           Scottish Socialist Party
2025/02/28 10:15:26 PM ERROR:Error in map_mp_to_party: "['PartyId'] not in index"
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 55, in map_mp_to_party
    RegulatedEntityNameMatch[['PartyId', 'PartyName']]
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PartyId'] not in index"
2025/02/28 10:15:26 PM ERROR:Error in load_cleaned_data: "['PartyId'] not in index"
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 55, in map_mp_to_party
    RegulatedEntityNameMatch[['PartyId', 'PartyName']]
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PartyId'] not in index"
2025/02/28 10:15:26 PM ERROR:Error in get_cleaned_data: "['PartyId'] not in index"
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 24, in get_cleaned_data
    return load_cleaned_data(datafile=None, output_csv=True, streamlitrun=True)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 55, in map_mp_to_party
    RegulatedEntityNameMatch[['PartyId', 'PartyName']]
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PartyId'] not in index"
2025/02/28 10:15:26 PM ERROR:Error in load_data_to_session: "['PartyId'] not in index"
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 50, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 24, in get_cleaned_data
    return load_cleaned_data(datafile=None, output_csv=True, streamlitrun=True)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 55, in map_mp_to_party
    RegulatedEntityNameMatch[['PartyId', 'PartyName']]
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PartyId'] not in index"
2025/02/28 10:15:26 PM ERROR:Error in firstload: "['PartyId'] not in index"
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 56, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 50, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 24, in get_cleaned_data
    return load_cleaned_data(datafile=None, output_csv=True, streamlitrun=True)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 55, in map_mp_to_party
    RegulatedEntityNameMatch[['PartyId', 'PartyName']]
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['PartyId'] not in index"
2025/02/28 10:18:03 PM INFO:Logging is set up correctly!
2025/02/28 10:18:03 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\utils',)
2025/02/28 10:18:03 PM INFO:get_git_version executed successfully
2025/02/28 10:18:04 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\data',)
2025/02/28 10:18:04 PM INFO:get_git_version executed successfully
2025/02/28 10:18:04 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\components',)
2025/02/28 10:18:04 PM INFO:get_git_version executed successfully
2025/02/28 10:18:04 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/02/28 10:18:04 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/02/28 10:18:04 PM INFO:Setting up the package
2025/02/28 10:18:04 PM INFO:Setting up the package
2025/02/28 10:18:04 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/02/28 10:18:04 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/02/28 10:18:04 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',)
2025/02/28 10:18:04 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',)
2025/02/28 10:18:04 PM INFO:get_git_version executed successfully
2025/02/28 10:18:04 PM INFO:Version: v20.113
2025/02/28 10:18:04 PM INFO:get_git_version executed successfully
2025/02/28 10:18:04 PM INFO:Calling initialize_session_state with args=()
2025/02/28 10:18:04 PM INFO:Version: v20.113
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('BASE_DIR', 'H:\\VScode\\dashboard_demo-1')
2025/02/28 10:18:04 PM INFO:Calling initialize_session_state with args=()
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('BASE_DIR', 'H:\\VScode\\dashboard_demo-1')
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('filenames', {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}})
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('filenames', {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}})
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('PLACEHOLDER_DATE', Timestamp('1900-01-01 00:00:00'))
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('PLACEHOLDER_DATE', Timestamp('1900-01-01 00:00:00'))
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('PLACEHOLDER_ID', 1000001)
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('PLACEHOLDER_ID', 1000001)
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('thresholds', {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'})
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('thresholds', {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'})
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('data_remappings', {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}})
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('data_remappings', {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}})
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('filter_def', {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}})
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('filter_def', {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}})
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('security', {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''})
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('security', {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''})
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('perc_target', 0.5)
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('perc_target', 0.5)
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('directories', {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'})
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('directories', {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'})
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('reference_dir', 'H:\\VScode\\dashboard_demo-1\\reference_files')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('reference_dir', 'H:\\VScode\\dashboard_demo-1\\reference_files')
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('data_dir', 'H:\\VScode\\dashboard_demo-1\\data')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('data_dir', 'H:\\VScode\\dashboard_demo-1\\data')
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('output_dir', 'H:\\VScode\\dashboard_demo-1\\output')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('output_dir', 'H:\\VScode\\dashboard_demo-1\\output')
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('logs_dir', 'H:\\VScode\\dashboard_demo-1\\logs')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('logs_dir', 'H:\\VScode\\dashboard_demo-1\\logs')
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('components_dir', 'H:\\VScode\\dashboard_demo-1\\components')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('components_dir', 'H:\\VScode\\dashboard_demo-1\\components')
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('app_pages_dir', 'H:\\VScode\\dashboard_demo-1\\app_pages')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('app_pages_dir', 'H:\\VScode\\dashboard_demo-1\\app_pages')
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('utils_dir', 'H:\\VScode\\dashboard_demo-1\\utils')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('utils_dir', 'H:\\VScode\\dashboard_demo-1\\utils')
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('directories', {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'})
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('directories', {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'})
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('Donor_dedupe_cleaned_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\Donor_dedupe_cleaned_data.csv')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('ListofPoliticalPeople_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\ListOfPoliticalPeople.csv')
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('Donor_dedupe_cleaned_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\Donor_dedupe_cleaned_data.csv')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('mppartymemb_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\mppartymemb_pypd.csv')
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('ListofPoliticalPeople_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\ListOfPoliticalPeople.csv')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('donor_map_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\PoliticalDonorsDeDuped.csv')
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('mppartymemb_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\mppartymemb_pypd.csv')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('politician_party_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\ListOfPoliticalPeople_Final.csv')
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('donor_map_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\PoliticalDonorsDeDuped.csv')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('regentity_map_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\PoliticalEntityDeDuped.csv')
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('politician_party_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\ListOfPoliticalPeople_Final.csv')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('potential_donor_duplicates_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\potential_donor_duplicates.csv')
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('regentity_map_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\PoliticalEntityDeDuped.csv')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('potential_regulatedentity_duplicates_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\potential_regentiity_duplicates.csv')
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('potential_donor_duplicates_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\potential_donor_duplicates.csv')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('original_data_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\original_data.csv')
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('potential_regulatedentity_duplicates_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\potential_regentiity_duplicates.csv')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('CREDENTIALS_FILE', 'H:\\VScode\\dashboard_demo-1\\reference_files\\admin_credentials.json')
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('original_data_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\original_data.csv')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('TEXT_FILE', 'H:\\VScode\\dashboard_demo-1\\reference_files\\admin_text.json')
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('CREDENTIALS_FILE', 'H:\\VScode\\dashboard_demo-1\\reference_files\\admin_credentials.json')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('cleaned_data_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_data.csv')
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('TEXT_FILE', 'H:\\VScode\\dashboard_demo-1\\reference_files\\admin_text.json')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('cleaned_donations_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_donations.csv')
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('cleaned_data_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_data.csv')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('cleaned_donorlist_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_donorlist.csv')
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('cleaned_donations_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_donations.csv')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('cleaned_regentity_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_regentity.csv')
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('cleaned_donorlist_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_donorlist.csv')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('party_summary_fname', 'H:\\VScode\\dashboard_demo-1\\output\\party_summary.csv')
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('cleaned_regentity_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_regentity.csv')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'Donations_accepted_by_political_parties.csv')
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('party_summary_fname', 'H:\\VScode\\dashboard_demo-1\\output\\party_summary.csv')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'H:\\VScode\\dashboard_demo-1\\Donations_accepted_by_political_parties.csv')
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'Donations_accepted_by_political_parties.csv')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'H:\\VScode\\dashboard_demo-1\\Donations_accepted_by_political_parties.csv')
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'H:\\VScode\\dashboard_demo-1\\Donations_accepted_by_political_parties.csv')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('Cash_ftr', {'DonationType': 'Cash'})
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'H:\\VScode\\dashboard_demo-1\\Donations_accepted_by_political_parties.csv')
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:Session_state variables initialized
2025/02/28 10:18:04 PM INFO:Calling init_state_var with args=('Cash_ftr', {'DonationType': 'Cash'})
2025/02/28 10:18:04 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/02/28 10:18:04 PM INFO:init_state_var executed successfully
2025/02/28 10:18:04 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/02/28 10:18:04 PM INFO:Session_state variables initialized
2025/02/28 10:18:04 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/02/28 10:18:04 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/02/28 10:18:04 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/02/28 10:18:04 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/02/28 10:18:04 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/02/28 10:18:04 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/02/28 10:18:04 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/02/28 10:18:04 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/02/28 10:18:04 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/02/28 10:18:04 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/02/28 10:18:04 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/02/28 10:18:04 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/02/28 10:18:04 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/02/28 10:18:04 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/02/28 10:18:04 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/02/28 10:18:04 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/02/28 10:18:04 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/02/28 10:18:04 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/02/28 10:18:04 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/02/28 10:18:04 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/02/28 10:18:04 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/02/28 10:18:04 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/02/28 10:18:04 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/02/28 10:18:04 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/02/28 10:18:04 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/02/28 10:18:04 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/02/28 10:18:04 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/02/28 10:18:04 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/02/28 10:18:04 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/02/28 10:18:04 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/02/28 10:18:04 PM INFO:directories: {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/02/28 10:18:04 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/02/28 10:18:04 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/02/28 10:18:04 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/02/28 10:18:04 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/02/28 10:18:04 PM INFO:directories: {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/02/28 10:18:04 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/02/28 10:18:04 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/02/28 10:18:04 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/02/28 10:18:04 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/02/28 10:18:04 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/02/28 10:18:04 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/02/28 10:18:04 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/02/28 10:18:04 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/02/28 10:18:04 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/02/28 10:18:04 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/02/28 10:18:04 PM INFO:PLACEHOLDER_ID: 1000001
2025/02/28 10:18:04 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/02/28 10:18:04 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/02/28 10:18:04 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/02/28 10:18:04 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/02/28 10:18:04 PM INFO:PLACEHOLDER_ID: 1000001
2025/02/28 10:18:04 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/02/28 10:18:04 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/02/28 10:18:04 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/02/28 10:18:04 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/02/28 10:18:04 PM INFO:perc_target: 0.5
2025/02/28 10:18:04 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/02/28 10:18:04 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/02/28 10:18:04 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/02/28 10:18:04 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/02/28 10:18:04 PM INFO:perc_target: 0.5
2025/02/28 10:18:04 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/02/28 10:18:04 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/02/28 10:18:04 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/02/28 10:18:04 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/02/28 10:18:04 PM INFO:Session state Setup complete
2025/02/28 10:18:04 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/02/28 10:18:04 PM INFO:initialize_session_state executed successfully
2025/02/28 10:18:04 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/02/28 10:18:04 PM INFO:Package setup complete
2025/02/28 10:18:04 PM INFO:Session state Setup complete
2025/02/28 10:18:04 PM INFO:initialize_session_state executed successfully
2025/02/28 10:18:04 PM INFO:Calling pagesetup with args=()
2025/02/28 10:18:04 PM INFO:Package setup complete
2025/02/28 10:18:04 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\app_pages',)
2025/02/28 10:18:04 PM INFO:Calling pagesetup with args=()
2025/02/28 10:18:04 PM INFO:get_git_version executed successfully
2025/02/28 10:18:05 PM INFO:Calling get_git_version with args=()
2025/02/28 10:18:05 PM INFO:get_git_version executed successfully
2025/02/28 10:18:05 PM INFO:App Version: v20.128
2025/02/28 10:18:05 PM INFO:Switched to page: Introduction
2025/02/28 10:18:05 PM INFO:pagesetup executed successfully
2025/02/28 10:18:05 PM INFO:Calling firstload with args=()
2025/02/28 10:18:05 PM INFO:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x000001689DE2A7A0>)
2025/02/28 10:18:05 PM INFO:Calling get_raw_data with args=()
2025/02/28 10:18:05 PM INFO:Calling load_raw_data with args=()
2025/02/28 10:18:05 PM INFO:Calling raw_data_cleanup with args=(           ECRef              RegulatedEntityName    RegulatedEntityType        Value AcceptedDate AccountingUnitName  ... RegulatedEntityId AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                                                  ...                                                                                         
0      NC0408174                   Mr Andy Street        Regulated Donee    £1,876.56   02/09/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    £2,700.00   02/09/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    £4,852.58   30/08/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    £2,500.00   30/08/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    £4,524.05   29/08/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
...          ...                              ...                    ...          ...          ...                ...  ...               ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   £10,000.00          NaN                NaN  ...              3945              NaN  74198.0             NaN            NaN         False
65274   C0242461               Vote Leave Limited  Permitted Participant  £100,000.00          NaN                NaN  ...              3945              NaN  74184.0             NaN            NaN         False
65275   C0243560               Vote Leave Limited  Permitted Participant   £40,000.00          NaN                NaN  ...              3945              NaN  74576.0             NaN            NaN         False
65276   C0319710  Conservative and Unionist Party        Political Party   £50,000.00          NaN      Central Party  ...                52              NaN  34241.0             NaN  Great Britain         False
65277   C0319727  Conservative and Unionist Party        Political Party   £15,000.00          NaN      Central Party  ...                52              NaN  74743.0             NaN  Great Britain         False

[65278 rows x 29 columns],)
2025/02/28 10:18:06 PM INFO:Calling dedupe_entity_file with args=()
2025/02/28 10:18:06 PM INFO:map_filename: regentity_map_fname
2025/02/28 10:18:06 PM INFO:map_filename found: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/02/28 10:18:06 PM INFO:Dedupe by file
2025/02/28 10:18:07 PM INFO:Dedupe by file, shape: (65279, 34)
2025/02/28 10:18:07 PM INFO:dedupe_entity_file executed successfully
2025/02/28 10:18:07 PM INFO:Calling dedupe_entity_file with args=()
2025/02/28 10:18:07 PM INFO:map_filename: donor_map_fname
2025/02/28 10:18:07 PM INFO:map_filename found: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/02/28 10:18:07 PM INFO:Dedupe by file
2025/02/28 10:18:07 PM INFO:Dedupe by file, shape: (66011, 40)
2025/02/28 10:18:07 PM INFO:dedupe_entity_file executed successfully
2025/02/28 10:18:07 PM INFO:Data cleanup completed, shape: (66011, 40)
2025/02/28 10:18:07 PM INFO:raw_data_cleanup executed successfully
2025/02/28 10:18:08 PM INFO:load_raw_data executed successfully
2025/02/28 10:18:08 PM INFO:get_raw_data executed successfully
2025/02/28 10:18:08 PM INFO:load_data_to_session executed successfully
2025/02/28 10:18:08 PM INFO:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x000001689DE2B010>)
2025/02/28 10:18:08 PM INFO:Calling get_cleaned_data with args=()
2025/02/28 10:18:08 PM INFO:Calling load_cleaned_data with args=()
2025/02/28 10:18:11 PM INFO:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate AccountingUnitName  ...  DonorId                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...                ...  ...      ...                              ...        ...          ...           ...               ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN                     ...  74198.0          Shaftesbury Investments          1         2016             4            201604
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN                     ...  74184.0                Mr Jeremy Hosking          1         2016             2            201602
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN                     ...  23556.0                   Anthony Clarke          1         2016             6            201606
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN      Central Party  ...   2146.0                Mr Peter A Dubens          1         2017             5            201705
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN      Central Party  ...  74743.0                 Mr Ravi S Kailas          1         2017             5            201705

[66011 rows x 44 columns],)
2025/02/28 10:18:11 PM INFO:politician_party_dict:    Original RegulatedEntityId  RegulatedEntityId OriginalRegulatedEntityName  RegulatedEntityName   RegisterName                   RegulatedDoneeType RegulatedEntityType      CleanedName    Status PoliticalParty_pdpy
0                        6304               6304             Alec Shelbrooke      Alec Shelbrooke  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee  Alec Shelbrooke       NaN        Conservative
1                        6423               6423           Andrew Bingham Mp    Andrew Bingham Mp  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee   Andrew Bingham        Mp        Conservative
2                        1425               1425         Mr Boris Johnson Mp  Mr Boris Johnson Mp  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee    Boris Johnson   Mr & Mp        Conservative
3                        2061               2061          Mr John Lamont Msp   Mr John Lamont Msp  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee      John Lamont  Mr & Msp        Conservative
4                        6417               6417              Mr Sean Anstee       Mr Sean Anstee  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee      Sean Anstee        Mr             Unknown
2025/02/28 10:18:11 PM INFO:PartyUpdate_df: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}
2025/02/28 10:18:11 PM INFO:loaddata_df:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ...                        DonorName EventCount YearReceived MonthReceived YearMonthReceived PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...  Conservative And Unionist Party          1         2019             9            201909     NaN
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...  Conservative And Unionist Party          1         2019             9            201909     NaN
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...  Conservative And Unionist Party          1         2019             8            201908     NaN
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...  Conservative And Unionist Party          1         2019             8            201908     NaN
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...  Conservative And Unionist Party          1         2019             8            201908     0.0

[5 rows x 45 columns]
2025/02/28 10:18:11 PM INFO:RegulatedEntityNameMatch:    PartyId  RegulatedEntityId                                          PartyName                                RegulatedEntityName
0       17                 17                                  English Democrats                                  English Democrats
1       19                 19                         Legalise Cannabis Alliance                         Legalise Cannabis Alliance
2       30                 30        Upminster And Cranham Residents Association        Upminster And Cranham Residents Association
3       44                 44  Independent Kidderminster Hospital And Health ...  Independent Kidderminster Hospital And Health ...
4       46                 46                           Scottish Socialist Party                           Scottish Socialist Party
2025/02/28 10:18:11 PM ERROR:Error in map_mp_to_party: Series.replace cannot use dict-value and non-None to_replace
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 65, in map_mp_to_party
    loaddata_df['PartyName'].replace("",
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 8125, in replace
    raise ValueError(
ValueError: Series.replace cannot use dict-value and non-None to_replace
2025/02/28 10:18:11 PM ERROR:Error in load_cleaned_data: Series.replace cannot use dict-value and non-None to_replace
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 65, in map_mp_to_party
    loaddata_df['PartyName'].replace("",
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 8125, in replace
    raise ValueError(
ValueError: Series.replace cannot use dict-value and non-None to_replace
2025/02/28 10:18:11 PM ERROR:Error in get_cleaned_data: Series.replace cannot use dict-value and non-None to_replace
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 24, in get_cleaned_data
    return load_cleaned_data(datafile=None, output_csv=True, streamlitrun=True)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 65, in map_mp_to_party
    loaddata_df['PartyName'].replace("",
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 8125, in replace
    raise ValueError(
ValueError: Series.replace cannot use dict-value and non-None to_replace
2025/02/28 10:18:11 PM ERROR:Error in load_data_to_session: Series.replace cannot use dict-value and non-None to_replace
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 50, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 24, in get_cleaned_data
    return load_cleaned_data(datafile=None, output_csv=True, streamlitrun=True)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 65, in map_mp_to_party
    loaddata_df['PartyName'].replace("",
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 8125, in replace
    raise ValueError(
ValueError: Series.replace cannot use dict-value and non-None to_replace
2025/02/28 10:18:11 PM ERROR:Error in firstload: Series.replace cannot use dict-value and non-None to_replace
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 56, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 50, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 24, in get_cleaned_data
    return load_cleaned_data(datafile=None, output_csv=True, streamlitrun=True)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 65, in map_mp_to_party
    loaddata_df['PartyName'].replace("",
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 8125, in replace
    raise ValueError(
ValueError: Series.replace cannot use dict-value and non-None to_replace
2025/02/28 10:18:11 PM INFO:Calling get_git_version with args=()
2025/02/28 10:18:11 PM INFO:get_git_version executed successfully
2025/02/28 10:18:11 PM INFO:App Version: v20.128
2025/02/28 10:18:11 PM INFO:Switched to page: Introduction
2025/02/28 10:18:11 PM INFO:pagesetup executed successfully
2025/02/28 10:18:11 PM INFO:Calling firstload with args=()
2025/02/28 10:18:11 PM INFO:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x000001689DE2A7A0>)
2025/02/28 10:18:11 PM INFO:Calling get_raw_data with args=()
2025/02/28 10:18:11 PM INFO:get_raw_data executed successfully
2025/02/28 10:18:11 PM INFO:load_data_to_session executed successfully
2025/02/28 10:18:11 PM INFO:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x000001689DE2B010>)
2025/02/28 10:18:11 PM INFO:Calling get_cleaned_data with args=()
2025/02/28 10:18:11 PM INFO:Calling load_cleaned_data with args=()
2025/02/28 10:18:14 PM INFO:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate AccountingUnitName  ...  DonorId                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...                ...  ...      ...                              ...        ...          ...           ...               ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN                     ...  74198.0          Shaftesbury Investments          1         2016             4            201604
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN                     ...  74184.0                Mr Jeremy Hosking          1         2016             2            201602
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN                     ...  23556.0                   Anthony Clarke          1         2016             6            201606
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN      Central Party  ...   2146.0                Mr Peter A Dubens          1         2017             5            201705
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN      Central Party  ...  74743.0                 Mr Ravi S Kailas          1         2017             5            201705

[66011 rows x 44 columns],)
2025/02/28 10:18:14 PM INFO:politician_party_dict:    Original RegulatedEntityId  RegulatedEntityId OriginalRegulatedEntityName  RegulatedEntityName   RegisterName                   RegulatedDoneeType RegulatedEntityType      CleanedName    Status PoliticalParty_pdpy
0                        6304               6304             Alec Shelbrooke      Alec Shelbrooke  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee  Alec Shelbrooke       NaN        Conservative
1                        6423               6423           Andrew Bingham Mp    Andrew Bingham Mp  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee   Andrew Bingham        Mp        Conservative
2                        1425               1425         Mr Boris Johnson Mp  Mr Boris Johnson Mp  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee    Boris Johnson   Mr & Mp        Conservative
3                        2061               2061          Mr John Lamont Msp   Mr John Lamont Msp  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee      John Lamont  Mr & Msp        Conservative
4                        6417               6417              Mr Sean Anstee       Mr Sean Anstee  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee      Sean Anstee        Mr             Unknown
2025/02/28 10:18:14 PM INFO:PartyUpdate_df: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}
2025/02/28 10:18:14 PM INFO:loaddata_df:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ...                        DonorName EventCount YearReceived MonthReceived YearMonthReceived PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...  Conservative And Unionist Party          1         2019             9            201909     NaN
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...  Conservative And Unionist Party          1         2019             9            201909     NaN
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...  Conservative And Unionist Party          1         2019             8            201908     NaN
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...  Conservative And Unionist Party          1         2019             8            201908     NaN
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...  Conservative And Unionist Party          1         2019             8            201908     0.0

[5 rows x 45 columns]
2025/02/28 10:18:14 PM INFO:RegulatedEntityNameMatch:    PartyId  RegulatedEntityId                                          PartyName                                RegulatedEntityName
0       17                 17                                  English Democrats                                  English Democrats
1       19                 19                         Legalise Cannabis Alliance                         Legalise Cannabis Alliance
2       30                 30        Upminster And Cranham Residents Association        Upminster And Cranham Residents Association
3       44                 44  Independent Kidderminster Hospital And Health ...  Independent Kidderminster Hospital And Health ...
4       46                 46                           Scottish Socialist Party                           Scottish Socialist Party
2025/02/28 10:18:14 PM ERROR:Error in map_mp_to_party: Series.replace cannot use dict-value and non-None to_replace
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 65, in map_mp_to_party
    loaddata_df['PartyName'].replace("",
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 8125, in replace
    raise ValueError(
ValueError: Series.replace cannot use dict-value and non-None to_replace
2025/02/28 10:18:14 PM ERROR:Error in load_cleaned_data: Series.replace cannot use dict-value and non-None to_replace
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 65, in map_mp_to_party
    loaddata_df['PartyName'].replace("",
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 8125, in replace
    raise ValueError(
ValueError: Series.replace cannot use dict-value and non-None to_replace
2025/02/28 10:18:14 PM ERROR:Error in get_cleaned_data: Series.replace cannot use dict-value and non-None to_replace
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 24, in get_cleaned_data
    return load_cleaned_data(datafile=None, output_csv=True, streamlitrun=True)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 65, in map_mp_to_party
    loaddata_df['PartyName'].replace("",
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 8125, in replace
    raise ValueError(
ValueError: Series.replace cannot use dict-value and non-None to_replace
2025/02/28 10:18:14 PM ERROR:Error in load_data_to_session: Series.replace cannot use dict-value and non-None to_replace
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 50, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 24, in get_cleaned_data
    return load_cleaned_data(datafile=None, output_csv=True, streamlitrun=True)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 65, in map_mp_to_party
    loaddata_df['PartyName'].replace("",
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 8125, in replace
    raise ValueError(
ValueError: Series.replace cannot use dict-value and non-None to_replace
2025/02/28 10:18:14 PM ERROR:Error in firstload: Series.replace cannot use dict-value and non-None to_replace
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 56, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 50, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 24, in get_cleaned_data
    return load_cleaned_data(datafile=None, output_csv=True, streamlitrun=True)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 65, in map_mp_to_party
    loaddata_df['PartyName'].replace("",
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 8125, in replace
    raise ValueError(
ValueError: Series.replace cannot use dict-value and non-None to_replace
2025/02/28 10:21:05 PM INFO:Logging is set up correctly!
2025/02/28 10:21:05 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\utils',)
2025/02/28 10:21:05 PM INFO:get_git_version executed successfully
2025/02/28 10:21:05 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\data',)
2025/02/28 10:21:05 PM INFO:get_git_version executed successfully
2025/02/28 10:21:05 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\components',)
2025/02/28 10:21:06 PM INFO:get_git_version executed successfully
2025/02/28 10:21:06 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/02/28 10:21:06 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/02/28 10:21:06 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/02/28 10:21:06 PM INFO:Setting up the package
2025/02/28 10:21:06 PM INFO:Setting up the package
2025/02/28 10:21:06 PM INFO:Setting up the package
2025/02/28 10:21:06 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/02/28 10:21:06 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/02/28 10:21:06 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/02/28 10:21:06 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',)
2025/02/28 10:21:06 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',)
2025/02/28 10:21:06 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1',)
2025/02/28 10:21:06 PM INFO:get_git_version executed successfully
2025/02/28 10:21:06 PM INFO:get_git_version executed successfully
2025/02/28 10:21:06 PM INFO:get_git_version executed successfully
2025/02/28 10:21:06 PM INFO:Version: v20.113
2025/02/28 10:21:06 PM INFO:Version: v20.113
2025/02/28 10:21:06 PM INFO:Version: v20.113
2025/02/28 10:21:06 PM INFO:Calling initialize_session_state with args=()
2025/02/28 10:21:06 PM INFO:Calling initialize_session_state with args=()
2025/02/28 10:21:06 PM INFO:Calling initialize_session_state with args=()
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('BASE_DIR', 'H:\\VScode\\dashboard_demo-1')
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('BASE_DIR', 'H:\\VScode\\dashboard_demo-1')
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('BASE_DIR', 'H:\\VScode\\dashboard_demo-1')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('filenames', {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}})
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('filenames', {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}})
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('filenames', {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}})
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('PLACEHOLDER_DATE', Timestamp('1900-01-01 00:00:00'))
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('PLACEHOLDER_DATE', Timestamp('1900-01-01 00:00:00'))
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('PLACEHOLDER_DATE', Timestamp('1900-01-01 00:00:00'))
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('PLACEHOLDER_ID', 1000001)
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('PLACEHOLDER_ID', 1000001)
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('PLACEHOLDER_ID', 1000001)
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('thresholds', {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'})
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('thresholds', {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'})
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('thresholds', {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'})
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('data_remappings', {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}})
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('data_remappings', {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}})
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('data_remappings', {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}})
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('filter_def', {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}})
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('filter_def', {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}})
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('filter_def', {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}})
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('security', {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''})
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('security', {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''})
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('security', {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''})
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('perc_target', 0.5)
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('perc_target', 0.5)
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('perc_target', 0.5)
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('directories', {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'})
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('directories', {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'})
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('directories', {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'})
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('reference_dir', 'H:\\VScode\\dashboard_demo-1\\reference_files')
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('reference_dir', 'H:\\VScode\\dashboard_demo-1\\reference_files')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('reference_dir', 'H:\\VScode\\dashboard_demo-1\\reference_files')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('data_dir', 'H:\\VScode\\dashboard_demo-1\\data')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('data_dir', 'H:\\VScode\\dashboard_demo-1\\data')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('data_dir', 'H:\\VScode\\dashboard_demo-1\\data')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('output_dir', 'H:\\VScode\\dashboard_demo-1\\output')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('output_dir', 'H:\\VScode\\dashboard_demo-1\\output')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('output_dir', 'H:\\VScode\\dashboard_demo-1\\output')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('logs_dir', 'H:\\VScode\\dashboard_demo-1\\logs')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('logs_dir', 'H:\\VScode\\dashboard_demo-1\\logs')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('logs_dir', 'H:\\VScode\\dashboard_demo-1\\logs')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('components_dir', 'H:\\VScode\\dashboard_demo-1\\components')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('components_dir', 'H:\\VScode\\dashboard_demo-1\\components')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('components_dir', 'H:\\VScode\\dashboard_demo-1\\components')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('app_pages_dir', 'H:\\VScode\\dashboard_demo-1\\app_pages')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('app_pages_dir', 'H:\\VScode\\dashboard_demo-1\\app_pages')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('app_pages_dir', 'H:\\VScode\\dashboard_demo-1\\app_pages')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('utils_dir', 'H:\\VScode\\dashboard_demo-1\\utils')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('utils_dir', 'H:\\VScode\\dashboard_demo-1\\utils')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('utils_dir', 'H:\\VScode\\dashboard_demo-1\\utils')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('directories', {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'})
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('directories', {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'})
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('directories', {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'})
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('Donor_dedupe_cleaned_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\Donor_dedupe_cleaned_data.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('ListofPoliticalPeople_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\ListOfPoliticalPeople.csv')
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('Donor_dedupe_cleaned_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\Donor_dedupe_cleaned_data.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('Donor_dedupe_cleaned_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\Donor_dedupe_cleaned_data.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('mppartymemb_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\mppartymemb_pypd.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('ListofPoliticalPeople_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\ListOfPoliticalPeople.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('ListofPoliticalPeople_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\ListOfPoliticalPeople.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('donor_map_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\PoliticalDonorsDeDuped.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('mppartymemb_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\mppartymemb_pypd.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('mppartymemb_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\mppartymemb_pypd.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('politician_party_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\ListOfPoliticalPeople_Final.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('donor_map_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\PoliticalDonorsDeDuped.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('donor_map_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\PoliticalDonorsDeDuped.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('regentity_map_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\PoliticalEntityDeDuped.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('politician_party_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\ListOfPoliticalPeople_Final.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('politician_party_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\ListOfPoliticalPeople_Final.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('potential_donor_duplicates_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\potential_donor_duplicates.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('regentity_map_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\PoliticalEntityDeDuped.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('regentity_map_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\PoliticalEntityDeDuped.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('potential_regulatedentity_duplicates_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\potential_regentiity_duplicates.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('potential_donor_duplicates_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\potential_donor_duplicates.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('potential_donor_duplicates_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\potential_donor_duplicates.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('original_data_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\original_data.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('potential_regulatedentity_duplicates_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\potential_regentiity_duplicates.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('potential_regulatedentity_duplicates_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\potential_regentiity_duplicates.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('CREDENTIALS_FILE', 'H:\\VScode\\dashboard_demo-1\\reference_files\\admin_credentials.json')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('original_data_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\original_data.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('original_data_fname', 'H:\\VScode\\dashboard_demo-1\\reference_files\\original_data.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('TEXT_FILE', 'H:\\VScode\\dashboard_demo-1\\reference_files\\admin_text.json')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('CREDENTIALS_FILE', 'H:\\VScode\\dashboard_demo-1\\reference_files\\admin_credentials.json')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('CREDENTIALS_FILE', 'H:\\VScode\\dashboard_demo-1\\reference_files\\admin_credentials.json')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('cleaned_data_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_data.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('TEXT_FILE', 'H:\\VScode\\dashboard_demo-1\\reference_files\\admin_text.json')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('TEXT_FILE', 'H:\\VScode\\dashboard_demo-1\\reference_files\\admin_text.json')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('cleaned_donations_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_donations.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('cleaned_data_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_data.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('cleaned_data_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_data.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('cleaned_donorlist_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_donorlist.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('cleaned_donations_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_donations.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('cleaned_donations_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_donations.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('cleaned_regentity_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_regentity.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('cleaned_donorlist_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_donorlist.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('cleaned_donorlist_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_donorlist.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('party_summary_fname', 'H:\\VScode\\dashboard_demo-1\\output\\party_summary.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('cleaned_regentity_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_regentity.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('cleaned_regentity_fname', 'H:\\VScode\\dashboard_demo-1\\output\\cleaned_regentity.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'Donations_accepted_by_political_parties.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('party_summary_fname', 'H:\\VScode\\dashboard_demo-1\\output\\party_summary.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('party_summary_fname', 'H:\\VScode\\dashboard_demo-1\\output\\party_summary.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'H:\\VScode\\dashboard_demo-1\\Donations_accepted_by_political_parties.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'Donations_accepted_by_political_parties.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'Donations_accepted_by_political_parties.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'H:\\VScode\\dashboard_demo-1\\Donations_accepted_by_political_parties.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'H:\\VScode\\dashboard_demo-1\\Donations_accepted_by_political_parties.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'H:\\VScode\\dashboard_demo-1\\Donations_accepted_by_political_parties.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('Cash_ftr', {'DonationType': 'Cash'})
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'H:\\VScode\\dashboard_demo-1\\Donations_accepted_by_political_parties.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('ec_donations_fname', 'H:\\VScode\\dashboard_demo-1\\Donations_accepted_by_political_parties.csv')
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Session_state variables initialized
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('Cash_ftr', {'DonationType': 'Cash'})
2025/02/28 10:21:06 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/02/28 10:21:06 PM INFO:Calling init_state_var with args=('Cash_ftr', {'DonationType': 'Cash'})
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/02/28 10:21:06 PM INFO:init_state_var executed successfully
2025/02/28 10:21:06 PM INFO:Session_state variables initialized
2025/02/28 10:21:06 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/02/28 10:21:06 PM INFO:Session_state variables initialized
2025/02/28 10:21:06 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/02/28 10:21:06 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/02/28 10:21:06 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/02/28 10:21:06 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/02/28 10:21:06 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/02/28 10:21:06 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/02/28 10:21:06 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/02/28 10:21:06 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/02/28 10:21:06 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/02/28 10:21:06 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/02/28 10:21:06 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/02/28 10:21:06 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/02/28 10:21:06 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/02/28 10:21:06 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/02/28 10:21:06 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/02/28 10:21:06 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/02/28 10:21:06 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/02/28 10:21:06 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/02/28 10:21:06 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/02/28 10:21:06 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/02/28 10:21:06 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/02/28 10:21:06 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/02/28 10:21:06 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/02/28 10:21:06 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/02/28 10:21:06 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/02/28 10:21:06 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/02/28 10:21:06 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/02/28 10:21:06 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/02/28 10:21:06 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/02/28 10:21:06 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/02/28 10:21:06 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/02/28 10:21:06 PM INFO:PLACEHOLDER_ID: 1000001
2025/02/28 10:21:06 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/02/28 10:21:06 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/02/28 10:21:06 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/02/28 10:21:06 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/02/28 10:21:06 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/02/28 10:21:06 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/02/28 10:21:06 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/02/28 10:21:06 PM INFO:PLACEHOLDER_ID: 1000001
2025/02/28 10:21:06 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/02/28 10:21:06 PM INFO:PLACEHOLDER_ID: 1000001
2025/02/28 10:21:06 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/02/28 10:21:06 PM INFO:perc_target: 0.5
2025/02/28 10:21:06 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/02/28 10:21:06 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/02/28 10:21:06 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/02/28 10:21:06 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/02/28 10:21:06 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/02/28 10:21:06 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/02/28 10:21:06 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/02/28 10:21:06 PM INFO:perc_target: 0.5
2025/02/28 10:21:06 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/02/28 10:21:06 PM INFO:perc_target: 0.5
2025/02/28 10:21:06 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/02/28 10:21:06 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/02/28 10:21:06 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/02/28 10:21:06 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/02/28 10:21:06 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/02/28 10:21:06 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/02/28 10:21:06 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/02/28 10:21:06 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/02/28 10:21:06 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/02/28 10:21:06 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/02/28 10:21:06 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/02/28 10:21:06 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/02/28 10:21:06 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/02/28 10:21:06 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/02/28 10:21:06 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/02/28 10:21:06 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/02/28 10:21:06 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/02/28 10:21:06 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/02/28 10:21:06 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/02/28 10:21:06 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/02/28 10:21:06 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/02/28 10:21:06 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/02/28 10:21:06 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/02/28 10:21:06 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/02/28 10:21:06 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/02/28 10:21:06 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/02/28 10:21:06 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/02/28 10:21:06 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/02/28 10:21:06 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/02/28 10:21:06 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/02/28 10:21:06 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/02/28 10:21:06 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/02/28 10:21:06 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/02/28 10:21:06 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/02/28 10:21:06 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/02/28 10:21:06 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/02/28 10:21:06 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/02/28 10:21:06 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/02/28 10:21:06 PM INFO:directories: {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/02/28 10:21:06 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/02/28 10:21:06 PM INFO:directories: {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/02/28 10:21:06 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/02/28 10:21:06 PM INFO:Session state Setup complete
2025/02/28 10:21:06 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/02/28 10:21:06 PM INFO:initialize_session_state executed successfully
2025/02/28 10:21:06 PM INFO:Session state Setup complete
2025/02/28 10:21:06 PM INFO:Package setup complete
2025/02/28 10:21:06 PM INFO:initialize_session_state executed successfully
2025/02/28 10:21:06 PM INFO:Package setup complete
2025/02/28 10:21:06 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/02/28 10:21:06 PM INFO:Calling pagesetup with args=()
2025/02/28 10:21:06 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/02/28 10:21:06 PM INFO:Calling pagesetup with args=()
2025/02/28 10:21:06 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/02/28 10:21:06 PM INFO:directories: {'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/02/28 10:21:06 PM INFO:Calling get_git_version with args=('H:\\VScode\\dashboard_demo-1\\app_pages',)
2025/02/28 10:21:06 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/02/28 10:21:06 PM INFO:Session state Setup complete
2025/02/28 10:21:06 PM INFO:initialize_session_state executed successfully
2025/02/28 10:21:06 PM INFO:Package setup complete
2025/02/28 10:21:06 PM INFO:Calling pagesetup with args=()
2025/02/28 10:21:06 PM INFO:get_git_version executed successfully
2025/02/28 10:21:06 PM INFO:Calling get_git_version with args=()
2025/02/28 10:21:06 PM INFO:Calling get_git_version with args=()
2025/02/28 10:21:06 PM INFO:get_git_version executed successfully
2025/02/28 10:21:06 PM INFO:App Version: v20.128
2025/02/28 10:21:06 PM INFO:Switched to page: Introduction
2025/02/28 10:21:06 PM INFO:get_git_version executed successfully
2025/02/28 10:21:06 PM INFO:App Version: v20.128
2025/02/28 10:21:06 PM INFO:Switched to page: Introduction
2025/02/28 10:21:06 PM INFO:pagesetup executed successfully
2025/02/28 10:21:06 PM INFO:pagesetup executed successfully
2025/02/28 10:21:06 PM INFO:Calling firstload with args=()
2025/02/28 10:21:06 PM INFO:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x00000290A2B172E0>)
2025/02/28 10:21:06 PM INFO:Calling firstload with args=()
2025/02/28 10:21:06 PM INFO:Calling get_raw_data with args=()
2025/02/28 10:21:06 PM INFO:Calling load_raw_data with args=()
2025/02/28 10:21:07 PM INFO:Calling raw_data_cleanup with args=(           ECRef              RegulatedEntityName    RegulatedEntityType        Value AcceptedDate AccountingUnitName  ... RegulatedEntityId AccountingUnitId  DonorId CampaigningName   RegisterName IsIrishSource
index                                                                                                                  ...                                                                                         
0      NC0408174                   Mr Andy Street        Regulated Donee    £1,876.56   02/09/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
1      NC0408173                   Mr Andy Street        Regulated Donee    £2,700.00   02/09/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
2      NC0408177                   Mr Andy Street        Regulated Donee    £4,852.58   30/08/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
3      NC0408176                   Mr Andy Street        Regulated Donee    £2,500.00   30/08/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
4      NC0408170                   Mr Andy Street        Regulated Donee    £4,524.05   29/08/2019                NaN  ...              8015              NaN  86310.0             NaN  Great Britain         False
...          ...                              ...                    ...          ...          ...                ...  ...               ...              ...      ...             ...            ...           ...
65273   C0242478               Vote Leave Limited  Permitted Participant   £10,000.00          NaN                NaN  ...              3945              NaN  74198.0             NaN            NaN         False
65274   C0242461               Vote Leave Limited  Permitted Participant  £100,000.00          NaN                NaN  ...              3945              NaN  74184.0             NaN            NaN         False
65275   C0243560               Vote Leave Limited  Permitted Participant   £40,000.00          NaN                NaN  ...              3945              NaN  74576.0             NaN            NaN         False
65276   C0319710  Conservative and Unionist Party        Political Party   £50,000.00          NaN      Central Party  ...                52              NaN  34241.0             NaN  Great Britain         False
65277   C0319727  Conservative and Unionist Party        Political Party   £15,000.00          NaN      Central Party  ...                52              NaN  74743.0             NaN  Great Britain         False

[65278 rows x 29 columns],)
2025/02/28 10:21:08 PM INFO:Calling dedupe_entity_file with args=()
2025/02/28 10:21:08 PM INFO:map_filename: regentity_map_fname
2025/02/28 10:21:08 PM INFO:map_filename found: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/02/28 10:21:08 PM INFO:Dedupe by file
2025/02/28 10:21:08 PM INFO:Dedupe by file, shape: (65279, 34)
2025/02/28 10:21:08 PM INFO:dedupe_entity_file executed successfully
2025/02/28 10:21:08 PM INFO:Calling dedupe_entity_file with args=()
2025/02/28 10:21:08 PM INFO:map_filename: donor_map_fname
2025/02/28 10:21:08 PM INFO:map_filename found: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/02/28 10:21:08 PM INFO:Dedupe by file
2025/02/28 10:21:08 PM INFO:Dedupe by file, shape: (66011, 40)
2025/02/28 10:21:08 PM INFO:dedupe_entity_file executed successfully
2025/02/28 10:21:08 PM INFO:Data cleanup completed, shape: (66011, 40)
2025/02/28 10:21:08 PM INFO:raw_data_cleanup executed successfully
2025/02/28 10:21:09 PM INFO:load_raw_data executed successfully
2025/02/28 10:21:10 PM INFO:get_raw_data executed successfully
2025/02/28 10:21:10 PM INFO:load_data_to_session executed successfully
2025/02/28 10:21:10 PM INFO:Calling load_data_to_session with args=('data_clean', <function get_cleaned_data at 0x00000290A2B17B50>)
2025/02/28 10:21:10 PM INFO:Calling get_cleaned_data with args=()
2025/02/28 10:21:10 PM INFO:Calling load_cleaned_data with args=()
2025/02/28 10:21:12 PM INFO:Calling map_mp_to_party with args=(           ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value AcceptedDate AccountingUnitName  ...  DonorId                        DonorName EventCount YearReceived MonthReceived YearMonthReceived
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56   02/09/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             9            201909
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00   02/09/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             9            201909
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58   30/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00   30/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05   29/08/2019                     ...  86310.0  Conservative And Unionist Party          1         2019             8            201908
...          ...                              ...                    ...        ...          ...                ...  ...      ...                              ...        ...          ...           ...               ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00          NaN                     ...  74198.0          Shaftesbury Investments          1         2016             4            201604
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00          NaN                     ...  74184.0                Mr Jeremy Hosking          1         2016             2            201602
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00          NaN                     ...  23556.0                   Anthony Clarke          1         2016             6            201606
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00          NaN      Central Party  ...   2146.0                Mr Peter A Dubens          1         2017             5            201705
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00          NaN      Central Party  ...  74743.0                 Mr Ravi S Kailas          1         2017             5            201705

[66011 rows x 44 columns],)
2025/02/28 10:21:12 PM INFO:politician_party_dict:    Original RegulatedEntityId  RegulatedEntityId OriginalRegulatedEntityName  RegulatedEntityName   RegisterName                   RegulatedDoneeType RegulatedEntityType      CleanedName    Status PoliticalParty_pdpy
0                        6304               6304             Alec Shelbrooke      Alec Shelbrooke  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee  Alec Shelbrooke       NaN        Conservative
1                        6423               6423           Andrew Bingham Mp    Andrew Bingham Mp  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee   Andrew Bingham        Mp        Conservative
2                        1425               1425         Mr Boris Johnson Mp  Mr Boris Johnson Mp  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee    Boris Johnson   Mr & Mp        Conservative
3                        2061               2061          Mr John Lamont Msp   Mr John Lamont Msp  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee      John Lamont  Mr & Msp        Conservative
4                        6417               6417              Mr Sean Anstee       Mr Sean Anstee  Great Britain  Cllr. - Member of a Local Authority     Regulated Donee      Sean Anstee        Mr             Unknown
2025/02/28 10:21:12 PM INFO:PartyUpdate_df: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}
2025/02/28 10:21:12 PM INFO:loaddata_df:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ...                        DonorName EventCount YearReceived MonthReceived YearMonthReceived PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...  Conservative And Unionist Party          1         2019             9            201909     NaN
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...  Conservative And Unionist Party          1         2019             9            201909     NaN
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...  Conservative And Unionist Party          1         2019             8            201908     NaN
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...  Conservative And Unionist Party          1         2019             8            201908     NaN
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...  Conservative And Unionist Party          1         2019             8            201908     0.0

[5 rows x 45 columns]
2025/02/28 10:21:12 PM INFO:RegulatedEntityNameMatch:    PartyId  RegulatedEntityId                                          PartyName                                RegulatedEntityName
0       17                 17                                  English Democrats                                  English Democrats
1       19                 19                         Legalise Cannabis Alliance                         Legalise Cannabis Alliance
2       30                 30        Upminster And Cranham Residents Association        Upminster And Cranham Residents Association
3       44                 44  Independent Kidderminster Hospital And Health ...  Independent Kidderminster Hospital And Health ...
4       46                 46                           Scottish Socialist Party                           Scottish Socialist Party
2025/02/28 10:21:13 PM INFO:loaddata_df:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyId PartyName
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909     NaN       NaN
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909     NaN       NaN
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908     NaN       NaN
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908     NaN       NaN
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908     0.0       NaN

[5 rows x 46 columns]
2025/02/28 10:21:13 PM ERROR:Error in map_mp_to_party: Series.replace cannot use dict-value and non-None to_replace
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 67, in map_mp_to_party
    loaddata_df['PartyName'].replace("",
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 8125, in replace
    raise ValueError(
ValueError: Series.replace cannot use dict-value and non-None to_replace
2025/02/28 10:21:13 PM ERROR:Error in load_cleaned_data: Series.replace cannot use dict-value and non-None to_replace
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 67, in map_mp_to_party
    loaddata_df['PartyName'].replace("",
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 8125, in replace
    raise ValueError(
ValueError: Series.replace cannot use dict-value and non-None to_replace
2025/02/28 10:21:13 PM ERROR:Error in get_cleaned_data: Series.replace cannot use dict-value and non-None to_replace
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 24, in get_cleaned_data
    return load_cleaned_data(datafile=None, output_csv=True, streamlitrun=True)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 67, in map_mp_to_party
    loaddata_df['PartyName'].replace("",
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 8125, in replace
    raise ValueError(
ValueError: Series.replace cannot use dict-value and non-None to_replace
2025/02/28 10:21:13 PM ERROR:Error in load_data_to_session: Series.replace cannot use dict-value and non-None to_replace
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 50, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 24, in get_cleaned_data
    return load_cleaned_data(datafile=None, output_csv=True, streamlitrun=True)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 67, in map_mp_to_party
    loaddata_df['PartyName'].replace("",
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 8125, in replace
    raise ValueError(
ValueError: Series.replace cannot use dict-value and non-None to_replace
2025/02/28 10:21:13 PM INFO:Calling load_data_to_session with args=('raw_data', <function get_raw_data at 0x00000290A2B172E0>)
2025/02/28 10:21:13 PM ERROR:Error in firstload: Series.replace cannot use dict-value and non-None to_replace
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 56, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 50, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 24, in get_cleaned_data
    return load_cleaned_data(datafile=None, output_csv=True, streamlitrun=True)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 82, in load_cleaned_data
    loadclean_df = map_mp_to_party(loadclean_df)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 31, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 26, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\politicalperson.py", line 67, in map_mp_to_party
    loaddata_df['PartyName'].replace("",
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 8125, in replace
    raise ValueError(
ValueError: Series.replace cannot use dict-value and non-None to_replace
